{"episode_reward_max": -8.3, "episode_reward_min": -139.3, "episode_reward_mean": -44.21500000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-124.2, -41.0, -26.300000000000004, -39.300000000000004, -52.4, -36.3, -32.2, -127.3, -35.6, -75.7, -42.20000000000001, -23.2, -14.799999999999978, -50.7, -8.3, -37.2, -20.30000000000005, -44.000000000000014, -38.3, -39.90000000000002, -25.9, -66.30000000000001, -63.50000000000002, -11.6, -139.3, -96.0, -54.4, -21.900000000000052, -15.999999999999982, -10.799999999999999, -46.3, -45.2, -19.6, -22.400000000000006, -43.2, -44.3, -52.30000000000001, -29.000000000000004, -18.099999999999998, -33.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.829590784086214, "mean_inference_ms": 1.1966414861269405, "mean_action_processing_ms": 0.06787105278297142, "mean_env_wait_ms": 5.535625077627756, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 4000, "timesteps_this_iter": 0, "agent_timesteps_total": 4000, "timers": {"sample_time_ms": 7886.578, "sample_throughput": 507.191, "load_time_ms": 0.403, "load_throughput": 9921476.05, "learn_time_ms": 7197.514, "learn_throughput": 555.747, "update_time_ms": 1.953}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.212860783260636, "policy_loss": -0.008900303393602371, "vf_loss": 421.89019523282207, "vf_explained_var": 0.023223114526400003, "kl": 0.014296083734490013, "entropy": 0.6791768377186149, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4000, "num_agent_steps_sampled": 4000, "num_steps_trained": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 40, "training_iteration": 1, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-08-52", "timestamp": 1643645332, "time_this_iter_s": 15.086133003234863, "time_total_s": 15.086133003234863, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15.086133003234863, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.513636363636365, "ram_util_percent": 62.58181818181818}}
{"episode_reward_max": -8.3, "episode_reward_min": -173.3, "episode_reward_mean": -43.35875, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-124.2, -41.0, -26.300000000000004, -39.300000000000004, -52.4, -36.3, -32.2, -127.3, -35.6, -75.7, -42.20000000000001, -23.2, -14.799999999999978, -50.7, -8.3, -37.2, -20.30000000000005, -44.000000000000014, -38.3, -39.90000000000002, -25.9, -66.30000000000001, -63.50000000000002, -11.6, -139.3, -96.0, -54.4, -21.900000000000052, -15.999999999999982, -10.799999999999999, -46.3, -45.2, -19.6, -22.400000000000006, -43.2, -44.3, -52.30000000000001, -29.000000000000004, -18.099999999999998, -33.3, -147.4, -24.3, -45.7, -26.3, -37.40000000000008, -11.39999999999999, -30.3, -23.0, -38.30000000000007, -32.3, -34.400000000000006, -15.79999999999998, -23.4, -11.999999999999998, -44.3, -20.699999999999985, -87.80000000000015, -24.000000000000007, -44.4, -40.4, -33.90000000000002, -44.7, -43.6, -9.2, -34.4, -25.70000000000001, -22.400000000000006, -27.400000000000002, -18.3, -37.4, -35.20000000000001, -173.3, -46.4, -31.20000000000001, -76.19999999999993, -28.2, -29.500000000000007, -138.7, -29.300000000000004, -51.5], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8861268653359635, "mean_inference_ms": 1.2206775031542654, "mean_action_processing_ms": 0.06905944738024823, "mean_env_wait_ms": 5.6164156494347, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 8000, "timesteps_this_iter": 0, "agent_timesteps_total": 8000, "timers": {"sample_time_ms": 11777.454, "sample_throughput": 339.632, "load_time_ms": 0.384, "load_throughput": 10414162.632, "learn_time_ms": 6921.345, "learn_throughput": 577.922, "update_time_ms": 2.055}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.245117641576836, "policy_loss": -0.00902103515522134, "vf_loss": 325.2273203931829, "vf_explained_var": 0.04012226263682048, "kl": 0.009327862379342036, "entropy": 0.663418084703466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 8000, "num_agent_steps_sampled": 8000, "num_steps_trained": 8000, "num_agent_steps_trained": 8000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 80, "training_iteration": 2, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-09-07", "timestamp": 1643645347, "time_this_iter_s": 15.094554662704468, "time_total_s": 30.18068766593933, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 30.18068766593933, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 36.154545454545456, "ram_util_percent": 62.59999999999998}}
{"episode_reward_max": -9.2, "episode_reward_min": -173.3, "episode_reward_mean": -39.44800000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.9, -66.30000000000001, -63.50000000000002, -11.6, -139.3, -96.0, -54.4, -21.900000000000052, -15.999999999999982, -10.799999999999999, -46.3, -45.2, -19.6, -22.400000000000006, -43.2, -44.3, -52.30000000000001, -29.000000000000004, -18.099999999999998, -33.3, -147.4, -24.3, -45.7, -26.3, -37.40000000000008, -11.39999999999999, -30.3, -23.0, -38.30000000000007, -32.3, -34.400000000000006, -15.79999999999998, -23.4, -11.999999999999998, -44.3, -20.699999999999985, -87.80000000000015, -24.000000000000007, -44.4, -40.4, -33.90000000000002, -44.7, -43.6, -9.2, -34.4, -25.70000000000001, -22.400000000000006, -27.400000000000002, -18.3, -37.4, -35.20000000000001, -173.3, -46.4, -31.20000000000001, -76.19999999999993, -28.2, -29.500000000000007, -138.7, -29.300000000000004, -51.5, -37.2, -36.099999999999994, -10.6, -27.200000000000006, -25.600000000000016, -38.400000000000006, -61.7, -22.299999999999983, -32.3, -9.3, -48.300000000000004, -32.4, -11.899999999999999, -29.2, -39.4, -27.6, -69.19999999999999, -31.3, -65.3, -13.499999999999996, -41.10000000000008, -44.90000000000002, -18.3, -33.900000000000006, -35.4, -34.7, -54.7, -27.0, -50.0, -39.2, -49.6, -10.2, -56.90000000000012, -22.299999999999965, -40.3, -20.1, -27.2, -37.40000000000002, -32.499999999999986, -40.80000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9497888940382375, "mean_inference_ms": 1.2769629295044183, "mean_action_processing_ms": 0.07165309761605836, "mean_env_wait_ms": 5.852785136713043, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 12000, "timesteps_this_iter": 0, "agent_timesteps_total": 12000, "timers": {"sample_time_ms": 13483.271, "sample_throughput": 296.664, "load_time_ms": 0.378, "load_throughput": 10589448.348, "learn_time_ms": 7137.15, "learn_throughput": 560.448, "update_time_ms": 1.978}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.6976665171278861, "policy_loss": -0.018943691081417503, "vf_loss": 71.35877977186634, "vf_explained_var": 0.07095179070708572, "kl": 0.015112140240424394, "entropy": 0.6258201121002115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 12000, "num_agent_steps_sampled": 12000, "num_steps_trained": 12000, "num_agent_steps_trained": 12000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 120, "training_iteration": 3, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-09-25", "timestamp": 1643645365, "time_this_iter_s": 17.787126064300537, "time_total_s": 47.96781373023987, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 47.96781373023987, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 45.62, "ram_util_percent": 62.55199999999999}}
{"episode_reward_max": -7.299999999999999, "episode_reward_min": -173.3, "episode_reward_mean": -35.254, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.90000000000002, -44.7, -43.6, -9.2, -34.4, -25.70000000000001, -22.400000000000006, -27.400000000000002, -18.3, -37.4, -35.20000000000001, -173.3, -46.4, -31.20000000000001, -76.19999999999993, -28.2, -29.500000000000007, -138.7, -29.300000000000004, -51.5, -37.2, -36.099999999999994, -10.6, -27.200000000000006, -25.600000000000016, -38.400000000000006, -61.7, -22.299999999999983, -32.3, -9.3, -48.300000000000004, -32.4, -11.899999999999999, -29.2, -39.4, -27.6, -69.19999999999999, -31.3, -65.3, -13.499999999999996, -41.10000000000008, -44.90000000000002, -18.3, -33.900000000000006, -35.4, -34.7, -54.7, -27.0, -50.0, -39.2, -49.6, -10.2, -56.90000000000012, -22.299999999999965, -40.3, -20.1, -27.2, -37.40000000000002, -32.499999999999986, -40.80000000000001, -10.2, -23.10000000000001, -7.3, -11.600000000000001, -24.900000000000002, -17.0, -23.4, -26.000000000000004, -17.299999999999997, -16.199999999999996, -36.4, -28.2, -44.800000000000004, -34.7, -57.3, -16.3, -7.299999999999999, -24.3, -13.899999999999999, -30.3, -25.500000000000007, -86.70000000000006, -20.3, -148.1, -50.00000000000001, -16.2, -15.699999999999992, -19.1, -37.1, -21.5, -64.2, -29.60000000000001, -23.7, -23.300000000000004, -35.3, -25.300000000000004, -14.299999999999999, -29.5, -26.2, -21.5], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0163389939520118, "mean_inference_ms": 1.3272809037794249, "mean_action_processing_ms": 0.07406287366874023, "mean_env_wait_ms": 6.050655945843184, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 16000, "timesteps_this_iter": 0, "agent_timesteps_total": 16000, "timers": {"sample_time_ms": 14212.96, "sample_throughput": 281.433, "load_time_ms": 0.371, "load_throughput": 10787472.111, "learn_time_ms": 6984.458, "learn_throughput": 572.7, "update_time_ms": 1.979}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.544003279290102, "policy_loss": -0.019628766862054666, "vf_loss": 156.1272549095974, "vf_explained_var": 0.03284972527975677, "kl": 0.011797632426351791, "entropy": 0.6120969694147828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 16000, "num_agent_steps_sampled": 16000, "num_steps_trained": 16000, "num_agent_steps_trained": 16000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 160, "training_iteration": 4, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-09-40", "timestamp": 1643645380, "time_this_iter_s": 15.332265853881836, "time_total_s": 63.300079584121704, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 63.300079584121704, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.27272727272727, "ram_util_percent": 62.57272727272725}}
{"episode_reward_max": -4.5, "episode_reward_min": -148.1, "episode_reward_mean": -28.846000000000007, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.10000000000008, -44.90000000000002, -18.3, -33.900000000000006, -35.4, -34.7, -54.7, -27.0, -50.0, -39.2, -49.6, -10.2, -56.90000000000012, -22.299999999999965, -40.3, -20.1, -27.2, -37.40000000000002, -32.499999999999986, -40.80000000000001, -10.2, -23.10000000000001, -7.3, -11.600000000000001, -24.900000000000002, -17.0, -23.4, -26.000000000000004, -17.299999999999997, -16.199999999999996, -36.4, -28.2, -44.800000000000004, -34.7, -57.3, -16.3, -7.299999999999999, -24.3, -13.899999999999999, -30.3, -25.500000000000007, -86.70000000000006, -20.3, -148.1, -50.00000000000001, -16.2, -15.699999999999992, -19.1, -37.1, -21.5, -64.2, -29.60000000000001, -23.7, -23.300000000000004, -35.3, -25.300000000000004, -14.299999999999999, -29.5, -26.2, -21.5, -9.3, -11.3, -28.30000000000001, -16.3, -27.400000000000002, -9.2, -20.0, -11.2, -18.7, -55.70000000000003, -35.20000000000001, -21.3, -16.900000000000002, -15.799999999999999, -35.8, -29.400000000000002, -26.700000000000006, -15.799999999999995, -30.3, -19.299999999999997, -29.3, -42.80000000000003, -25.5, -40.2, -48.90000000000006, -12.7, -29.300000000000004, -16.499999999999996, -32.3, -4.5, -16.9, -23.099999999999998, -11.7, -17.2, -20.199999999999996, -35.3, -12.6, -17.800000000000004, -39.4, -34.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0366558226337288, "mean_inference_ms": 1.334684654126201, "mean_action_processing_ms": 0.074230753293193, "mean_env_wait_ms": 6.0553328918747535, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 20000, "timesteps_this_iter": 0, "agent_timesteps_total": 20000, "timers": {"sample_time_ms": 14233.4, "sample_throughput": 281.029, "load_time_ms": 0.362, "load_throughput": 11034738.227, "learn_time_ms": 6917.383, "learn_throughput": 578.253, "update_time_ms": 1.874}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.4324997539391681, "policy_loss": -0.023443959448086, "vf_loss": 45.3807281555668, "vf_explained_var": 0.07906203417367832, "kl": 0.010682226168753264, "entropy": 0.5735951765250135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 20000, "num_agent_steps_sampled": 20000, "num_steps_trained": 20000, "num_agent_steps_trained": 20000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 5, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-09-55", "timestamp": 1643645395, "time_this_iter_s": 14.403940916061401, "time_total_s": 77.7040205001831, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 77.7040205001831, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 31.499999999999993, "ram_util_percent": 62.59499999999999}}
{"episode_reward_max": -4.5, "episode_reward_min": -148.1, "episode_reward_mean": -25.936000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.500000000000007, -86.70000000000006, -20.3, -148.1, -50.00000000000001, -16.2, -15.699999999999992, -19.1, -37.1, -21.5, -64.2, -29.60000000000001, -23.7, -23.300000000000004, -35.3, -25.300000000000004, -14.299999999999999, -29.5, -26.2, -21.5, -9.3, -11.3, -28.30000000000001, -16.3, -27.400000000000002, -9.2, -20.0, -11.2, -18.7, -55.70000000000003, -35.20000000000001, -21.3, -16.900000000000002, -15.799999999999999, -35.8, -29.400000000000002, -26.700000000000006, -15.799999999999995, -30.3, -19.299999999999997, -29.3, -42.80000000000003, -25.5, -40.2, -48.90000000000006, -12.7, -29.300000000000004, -16.499999999999996, -32.3, -4.5, -16.9, -23.099999999999998, -11.7, -17.2, -20.199999999999996, -35.3, -12.6, -17.800000000000004, -39.4, -34.4, -20.5, -13.7, -32.4, -8.3, -32.400000000000006, -8.0, -13.89999999999999, -19.30000000000001, -26.400000000000006, -22.2, -16.4, -22.7, -19.3, -36.3, -10.3, -17.3, -26.400000000000006, -22.3, -23.4, -29.3, -9.799999999999999, -60.2, -30.999999999999986, -23.9, -42.2, -18.2, -33.500000000000014, -22.100000000000055, -29.2, -15.799999999999997, -18.5, -37.0, -13.2, -13.7, -10.3, -10.399999999999999, -19.9, -17.8, -26.299999999999997, -22.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0299860375064829, "mean_inference_ms": 1.311328514984872, "mean_action_processing_ms": 0.07290183682415231, "mean_env_wait_ms": 5.937723283021016, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 24000, "timesteps_this_iter": 0, "agent_timesteps_total": 24000, "timers": {"sample_time_ms": 14258.908, "sample_throughput": 280.526, "load_time_ms": 0.359, "load_throughput": 11134088.707, "learn_time_ms": 6805.293, "learn_throughput": 587.778, "update_time_ms": 1.816}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.3820538953802879, "policy_loss": -0.022450610118046884, "vf_loss": 40.22598921047744, "vf_explained_var": 0.14448552214971153, "kl": 0.011223101323248585, "entropy": 0.5370771212283001, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 24000, "num_agent_steps_sampled": 24000, "num_steps_trained": 24000, "num_agent_steps_trained": 24000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 240, "training_iteration": 6, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-10-09", "timestamp": 1643645409, "time_this_iter_s": 13.950359106063843, "time_total_s": 91.65437960624695, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 91.65437960624695, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 32.35, "ram_util_percent": 62.54999999999999}}
{"episode_reward_max": -4.2, "episode_reward_min": -60.2, "episode_reward_mean": -21.697, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.3, -42.80000000000003, -25.5, -40.2, -48.90000000000006, -12.7, -29.300000000000004, -16.499999999999996, -32.3, -4.5, -16.9, -23.099999999999998, -11.7, -17.2, -20.199999999999996, -35.3, -12.6, -17.800000000000004, -39.4, -34.4, -20.5, -13.7, -32.4, -8.3, -32.400000000000006, -8.0, -13.89999999999999, -19.30000000000001, -26.400000000000006, -22.2, -16.4, -22.7, -19.3, -36.3, -10.3, -17.3, -26.400000000000006, -22.3, -23.4, -29.3, -9.799999999999999, -60.2, -30.999999999999986, -23.9, -42.2, -18.2, -33.500000000000014, -22.100000000000055, -29.2, -15.799999999999997, -18.5, -37.0, -13.2, -13.7, -10.3, -10.399999999999999, -19.9, -17.8, -26.299999999999997, -22.2, -19.2, -16.199999999999996, -26.3, -26.5, -15.199999999999982, -8.3, -38.3, -16.299999999999997, -47.79999999999999, -24.200000000000003, -52.3, -17.6, -4.2, -7.099999999999999, -13.2, -30.199999999999996, -7.300000000000001, -17.800000000000004, -22.00000000000001, -26.700000000000003, -13.699999999999998, -23.2, -11.7, -6.499999999999998, -25.4, -10.399999999999999, -6.2, -19.3, -34.70000000000003, -21.0, -19.3, -14.2, -14.299999999999999, -15.399999999999999, -11.1, -13.5, -13.3, -13.2, -22.00000000000001, -18.0], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0118504236648374, "mean_inference_ms": 1.291979765863613, "mean_action_processing_ms": 0.07181112262987685, "mean_env_wait_ms": 5.84459154541372, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 28000, "timesteps_this_iter": 0, "agent_timesteps_total": 28000, "timers": {"sample_time_ms": 14255.856, "sample_throughput": 280.586, "load_time_ms": 0.355, "load_throughput": 11270682.534, "learn_time_ms": 6721.107, "learn_throughput": 595.14, "update_time_ms": 1.748}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.2529790300780767, "policy_loss": -0.020270129455433737, "vf_loss": 27.107512608907555, "vf_explained_var": 0.16949549932633676, "kl": 0.010870200334215542, "entropy": 0.5183674376497986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 28000, "num_agent_steps_sampled": 28000, "num_steps_trained": 28000, "num_agent_steps_trained": 28000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 280, "training_iteration": 7, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-10-23", "timestamp": 1643645423, "time_this_iter_s": 14.176770210266113, "time_total_s": 105.83114981651306, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 105.83114981651306, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 32.65, "ram_util_percent": 62.529999999999994}}
{"episode_reward_max": -4.2, "episode_reward_min": -61.3, "episode_reward_mean": -20.664, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.799999999999999, -60.2, -30.999999999999986, -23.9, -42.2, -18.2, -33.500000000000014, -22.100000000000055, -29.2, -15.799999999999997, -18.5, -37.0, -13.2, -13.7, -10.3, -10.399999999999999, -19.9, -17.8, -26.299999999999997, -22.2, -19.2, -16.199999999999996, -26.3, -26.5, -15.199999999999982, -8.3, -38.3, -16.299999999999997, -47.79999999999999, -24.200000000000003, -52.3, -17.6, -4.2, -7.099999999999999, -13.2, -30.199999999999996, -7.300000000000001, -17.800000000000004, -22.00000000000001, -26.700000000000003, -13.699999999999998, -23.2, -11.7, -6.499999999999998, -25.4, -10.399999999999999, -6.2, -19.3, -34.70000000000003, -21.0, -19.3, -14.2, -14.299999999999999, -15.399999999999999, -11.1, -13.5, -13.3, -13.2, -22.00000000000001, -18.0, -20.3, -11.3, -11.2, -21.800000000000004, -39.5, -19.2, -30.2, -6.799999999999999, -61.3, -15.599999999999998, -10.2, -9.2, -14.4, -33.50000000000002, -15.799999999999999, -21.600000000000005, -11.1, -51.3, -26.199999999999992, -9.899999999999999, -18.3, -18.600000000000005, -52.2, -16.099999999999994, -11.9, -10.3, -15.5, -5.699999999999999, -14.3, -21.3, -16.3, -17.599999999999998, -11.199999999999998, -39.40000000000002, -5.2, -23.0, -11.2, -21.099999999999994, -49.3, -9.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9904099792846209, "mean_inference_ms": 1.2761808654775066, "mean_action_processing_ms": 0.07094888315766751, "mean_env_wait_ms": 5.769692076614356, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 32000, "timesteps_this_iter": 0, "agent_timesteps_total": 32000, "timers": {"sample_time_ms": 14176.253, "sample_throughput": 282.162, "load_time_ms": 0.354, "load_throughput": 11310164.995, "learn_time_ms": 6749.61, "learn_throughput": 592.627, "update_time_ms": 1.702}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.7582520815841753, "policy_loss": -0.01587832549221373, "vf_loss": 77.14523265438694, "vf_explained_var": 0.05156745750416992, "kl": 0.013390480288176904, "entropy": 0.47558895224525083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 32000, "num_agent_steps_sampled": 32000, "num_steps_trained": 32000, "num_agent_steps_trained": 32000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 320, "training_iteration": 8, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-10-37", "timestamp": 1643645437, "time_this_iter_s": 14.319852828979492, "time_total_s": 120.15100264549255, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 120.15100264549255, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 32.7952380952381, "ram_util_percent": 62.5095238095238}}
{"episode_reward_max": -5.2, "episode_reward_min": -95.99999999999989, "episode_reward_mean": -21.592000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.699999999999998, -23.2, -11.7, -6.499999999999998, -25.4, -10.399999999999999, -6.2, -19.3, -34.70000000000003, -21.0, -19.3, -14.2, -14.299999999999999, -15.399999999999999, -11.1, -13.5, -13.3, -13.2, -22.00000000000001, -18.0, -20.3, -11.3, -11.2, -21.800000000000004, -39.5, -19.2, -30.2, -6.799999999999999, -61.3, -15.599999999999998, -10.2, -9.2, -14.4, -33.50000000000002, -15.799999999999999, -21.600000000000005, -11.1, -51.3, -26.199999999999992, -9.899999999999999, -18.3, -18.600000000000005, -52.2, -16.099999999999994, -11.9, -10.3, -15.5, -5.699999999999999, -14.3, -21.3, -16.3, -17.599999999999998, -11.199999999999998, -39.40000000000002, -5.2, -23.0, -11.2, -21.099999999999994, -49.3, -9.2, -89.09999999999992, -15.7, -65.19999999999997, -18.500000000000007, -13.799999999999999, -14.4, -15.3, -67.2, -16.2, -15.699999999999998, -15.399999999999984, -32.60000000000001, -6.999999999999998, -8.9, -5.7, -10.899999999999999, -11.2, -34.3, -9.700000000000001, -26.6, -33.600000000000016, -8.099999999999998, -26.3, -76.3, -5.9, -9.3, -10.9, -18.6, -13.1, -19.10000000000001, -13.199999999999996, -13.2, -77.70000000000003, -95.99999999999989, -23.800000000000004, -17.4, -13.4, -7.3, -14.3, -13.799999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9781941746214793, "mean_inference_ms": 1.2635005179382846, "mean_action_processing_ms": 0.07029921275546734, "mean_env_wait_ms": 5.705857170211239, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 36000, "timesteps_this_iter": 0, "agent_timesteps_total": 36000, "timers": {"sample_time_ms": 14245.303, "sample_throughput": 280.794, "load_time_ms": 0.353, "load_throughput": 11333404.188, "learn_time_ms": 6724.943, "learn_throughput": 594.801, "update_time_ms": 1.69}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.0063183378756186, "policy_loss": -0.011722487022960058, "vf_loss": 101.61225204365228, "vf_explained_var": -0.038412936143977665, "kl": 0.009591691012245442, "entropy": 0.4815869835435703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 36000, "num_agent_steps_sampled": 36000, "num_steps_trained": 36000, "num_agent_steps_trained": 36000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 360, "training_iteration": 9, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-10-52", "timestamp": 1643645452, "time_this_iter_s": 14.34543490409851, "time_total_s": 134.49643754959106, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 134.49643754959106, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 33.37500000000001, "ram_util_percent": 62.5}}
{"episode_reward_max": -3.2, "episode_reward_min": -95.99999999999989, "episode_reward_mean": -19.97, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.9, -10.3, -15.5, -5.699999999999999, -14.3, -21.3, -16.3, -17.599999999999998, -11.199999999999998, -39.40000000000002, -5.2, -23.0, -11.2, -21.099999999999994, -49.3, -9.2, -89.09999999999992, -15.7, -65.19999999999997, -18.500000000000007, -13.799999999999999, -14.4, -15.3, -67.2, -16.2, -15.699999999999998, -15.399999999999984, -32.60000000000001, -6.999999999999998, -8.9, -5.7, -10.899999999999999, -11.2, -34.3, -9.700000000000001, -26.6, -33.600000000000016, -8.099999999999998, -26.3, -76.3, -5.9, -9.3, -10.9, -18.6, -13.1, -19.10000000000001, -13.199999999999996, -13.2, -77.70000000000003, -95.99999999999989, -23.800000000000004, -17.4, -13.4, -7.3, -14.3, -13.799999999999999, -17.2, -15.3, -15.2, -19.9, -19.3, -9.999999999999998, -10.199999999999998, -17.2, -18.6, -12.9, -8.7, -15.599999999999996, -38.3, -13.299999999999997, -36.2, -9.1, -6.0, -9.3, -40.000000000000036, -11.899999999999999, -8.2, -3.2, -12.2, -21.500000000000014, -16.2, -30.3, -11.7, -13.999999999999998, -20.800000000000004, -17.099999999999994, -21.799999999999997, -11.8, -19.799999999999997, -11.799999999999999, -16.599999999999998, -9.2, -14.899999999999997, -6.499999999999999, -26.3, -5.2, -14.3, -26.500000000000025, -12.2, -13.5], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9754189305194322, "mean_inference_ms": 1.2520632850029207, "mean_action_processing_ms": 0.06976600714076434, "mean_env_wait_ms": 5.648970650157984, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 40000, "timesteps_this_iter": 0, "agent_timesteps_total": 40000, "timers": {"sample_time_ms": 14245.797, "sample_throughput": 280.785, "load_time_ms": 0.349, "load_throughput": 11469248.018, "learn_time_ms": 6661.594, "learn_throughput": 600.457, "update_time_ms": 1.712}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.2507938324964495, "policy_loss": -0.009598835257272566, "vf_loss": 25.82802479497848, "vf_explained_var": 0.11676438399540481, "kl": 0.010562144143260245, "entropy": 0.45247792845131246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 40000, "num_agent_steps_sampled": 40000, "num_steps_trained": 40000, "num_agent_steps_trained": 40000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 404, "training_iteration": 10, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-11-06", "timestamp": 1643645466, "time_this_iter_s": 13.78603219985962, "time_total_s": 148.28246974945068, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 148.28246974945068, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 34.41, "ram_util_percent": 62.504999999999995}}
{"episode_reward_max": -3.2, "episode_reward_min": -138.3, "episode_reward_mean": -18.727, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.9, -9.3, -10.9, -18.6, -13.1, -19.10000000000001, -13.199999999999996, -13.2, -77.70000000000003, -95.99999999999989, -23.800000000000004, -17.4, -13.4, -7.3, -14.3, -13.799999999999999, -17.2, -15.3, -15.2, -19.9, -19.3, -9.999999999999998, -10.199999999999998, -17.2, -18.6, -12.9, -8.7, -15.599999999999996, -38.3, -13.299999999999997, -36.2, -9.1, -6.0, -9.3, -40.000000000000036, -11.899999999999999, -8.2, -3.2, -12.2, -21.500000000000014, -16.2, -30.3, -11.7, -13.999999999999998, -20.800000000000004, -17.099999999999994, -21.799999999999997, -11.8, -19.799999999999997, -11.799999999999999, -16.599999999999998, -9.2, -14.899999999999997, -6.499999999999999, -26.3, -5.2, -14.3, -26.500000000000025, -12.2, -13.5, -11.2, -12.3, -17.4, -19.10000000000001, -25.2, -15.7, -22.20000000000003, -13.799999999999999, -10.2, -27.700000000000003, -15.3, -11.3, -27.2, -21.2, -9.2, -37.3, -6.2, -12.2, -5.6, -34.7, -14.3, -14.3, -38.899999999999984, -15.3, -12.6, -15.2, -138.3, -8.700000000000001, -10.799999999999999, -26.599999999999998, -18.6, -17.2, -5.299999999999999, -19.4, -11.600000000000001, -13.899999999999999, -20.3, -12.999999999999995, -15.299999999999995, -11.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9739160165385372, "mean_inference_ms": 1.2426703093235871, "mean_action_processing_ms": 0.06928337053416721, "mean_env_wait_ms": 5.603345361804559, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 44000, "timesteps_this_iter": 0, "agent_timesteps_total": 44000, "timers": {"sample_time_ms": 14814.595, "sample_throughput": 270.004, "load_time_ms": 0.343, "load_throughput": 11673543.0, "learn_time_ms": 6614.252, "learn_throughput": 604.755, "update_time_ms": 1.692}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.6915812946292722, "policy_loss": -0.00989641697666738, "vf_loss": 70.01819970069393, "vf_explained_var": 0.07168365351615413, "kl": 0.006478669268473899, "entropy": 0.4179024651165931, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 44000, "num_agent_steps_sampled": 44000, "num_steps_trained": 44000, "num_agent_steps_trained": 44000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 444, "training_iteration": 11, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-11-20", "timestamp": 1643645480, "time_this_iter_s": 14.15270209312439, "time_total_s": 162.43517184257507, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 162.43517184257507, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 32.175, "ram_util_percent": 62.594999999999985}}
{"episode_reward_max": -5.1, "episode_reward_min": -138.3, "episode_reward_mean": -17.126, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.2, -30.3, -11.7, -13.999999999999998, -20.800000000000004, -17.099999999999994, -21.799999999999997, -11.8, -19.799999999999997, -11.799999999999999, -16.599999999999998, -9.2, -14.899999999999997, -6.499999999999999, -26.3, -5.2, -14.3, -26.500000000000025, -12.2, -13.5, -11.2, -12.3, -17.4, -19.10000000000001, -25.2, -15.7, -22.20000000000003, -13.799999999999999, -10.2, -27.700000000000003, -15.3, -11.3, -27.2, -21.2, -9.2, -37.3, -6.2, -12.2, -5.6, -34.7, -14.3, -14.3, -38.899999999999984, -15.3, -12.6, -15.2, -138.3, -8.700000000000001, -10.799999999999999, -26.599999999999998, -18.6, -17.2, -5.299999999999999, -19.4, -11.600000000000001, -13.899999999999999, -20.3, -12.999999999999995, -15.299999999999995, -11.3, -11.699999999999998, -17.3, -17.0, -18.0, -13.5, -13.499999999999995, -15.299999999999995, -13.3, -6.300000000000001, -13.3, -12.899999999999999, -5.1, -14.599999999999998, -15.5, -20.3, -12.4, -7.6, -16.700000000000003, -11.3, -14.799999999999997, -10.899999999999999, -9.099999999999998, -23.4, -19.099999999999994, -17.9, -11.699999999999998, -14.2, -6.999999999999998, -15.799999999999997, -16.2, -9.3, -5.6000000000000005, -12.3, -14.599999999999994, -10.7, -12.2, -90.3, -10.499999999999998, -5.2, -9.8], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9745879238806298, "mean_inference_ms": 1.2365450837009064, "mean_action_processing_ms": 0.0689111766255004, "mean_env_wait_ms": 5.574406587886988, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 48000, "timesteps_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"sample_time_ms": 14751.151, "sample_throughput": 271.165, "load_time_ms": 0.35, "load_throughput": 11433294.262, "learn_time_ms": 6601.744, "learn_throughput": 605.9, "update_time_ms": 1.647}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.26798005921776175, "policy_loss": -0.009308372903615237, "vf_loss": 27.55148142230126, "vf_explained_var": 0.003162712307386501, "kl": 0.008868117916008219, "entropy": 0.41171487390354117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 48000, "num_steps_trained": 48000, "num_agent_steps_trained": 48000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 484, "training_iteration": 12, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-11-35", "timestamp": 1643645495, "time_this_iter_s": 14.80112099647522, "time_total_s": 177.2362928390503, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 177.2362928390503, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 34.8904761904762, "ram_util_percent": 62.585714285714275}}
{"episode_reward_max": -2.2, "episode_reward_min": -138.3, "episode_reward_mean": -16.725999999999996, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.3, -14.3, -38.899999999999984, -15.3, -12.6, -15.2, -138.3, -8.700000000000001, -10.799999999999999, -26.599999999999998, -18.6, -17.2, -5.299999999999999, -19.4, -11.600000000000001, -13.899999999999999, -20.3, -12.999999999999995, -15.299999999999995, -11.3, -11.699999999999998, -17.3, -17.0, -18.0, -13.5, -13.499999999999995, -15.299999999999995, -13.3, -6.300000000000001, -13.3, -12.899999999999999, -5.1, -14.599999999999998, -15.5, -20.3, -12.4, -7.6, -16.700000000000003, -11.3, -14.799999999999997, -10.899999999999999, -9.099999999999998, -23.4, -19.099999999999994, -17.9, -11.699999999999998, -14.2, -6.999999999999998, -15.799999999999997, -16.2, -9.3, -5.6000000000000005, -12.3, -14.599999999999994, -10.7, -12.2, -90.3, -10.499999999999998, -5.2, -9.8, -16.29999999999998, -21.5, -11.3, -19.400000000000006, -12.3, -13.2, -25.200000000000003, -23.500000000000004, -13.5, -11.2, -19.800000000000004, -14.2, -13.099999999999996, -21.2, -11.499999999999995, -25.3, -14.2, -12.3, -6.300000000000001, -14.2, -2.2, -21.2, -11.499999999999998, -12.999999999999998, -14.3, -11.699999999999998, -10.3, -18.5, -10.499999999999998, -3.3000000000000003, -14.700000000000001, -13.3, -4.2, -84.3, -18.3, -5.2, -11.3, -13.299999999999999, -16.6, -18.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9725457788034624, "mean_inference_ms": 1.2311314720664563, "mean_action_processing_ms": 0.06863105997125034, "mean_env_wait_ms": 5.547285638591258, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 52000, "timesteps_this_iter": 0, "agent_timesteps_total": 52000, "timers": {"sample_time_ms": 14460.144, "sample_throughput": 276.622, "load_time_ms": 0.346, "load_throughput": 11552169.662, "learn_time_ms": 6516.786, "learn_throughput": 613.8, "update_time_ms": 1.671}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.3801794510284659, "policy_loss": -0.007561526177651299, "vf_loss": 38.61333711378036, "vf_explained_var": 0.23782052718183047, "kl": 0.008038054548057416, "entropy": 0.41959908021393644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 52000, "num_agent_steps_sampled": 52000, "num_steps_trained": 52000, "num_agent_steps_trained": 52000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 524, "training_iteration": 13, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-11-49", "timestamp": 1643645509, "time_this_iter_s": 14.144752025604248, "time_total_s": 191.38104486465454, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 191.38104486465454, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.180952380952384, "ram_util_percent": 62.59999999999999}}
{"episode_reward_max": -2.2, "episode_reward_min": -93.90000000000009, "episode_reward_mean": -16.642, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.899999999999999, -9.099999999999998, -23.4, -19.099999999999994, -17.9, -11.699999999999998, -14.2, -6.999999999999998, -15.799999999999997, -16.2, -9.3, -5.6000000000000005, -12.3, -14.599999999999994, -10.7, -12.2, -90.3, -10.499999999999998, -5.2, -9.8, -16.29999999999998, -21.5, -11.3, -19.400000000000006, -12.3, -13.2, -25.200000000000003, -23.500000000000004, -13.5, -11.2, -19.800000000000004, -14.2, -13.099999999999996, -21.2, -11.499999999999995, -25.3, -14.2, -12.3, -6.300000000000001, -14.2, -2.2, -21.2, -11.499999999999998, -12.999999999999998, -14.3, -11.699999999999998, -10.3, -18.5, -10.499999999999998, -3.3000000000000003, -14.700000000000001, -13.3, -4.2, -84.3, -18.3, -5.2, -11.3, -13.299999999999999, -16.6, -18.3, -11.4, -26.6, -10.2, -15.999999999999998, -23.2, -8.5, -22.49999999999998, -28.600000000000005, -8.2, -15.2, -18.2, -23.10000000000001, -93.90000000000009, -12.3, -14.499999999999991, -20.3, -23.3, -17.2, -14.099999999999994, -14.599999999999998, -21.700000000000003, -5.300000000000001, -8.3, -22.0, -21.2, -7.999999999999998, -8.1, -7.199999999999999, -20.300000000000004, -23.3, -8.8, -19.3, -15.2, -8.199999999999998, -10.899999999999997, -10.399999999999999, -8.3, -19.300000000000043, -23.00000000000001, -12.199999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9718522035687838, "mean_inference_ms": 1.226727927459531, "mean_action_processing_ms": 0.06840546989882776, "mean_env_wait_ms": 5.524717295499084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 56000, "timesteps_this_iter": 0, "agent_timesteps_total": 56000, "timers": {"sample_time_ms": 14280.957, "sample_throughput": 280.093, "load_time_ms": 0.345, "load_throughput": 11585675.022, "learn_time_ms": 6535.053, "learn_throughput": 612.084, "update_time_ms": 1.632}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.3555250467026546, "policy_loss": -0.009626163852711518, "vf_loss": 36.35680698297357, "vf_explained_var": 0.06267577211062113, "kl": 0.007915741697021535, "entropy": 0.39745681849859094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 56000, "num_agent_steps_sampled": 56000, "num_steps_trained": 56000, "num_agent_steps_trained": 56000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 564, "training_iteration": 14, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-12-03", "timestamp": 1643645523, "time_this_iter_s": 14.56647801399231, "time_total_s": 205.94752287864685, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 205.94752287864685, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 32.980000000000004, "ram_util_percent": 62.59999999999999}}
{"episode_reward_max": -2.2, "episode_reward_min": -109.8, "episode_reward_mean": -16.803, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2, -21.2, -11.499999999999998, -12.999999999999998, -14.3, -11.699999999999998, -10.3, -18.5, -10.499999999999998, -3.3000000000000003, -14.700000000000001, -13.3, -4.2, -84.3, -18.3, -5.2, -11.3, -13.299999999999999, -16.6, -18.3, -11.4, -26.6, -10.2, -15.999999999999998, -23.2, -8.5, -22.49999999999998, -28.600000000000005, -8.2, -15.2, -18.2, -23.10000000000001, -93.90000000000009, -12.3, -14.499999999999991, -20.3, -23.3, -17.2, -14.099999999999994, -14.599999999999998, -21.700000000000003, -5.300000000000001, -8.3, -22.0, -21.2, -7.999999999999998, -8.1, -7.199999999999999, -20.300000000000004, -23.3, -8.8, -19.3, -15.2, -8.199999999999998, -10.899999999999997, -10.399999999999999, -8.3, -19.300000000000043, -23.00000000000001, -12.199999999999998, -12.6, -13.1, -16.3, -9.499999999999998, -8.799999999999997, -28.099999999999987, -11.2, -6.300000000000001, -16.2, -12.899999999999997, -12.2, -6.499999999999999, -10.3, -23.20000000000001, -10.3, -19.5, -12.2, -12.3, -10.3, -12.8, -10.2, -15.799999999999999, -15.999999999999998, -109.8, -14.3, -9.299999999999999, -12.3, -38.2, -10.999999999999998, -14.2, -8.7, -15.2, -15.3, -19.6, -10.9, -25.5, -12.3, -3.3000000000000003, -13.3, -21.60000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9696403154283756, "mean_inference_ms": 1.2228279071132753, "mean_action_processing_ms": 0.06819828925731278, "mean_env_wait_ms": 5.505068691068138, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 60000, "timesteps_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"sample_time_ms": 14299.795, "sample_throughput": 279.724, "load_time_ms": 0.343, "load_throughput": 11667048.679, "learn_time_ms": 6536.82, "learn_throughput": 611.918, "update_time_ms": 1.689}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.545477343927468, "policy_loss": -0.011001827744066075, "vf_loss": 55.530141183125075, "vf_explained_var": 0.19572769300912016, "kl": 0.005888851462872791, "entropy": 0.4053836571593438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60000, "num_agent_steps_sampled": 60000, "num_steps_trained": 60000, "num_agent_steps_trained": 60000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 604, "training_iteration": 15, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-12-18", "timestamp": 1643645538, "time_this_iter_s": 14.435307025909424, "time_total_s": 220.38282990455627, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 220.38282990455627, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 28.995238095238093, "ram_util_percent": 62.590476190476174}}
{"episode_reward_max": -3.3000000000000003, "episode_reward_min": -109.8, "episode_reward_mean": -15.469, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.700000000000003, -5.300000000000001, -8.3, -22.0, -21.2, -7.999999999999998, -8.1, -7.199999999999999, -20.300000000000004, -23.3, -8.8, -19.3, -15.2, -8.199999999999998, -10.899999999999997, -10.399999999999999, -8.3, -19.300000000000043, -23.00000000000001, -12.199999999999998, -12.6, -13.1, -16.3, -9.499999999999998, -8.799999999999997, -28.099999999999987, -11.2, -6.300000000000001, -16.2, -12.899999999999997, -12.2, -6.499999999999999, -10.3, -23.20000000000001, -10.3, -19.5, -12.2, -12.3, -10.3, -12.8, -10.2, -15.799999999999999, -15.999999999999998, -109.8, -14.3, -9.299999999999999, -12.3, -38.2, -10.999999999999998, -14.2, -8.7, -15.2, -15.3, -19.6, -10.9, -25.5, -12.3, -3.3000000000000003, -13.3, -21.60000000000001, -13.4, -14.699999999999996, -8.3, -11.3, -17.099999999999998, -28.3, -13.3, -12.3, -8.1, -17.3, -12.399999999999997, -31.60000000000002, -10.2, -12.3, -18.6, -11.799999999999999, -15.2, -14.899999999999999, -7.3999999999999995, -11.299999999999997, -8.799999999999999, -17.6, -9.999999999999998, -15.9, -10.3, -8.199999999999998, -13.799999999999999, -4.800000000000001, -11.3, -20.3, -10.4, -70.3, -16.3, -13.2, -10.600000000000001, -18.499999999999993, -12.3, -11.2, -17.3, -13.6], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9679289597040796, "mean_inference_ms": 1.2201223982537155, "mean_action_processing_ms": 0.06804804147005936, "mean_env_wait_ms": 5.492997512203187, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 64000, "timesteps_this_iter": 0, "agent_timesteps_total": 64000, "timers": {"sample_time_ms": 14322.902, "sample_throughput": 279.273, "load_time_ms": 0.341, "load_throughput": 11719206.482, "learn_time_ms": 6620.416, "learn_throughput": 604.192, "update_time_ms": 1.686}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.27843144361820993, "policy_loss": -0.008230782813713035, "vf_loss": 28.540404083267337, "vf_explained_var": 0.2597498174636595, "kl": 0.00629097840938777, "entropy": 0.4030881761382985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 64000, "num_agent_steps_sampled": 64000, "num_steps_trained": 64000, "num_agent_steps_trained": 64000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 644, "training_iteration": 16, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-12-33", "timestamp": 1643645553, "time_this_iter_s": 14.995090961456299, "time_total_s": 235.37792086601257, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 235.37792086601257, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 37.89047619047619, "ram_util_percent": 62.57142857142855}}
{"episode_reward_max": -2.2, "episode_reward_min": -109.8, "episode_reward_mean": -15.115, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.2, -15.799999999999999, -15.999999999999998, -109.8, -14.3, -9.299999999999999, -12.3, -38.2, -10.999999999999998, -14.2, -8.7, -15.2, -15.3, -19.6, -10.9, -25.5, -12.3, -3.3000000000000003, -13.3, -21.60000000000001, -13.4, -14.699999999999996, -8.3, -11.3, -17.099999999999998, -28.3, -13.3, -12.3, -8.1, -17.3, -12.399999999999997, -31.60000000000002, -10.2, -12.3, -18.6, -11.799999999999999, -15.2, -14.899999999999999, -7.3999999999999995, -11.299999999999997, -8.799999999999999, -17.6, -9.999999999999998, -15.9, -10.3, -8.199999999999998, -13.799999999999999, -4.800000000000001, -11.3, -20.3, -10.4, -70.3, -16.3, -13.2, -10.600000000000001, -18.499999999999993, -12.3, -11.2, -17.3, -13.6, -16.799999999999997, -13.3, -7.300000000000001, -16.3, -12.3, -29.30000000000001, -6.6, -26.4, -14.3, -10.3, -4.7, -19.899999999999995, -3.6000000000000005, -8.399999999999999, -12.299999999999999, -5.2, -17.2, -15.2, -3.8000000000000003, -12.2, -16.5, -12.399999999999993, -8.999999999999998, -9.2, -13.799999999999999, -11.499999999999998, -12.2, -11.899999999999997, -4.1000000000000005, -11.299999999999997, -19.700000000000003, -8.399999999999999, -10.3, -9.3, -20.699999999999996, -2.2, -16.5, -27.3, -16.3, -12.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9649690707121497, "mean_inference_ms": 1.219153825310263, "mean_action_processing_ms": 0.06799339095943013, "mean_env_wait_ms": 5.490646571235718, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 68000, "timesteps_this_iter": 0, "agent_timesteps_total": 68000, "timers": {"sample_time_ms": 14426.296, "sample_throughput": 277.271, "load_time_ms": 0.344, "load_throughput": 11626622.315, "learn_time_ms": 6690.093, "learn_throughput": 597.899, "update_time_ms": 1.709}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.13868489121612643, "policy_loss": -0.009474816842265027, "vf_loss": 14.620324844698752, "vf_explained_var": 0.22549068658582627, "kl": 0.009782312625695523, "entropy": 0.3832118475789665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 68000, "num_agent_steps_sampled": 68000, "num_steps_trained": 68000, "num_agent_steps_trained": 68000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 684, "training_iteration": 17, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-12-48", "timestamp": 1643645568, "time_this_iter_s": 15.069393157958984, "time_total_s": 250.44731402397156, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 250.44731402397156, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 33.904545454545456, "ram_util_percent": 62.65454545454547}}
{"episode_reward_max": -2.2, "episode_reward_min": -70.3, "episode_reward_mean": -13.485000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.799999999999999, -17.6, -9.999999999999998, -15.9, -10.3, -8.199999999999998, -13.799999999999999, -4.800000000000001, -11.3, -20.3, -10.4, -70.3, -16.3, -13.2, -10.600000000000001, -18.499999999999993, -12.3, -11.2, -17.3, -13.6, -16.799999999999997, -13.3, -7.300000000000001, -16.3, -12.3, -29.30000000000001, -6.6, -26.4, -14.3, -10.3, -4.7, -19.899999999999995, -3.6000000000000005, -8.399999999999999, -12.299999999999999, -5.2, -17.2, -15.2, -3.8000000000000003, -12.2, -16.5, -12.399999999999993, -8.999999999999998, -9.2, -13.799999999999999, -11.499999999999998, -12.2, -11.899999999999997, -4.1000000000000005, -11.299999999999997, -19.700000000000003, -8.399999999999999, -10.3, -9.3, -20.699999999999996, -2.2, -16.5, -27.3, -16.3, -12.2, -15.2, -10.599999999999985, -26.100000000000044, -12.3, -16.5, -22.1, -12.2, -12.3, -13.3, -15.2, -18.1, -13.599999999999998, -13.2, -3.8000000000000007, -18.400000000000002, -4.300000000000001, -20.699999999999996, -13.3, -15.899999999999995, -17.2, -13.3, -14.299999999999999, -8.899999999999999, -16.3, -11.399999999999997, -11.2, -9.4, -12.999999999999998, -11.099999999999996, -14.2, -14.2, -4.300000000000001, -10.899999999999999, -13.1, -15.2, -5.300000000000001, -9.4, -10.1, -12.799999999999999, -10.899999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9632561895323554, "mean_inference_ms": 1.2187383707223893, "mean_action_processing_ms": 0.06796231481369676, "mean_env_wait_ms": 5.490298439482668, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 72000, "timesteps_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"sample_time_ms": 14544.97, "sample_throughput": 275.009, "load_time_ms": 0.345, "load_throughput": 11583275.338, "learn_time_ms": 6740.784, "learn_throughput": 593.403, "update_time_ms": 1.713}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.09521132390745865, "policy_loss": -0.003856614456381849, "vf_loss": 9.77042672839216, "vf_explained_var": 0.34568361575885487, "kl": 0.0068183730830666004, "entropy": 0.3905196682419828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 72000, "num_agent_steps_sampled": 72000, "num_steps_trained": 72000, "num_agent_steps_trained": 72000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 724, "training_iteration": 18, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-13-03", "timestamp": 1643645583, "time_this_iter_s": 15.30808711051941, "time_total_s": 265.75540113449097, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 265.75540113449097, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 32.586363636363636, "ram_util_percent": 62.53181818181818}}
{"episode_reward_max": -2.2, "episode_reward_min": -58.40000000000003, "episode_reward_mean": -13.973999999999997, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.5, -12.399999999999993, -8.999999999999998, -9.2, -13.799999999999999, -11.499999999999998, -12.2, -11.899999999999997, -4.1000000000000005, -11.299999999999997, -19.700000000000003, -8.399999999999999, -10.3, -9.3, -20.699999999999996, -2.2, -16.5, -27.3, -16.3, -12.2, -15.2, -10.599999999999985, -26.100000000000044, -12.3, -16.5, -22.1, -12.2, -12.3, -13.3, -15.2, -18.1, -13.599999999999998, -13.2, -3.8000000000000007, -18.400000000000002, -4.300000000000001, -20.699999999999996, -13.3, -15.899999999999995, -17.2, -13.3, -14.299999999999999, -8.899999999999999, -16.3, -11.399999999999997, -11.2, -9.4, -12.999999999999998, -11.099999999999996, -14.2, -14.2, -4.300000000000001, -10.899999999999999, -13.1, -15.2, -5.300000000000001, -9.4, -10.1, -12.799999999999999, -10.899999999999999, -14.3, -17.3, -28.3, -20.0, -58.40000000000003, -12.3, -16.2, -14.1, -10.3, -13.799999999999999, -15.1, -19.799999999999997, -11.100000000000001, -6.2, -43.2, -10.7, -10.3, -7.6, -17.80000000000001, -15.3, -5.299999999999999, -12.2, -32.8, -12.899999999999999, -11.700000000000001, -13.3, -5.7, -16.8, -10.3, -9.3, -10.599999999999998, -14.3, -11.5, -10.2, -7.2, -12.2, -12.299999999999999, -12.399999999999995, -20.6, -15.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9641958342876478, "mean_inference_ms": 1.2198289136305545, "mean_action_processing_ms": 0.06802590204513914, "mean_env_wait_ms": 5.494504587342533, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 76000, "timesteps_this_iter": 0, "agent_timesteps_total": 76000, "timers": {"sample_time_ms": 14660.147, "sample_throughput": 272.849, "load_time_ms": 0.349, "load_throughput": 11462978.956, "learn_time_ms": 6768.018, "learn_throughput": 591.015, "update_time_ms": 1.702}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.2534556608667137, "policy_loss": -0.008188290950611875, "vf_loss": 26.005791203180948, "vf_explained_var": 0.30716746443061416, "kl": 0.007930215109140718, "entropy": 0.371090884795112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 76000, "num_agent_steps_sampled": 76000, "num_steps_trained": 76000, "num_agent_steps_trained": 76000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 764, "training_iteration": 19, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-13-19", "timestamp": 1643645599, "time_this_iter_s": 15.259151220321655, "time_total_s": 281.0145523548126, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 281.0145523548126, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 32.10476190476191, "ram_util_percent": 61.76190476190476}}
{"episode_reward_max": -3.2, "episode_reward_min": -58.40000000000003, "episode_reward_mean": -13.319999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.399999999999997, -11.2, -9.4, -12.999999999999998, -11.099999999999996, -14.2, -14.2, -4.300000000000001, -10.899999999999999, -13.1, -15.2, -5.300000000000001, -9.4, -10.1, -12.799999999999999, -10.899999999999999, -14.3, -17.3, -28.3, -20.0, -58.40000000000003, -12.3, -16.2, -14.1, -10.3, -13.799999999999999, -15.1, -19.799999999999997, -11.100000000000001, -6.2, -43.2, -10.7, -10.3, -7.6, -17.80000000000001, -15.3, -5.299999999999999, -12.2, -32.8, -12.899999999999999, -11.700000000000001, -13.3, -5.7, -16.8, -10.3, -9.3, -10.599999999999998, -14.3, -11.5, -10.2, -7.2, -12.2, -12.299999999999999, -12.399999999999995, -20.6, -15.3, -11.2, -3.7, -28.0, -16.2, -17.2, -11.7, -11.2, -15.199999999999996, -4.700000000000001, -3.2, -11.2, -10.099999999999998, -6.4, -11.299999999999997, -9.2, -12.2, -12.699999999999996, -9.3, -21.90000000000001, -5.2, -18.5, -12.999999999999998, -14.2, -13.2, -12.3, -12.3, -14.3, -13.3, -17.2, -12.2, -3.2, -6.5, -19.5, -10.700000000000001, -12.499999999999996, -12.999999999999998, -21.6, -6.799999999999999, -13.0, -13.3, -11.3, -13.2, -5.300000000000001, -14.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9651574323078065, "mean_inference_ms": 1.2186759166540668, "mean_action_processing_ms": 0.0680232786792127, "mean_env_wait_ms": 5.490241706939023, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 80000, "timesteps_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"sample_time_ms": 14676.643, "sample_throughput": 272.542, "load_time_ms": 0.361, "load_throughput": 11094574.792, "learn_time_ms": 6857.896, "learn_throughput": 583.269, "update_time_ms": 1.693}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.11279958514596826, "policy_loss": -0.008194638924893513, "vf_loss": 11.97738314636292, "vf_explained_var": 0.3420140817601194, "kl": 0.006101983207040656, "entropy": 0.33145895374398077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 80000, "num_agent_steps_sampled": 80000, "num_steps_trained": 80000, "num_agent_steps_trained": 80000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 808, "training_iteration": 20, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-13-33", "timestamp": 1643645613, "time_this_iter_s": 14.570576906204224, "time_total_s": 295.58512926101685, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 295.58512926101685, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 23.776190476190475, "ram_util_percent": 61.57619047619046}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -30.6, "episode_reward_mean": -12.352, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.700000000000001, -13.3, -5.7, -16.8, -10.3, -9.3, -10.599999999999998, -14.3, -11.5, -10.2, -7.2, -12.2, -12.299999999999999, -12.399999999999995, -20.6, -15.3, -11.2, -3.7, -28.0, -16.2, -17.2, -11.7, -11.2, -15.199999999999996, -4.700000000000001, -3.2, -11.2, -10.099999999999998, -6.4, -11.299999999999997, -9.2, -12.2, -12.699999999999996, -9.3, -21.90000000000001, -5.2, -18.5, -12.999999999999998, -14.2, -13.2, -12.3, -12.3, -14.3, -13.3, -17.2, -12.2, -3.2, -6.5, -19.5, -10.700000000000001, -12.499999999999996, -12.999999999999998, -21.6, -6.799999999999999, -13.0, -13.3, -11.3, -13.2, -5.300000000000001, -14.3, -14.2, -11.6, -10.799999999999999, -14.3, -12.399999999999999, -12.299999999999999, -15.5, -14.2, -12.5, -11.599999999999996, -3.7, -19.700000000000042, -8.4, -17.5, -17.3, -30.6, -16.3, -8.3, -22.0, -10.5, -11.2, -10.5, -11.2, -8.999999999999998, -13.3, -10.3, -2.3000000000000003, -12.399999999999999, -6.300000000000001, -13.5, -19.799999999999997, -6.1, -7.1, -12.8, -9.299999999999995, -5.5, -14.699999999999998, -21.5, -16.5, -7.999999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9648270210618898, "mean_inference_ms": 1.2170990016372691, "mean_action_processing_ms": 0.06794489122745638, "mean_env_wait_ms": 5.484133856097742, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 84000, "timesteps_this_iter": 0, "agent_timesteps_total": 84000, "timers": {"sample_time_ms": 14825.204, "sample_throughput": 269.811, "load_time_ms": 0.363, "load_throughput": 11018070.533, "learn_time_ms": 6875.788, "learn_throughput": 581.752, "update_time_ms": 1.666}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.11148871204224967, "policy_loss": -0.0016521480134738388, "vf_loss": 11.173097135431023, "vf_explained_var": 0.25668393232489145, "kl": 0.007049453545945881, "entropy": 0.3525287739531968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 84000, "num_agent_steps_sampled": 84000, "num_steps_trained": 84000, "num_agent_steps_trained": 84000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 848, "training_iteration": 21, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-13-48", "timestamp": 1643645628, "time_this_iter_s": 14.93814992904663, "time_total_s": 310.5232791900635, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 310.5232791900635, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.749999999999996, "ram_util_percent": 61.66363636363637}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -42.2, "episode_reward_mean": -13.073, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.3, -12.3, -14.3, -13.3, -17.2, -12.2, -3.2, -6.5, -19.5, -10.700000000000001, -12.499999999999996, -12.999999999999998, -21.6, -6.799999999999999, -13.0, -13.3, -11.3, -13.2, -5.300000000000001, -14.3, -14.2, -11.6, -10.799999999999999, -14.3, -12.399999999999999, -12.299999999999999, -15.5, -14.2, -12.5, -11.599999999999996, -3.7, -19.700000000000042, -8.4, -17.5, -17.3, -30.6, -16.3, -8.3, -22.0, -10.5, -11.2, -10.5, -11.2, -8.999999999999998, -13.3, -10.3, -2.3000000000000003, -12.399999999999999, -6.300000000000001, -13.5, -19.799999999999997, -6.1, -7.1, -12.8, -9.299999999999995, -5.5, -14.699999999999998, -21.5, -16.5, -7.999999999999997, -19.2, -15.3, -20.099999999999987, -11.9, -9.3, -10.7, -14.2, -7.199999999999999, -12.5, -17.299999999999997, -11.2, -7.1, -13.799999999999995, -11.799999999999999, -5.8999999999999995, -15.799999999999997, -5.2, -6.300000000000001, -22.1, -17.299999999999997, -11.299999999999999, -7.5, -42.2, -12.3, -10.7, -13.099999999999996, -16.49999999999998, -19.700000000000006, -9.3, -22.899999999999988, -10.099999999999998, -17.9, -11.3, -16.9, -11.2, -24.100000000000037, -2.6000000000000005, -21.3, -4.0, -17.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9633664368676398, "mean_inference_ms": 1.215213298519029, "mean_action_processing_ms": 0.06780697328624753, "mean_env_wait_ms": 5.475828303388591, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 88000, "timesteps_this_iter": 0, "agent_timesteps_total": 88000, "timers": {"sample_time_ms": 14779.469, "sample_throughput": 270.646, "load_time_ms": 0.353, "load_throughput": 11335956.757, "learn_time_ms": 6940.321, "learn_throughput": 576.342, "update_time_ms": 1.654}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.13664257533833266, "policy_loss": -0.0029035614422893014, "vf_loss": 13.861080167370458, "vf_explained_var": 0.24526472322402462, "kl": 0.004676686494019582, "entropy": 0.32218001166018106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 88000, "num_agent_steps_sampled": 88000, "num_steps_trained": 88000, "num_agent_steps_trained": 88000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 888, "training_iteration": 22, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-14-03", "timestamp": 1643645643, "time_this_iter_s": 14.806752920150757, "time_total_s": 325.33003211021423, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 325.33003211021423, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.6047619047619, "ram_util_percent": 61.709523809523816}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -42.2, "episode_reward_mean": -13.094, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.2, -10.5, -11.2, -8.999999999999998, -13.3, -10.3, -2.3000000000000003, -12.399999999999999, -6.300000000000001, -13.5, -19.799999999999997, -6.1, -7.1, -12.8, -9.299999999999995, -5.5, -14.699999999999998, -21.5, -16.5, -7.999999999999997, -19.2, -15.3, -20.099999999999987, -11.9, -9.3, -10.7, -14.2, -7.199999999999999, -12.5, -17.299999999999997, -11.2, -7.1, -13.799999999999995, -11.799999999999999, -5.8999999999999995, -15.799999999999997, -5.2, -6.300000000000001, -22.1, -17.299999999999997, -11.299999999999999, -7.5, -42.2, -12.3, -10.7, -13.099999999999996, -16.49999999999998, -19.700000000000006, -9.3, -22.899999999999988, -10.099999999999998, -17.9, -11.3, -16.9, -11.2, -24.100000000000037, -2.6000000000000005, -21.3, -4.0, -17.4, -7.1, -12.3, -11.3, -6.1, -12.3, -8.3, -11.499999999999988, -8.599999999999987, -11.299999999999999, -10.799999999999985, -9.0, -4.300000000000001, -16.2, -10.2, -14.2, -6.899999999999994, -9.2, -14.2, -13.3, -9.299999999999999, -9.499999999999998, -14.2, -9.2, -40.3, -14.3, -19.1, -11.2, -13.2, -14.7, -41.2, -6.799999999999998, -17.799999999999997, -18.3, -15.899999999999999, -14.1, -10.399999999999999, -12.3, -14.2, -11.2, -17.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9610222559477234, "mean_inference_ms": 1.2124593345812975, "mean_action_processing_ms": 0.06765554377502751, "mean_env_wait_ms": 5.463905253065389, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 92000, "timesteps_this_iter": 0, "agent_timesteps_total": 92000, "timers": {"sample_time_ms": 14839.24, "sample_throughput": 269.556, "load_time_ms": 0.354, "load_throughput": 11287906.883, "learn_time_ms": 6972.987, "learn_throughput": 573.642, "update_time_ms": 1.611}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.12345870327985575, "policy_loss": -0.012232149658744694, "vf_loss": 13.45094856690335, "vf_explained_var": 0.3645535872187666, "kl": 0.011813688179369949, "entropy": 0.3292762032599859, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 92000, "num_agent_steps_sampled": 92000, "num_steps_trained": 92000, "num_agent_steps_trained": 92000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 928, "training_iteration": 23, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-14-18", "timestamp": 1643645658, "time_this_iter_s": 14.429250001907349, "time_total_s": 339.7592821121216, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 339.7592821121216, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 29.009999999999998, "ram_util_percent": 61.835000000000015}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -42.2, "episode_reward_mean": -13.975999999999997, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.299999999999999, -7.5, -42.2, -12.3, -10.7, -13.099999999999996, -16.49999999999998, -19.700000000000006, -9.3, -22.899999999999988, -10.099999999999998, -17.9, -11.3, -16.9, -11.2, -24.100000000000037, -2.6000000000000005, -21.3, -4.0, -17.4, -7.1, -12.3, -11.3, -6.1, -12.3, -8.3, -11.499999999999988, -8.599999999999987, -11.299999999999999, -10.799999999999985, -9.0, -4.300000000000001, -16.2, -10.2, -14.2, -6.899999999999994, -9.2, -14.2, -13.3, -9.299999999999999, -9.499999999999998, -14.2, -9.2, -40.3, -14.3, -19.1, -11.2, -13.2, -14.7, -41.2, -6.799999999999998, -17.799999999999997, -18.3, -15.899999999999999, -14.1, -10.399999999999999, -12.3, -14.2, -11.2, -17.3, -13.999999999999998, -12.2, -7.300000000000001, -10.3, -19.700000000000003, -8.3, -12.099999999999998, -7.200000000000001, -11.2, -12.699999999999996, -21.1, -19.000000000000007, -9.2, -8.999999999999998, -24.600000000000005, -8.2, -18.3, -10.6, -7.799999999999999, -13.599999999999998, -16.7, -10.099999999999996, -13.3, -12.2, -19.9, -4.300000000000001, -7.300000000000001, -21.70000000000002, -14.899999999999999, -7.300000000000001, -8.2, -38.4, -7.300000000000001, -14.6, -11.3, -13.799999999999999, -10.299999999999999, -21.2, -33.39999999999997, -21.100000000000012], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9585611532152961, "mean_inference_ms": 1.210236667604644, "mean_action_processing_ms": 0.06752988812708954, "mean_env_wait_ms": 5.454119837258005, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"sample_time_ms": 14881.148, "sample_throughput": 268.796, "load_time_ms": 0.354, "load_throughput": 11296267.169, "learn_time_ms": 6919.911, "learn_throughput": 578.042, "update_time_ms": 1.621}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.13398375421191655, "policy_loss": -0.011300047623714612, "vf_loss": 14.428894551338688, "vf_explained_var": 0.25471515681153983, "kl": 0.009948565733050457, "entropy": 0.33236875346591394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 96000, "num_steps_trained": 96000, "num_agent_steps_trained": 96000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 968, "training_iteration": 24, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-14-32", "timestamp": 1643645672, "time_this_iter_s": 14.132918119430542, "time_total_s": 353.8922002315521, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 353.8922002315521, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 29.745000000000005, "ram_util_percent": 61.89000000000002}}
{"episode_reward_max": -4.2, "episode_reward_min": -41.2, "episode_reward_mean": -14.021, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.499999999999998, -14.2, -9.2, -40.3, -14.3, -19.1, -11.2, -13.2, -14.7, -41.2, -6.799999999999998, -17.799999999999997, -18.3, -15.899999999999999, -14.1, -10.399999999999999, -12.3, -14.2, -11.2, -17.3, -13.999999999999998, -12.2, -7.300000000000001, -10.3, -19.700000000000003, -8.3, -12.099999999999998, -7.200000000000001, -11.2, -12.699999999999996, -21.1, -19.000000000000007, -9.2, -8.999999999999998, -24.600000000000005, -8.2, -18.3, -10.6, -7.799999999999999, -13.599999999999998, -16.7, -10.099999999999996, -13.3, -12.2, -19.9, -4.300000000000001, -7.300000000000001, -21.70000000000002, -14.899999999999999, -7.300000000000001, -8.2, -38.4, -7.300000000000001, -14.6, -11.3, -13.799999999999999, -10.299999999999999, -21.2, -33.39999999999997, -21.100000000000012, -7.300000000000001, -16.2, -6.1, -12.2, -12.2, -14.1, -7.999999999999998, -12.199999999999998, -19.3, -12.2, -12.2, -11.2, -6.499999999999999, -13.3, -10.1, -16.3, -11.5, -27.2, -7.2, -11.2, -9.2, -29.40000000000005, -5.2, -14.3, -14.3, -20.3, -5.0, -12.899999999999999, -10.999999999999998, -10.100000000000001, -12.0, -11.2, -25.1, -17.9, -14.999999999999998, -11.4, -10.699999999999998, -14.3, -13.2, -4.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.955237294964566, "mean_inference_ms": 1.2080444791953489, "mean_action_processing_ms": 0.06741085879580919, "mean_env_wait_ms": 5.445166002373871, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 100000, "timesteps_this_iter": 0, "agent_timesteps_total": 100000, "timers": {"sample_time_ms": 14793.483, "sample_throughput": 270.389, "load_time_ms": 0.357, "load_throughput": 11213966.981, "learn_time_ms": 6934.485, "learn_throughput": 576.827, "update_time_ms": 1.567}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.081104883977202, "policy_loss": -0.01644317523566305, "vf_loss": 9.632188562552134, "vf_explained_var": 0.38072281261926055, "kl": 0.012261768993479255, "entropy": 0.3157011829717185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 100000, "num_agent_steps_sampled": 100000, "num_steps_trained": 100000, "num_agent_steps_trained": 100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1008, "training_iteration": 25, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-14-46", "timestamp": 1643645686, "time_this_iter_s": 14.229732036590576, "time_total_s": 368.1219322681427, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 368.1219322681427, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 26.6047619047619, "ram_util_percent": 61.92857142857144}}
{"episode_reward_max": -2.2, "episode_reward_min": -38.4, "episode_reward_mean": -13.778000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.7, -10.099999999999996, -13.3, -12.2, -19.9, -4.300000000000001, -7.300000000000001, -21.70000000000002, -14.899999999999999, -7.300000000000001, -8.2, -38.4, -7.300000000000001, -14.6, -11.3, -13.799999999999999, -10.299999999999999, -21.2, -33.39999999999997, -21.100000000000012, -7.300000000000001, -16.2, -6.1, -12.2, -12.2, -14.1, -7.999999999999998, -12.199999999999998, -19.3, -12.2, -12.2, -11.2, -6.499999999999999, -13.3, -10.1, -16.3, -11.5, -27.2, -7.2, -11.2, -9.2, -29.40000000000005, -5.2, -14.3, -14.3, -20.3, -5.0, -12.899999999999999, -10.999999999999998, -10.100000000000001, -12.0, -11.2, -25.1, -17.9, -14.999999999999998, -11.4, -10.699999999999998, -14.3, -13.2, -4.2, -10.2, -18.999999999999986, -6.2, -15.3, -8.2, -15.2, -12.1, -12.4, -5.300000000000001, -10.899999999999999, -12.4, -9.3, -13.3, -2.2, -12.899999999999999, -10.799999999999999, -12.499999999999998, -13.3, -15.3, -31.100000000000012, -7.6000000000000005, -5.4, -16.4, -6.2, -15.09999999999998, -5.5, -34.40000000000004, -28.3, -14.299999999999997, -15.599999999999998, -20.30000000000002, -9.3, -16.5, -16.2, -13.3, -17.80000000000001, -14.3, -21.0, -10.3, -21.6], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9525414297532174, "mean_inference_ms": 1.206456239932499, "mean_action_processing_ms": 0.06732570629954154, "mean_env_wait_ms": 5.439257177466983, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 104000, "timesteps_this_iter": 0, "agent_timesteps_total": 104000, "timers": {"sample_time_ms": 14802.242, "sample_throughput": 270.229, "load_time_ms": 0.36, "load_throughput": 11119575.822, "learn_time_ms": 6892.73, "learn_throughput": 580.322, "update_time_ms": 1.604}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.10994178626926676, "policy_loss": -0.0068099206383590415, "vf_loss": 11.57846109303095, "vf_explained_var": 0.46515221723946193, "kl": 0.00967097136043865, "entropy": 0.2882412132396493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 104000, "num_agent_steps_sampled": 104000, "num_steps_trained": 104000, "num_agent_steps_trained": 104000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1048, "training_iteration": 26, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-15-01", "timestamp": 1643645701, "time_this_iter_s": 14.523211002349854, "time_total_s": 382.64514327049255, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 382.64514327049255, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 35.86, "ram_util_percent": 61.839999999999996}}
{"episode_reward_max": -2.2, "episode_reward_min": -34.40000000000004, "episode_reward_mean": -13.029000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.2, -29.40000000000005, -5.2, -14.3, -14.3, -20.3, -5.0, -12.899999999999999, -10.999999999999998, -10.100000000000001, -12.0, -11.2, -25.1, -17.9, -14.999999999999998, -11.4, -10.699999999999998, -14.3, -13.2, -4.2, -10.2, -18.999999999999986, -6.2, -15.3, -8.2, -15.2, -12.1, -12.4, -5.300000000000001, -10.899999999999999, -12.4, -9.3, -13.3, -2.2, -12.899999999999999, -10.799999999999999, -12.499999999999998, -13.3, -15.3, -31.100000000000012, -7.6000000000000005, -5.4, -16.4, -6.2, -15.09999999999998, -5.5, -34.40000000000004, -28.3, -14.299999999999997, -15.599999999999998, -20.30000000000002, -9.3, -16.5, -16.2, -13.3, -17.80000000000001, -14.3, -21.0, -10.3, -21.6, -6.2, -10.099999999999996, -14.499999999999993, -4.5, -4.300000000000001, -14.799999999999999, -21.8, -4.4, -11.899999999999999, -4.300000000000001, -15.1, -24.5, -4.2, -8.3, -11.600000000000001, -18.3, -16.900000000000002, -5.300000000000001, -9.3, -16.999999999999993, -21.199999999999996, -12.199999999999996, -9.7, -21.100000000000005, -2.6000000000000005, -11.3, -11.799999999999999, -15.299999999999997, -19.5, -6.799999999999999, -7.199999999999999, -9.399999999999999, -16.5, -17.0, -12.0, -8.2, -8.299999999999997, -7.600000000000001, -13.799999999999997, -20.100000000000026], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9504393738420572, "mean_inference_ms": 1.2047544629908942, "mean_action_processing_ms": 0.0672416642087183, "mean_env_wait_ms": 5.432856562088898, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 108000, "timesteps_this_iter": 0, "agent_timesteps_total": 108000, "timers": {"sample_time_ms": 14713.015, "sample_throughput": 271.868, "load_time_ms": 0.356, "load_throughput": 11238756.699, "learn_time_ms": 6916.419, "learn_throughput": 578.334, "update_time_ms": 1.59}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.09935824339708654, "policy_loss": -0.010444504757642106, "vf_loss": 10.916727111416478, "vf_explained_var": 0.2764925661266491, "kl": 0.006354811868307554, "entropy": 0.2645602767185498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 108000, "num_agent_steps_sampled": 108000, "num_steps_trained": 108000, "num_agent_steps_trained": 108000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1088, "training_iteration": 27, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-15-15", "timestamp": 1643645715, "time_this_iter_s": 14.833542823791504, "time_total_s": 397.47868609428406, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 397.47868609428406, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 32.49047619047619, "ram_util_percent": 61.90000000000001}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -44.3, "episode_reward_mean": -12.832, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.6000000000000005, -5.4, -16.4, -6.2, -15.09999999999998, -5.5, -34.40000000000004, -28.3, -14.299999999999997, -15.599999999999998, -20.30000000000002, -9.3, -16.5, -16.2, -13.3, -17.80000000000001, -14.3, -21.0, -10.3, -21.6, -6.2, -10.099999999999996, -14.499999999999993, -4.5, -4.300000000000001, -14.799999999999999, -21.8, -4.4, -11.899999999999999, -4.300000000000001, -15.1, -24.5, -4.2, -8.3, -11.600000000000001, -18.3, -16.900000000000002, -5.300000000000001, -9.3, -16.999999999999993, -21.199999999999996, -12.199999999999996, -9.7, -21.100000000000005, -2.6000000000000005, -11.3, -11.799999999999999, -15.299999999999997, -19.5, -6.799999999999999, -7.199999999999999, -9.399999999999999, -16.5, -17.0, -12.0, -8.2, -8.299999999999997, -7.600000000000001, -13.799999999999997, -20.100000000000026, -5.3, -11.899999999999999, -14.7, -11.799999999999999, -21.3, -14.5, -6.6, -3.4, -11.3, -15.2, -16.099999999999998, -8.299999999999999, -3.4000000000000004, -15.399999999999995, -5.4, -14.2, -10.4, -26.6, -10.999999999999998, -44.3, -11.3, -12.2, -6.999999999999991, -10.3, -21.80000000000005, -6.300000000000001, -11.799999999999999, -5.300000000000001, -24.10000000000001, -6.2, -14.999999999999998, -9.3, -12.399999999999999, -26.200000000000003, -5.300000000000001, -6.899999999999999, -12.2, -6.6000000000000005, -9.3, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9480463396573521, "mean_inference_ms": 1.2025262284301181, "mean_action_processing_ms": 0.06713235598400567, "mean_env_wait_ms": 5.424509089242281, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 112000, "timesteps_this_iter": 0, "agent_timesteps_total": 112000, "timers": {"sample_time_ms": 14697.071, "sample_throughput": 272.163, "load_time_ms": 0.356, "load_throughput": 11231233.097, "learn_time_ms": 6874.524, "learn_throughput": 581.858, "update_time_ms": 1.594}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.14432147546441004, "policy_loss": -0.018466421278814475, "vf_loss": 16.17459598638678, "vf_explained_var": 0.28837886100174276, "kl": 0.010419393847702631, "entropy": 0.2547851216728969, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 112000, "num_agent_steps_sampled": 112000, "num_steps_trained": 112000, "num_agent_steps_trained": 112000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1128, "training_iteration": 28, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-15-30", "timestamp": 1643645730, "time_this_iter_s": 14.496304750442505, "time_total_s": 411.97499084472656, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 411.97499084472656, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 32.48571428571428, "ram_util_percent": 61.8809523809524}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -44.3, "episode_reward_mean": -11.957, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.199999999999996, -12.199999999999996, -9.7, -21.100000000000005, -2.6000000000000005, -11.3, -11.799999999999999, -15.299999999999997, -19.5, -6.799999999999999, -7.199999999999999, -9.399999999999999, -16.5, -17.0, -12.0, -8.2, -8.299999999999997, -7.600000000000001, -13.799999999999997, -20.100000000000026, -5.3, -11.899999999999999, -14.7, -11.799999999999999, -21.3, -14.5, -6.6, -3.4, -11.3, -15.2, -16.099999999999998, -8.299999999999999, -3.4000000000000004, -15.399999999999995, -5.4, -14.2, -10.4, -26.6, -10.999999999999998, -44.3, -11.3, -12.2, -6.999999999999991, -10.3, -21.80000000000005, -6.300000000000001, -11.799999999999999, -5.300000000000001, -24.10000000000001, -6.2, -14.999999999999998, -9.3, -12.399999999999999, -26.200000000000003, -5.300000000000001, -6.899999999999999, -12.2, -6.6000000000000005, -9.3, -4.300000000000001, -23.90000000000002, -24.3, -13.899999999999999, -25.200000000000056, -21.3, -3.3000000000000003, -6.299999999999999, -9.7, -6.2, -4.300000000000001, -9.5, -12.3, -10.3, -5.699999999999999, -7.4, -10.799999999999999, -4.300000000000001, -7.4, -16.199999999999996, -11.899999999999997, -10.099999999999998, -4.300000000000001, -15.999999999999979, -19.3, -17.2, -4.2, -19.299999999999997, -15.49999999999998, -3.6000000000000005, -3.3, -20.70000000000001, -12.2, -7.299999999999999, -8.8, -6.2, -8.999999999999998, -4.300000000000001, -13.19999999999999, -4.300000000000001, -16.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.946489236239639, "mean_inference_ms": 1.2009845286419227, "mean_action_processing_ms": 0.06705595530628888, "mean_env_wait_ms": 5.419358776488427, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 116000, "timesteps_this_iter": 0, "agent_timesteps_total": 116000, "timers": {"sample_time_ms": 14606.604, "sample_throughput": 273.849, "load_time_ms": 0.353, "load_throughput": 11346690.112, "learn_time_ms": 6856.98, "learn_throughput": 583.347, "update_time_ms": 1.612}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.08935636890030677, "policy_loss": -0.012569683854548281, "vf_loss": 10.088210463267501, "vf_explained_var": 0.08581087755900557, "kl": 0.010439508881862526, "entropy": 0.2290675321253397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 116000, "num_agent_steps_sampled": 116000, "num_steps_trained": 116000, "num_agent_steps_trained": 116000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1168, "training_iteration": 29, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-15-45", "timestamp": 1643645745, "time_this_iter_s": 14.60238003730774, "time_total_s": 426.5773708820343, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 426.5773708820343, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 34.3047619047619, "ram_util_percent": 61.8857142857143}}
{"episode_reward_max": -2.2, "episode_reward_min": -47.800000000000004, "episode_reward_mean": -11.72, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.80000000000005, -6.300000000000001, -11.799999999999999, -5.300000000000001, -24.10000000000001, -6.2, -14.999999999999998, -9.3, -12.399999999999999, -26.200000000000003, -5.300000000000001, -6.899999999999999, -12.2, -6.6000000000000005, -9.3, -4.300000000000001, -23.90000000000002, -24.3, -13.899999999999999, -25.200000000000056, -21.3, -3.3000000000000003, -6.299999999999999, -9.7, -6.2, -4.300000000000001, -9.5, -12.3, -10.3, -5.699999999999999, -7.4, -10.799999999999999, -4.300000000000001, -7.4, -16.199999999999996, -11.899999999999997, -10.099999999999998, -4.300000000000001, -15.999999999999979, -19.3, -17.2, -4.2, -19.299999999999997, -15.49999999999998, -3.6000000000000005, -3.3, -20.70000000000001, -12.2, -7.299999999999999, -8.8, -6.2, -8.999999999999998, -4.300000000000001, -13.19999999999999, -4.300000000000001, -16.2, -15.2, -7.299999999999993, -15.299999999999997, -8.2, -12.7, -8.799999999999997, -22.799999999999997, -7.199999999999999, -12.099999999999996, -9.2, -47.800000000000004, -5.300000000000001, -18.2, -8.599999999999998, -4.4, -10.2, -10.3, -11.499999999999998, -8.7, -8.3, -13.2, -11.299999999999999, -4.6, -19.399999999999995, -6.4, -12.700000000000001, -14.7, -4.4, -16.9, -5.4, -17.700000000000003, -9.2, -5.300000000000001, -2.2, -20.000000000000004, -10.4, -12.3, -27.5, -14.599999999999998, -11.999999999999996, -14.799999999999999, -11.199999999999998, -11.3, -10.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9464825455801887, "mean_inference_ms": 1.1993788517446113, "mean_action_processing_ms": 0.06702532829468909, "mean_env_wait_ms": 5.414888749612332, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"sample_time_ms": 14589.086, "sample_throughput": 274.178, "load_time_ms": 0.344, "load_throughput": 11630652.34, "learn_time_ms": 6859.504, "learn_throughput": 583.133, "update_time_ms": 1.577}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.1444767028093338, "policy_loss": -0.006313930059312492, "vf_loss": 14.994201363735302, "vf_explained_var": 0.35320873177179724, "kl": 0.008486234922844987, "entropy": 0.21587059114088294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 120000, "num_steps_trained": 120000, "num_agent_steps_trained": 120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1212, "training_iteration": 30, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-15-59", "timestamp": 1643645759, "time_this_iter_s": 14.597196102142334, "time_total_s": 441.17456698417664, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 441.17456698417664, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 34.085, "ram_util_percent": 61.90500000000001}}
{"episode_reward_max": -2.2, "episode_reward_min": -92.4, "episode_reward_mean": -13.171000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.2, -4.2, -19.299999999999997, -15.49999999999998, -3.6000000000000005, -3.3, -20.70000000000001, -12.2, -7.299999999999999, -8.8, -6.2, -8.999999999999998, -4.300000000000001, -13.19999999999999, -4.300000000000001, -16.2, -15.2, -7.299999999999993, -15.299999999999997, -8.2, -12.7, -8.799999999999997, -22.799999999999997, -7.199999999999999, -12.099999999999996, -9.2, -47.800000000000004, -5.300000000000001, -18.2, -8.599999999999998, -4.4, -10.2, -10.3, -11.499999999999998, -8.7, -8.3, -13.2, -11.299999999999999, -4.6, -19.399999999999995, -6.4, -12.700000000000001, -14.7, -4.4, -16.9, -5.4, -17.700000000000003, -9.2, -5.300000000000001, -2.2, -20.000000000000004, -10.4, -12.3, -27.5, -14.599999999999998, -11.999999999999996, -14.799999999999999, -11.199999999999998, -11.3, -10.2, -4.2, -13.499999999999998, -14.999999999999998, -15.2, -11.2, -11.2, -5.300000000000001, -22.7, -9.3, -19.10000000000003, -2.5, -92.4, -9.999999999999998, -11.599999999999996, -18.399999999999988, -17.3, -35.2, -9.3, -9.3, -9.999999999999998, -5.4, -8.399999999999999, -14.899999999999995, -5.699999999999999, -7.300000000000001, -11.1, -7.299999999999999, -64.4, -14.999999999999996, -10.399999999999997, -13.2, -7.3, -18.3, -11.3, -6.699999999999999, -6.9, -17.5, -9.2, -11.1, -17.900000000000006], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9471200797680911, "mean_inference_ms": 1.1983987047351103, "mean_action_processing_ms": 0.06698252049655436, "mean_env_wait_ms": 5.411100422213913, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 124000, "timesteps_this_iter": 0, "agent_timesteps_total": 124000, "timers": {"sample_time_ms": 14569.833, "sample_throughput": 274.54, "load_time_ms": 0.342, "load_throughput": 11693069.417, "learn_time_ms": 6802.24, "learn_throughput": 588.042, "update_time_ms": 1.57}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.5295332417410288, "policy_loss": -0.004841897394307839, "vf_loss": 53.3361572329716, "vf_explained_var": 0.05401479537769031, "kl": 0.010135871049820028, "entropy": 0.2217715832254579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 124000, "num_agent_steps_sampled": 124000, "num_steps_trained": 124000, "num_agent_steps_trained": 124000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1252, "training_iteration": 31, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-16-13", "timestamp": 1643645773, "time_this_iter_s": 14.151828289031982, "time_total_s": 455.3263952732086, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 455.3263952732086, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 32.23809523809524, "ram_util_percent": 61.96190476190476}}
{"episode_reward_max": -2.2, "episode_reward_min": -92.4, "episode_reward_mean": -12.897, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.4, -12.700000000000001, -14.7, -4.4, -16.9, -5.4, -17.700000000000003, -9.2, -5.300000000000001, -2.2, -20.000000000000004, -10.4, -12.3, -27.5, -14.599999999999998, -11.999999999999996, -14.799999999999999, -11.199999999999998, -11.3, -10.2, -4.2, -13.499999999999998, -14.999999999999998, -15.2, -11.2, -11.2, -5.300000000000001, -22.7, -9.3, -19.10000000000003, -2.5, -92.4, -9.999999999999998, -11.599999999999996, -18.399999999999988, -17.3, -35.2, -9.3, -9.3, -9.999999999999998, -5.4, -8.399999999999999, -14.899999999999995, -5.699999999999999, -7.300000000000001, -11.1, -7.299999999999999, -64.4, -14.999999999999996, -10.399999999999997, -13.2, -7.3, -18.3, -11.3, -6.699999999999999, -6.9, -17.5, -9.2, -11.1, -17.900000000000006, -10.3, -17.099999999999977, -17.3, -12.2, -8.2, -5.4, -4.700000000000001, -9.5, -6.199999999999999, -13.2, -13.899999999999999, -18.2, -7.3, -9.3, -18.6, -16.6, -11.0, -8.2, -5.2, -12.3, -10.2, -6.599999999999999, -9.499999999999996, -17.099999999999998, -14.099999999999998, -16.2, -16.3, -14.2, -4.3, -6.4, -10.199999999999996, -7.3, -4.300000000000001, -10.3, -6.6, -9.7, -12.2, -10.0, -20.099999999999994, -8.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9474620899592449, "mean_inference_ms": 1.1974344341611065, "mean_action_processing_ms": 0.06689928228944463, "mean_env_wait_ms": 5.406271849716818, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 128000, "timesteps_this_iter": 0, "agent_timesteps_total": 128000, "timers": {"sample_time_ms": 14517.206, "sample_throughput": 275.535, "load_time_ms": 0.341, "load_throughput": 11718387.93, "learn_time_ms": 6811.036, "learn_throughput": 587.282, "update_time_ms": 1.579}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.054667714317279154, "policy_loss": -0.018649809930213198, "vf_loss": 7.267966573212736, "vf_explained_var": 0.3527721772270818, "kl": 0.0063786020562143315, "entropy": 0.226669356150813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 128000, "num_agent_steps_sampled": 128000, "num_steps_trained": 128000, "num_agent_steps_trained": 128000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1292, "training_iteration": 32, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-16-28", "timestamp": 1643645788, "time_this_iter_s": 14.948259830474854, "time_total_s": 470.2746551036835, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 470.2746551036835, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 32.79047619047619, "ram_util_percent": 61.8857142857143}}
{"episode_reward_max": -4.2, "episode_reward_min": -64.4, "episode_reward_mean": -11.817, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -8.399999999999999, -14.899999999999995, -5.699999999999999, -7.300000000000001, -11.1, -7.299999999999999, -64.4, -14.999999999999996, -10.399999999999997, -13.2, -7.3, -18.3, -11.3, -6.699999999999999, -6.9, -17.5, -9.2, -11.1, -17.900000000000006, -10.3, -17.099999999999977, -17.3, -12.2, -8.2, -5.4, -4.700000000000001, -9.5, -6.199999999999999, -13.2, -13.899999999999999, -18.2, -7.3, -9.3, -18.6, -16.6, -11.0, -8.2, -5.2, -12.3, -10.2, -6.599999999999999, -9.499999999999996, -17.099999999999998, -14.099999999999998, -16.2, -16.3, -14.2, -4.3, -6.4, -10.199999999999996, -7.3, -4.300000000000001, -10.3, -6.6, -9.7, -12.2, -10.0, -20.099999999999994, -8.2, -9.3, -5.300000000000001, -12.0, -18.599999999999998, -15.399999999999999, -16.9, -14.6, -5.3, -5.3, -11.799999999999999, -9.2, -6.2, -9.2, -9.599999999999996, -6.899999999999998, -6.999999999999999, -13.799999999999999, -6.2, -9.899999999999999, -12.5, -18.299999999999997, -13.49999999999999, -15.699999999999976, -7.3, -4.2, -4.300000000000001, -18.800000000000004, -11.2, -23.700000000000003, -22.700000000000003, -17.9, -19.399999999999984, -5.6, -17.699999999999996, -9.3, -17.599999999999998, -14.700000000000001, -10.1, -11.7, -5.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9463935588661758, "mean_inference_ms": 1.1958681917338645, "mean_action_processing_ms": 0.06680965050846081, "mean_env_wait_ms": 5.399112935856172, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 132000, "timesteps_this_iter": 0, "agent_timesteps_total": 132000, "timers": {"sample_time_ms": 14521.066, "sample_throughput": 275.462, "load_time_ms": 0.334, "load_throughput": 11993148.903, "learn_time_ms": 6827.309, "learn_throughput": 585.882, "update_time_ms": 1.574}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.06912450022915358, "policy_loss": -0.008329143408705952, "vf_loss": 7.653913900929113, "vf_explained_var": 0.3680454364386938, "kl": 0.009145053550060378, "entropy": 0.20657029572914365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 132000, "num_agent_steps_sampled": 132000, "num_steps_trained": 132000, "num_agent_steps_trained": 132000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1332, "training_iteration": 33, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-16-43", "timestamp": 1643645803, "time_this_iter_s": 14.546359062194824, "time_total_s": 484.8210141658783, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 484.8210141658783, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 24.915, "ram_util_percent": 61.93000000000001}}
{"episode_reward_max": -3.2, "episode_reward_min": -23.700000000000003, "episode_reward_mean": -11.081, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.2, -6.599999999999999, -9.499999999999996, -17.099999999999998, -14.099999999999998, -16.2, -16.3, -14.2, -4.3, -6.4, -10.199999999999996, -7.3, -4.300000000000001, -10.3, -6.6, -9.7, -12.2, -10.0, -20.099999999999994, -8.2, -9.3, -5.300000000000001, -12.0, -18.599999999999998, -15.399999999999999, -16.9, -14.6, -5.3, -5.3, -11.799999999999999, -9.2, -6.2, -9.2, -9.599999999999996, -6.899999999999998, -6.999999999999999, -13.799999999999999, -6.2, -9.899999999999999, -12.5, -18.299999999999997, -13.49999999999999, -15.699999999999976, -7.3, -4.2, -4.300000000000001, -18.800000000000004, -11.2, -23.700000000000003, -22.700000000000003, -17.9, -19.399999999999984, -5.6, -17.699999999999996, -9.3, -17.599999999999998, -14.700000000000001, -10.1, -11.7, -5.2, -7.999999999999997, -19.4, -6.299999999999999, -10.3, -3.5, -10.2, -10.2, -11.799999999999994, -5.8, -19.9, -9.799999999999995, -17.4, -5.300000000000001, -6.8, -8.799999999999997, -4.0, -6.799999999999998, -10.799999999999997, -14.5, -10.600000000000001, -5.2, -19.6, -4.2, -15.899999999999999, -14.5, -13.599999999999998, -11.3, -4.2, -12.2, -12.3, -12.2, -8.3, -18.2, -4.800000000000001, -18.799999999999997, -11.3, -12.9, -3.2, -12.2, -5.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9462527960190107, "mean_inference_ms": 1.1948345967799914, "mean_action_processing_ms": 0.06675353684224586, "mean_env_wait_ms": 5.394742879532307, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 136000, "timesteps_this_iter": 0, "agent_timesteps_total": 136000, "timers": {"sample_time_ms": 14552.915, "sample_throughput": 274.859, "load_time_ms": 0.336, "load_throughput": 11899578.694, "learn_time_ms": 7044.812, "learn_throughput": 567.794, "update_time_ms": 1.598}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.05887549873842027, "policy_loss": -0.012870122602720174, "vf_loss": 7.104304819337783, "vf_explained_var": 0.33063872315550363, "kl": 0.0070257533045046845, "entropy": 0.2282017548478419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 136000, "num_agent_steps_sampled": 136000, "num_steps_trained": 136000, "num_agent_steps_trained": 136000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1372, "training_iteration": 34, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-16-59", "timestamp": 1643645819, "time_this_iter_s": 16.45470118522644, "time_total_s": 501.27571535110474, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 501.27571535110474, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 32.90833333333333, "ram_util_percent": 62.04583333333333}}
{"episode_reward_max": -3.2, "episode_reward_min": -28.700000000000003, "episode_reward_mean": -11.344, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.299999999999997, -13.49999999999999, -15.699999999999976, -7.3, -4.2, -4.300000000000001, -18.800000000000004, -11.2, -23.700000000000003, -22.700000000000003, -17.9, -19.399999999999984, -5.6, -17.699999999999996, -9.3, -17.599999999999998, -14.700000000000001, -10.1, -11.7, -5.2, -7.999999999999997, -19.4, -6.299999999999999, -10.3, -3.5, -10.2, -10.2, -11.799999999999994, -5.8, -19.9, -9.799999999999995, -17.4, -5.300000000000001, -6.8, -8.799999999999997, -4.0, -6.799999999999998, -10.799999999999997, -14.5, -10.600000000000001, -5.2, -19.6, -4.2, -15.899999999999999, -14.5, -13.599999999999998, -11.3, -4.2, -12.2, -12.3, -12.2, -8.3, -18.2, -4.800000000000001, -18.799999999999997, -11.3, -12.9, -3.2, -12.2, -5.300000000000001, -10.700000000000001, -13.6, -5.799999999999999, -15.499999999999995, -3.4, -11.3, -14.3, -9.8, -10.3, -15.699999999999998, -8.2, -9.799999999999997, -4.300000000000001, -8.2, -6.8999999999999995, -5.2, -6.2, -9.2, -27.799999999999997, -9.600000000000001, -28.700000000000003, -5.499999999999999, -20.799999999999997, -11.999999999999998, -16.1, -12.6, -3.3, -4.1, -8.2, -8.7, -12.2, -19.5, -9.2, -9.2, -7.1, -12.099999999999998, -13.3, -8.9, -7.3, -20.499999999999996], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9472142564353533, "mean_inference_ms": 1.194821744938295, "mean_action_processing_ms": 0.06674968162264562, "mean_env_wait_ms": 5.395451512345215, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 140000, "timesteps_this_iter": 0, "agent_timesteps_total": 140000, "timers": {"sample_time_ms": 14834.534, "sample_throughput": 269.641, "load_time_ms": 0.338, "load_throughput": 11822433.937, "learn_time_ms": 7170.517, "learn_throughput": 557.84, "update_time_ms": 1.613}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.055912672936595895, "policy_loss": -0.004188864833865595, "vf_loss": 5.960221383936943, "vf_explained_var": 0.3716397331606957, "kl": 0.0049932501346204574, "entropy": 0.19883673610866712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 140000, "num_agent_steps_sampled": 140000, "num_steps_trained": 140000, "num_agent_steps_trained": 140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1412, "training_iteration": 35, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-17-16", "timestamp": 1643645836, "time_this_iter_s": 16.122977018356323, "time_total_s": 517.3986923694611, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 517.3986923694611, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 35.28695652173913, "ram_util_percent": 62.12608695652175}}
{"episode_reward_max": -3.2, "episode_reward_min": -84.3, "episode_reward_mean": -11.405999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -19.6, -4.2, -15.899999999999999, -14.5, -13.599999999999998, -11.3, -4.2, -12.2, -12.3, -12.2, -8.3, -18.2, -4.800000000000001, -18.799999999999997, -11.3, -12.9, -3.2, -12.2, -5.300000000000001, -10.700000000000001, -13.6, -5.799999999999999, -15.499999999999995, -3.4, -11.3, -14.3, -9.8, -10.3, -15.699999999999998, -8.2, -9.799999999999997, -4.300000000000001, -8.2, -6.8999999999999995, -5.2, -6.2, -9.2, -27.799999999999997, -9.600000000000001, -28.700000000000003, -5.499999999999999, -20.799999999999997, -11.999999999999998, -16.1, -12.6, -3.3, -4.1, -8.2, -8.7, -12.2, -19.5, -9.2, -9.2, -7.1, -12.099999999999998, -13.3, -8.9, -7.3, -20.499999999999996, -5.4, -10.7, -4.4, -7.399999999999999, -25.300000000000004, -5.6, -14.899999999999999, -7.300000000000001, -8.4, -84.3, -4.4, -3.2, -9.3, -17.4, -6.599999999999998, -5.2, -27.3, -10.899999999999999, -6.4, -4.4, -15.899999999999999, -4.5, -14.3, -13.299999999999995, -3.3, -9.6, -15.2, -4.6, -7.4, -4.4, -5.2, -16.299999999999997, -4.5, -14.299999999999997, -9.2, -13.099999999999971, -14.899999999999997, -6.300000000000001, -9.3, -20.900000000000006], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9486398079756276, "mean_inference_ms": 1.1963216723434824, "mean_action_processing_ms": 0.06682364909584475, "mean_env_wait_ms": 5.403134423787771, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 144000, "timesteps_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"sample_time_ms": 15034.445, "sample_throughput": 266.056, "load_time_ms": 0.346, "load_throughput": 11570493.793, "learn_time_ms": 7341.15, "learn_throughput": 544.874, "update_time_ms": 1.584}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.4003485622252488, "policy_loss": -0.004249051814993984, "vf_loss": 40.439652787229065, "vf_explained_var": 0.2968805855961256, "kl": 0.004022090349699974, "entropy": 0.1937099071960616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 144000, "num_agent_steps_sampled": 144000, "num_steps_trained": 144000, "num_agent_steps_trained": 144000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1452, "training_iteration": 36, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-17-33", "timestamp": 1643645853, "time_this_iter_s": 16.972096920013428, "time_total_s": 534.3707892894745, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 534.3707892894745, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 30.724999999999998, "ram_util_percent": 62.18333333333334}}
{"episode_reward_max": -3.2, "episode_reward_min": -84.3, "episode_reward_mean": -11.627, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.700000000000003, -5.499999999999999, -20.799999999999997, -11.999999999999998, -16.1, -12.6, -3.3, -4.1, -8.2, -8.7, -12.2, -19.5, -9.2, -9.2, -7.1, -12.099999999999998, -13.3, -8.9, -7.3, -20.499999999999996, -5.4, -10.7, -4.4, -7.399999999999999, -25.300000000000004, -5.6, -14.899999999999999, -7.300000000000001, -8.4, -84.3, -4.4, -3.2, -9.3, -17.4, -6.599999999999998, -5.2, -27.3, -10.899999999999999, -6.4, -4.4, -15.899999999999999, -4.5, -14.3, -13.299999999999995, -3.3, -9.6, -15.2, -4.6, -7.4, -4.4, -5.2, -16.299999999999997, -4.5, -14.299999999999997, -9.2, -13.099999999999971, -14.899999999999997, -6.300000000000001, -9.3, -20.900000000000006, -10.799999999999999, -19.3, -13.199999999999998, -16.09999999999998, -10.399999999999999, -4.2, -9.2, -5.2, -9.3, -10.3, -10.899999999999999, -9.999999999999998, -8.3, -3.3, -24.699999999999996, -4.2, -15.7, -13.699999999999998, -8.2, -12.399999999999999, -7.299999999999999, -6.3999999999999995, -7.0, -6.300000000000001, -21.3, -6.2, -18.199999999999996, -16.299999999999997, -5.300000000000001, -15.700000000000001, -9.1, -8.999999999999996, -15.299999999999997, -8.2, -3.3, -7.899999999999999, -16.2, -10.9, -28.199999999999996, -10.600000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9494065492055113, "mean_inference_ms": 1.1984649981995306, "mean_action_processing_ms": 0.06693294203331261, "mean_env_wait_ms": 5.413225272740458, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 148000, "timesteps_this_iter": 0, "agent_timesteps_total": 148000, "timers": {"sample_time_ms": 15277.87, "sample_throughput": 261.817, "load_time_ms": 0.354, "load_throughput": 11297788.552, "learn_time_ms": 7445.626, "learn_throughput": 537.228, "update_time_ms": 1.638}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.2519272593330712, "policy_loss": -0.014292833555529835, "vf_loss": 26.599516360605918, "vf_explained_var": 0.25925566746342565, "kl": 0.008997377302418948, "entropy": 0.22890989608982557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 148000, "num_agent_steps_sampled": 148000, "num_steps_trained": 148000, "num_agent_steps_trained": 148000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1492, "training_iteration": 37, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-17-49", "timestamp": 1643645869, "time_this_iter_s": 16.605098009109497, "time_total_s": 550.975887298584, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 550.975887298584, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 25.03333333333333, "ram_util_percent": 62.12083333333334}}
{"episode_reward_max": -3.3, "episode_reward_min": -94.4, "episode_reward_mean": -13.427999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.899999999999999, -4.5, -14.3, -13.299999999999995, -3.3, -9.6, -15.2, -4.6, -7.4, -4.4, -5.2, -16.299999999999997, -4.5, -14.299999999999997, -9.2, -13.099999999999971, -14.899999999999997, -6.300000000000001, -9.3, -20.900000000000006, -10.799999999999999, -19.3, -13.199999999999998, -16.09999999999998, -10.399999999999999, -4.2, -9.2, -5.2, -9.3, -10.3, -10.899999999999999, -9.999999999999998, -8.3, -3.3, -24.699999999999996, -4.2, -15.7, -13.699999999999998, -8.2, -12.399999999999999, -7.299999999999999, -6.3999999999999995, -7.0, -6.300000000000001, -21.3, -6.2, -18.199999999999996, -16.299999999999997, -5.300000000000001, -15.700000000000001, -9.1, -8.999999999999996, -15.299999999999997, -8.2, -3.3, -7.899999999999999, -16.2, -10.9, -28.199999999999996, -10.600000000000001, -94.4, -19.599999999999998, -10.7, -14.5, -14.5, -13.3, -12.3, -6.3, -19.199999999999974, -89.3, -15.3, -8.699999999999998, -10.899999999999999, -13.999999999999998, -8.899999999999999, -4.4, -6.4, -7.3, -9.999999999999996, -15.399999999999999, -4.3, -9.2, -7.299999999999999, -3.3, -6.300000000000001, -9.2, -22.699999999999996, -14.6, -5.3, -13.299999999999995, -18.6, -17.9, -15.5, -84.4, -9.299999999999999, -11.899999999999999, -4.300000000000001, -7.2, -16.5, -11.7], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9502364448058345, "mean_inference_ms": 1.1995719123669573, "mean_action_processing_ms": 0.06698475427906254, "mean_env_wait_ms": 5.417912942103198, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 152000, "timesteps_this_iter": 0, "agent_timesteps_total": 152000, "timers": {"sample_time_ms": 15414.109, "sample_throughput": 259.503, "load_time_ms": 0.354, "load_throughput": 11314550.85, "learn_time_ms": 7567.599, "learn_throughput": 528.569, "update_time_ms": 1.679}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.6902126334555027, "policy_loss": -0.007061696725506937, "vf_loss": 69.70079008430562, "vf_explained_var": 0.25246926103868794, "kl": 0.010657917544275303, "entropy": 0.2258345698957802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 152000, "num_agent_steps_sampled": 152000, "num_steps_trained": 152000, "num_agent_steps_trained": 152000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1532, "training_iteration": 38, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-18-05", "timestamp": 1643645885, "time_this_iter_s": 16.058300256729126, "time_total_s": 567.0341875553131, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 567.0341875553131, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 27.995652173913044, "ram_util_percent": 62.07391304347825}}
{"episode_reward_max": -2.5, "episode_reward_min": -94.4, "episode_reward_mean": -13.761, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.299999999999999, -6.3999999999999995, -7.0, -6.300000000000001, -21.3, -6.2, -18.199999999999996, -16.299999999999997, -5.300000000000001, -15.700000000000001, -9.1, -8.999999999999996, -15.299999999999997, -8.2, -3.3, -7.899999999999999, -16.2, -10.9, -28.199999999999996, -10.600000000000001, -94.4, -19.599999999999998, -10.7, -14.5, -14.5, -13.3, -12.3, -6.3, -19.199999999999974, -89.3, -15.3, -8.699999999999998, -10.899999999999999, -13.999999999999998, -8.899999999999999, -4.4, -6.4, -7.3, -9.999999999999996, -15.399999999999999, -4.3, -9.2, -7.299999999999999, -3.3, -6.300000000000001, -9.2, -22.699999999999996, -14.6, -5.3, -13.299999999999995, -18.6, -17.9, -15.5, -84.4, -9.299999999999999, -11.899999999999999, -4.300000000000001, -7.2, -16.5, -11.7, -17.500000000000004, -10.599999999999998, -18.8, -9.799999999999999, -10.3, -14.7, -33.3, -6.300000000000001, -19.099999999999998, -16.6, -9.7, -3.4000000000000004, -3.3, -8.5, -4.300000000000001, -17.799999999999997, -5.300000000000001, -5.300000000000001, -17.3, -6.1, -20.199999999999985, -23.3, -2.5, -12.999999999999996, -7.599999999999998, -12.799999999999997, -12.2, -6.4, -19.5, -3.3, -12.099999999999971, -6.899999999999999, -20.799999999999997, -16.1, -4.700000000000001, -3.3, -8.299999999999997, -8.299999999999997, -11.7, -8.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9502197273678797, "mean_inference_ms": 1.201411624942197, "mean_action_processing_ms": 0.0670124107131574, "mean_env_wait_ms": 5.4206637174039125, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 156000, "timesteps_this_iter": 0, "agent_timesteps_total": 156000, "timers": {"sample_time_ms": 15571.846, "sample_throughput": 256.874, "load_time_ms": 0.355, "load_throughput": 11279558.962, "learn_time_ms": 7647.218, "learn_throughput": 523.066, "update_time_ms": 1.69}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.1399923080688603, "policy_loss": -0.008513104561616176, "vf_loss": 14.828576523514204, "vf_explained_var": 0.07065550383701119, "kl": 0.008785982253800161, "entropy": 0.2060843186593184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 156000, "num_agent_steps_sampled": 156000, "num_steps_trained": 156000, "num_agent_steps_trained": 156000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1572, "training_iteration": 39, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-18-21", "timestamp": 1643645901, "time_this_iter_s": 15.722701072692871, "time_total_s": 582.756888628006, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 582.756888628006, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 27.227272727272727, "ram_util_percent": 62.5}}
{"episode_reward_max": -2.5, "episode_reward_min": -84.4, "episode_reward_mean": -12.616999999999997, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.300000000000001, -9.2, -22.699999999999996, -14.6, -5.3, -13.299999999999995, -18.6, -17.9, -15.5, -84.4, -9.299999999999999, -11.899999999999999, -4.300000000000001, -7.2, -16.5, -11.7, -17.500000000000004, -10.599999999999998, -18.8, -9.799999999999999, -10.3, -14.7, -33.3, -6.300000000000001, -19.099999999999998, -16.6, -9.7, -3.4000000000000004, -3.3, -8.5, -4.300000000000001, -17.799999999999997, -5.300000000000001, -5.300000000000001, -17.3, -6.1, -20.199999999999985, -23.3, -2.5, -12.999999999999996, -7.599999999999998, -12.799999999999997, -12.2, -6.4, -19.5, -3.3, -12.099999999999971, -6.899999999999999, -20.799999999999997, -16.1, -4.700000000000001, -3.3, -8.299999999999997, -8.299999999999997, -11.7, -8.2, -7.2, -16.099999999999994, -8.2, -5.300000000000001, -9.2, -4.300000000000001, -7.2, -11.499999999999998, -13.399999999999999, -22.499999999999996, -74.3, -7.800000000000001, -17.2, -15.7, -8.3, -12.299999999999999, -4.1, -14.399999999999999, -7.1, -18.599999999999998, -9.2, -13.1, -10.1, -8.799999999999997, -12.600000000000001, -17.7, -12.1, -12.600000000000001, -15.799999999999997, -12.4, -8.8, -8.9, -8.3, -7.300000000000001, -3.2, -4.2, -6.300000000000001, -16.099999999999998, -9.5, -9.2, -12.799999999999986, -8.2, -9.799999999999999, -12.1], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9512481657565139, "mean_inference_ms": 1.2023355382611414, "mean_action_processing_ms": 0.06703075376934864, "mean_env_wait_ms": 5.420050206087092, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 160000, "timesteps_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"sample_time_ms": 15644.097, "sample_throughput": 255.687, "load_time_ms": 0.358, "load_throughput": 11188540.18, "learn_time_ms": 7683.756, "learn_throughput": 520.579, "update_time_ms": 1.694}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.37817132424022404, "policy_loss": -0.002320068902386132, "vf_loss": 38.03194393009268, "vf_explained_var": 0.09548283866656723, "kl": 0.006878363663879793, "entropy": 0.18957773926517657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 160000, "num_agent_steps_sampled": 160000, "num_steps_trained": 160000, "num_agent_steps_trained": 160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1616, "training_iteration": 40, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-18-36", "timestamp": 1643645916, "time_this_iter_s": 14.883954048156738, "time_total_s": 597.6408426761627, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 597.6408426761627, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 31.695238095238096, "ram_util_percent": 62.39047619047619}}
{"episode_reward_max": -3.2, "episode_reward_min": -74.3, "episode_reward_mean": -10.927, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.599999999999998, -12.799999999999997, -12.2, -6.4, -19.5, -3.3, -12.099999999999971, -6.899999999999999, -20.799999999999997, -16.1, -4.700000000000001, -3.3, -8.299999999999997, -8.299999999999997, -11.7, -8.2, -7.2, -16.099999999999994, -8.2, -5.300000000000001, -9.2, -4.300000000000001, -7.2, -11.499999999999998, -13.399999999999999, -22.499999999999996, -74.3, -7.800000000000001, -17.2, -15.7, -8.3, -12.299999999999999, -4.1, -14.399999999999999, -7.1, -18.599999999999998, -9.2, -13.1, -10.1, -8.799999999999997, -12.600000000000001, -17.7, -12.1, -12.600000000000001, -15.799999999999997, -12.4, -8.8, -8.9, -8.3, -7.300000000000001, -3.2, -4.2, -6.300000000000001, -16.099999999999998, -9.5, -9.2, -12.799999999999986, -8.2, -9.799999999999999, -12.1, -21.099999999999998, -4.2, -10.099999999999998, -26.3, -16.79999999999998, -11.6, -3.3, -4.2, -6.899999999999999, -24.4, -10.6, -4.300000000000001, -7.2, -20.4, -6.300000000000001, -3.3, -11.2, -7.199999999999999, -19.0, -5.3, -12.3, -6.199999999999999, -6.3, -11.2, -4.2, -4.2, -13.7, -8.899999999999997, -9.2, -3.3, -12.6, -17.5, -12.4, -4.300000000000001, -4.4, -4.300000000000001, -9.3, -6.4, -8.4, -13.89999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9525056305587847, "mean_inference_ms": 1.2019921877926014, "mean_action_processing_ms": 0.06699962431959368, "mean_env_wait_ms": 5.41782889813198, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 164000, "timesteps_this_iter": 0, "agent_timesteps_total": 164000, "timers": {"sample_time_ms": 15691.552, "sample_throughput": 254.914, "load_time_ms": 0.355, "load_throughput": 11257609.877, "learn_time_ms": 7817.325, "learn_throughput": 511.684, "update_time_ms": 1.713}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.07559852652722389, "policy_loss": -0.01177208977801505, "vf_loss": 8.691612554045134, "vf_explained_var": 0.283426030476888, "kl": 0.01817965340693194, "entropy": 0.16038403416112545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 164000, "num_agent_steps_sampled": 164000, "num_steps_trained": 164000, "num_agent_steps_trained": 164000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1656, "training_iteration": 41, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-18-52", "timestamp": 1643645932, "time_this_iter_s": 15.597401142120361, "time_total_s": 613.2382438182831, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 613.2382438182831, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 34.5391304347826, "ram_util_percent": 62.1173913043478}}
{"episode_reward_max": -3.2, "episode_reward_min": -46.3, "episode_reward_mean": -11.264, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.600000000000001, -17.7, -12.1, -12.600000000000001, -15.799999999999997, -12.4, -8.8, -8.9, -8.3, -7.300000000000001, -3.2, -4.2, -6.300000000000001, -16.099999999999998, -9.5, -9.2, -12.799999999999986, -8.2, -9.799999999999999, -12.1, -21.099999999999998, -4.2, -10.099999999999998, -26.3, -16.79999999999998, -11.6, -3.3, -4.2, -6.899999999999999, -24.4, -10.6, -4.300000000000001, -7.2, -20.4, -6.300000000000001, -3.3, -11.2, -7.199999999999999, -19.0, -5.3, -12.3, -6.199999999999999, -6.3, -11.2, -4.2, -4.2, -13.7, -8.899999999999997, -9.2, -3.3, -12.6, -17.5, -12.4, -4.300000000000001, -4.4, -4.300000000000001, -9.3, -6.4, -8.4, -13.89999999999998, -3.3, -4.4, -18.799999999999997, -12.899999999999999, -5.4, -9.2, -20.1, -33.400000000000006, -3.3, -29.3, -3.2, -5.300000000000001, -4.4, -4.800000000000001, -25.400000000000016, -9.299999999999999, -4.300000000000001, -10.699999999999998, -7.3, -15.5, -11.899999999999999, -11.2, -4.4, -8.2, -12.1, -12.1, -9.999999999999998, -8.299999999999997, -9.4, -6.5, -21.8, -4.2, -7.300000000000001, -3.3, -10.799999999999999, -17.5, -16.5, -46.2, -23.5, -46.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9530029098032128, "mean_inference_ms": 1.2020056890904585, "mean_action_processing_ms": 0.06696088664044392, "mean_env_wait_ms": 5.418021388051861, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 168000, "timesteps_this_iter": 0, "agent_timesteps_total": 168000, "timers": {"sample_time_ms": 15864.532, "sample_throughput": 252.135, "load_time_ms": 0.356, "load_throughput": 11234993.638, "learn_time_ms": 7855.014, "learn_throughput": 509.229, "update_time_ms": 1.722}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.2165711773779764, "policy_loss": -0.009466315082885245, "vf_loss": 22.57159216647507, "vf_explained_var": 0.18825016380638204, "kl": 0.012863025625083775, "entropy": 0.2202380861165703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 168000, "num_agent_steps_sampled": 168000, "num_steps_trained": 168000, "num_agent_steps_trained": 168000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1696, "training_iteration": 42, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-19-07", "timestamp": 1643645947, "time_this_iter_s": 15.700817108154297, "time_total_s": 628.9390609264374, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 628.9390609264374, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 32.04090909090908, "ram_util_percent": 62.145454545454555}}
{"episode_reward_max": -3.2, "episode_reward_min": -79.4, "episode_reward_mean": -12.366999999999996, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.3, -6.199999999999999, -6.3, -11.2, -4.2, -4.2, -13.7, -8.899999999999997, -9.2, -3.3, -12.6, -17.5, -12.4, -4.300000000000001, -4.4, -4.300000000000001, -9.3, -6.4, -8.4, -13.89999999999998, -3.3, -4.4, -18.799999999999997, -12.899999999999999, -5.4, -9.2, -20.1, -33.400000000000006, -3.3, -29.3, -3.2, -5.300000000000001, -4.4, -4.800000000000001, -25.400000000000016, -9.299999999999999, -4.300000000000001, -10.699999999999998, -7.3, -15.5, -11.899999999999999, -11.2, -4.4, -8.2, -12.1, -12.1, -9.999999999999998, -8.299999999999997, -9.4, -6.5, -21.8, -4.2, -7.300000000000001, -3.3, -10.799999999999999, -17.5, -16.5, -46.2, -23.5, -46.3, -12.199999999999998, -8.899999999999999, -8.2, -23.0, -5.799999999999999, -7.2, -9.599999999999998, -12.8, -27.700000000000003, -3.3, -3.2, -10.6, -10.7, -6.3, -3.4, -8.3, -5.300000000000001, -10.6, -3.3, -15.699999999999998, -7.4, -10.5, -9.2, -8.2, -15.899999999999993, -20.999999999999996, -3.3, -24.600000000000005, -18.099999999999998, -79.4, -9.499999999999998, -7.8999999999999995, -14.899999999999979, -15.599999999999996, -13.099999999999996, -13.199999999999998, -20.60000000000001, -8.6, -36.2, -8.600000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.95568813307702, "mean_inference_ms": 1.2052694778673045, "mean_action_processing_ms": 0.06715682869587287, "mean_env_wait_ms": 5.4331364918479235, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 172000, "timesteps_this_iter": 0, "agent_timesteps_total": 172000, "timers": {"sample_time_ms": 16189.392, "sample_throughput": 247.075, "load_time_ms": 0.366, "load_throughput": 10921244.63, "learn_time_ms": 7946.756, "learn_throughput": 503.35, "update_time_ms": 1.765}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.39317974254579074, "policy_loss": -0.009984441118575231, "vf_loss": 40.29133026907521, "vf_explained_var": 0.3088518098477394, "kl": 0.010035528799201792, "entropy": 0.24466253905607166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 172000, "num_agent_steps_sampled": 172000, "num_steps_trained": 172000, "num_agent_steps_trained": 172000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1736, "training_iteration": 43, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-19-26", "timestamp": 1643645966, "time_this_iter_s": 18.313371896743774, "time_total_s": 647.2524328231812, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 647.2524328231812, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 45.3346153846154, "ram_util_percent": 62.161538461538456}}
{"episode_reward_max": -3.2, "episode_reward_min": -79.4, "episode_reward_mean": -12.466999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.899999999999999, -11.2, -4.4, -8.2, -12.1, -12.1, -9.999999999999998, -8.299999999999997, -9.4, -6.5, -21.8, -4.2, -7.300000000000001, -3.3, -10.799999999999999, -17.5, -16.5, -46.2, -23.5, -46.3, -12.199999999999998, -8.899999999999999, -8.2, -23.0, -5.799999999999999, -7.2, -9.599999999999998, -12.8, -27.700000000000003, -3.3, -3.2, -10.6, -10.7, -6.3, -3.4, -8.3, -5.300000000000001, -10.6, -3.3, -15.699999999999998, -7.4, -10.5, -9.2, -8.2, -15.899999999999993, -20.999999999999996, -3.3, -24.600000000000005, -18.099999999999998, -79.4, -9.499999999999998, -7.8999999999999995, -14.899999999999979, -15.599999999999996, -13.099999999999996, -13.199999999999998, -20.60000000000001, -8.6, -36.2, -8.600000000000001, -4.3, -16.700000000000003, -9.0, -3.2, -5.499999999999999, -3.2, -13.999999999999998, -8.7, -45.3, -17.6, -9.4, -17.8, -4.700000000000001, -3.3, -12.599999999999989, -11.7, -15.4, -6.9, -3.3, -4.300000000000001, -9.2, -8.3, -11.299999999999999, -3.2, -6.3999999999999995, -13.7, -12.8, -7.2, -6.300000000000001, -5.300000000000001, -10.099999999999998, -4.300000000000001, -10.799999999999999, -4.4, -7.3999999999999995, -22.699999999999996, -3.3, -17.799999999999997, -20.700000000000003, -11.199999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9583425306930095, "mean_inference_ms": 1.2091198783262989, "mean_action_processing_ms": 0.06739397937134908, "mean_env_wait_ms": 5.453184319427367, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 176000, "timesteps_this_iter": 0, "agent_timesteps_total": 176000, "timers": {"sample_time_ms": 16342.763, "sample_throughput": 244.757, "load_time_ms": 0.366, "load_throughput": 10914139.995, "learn_time_ms": 7903.26, "learn_throughput": 506.12, "update_time_ms": 1.733}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.08583854283506591, "policy_loss": -0.010392028664148623, "vf_loss": 9.60065098629203, "vf_explained_var": 0.30470535473157, "kl": 0.00896251499536345, "entropy": 0.20841634342426896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 176000, "num_agent_steps_sampled": 176000, "num_steps_trained": 176000, "num_agent_steps_trained": 176000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1776, "training_iteration": 44, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-19-42", "timestamp": 1643645982, "time_this_iter_s": 16.64800524711609, "time_total_s": 663.9004380702972, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 663.9004380702972, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 37.15833333333333, "ram_util_percent": 62.25}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -79.4, "episode_reward_mean": -12.732999999999997, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.4, -10.5, -9.2, -8.2, -15.899999999999993, -20.999999999999996, -3.3, -24.600000000000005, -18.099999999999998, -79.4, -9.499999999999998, -7.8999999999999995, -14.899999999999979, -15.599999999999996, -13.099999999999996, -13.199999999999998, -20.60000000000001, -8.6, -36.2, -8.600000000000001, -4.3, -16.700000000000003, -9.0, -3.2, -5.499999999999999, -3.2, -13.999999999999998, -8.7, -45.3, -17.6, -9.4, -17.8, -4.700000000000001, -3.3, -12.599999999999989, -11.7, -15.4, -6.9, -3.3, -4.300000000000001, -9.2, -8.3, -11.299999999999999, -3.2, -6.3999999999999995, -13.7, -12.8, -7.2, -6.300000000000001, -5.300000000000001, -10.099999999999998, -4.300000000000001, -10.799999999999999, -4.4, -7.3999999999999995, -22.699999999999996, -3.3, -17.799999999999997, -20.700000000000003, -11.199999999999998, -2.3000000000000003, -45.2, -10.2, -13.7, -4.4, -18.599999999999994, -12.0, -41.3, -24.099999999999966, -7.3, -22.900000000000002, -7.599999999999999, -12.999999999999998, -3.4, -4.2, -7.2, -12.799999999999999, -16.099999999999998, -17.3, -4.4, -5.2, -3.4, -12.799999999999999, -12.7, -8.6, -12.3, -15.5, -7.300000000000001, -8.9, -9.899999999999991, -12.599999999999998, -15.799999999999999, -12.499999999999998, -3.3, -9.399999999999997, -39.3, -8.600000000000001, -4.6000000000000005, -16.299999999999997, -7.199999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9590541066283496, "mean_inference_ms": 1.2107501191702974, "mean_action_processing_ms": 0.06751239415631755, "mean_env_wait_ms": 5.462756808765794, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 180000, "timesteps_this_iter": 0, "agent_timesteps_total": 180000, "timers": {"sample_time_ms": 16244.461, "sample_throughput": 246.238, "load_time_ms": 0.366, "load_throughput": 10916980.739, "learn_time_ms": 7953.833, "learn_throughput": 502.902, "update_time_ms": 1.728}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.20653748735685343, "policy_loss": -0.007173836919208688, "vf_loss": 21.34437950400896, "vf_explained_var": 0.12191126481179268, "kl": 0.010701501865848336, "entropy": 0.2224900820442746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 180000, "num_agent_steps_sampled": 180000, "num_steps_trained": 180000, "num_agent_steps_trained": 180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1816, "training_iteration": 45, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-19-59", "timestamp": 1643645999, "time_this_iter_s": 16.08161187171936, "time_total_s": 679.9820499420166, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 679.9820499420166, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 35.84347826086957, "ram_util_percent": 62.09130434782606}}
{"episode_reward_max": -2.2, "episode_reward_min": -80.2, "episode_reward_mean": -11.811000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.2, -8.3, -11.299999999999999, -3.2, -6.3999999999999995, -13.7, -12.8, -7.2, -6.300000000000001, -5.300000000000001, -10.099999999999998, -4.300000000000001, -10.799999999999999, -4.4, -7.3999999999999995, -22.699999999999996, -3.3, -17.799999999999997, -20.700000000000003, -11.199999999999998, -2.3000000000000003, -45.2, -10.2, -13.7, -4.4, -18.599999999999994, -12.0, -41.3, -24.099999999999966, -7.3, -22.900000000000002, -7.599999999999999, -12.999999999999998, -3.4, -4.2, -7.2, -12.799999999999999, -16.099999999999998, -17.3, -4.4, -5.2, -3.4, -12.799999999999999, -12.7, -8.6, -12.3, -15.5, -7.300000000000001, -8.9, -9.899999999999991, -12.599999999999998, -15.799999999999999, -12.499999999999998, -3.3, -9.399999999999997, -39.3, -8.600000000000001, -4.6000000000000005, -16.299999999999997, -7.199999999999999, -11.799999999999997, -3.4, -4.300000000000001, -15.2, -10.0, -9.099999999999998, -7.3, -4.4, -13.399999999999999, -9.399999999999999, -10.099999999999998, -5.2, -5.1, -17.099999999999994, -3.3, -6.999999999999999, -4.2, -21.799999999999997, -12.899999999999995, -4.2, -80.2, -9.299999999999999, -17.299999999999997, -2.2, -3.3, -12.099999999999971, -16.599999999999998, -11.8, -8.3, -9.3, -3.2, -7.399999999999999, -4.300000000000001, -16.3, -13.7, -13.299999999999999, -20.9, -19.699999999999996, -17.7, -4.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9589364340557026, "mean_inference_ms": 1.2118064666017232, "mean_action_processing_ms": 0.06757855854708693, "mean_env_wait_ms": 5.4691221561989325, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 184000, "timesteps_this_iter": 0, "agent_timesteps_total": 184000, "timers": {"sample_time_ms": 16329.743, "sample_throughput": 244.952, "load_time_ms": 0.359, "load_throughput": 11149874.394, "learn_time_ms": 7896.753, "learn_throughput": 506.537, "update_time_ms": 1.75}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.1903568111540329, "policy_loss": -0.010379395763620094, "vf_loss": 20.05225219201016, "vf_explained_var": 0.14921665223695899, "kl": 0.008547667900552334, "entropy": 0.20143940495226972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 184000, "num_agent_steps_sampled": 184000, "num_steps_trained": 184000, "num_agent_steps_trained": 184000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1856, "training_iteration": 46, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-20-15", "timestamp": 1643646015, "time_this_iter_s": 16.74203896522522, "time_total_s": 696.7240889072418, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 696.7240889072418, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 38.87083333333333, "ram_util_percent": 62.15416666666666}}
{"episode_reward_max": -2.2, "episode_reward_min": -80.2, "episode_reward_mean": -11.539000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -3.4, -12.799999999999999, -12.7, -8.6, -12.3, -15.5, -7.300000000000001, -8.9, -9.899999999999991, -12.599999999999998, -15.799999999999999, -12.499999999999998, -3.3, -9.399999999999997, -39.3, -8.600000000000001, -4.6000000000000005, -16.299999999999997, -7.199999999999999, -11.799999999999997, -3.4, -4.300000000000001, -15.2, -10.0, -9.099999999999998, -7.3, -4.4, -13.399999999999999, -9.399999999999999, -10.099999999999998, -5.2, -5.1, -17.099999999999994, -3.3, -6.999999999999999, -4.2, -21.799999999999997, -12.899999999999995, -4.2, -80.2, -9.299999999999999, -17.299999999999997, -2.2, -3.3, -12.099999999999971, -16.599999999999998, -11.8, -8.3, -9.3, -3.2, -7.399999999999999, -4.300000000000001, -16.3, -13.7, -13.299999999999999, -20.9, -19.699999999999996, -17.7, -4.4, -18.200000000000003, -3.3, -4.300000000000001, -16.499999999999996, -8.899999999999999, -11.2, -15.699999999999982, -17.400000000000002, -3.2, -7.2, -9.2, -12.5, -4.300000000000001, -4.300000000000001, -7.6, -13.999999999999996, -23.4, -18.2, -8.3, -16.19999999999999, -4.300000000000001, -22.1, -12.2, -4.4, -11.099999999999998, -15.099999999999994, -14.3, -12.999999999999996, -20.10000000000001, -11.1, -6.999999999999998, -14.899999999999999, -14.5, -11.7, -17.7, -14.899999999999999, -8.3, -5.300000000000001, -4.4, -6.9], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9584789049159405, "mean_inference_ms": 1.2120811672379874, "mean_action_processing_ms": 0.06759854110236958, "mean_env_wait_ms": 5.471448436838125, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 188000, "timesteps_this_iter": 0, "agent_timesteps_total": 188000, "timers": {"sample_time_ms": 16192.411, "sample_throughput": 247.029, "load_time_ms": 0.353, "load_throughput": 11326772.887, "learn_time_ms": 7878.663, "learn_throughput": 507.7, "update_time_ms": 1.698}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.10644991332164375, "policy_loss": -0.005322994580692662, "vf_loss": 11.156621913627912, "vf_explained_var": 0.2257083914613211, "kl": 0.008267667229722556, "entropy": 0.19120570986621802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 188000, "num_agent_steps_sampled": 188000, "num_steps_trained": 188000, "num_agent_steps_trained": 188000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1896, "training_iteration": 47, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-20-31", "timestamp": 1643646031, "time_this_iter_s": 15.615543842315674, "time_total_s": 712.3396327495575, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 712.3396327495575, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 32.88181818181818, "ram_util_percent": 62.21363636363637}}
{"episode_reward_max": -2.2, "episode_reward_min": -80.2, "episode_reward_mean": -12.344, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-80.2, -9.299999999999999, -17.299999999999997, -2.2, -3.3, -12.099999999999971, -16.599999999999998, -11.8, -8.3, -9.3, -3.2, -7.399999999999999, -4.300000000000001, -16.3, -13.7, -13.299999999999999, -20.9, -19.699999999999996, -17.7, -4.4, -18.200000000000003, -3.3, -4.300000000000001, -16.499999999999996, -8.899999999999999, -11.2, -15.699999999999982, -17.400000000000002, -3.2, -7.2, -9.2, -12.5, -4.300000000000001, -4.300000000000001, -7.6, -13.999999999999996, -23.4, -18.2, -8.3, -16.19999999999999, -4.300000000000001, -22.1, -12.2, -4.4, -11.099999999999998, -15.099999999999994, -14.3, -12.999999999999996, -20.10000000000001, -11.1, -6.999999999999998, -14.899999999999999, -14.5, -11.7, -17.7, -14.899999999999999, -8.3, -5.300000000000001, -4.4, -6.9, -11.5, -6.3, -11.5, -7.3, -9.2, -11.100000000000001, -3.3, -5.4, -15.899999999999997, -8.3, -43.2, -9.2, -16.9, -11.0, -8.3, -3.2, -23.800000000000004, -24.599999999999998, -4.300000000000001, -22.300000000000008, -14.2, -14.0, -6.6000000000000005, -17.2, -19.499999999999996, -9.600000000000001, -5.3, -16.599999999999998, -8.3, -17.799999999999997, -3.2, -15.999999999999996, -14.599999999999998, -14.999999999999998, -4.4, -17.3, -4.300000000000001, -4.300000000000001, -17.799999999999997, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9594766715148043, "mean_inference_ms": 1.2152435187913433, "mean_action_processing_ms": 0.06778256662945699, "mean_env_wait_ms": 5.486830565226576, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 192000, "timesteps_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"sample_time_ms": 16441.775, "sample_throughput": 243.283, "load_time_ms": 0.359, "load_throughput": 11140989.442, "learn_time_ms": 8012.725, "learn_throughput": 499.206, "update_time_ms": 1.682}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.12870394023215417, "policy_loss": -0.0087602908572843, "vf_loss": 13.72475102056739, "vf_explained_var": 0.1452824564390285, "kl": 0.008668922126063133, "entropy": 0.19878802772571322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 192000, "num_agent_steps_sampled": 192000, "num_steps_trained": 192000, "num_agent_steps_trained": 192000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1936, "training_iteration": 48, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-20-51", "timestamp": 1643646051, "time_this_iter_s": 20.05658507347107, "time_total_s": 732.3962178230286, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 732.3962178230286, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 38.38275862068966, "ram_util_percent": 62.33793103448277}}
{"episode_reward_max": -3.2, "episode_reward_min": -43.900000000000006, "episode_reward_mean": -11.837, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -22.1, -12.2, -4.4, -11.099999999999998, -15.099999999999994, -14.3, -12.999999999999996, -20.10000000000001, -11.1, -6.999999999999998, -14.899999999999999, -14.5, -11.7, -17.7, -14.899999999999999, -8.3, -5.300000000000001, -4.4, -6.9, -11.5, -6.3, -11.5, -7.3, -9.2, -11.100000000000001, -3.3, -5.4, -15.899999999999997, -8.3, -43.2, -9.2, -16.9, -11.0, -8.3, -3.2, -23.800000000000004, -24.599999999999998, -4.300000000000001, -22.300000000000008, -14.2, -14.0, -6.6000000000000005, -17.2, -19.499999999999996, -9.600000000000001, -5.3, -16.599999999999998, -8.3, -17.799999999999997, -3.2, -15.999999999999996, -14.599999999999998, -14.999999999999998, -4.4, -17.3, -4.300000000000001, -4.300000000000001, -17.799999999999997, -3.3, -43.900000000000006, -8.299999999999999, -3.3, -11.5, -3.5, -29.19999999999996, -17.699999999999996, -11.799999999999999, -16.3, -19.800000000000004, -6.2, -7.699999999999999, -4.4, -11.399999999999999, -11.399999999999999, -7.7, -29.700000000000028, -14.4, -3.4, -4.4, -15.799999999999997, -7.4, -3.3, -13.299999999999997, -11.299999999999999, -3.3, -4.4, -12.1, -4.4, -3.4, -7.299999999999999, -11.399999999999999, -4.300000000000001, -5.4, -18.699999999999996, -13.999999999999998, -15.7, -4.300000000000001, -18.700000000000003, -20.0], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9622049475875727, "mean_inference_ms": 1.2208026177029454, "mean_action_processing_ms": 0.06809719579812919, "mean_env_wait_ms": 5.51349489877485, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 196000, "timesteps_this_iter": 0, "agent_timesteps_total": 196000, "timers": {"sample_time_ms": 16778.223, "sample_throughput": 238.404, "load_time_ms": 0.361, "load_throughput": 11074069.967, "learn_time_ms": 8135.956, "learn_throughput": 491.645, "update_time_ms": 1.655}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.09298665909677424, "policy_loss": -0.01189912017234551, "vf_loss": 10.456342040979735, "vf_explained_var": 0.24194364682320627, "kl": 0.01289453630850875, "entropy": 0.19258864914938326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 196000, "num_agent_steps_sampled": 196000, "num_steps_trained": 196000, "num_agent_steps_trained": 196000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1976, "training_iteration": 49, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-21-10", "timestamp": 1643646070, "time_this_iter_s": 19.007489919662476, "time_total_s": 751.403707742691, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 751.403707742691, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 33.86666666666667, "ram_util_percent": 62.34814814814814}}
{"episode_reward_max": -3.2, "episode_reward_min": -43.900000000000006, "episode_reward_mean": -11.520999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.499999999999996, -9.600000000000001, -5.3, -16.599999999999998, -8.3, -17.799999999999997, -3.2, -15.999999999999996, -14.599999999999998, -14.999999999999998, -4.4, -17.3, -4.300000000000001, -4.300000000000001, -17.799999999999997, -3.3, -43.900000000000006, -8.299999999999999, -3.3, -11.5, -3.5, -29.19999999999996, -17.699999999999996, -11.799999999999999, -16.3, -19.800000000000004, -6.2, -7.699999999999999, -4.4, -11.399999999999999, -11.399999999999999, -7.7, -29.700000000000028, -14.4, -3.4, -4.4, -15.799999999999997, -7.4, -3.3, -13.299999999999997, -11.299999999999999, -3.3, -4.4, -12.1, -4.4, -3.4, -7.299999999999999, -11.399999999999999, -4.300000000000001, -5.4, -18.699999999999996, -13.999999999999998, -15.7, -4.300000000000001, -18.700000000000003, -20.0, -13.799999999999999, -19.5, -4.6, -4.4, -4.2, -4.4, -9.3, -17.0, -5.000000000000001, -9.200000000000001, -7.3, -6.300000000000001, -18.2, -9.399999999999999, -3.2, -8.399999999999999, -17.2, -12.299999999999999, -3.3, -21.2, -13.699999999999998, -25.000000000000007, -11.59999999999999, -8.099999999999998, -12.899999999999997, -10.999999999999988, -12.700000000000001, -8.6, -4.300000000000001, -9.099999999999998, -10.000000000000004, -11.7, -10.3, -11.499999999999998, -8.3, -10.5, -26.3, -19.5, -8.199999999999998, -19.3, -21.199999999999996, -19.400000000000002, -14.799999999999997, -4.1000000000000005], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9679249960293569, "mean_inference_ms": 1.2286515573612595, "mean_action_processing_ms": 0.06858407882665483, "mean_env_wait_ms": 5.55226920470099, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 200000, "timesteps_this_iter": 0, "agent_timesteps_total": 200000, "timers": {"sample_time_ms": 17230.526, "sample_throughput": 232.146, "load_time_ms": 0.364, "load_throughput": 10997847.263, "learn_time_ms": 8376.979, "learn_throughput": 477.499, "update_time_ms": 1.718}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.09860465423584545, "policy_loss": -0.0070256050410730546, "vf_loss": 10.544063195361886, "vf_explained_var": 0.2213260002674595, "kl": 0.0075852000687273245, "entropy": 0.23000844616883545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 200000, "num_agent_steps_sampled": 200000, "num_steps_trained": 200000, "num_agent_steps_trained": 200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2020, "training_iteration": 50, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-21-31", "timestamp": 1643646091, "time_this_iter_s": 20.58609676361084, "time_total_s": 771.9898045063019, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 771.9898045063019, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 32.93103448275862, "ram_util_percent": 62.42413793103449}}
{"episode_reward_max": -3.2, "episode_reward_min": -75.3, "episode_reward_mean": -11.681, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.299999999999999, -3.3, -4.4, -12.1, -4.4, -3.4, -7.299999999999999, -11.399999999999999, -4.300000000000001, -5.4, -18.699999999999996, -13.999999999999998, -15.7, -4.300000000000001, -18.700000000000003, -20.0, -13.799999999999999, -19.5, -4.6, -4.4, -4.2, -4.4, -9.3, -17.0, -5.000000000000001, -9.200000000000001, -7.3, -6.300000000000001, -18.2, -9.399999999999999, -3.2, -8.399999999999999, -17.2, -12.299999999999999, -3.3, -21.2, -13.699999999999998, -25.000000000000007, -11.59999999999999, -8.099999999999998, -12.899999999999997, -10.999999999999988, -12.700000000000001, -8.6, -4.300000000000001, -9.099999999999998, -10.000000000000004, -11.7, -10.3, -11.499999999999998, -8.3, -10.5, -26.3, -19.5, -8.199999999999998, -19.3, -21.199999999999996, -19.400000000000002, -14.799999999999997, -4.1000000000000005, -4.4, -9.299999999999999, -75.3, -15.899999999999999, -15.399999999999999, -3.3, -15.2, -3.4, -8.2, -9.599999999999998, -8.199999999999998, -14.5, -16.5, -7.3, -15.199999999999998, -3.4, -49.900000000000006, -8.399999999999999, -9.1, -3.3, -10.599999999999998, -3.3, -8.399999999999999, -15.299999999999999, -10.3, -11.7, -11.799999999999997, -10.100000000000001, -16.599999999999994, -5.9, -8.2, -4.6, -4.2, -20.3, -17.2, -15.799999999999999, -7.2, -8.2, -9.3, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9731243999382755, "mean_inference_ms": 1.235035372004336, "mean_action_processing_ms": 0.06894179353209486, "mean_env_wait_ms": 5.582420716233307, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 204000, "timesteps_this_iter": 0, "agent_timesteps_total": 204000, "timers": {"sample_time_ms": 17677.337, "sample_throughput": 226.278, "load_time_ms": 0.373, "load_throughput": 10717526.511, "learn_time_ms": 8584.776, "learn_throughput": 465.941, "update_time_ms": 1.732}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.3702713510574853, "policy_loss": -0.010686884145502762, "vf_loss": 38.01277366838148, "vf_explained_var": 0.21320551864562495, "kl": 0.03322053345927374, "entropy": 0.22633881407078876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 204000, "num_agent_steps_sampled": 204000, "num_steps_trained": 204000, "num_agent_steps_trained": 204000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2060, "training_iteration": 51, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-21-51", "timestamp": 1643646111, "time_this_iter_s": 19.72534489631653, "time_total_s": 791.7151494026184, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 791.7151494026184, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 30.842857142857145, "ram_util_percent": 62.43214285714286}}
{"episode_reward_max": -3.3, "episode_reward_min": -75.3, "episode_reward_mean": -13.490000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.899999999999997, -10.999999999999988, -12.700000000000001, -8.6, -4.300000000000001, -9.099999999999998, -10.000000000000004, -11.7, -10.3, -11.499999999999998, -8.3, -10.5, -26.3, -19.5, -8.199999999999998, -19.3, -21.199999999999996, -19.400000000000002, -14.799999999999997, -4.1000000000000005, -4.4, -9.299999999999999, -75.3, -15.899999999999999, -15.399999999999999, -3.3, -15.2, -3.4, -8.2, -9.599999999999998, -8.199999999999998, -14.5, -16.5, -7.3, -15.199999999999998, -3.4, -49.900000000000006, -8.399999999999999, -9.1, -3.3, -10.599999999999998, -3.3, -8.399999999999999, -15.299999999999999, -10.3, -11.7, -11.799999999999997, -10.100000000000001, -16.599999999999994, -5.9, -8.2, -4.6, -4.2, -20.3, -17.2, -15.799999999999999, -7.2, -8.2, -9.3, -4.300000000000001, -10.3, -19.1, -18.799999999999997, -11.4, -15.4, -8.2, -15.899999999999997, -12.4, -16.299999999999997, -10.9, -17.299999999999997, -17.799999999999997, -12.3, -43.5, -9.4, -5.5, -18.6, -10.899999999999999, -8.3, -5.5, -9.399999999999999, -43.2, -17.3, -13.2, -20.900000000000034, -15.3, -8.099999999999998, -9.3, -34.3, -6.499999999999999, -19.8, -11.4, -22.500000000000004, -15.4, -11.3, -8.3, -9.2, -12.3, -9.4, -11.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.978433351964673, "mean_inference_ms": 1.2419546423450967, "mean_action_processing_ms": 0.06929431977208489, "mean_env_wait_ms": 5.613818506983121, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 208000, "timesteps_this_iter": 0, "agent_timesteps_total": 208000, "timers": {"sample_time_ms": 18188.62, "sample_throughput": 219.918, "load_time_ms": 0.395, "load_throughput": 10136678.146, "learn_time_ms": 8943.604, "learn_throughput": 447.247, "update_time_ms": 1.828}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0375, "cur_lr": 0.00010000000000000003, "total_loss": 0.16692720428910307, "policy_loss": -0.005764718221685779, "vf_loss": 17.209883365067103, "vf_explained_var": 0.2632887196797197, "kl": 0.015815809184793344, "entropy": 0.19871378917527455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 208000, "num_agent_steps_sampled": 208000, "num_steps_trained": 208000, "num_agent_steps_trained": 208000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2100, "training_iteration": 52, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-22-13", "timestamp": 1643646133, "time_this_iter_s": 22.32930088043213, "time_total_s": 814.0444502830505, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 814.0444502830505, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 46.334375, "ram_util_percent": 62.590625}}
{"episode_reward_max": -3.3, "episode_reward_min": -43.5, "episode_reward_mean": -13.621000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.599999999999998, -3.3, -8.399999999999999, -15.299999999999999, -10.3, -11.7, -11.799999999999997, -10.100000000000001, -16.599999999999994, -5.9, -8.2, -4.6, -4.2, -20.3, -17.2, -15.799999999999999, -7.2, -8.2, -9.3, -4.300000000000001, -10.3, -19.1, -18.799999999999997, -11.4, -15.4, -8.2, -15.899999999999997, -12.4, -16.299999999999997, -10.9, -17.299999999999997, -17.799999999999997, -12.3, -43.5, -9.4, -5.5, -18.6, -10.899999999999999, -8.3, -5.5, -9.399999999999999, -43.2, -17.3, -13.2, -20.900000000000034, -15.3, -8.099999999999998, -9.3, -34.3, -6.499999999999999, -19.8, -11.4, -22.500000000000004, -15.4, -11.3, -8.3, -9.2, -12.3, -9.4, -11.3, -12.3, -13.0, -16.499999999999993, -15.3, -32.4, -6.3, -13.7, -14.4, -9.3, -11.3, -17.0, -14.7, -22.100000000000005, -13.4, -11.3, -12.499999999999998, -13.6, -4.4, -11.3, -10.4, -17.8, -10.700000000000001, -8.099999999999998, -13.799999999999999, -8.3, -15.3, -15.2, -18.9, -16.299999999999997, -8.9, -23.4, -22.900000000000034, -5.4, -19.2, -10.699999999999998, -15.2, -22.7, -12.3, -9.099999999999998, -13.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.985586136339909, "mean_inference_ms": 1.2513365823436415, "mean_action_processing_ms": 0.06983078732236805, "mean_env_wait_ms": 5.656808086824353, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 212000, "timesteps_this_iter": 0, "agent_timesteps_total": 212000, "timers": {"sample_time_ms": 18768.317, "sample_throughput": 213.125, "load_time_ms": 0.425, "load_throughput": 9404796.233, "learn_time_ms": 9203.65, "learn_throughput": 434.61, "update_time_ms": 1.912}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0375, "cur_lr": 0.00010000000000000003, "total_loss": 0.09065414662923543, "policy_loss": -0.010355790452130378, "vf_loss": 10.050538284804231, "vf_explained_var": 0.3066372893189871, "kl": 0.013454835946077137, "entropy": 0.2165695718379431, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 212000, "num_agent_steps_sampled": 212000, "num_steps_trained": 212000, "num_agent_steps_trained": 212000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2140, "training_iteration": 53, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-22-36", "timestamp": 1643646156, "time_this_iter_s": 23.128270149230957, "time_total_s": 837.1727204322815, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 837.1727204322815, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 51.56060606060606, "ram_util_percent": 62.684848484848494}}
{"episode_reward_max": -3.2, "episode_reward_min": -43.2, "episode_reward_mean": -13.364, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.399999999999999, -43.2, -17.3, -13.2, -20.900000000000034, -15.3, -8.099999999999998, -9.3, -34.3, -6.499999999999999, -19.8, -11.4, -22.500000000000004, -15.4, -11.3, -8.3, -9.2, -12.3, -9.4, -11.3, -12.3, -13.0, -16.499999999999993, -15.3, -32.4, -6.3, -13.7, -14.4, -9.3, -11.3, -17.0, -14.7, -22.100000000000005, -13.4, -11.3, -12.499999999999998, -13.6, -4.4, -11.3, -10.4, -17.8, -10.700000000000001, -8.099999999999998, -13.799999999999999, -8.3, -15.3, -15.2, -18.9, -16.299999999999997, -8.9, -23.4, -22.900000000000034, -5.4, -19.2, -10.699999999999998, -15.2, -22.7, -12.3, -9.099999999999998, -13.2, -26.9, -12.1, -3.2, -6.6000000000000005, -13.099999999999998, -26.900000000000016, -7.3, -13.09999999999998, -10.299999999999999, -10.999999999999998, -8.4, -8.5, -12.3, -11.8, -7.3, -5.4, -10.1, -10.699999999999998, -17.3, -13.699999999999978, -9.4, -19.6, -9.4, -5.4, -12.899999999999999, -4.3, -7.399999999999998, -6.4, -23.4, -11.099999999999998, -14.299999999999995, -7.2, -5.4, -14.9, -16.799999999999976, -15.3, -10.3, -6.300000000000001, -20.20000000000001, -9.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.99258441138856, "mean_inference_ms": 1.260630504042019, "mean_action_processing_ms": 0.07036707447718973, "mean_env_wait_ms": 5.700442024920266, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 216000, "timesteps_this_iter": 0, "agent_timesteps_total": 216000, "timers": {"sample_time_ms": 19261.807, "sample_throughput": 207.665, "load_time_ms": 0.431, "load_throughput": 9287138.666, "learn_time_ms": 9539.339, "learn_throughput": 419.316, "update_time_ms": 1.967}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0375, "cur_lr": 0.00010000000000000003, "total_loss": 0.058384143544100625, "policy_loss": -0.011977779823205163, "vf_loss": 6.987179374694824, "vf_explained_var": 0.3878105346874524, "kl": 0.013070150306098082, "entropy": 0.19461470261536618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 216000, "num_agent_steps_sampled": 216000, "num_steps_trained": 216000, "num_agent_steps_trained": 216000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2180, "training_iteration": 54, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-22-58", "timestamp": 1643646178, "time_this_iter_s": 22.31771492958069, "time_total_s": 859.4904353618622, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 859.4904353618622, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 48.590625, "ram_util_percent": 62.425}}
{"episode_reward_max": -3.2, "episode_reward_min": -95.90000000000008, "episode_reward_mean": -14.057000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.8, -10.700000000000001, -8.099999999999998, -13.799999999999999, -8.3, -15.3, -15.2, -18.9, -16.299999999999997, -8.9, -23.4, -22.900000000000034, -5.4, -19.2, -10.699999999999998, -15.2, -22.7, -12.3, -9.099999999999998, -13.2, -26.9, -12.1, -3.2, -6.6000000000000005, -13.099999999999998, -26.900000000000016, -7.3, -13.09999999999998, -10.299999999999999, -10.999999999999998, -8.4, -8.5, -12.3, -11.8, -7.3, -5.4, -10.1, -10.699999999999998, -17.3, -13.699999999999978, -9.4, -19.6, -9.4, -5.4, -12.899999999999999, -4.3, -7.399999999999998, -6.4, -23.4, -11.099999999999998, -14.299999999999995, -7.2, -5.4, -14.9, -16.799999999999976, -15.3, -10.3, -6.300000000000001, -20.20000000000001, -9.4, -8.4, -7.699999999999998, -19.20000000000004, -95.90000000000008, -28.100000000000037, -70.4, -18.4, -12.499999999999988, -4.4, -8.099999999999998, -22.6, -16.999999999999993, -4.3, -20.39999999999999, -7.499999999999999, -7.4, -10.600000000000001, -8.6, -11.799999999999999, -22.9, -11.899999999999995, -5.5, -16.199999999999978, -15.799999999999997, -14.3, -17.2, -10.899999999999993, -7.399999999999999, -9.3, -18.299999999999997, -8.3, -14.8, -5.4, -8.3, -18.7, -9.999999999999998, -9.2, -19.4, -8.999999999999998, -16.799999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9976764935646689, "mean_inference_ms": 1.2670380971534727, "mean_action_processing_ms": 0.07072201893408324, "mean_env_wait_ms": 5.730038819100529, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 220000, "timesteps_this_iter": 0, "agent_timesteps_total": 220000, "timers": {"sample_time_ms": 19789.678, "sample_throughput": 202.126, "load_time_ms": 0.434, "load_throughput": 9214706.432, "learn_time_ms": 9596.012, "learn_throughput": 416.84, "update_time_ms": 1.973}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0375, "cur_lr": 0.00010000000000000003, "total_loss": 0.6510480111419794, "policy_loss": -0.016073906217371262, "vf_loss": 66.60547844338161, "vf_explained_var": 0.1417201388266779, "kl": 0.028457073505636844, "entropy": 0.21844575736791857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 220000, "num_agent_steps_sampled": 220000, "num_steps_trained": 220000, "num_agent_steps_trained": 220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2220, "training_iteration": 55, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-23-17", "timestamp": 1643646197, "time_this_iter_s": 18.553919076919556, "time_total_s": 878.0443544387817, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 878.0443544387817, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 41.32692307692308, "ram_util_percent": 61.47307692307693}}
{"episode_reward_max": -4.3, "episode_reward_min": -95.90000000000008, "episode_reward_mean": -13.472000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.4, -19.6, -9.4, -5.4, -12.899999999999999, -4.3, -7.399999999999998, -6.4, -23.4, -11.099999999999998, -14.299999999999995, -7.2, -5.4, -14.9, -16.799999999999976, -15.3, -10.3, -6.300000000000001, -20.20000000000001, -9.4, -8.4, -7.699999999999998, -19.20000000000004, -95.90000000000008, -28.100000000000037, -70.4, -18.4, -12.499999999999988, -4.4, -8.099999999999998, -22.6, -16.999999999999993, -4.3, -20.39999999999999, -7.499999999999999, -7.4, -10.600000000000001, -8.6, -11.799999999999999, -22.9, -11.899999999999995, -5.5, -16.199999999999978, -15.799999999999997, -14.3, -17.2, -10.899999999999993, -7.399999999999999, -9.3, -18.299999999999997, -8.3, -14.8, -5.4, -8.3, -18.7, -9.999999999999998, -9.2, -19.4, -8.999999999999998, -16.799999999999997, -7.2, -12.1, -10.2, -17.9, -7.8999999999999995, -8.999999999999988, -13.799999999999997, -12.899999999999999, -7.4, -7.5, -10.5, -8.6, -5.3, -11.899999999999997, -28.299999999999965, -4.4, -9.799999999999999, -11.2, -13.3, -6.799999999999999, -7.4, -20.4, -7.3, -17.10000000000001, -6.3, -10.899999999999999, -20.00000000000003, -11.299999999999997, -8.4, -10.1, -20.7, -10.4, -9.1, -18.100000000000005, -10.2, -12.4, -19.30000000000004, -4.800000000000001, -16.4, -8.299999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0005010750827934, "mean_inference_ms": 1.2713562451412843, "mean_action_processing_ms": 0.07096591404224789, "mean_env_wait_ms": 5.749894234795343, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 224000, "timesteps_this_iter": 0, "agent_timesteps_total": 224000, "timers": {"sample_time_ms": 19934.983, "sample_throughput": 200.652, "load_time_ms": 0.438, "load_throughput": 9132942.842, "learn_time_ms": 9920.041, "learn_throughput": 403.224, "update_time_ms": 1.984}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.08365546816844814, "policy_loss": -0.009536129382428944, "vf_loss": 9.258384345936518, "vf_explained_var": 0.3118901054705343, "kl": 0.010804564300722169, "entropy": 0.22294480194167424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 224000, "num_agent_steps_sampled": 224000, "num_steps_trained": 224000, "num_agent_steps_trained": 224000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2260, "training_iteration": 56, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-23-38", "timestamp": 1643646218, "time_this_iter_s": 20.87545108795166, "time_total_s": 898.9198055267334, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 898.9198055267334, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 46.84, "ram_util_percent": 61.36666666666666}}
{"episode_reward_max": -4.3, "episode_reward_min": -84.4, "episode_reward_mean": -12.968, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.899999999999995, -5.5, -16.199999999999978, -15.799999999999997, -14.3, -17.2, -10.899999999999993, -7.399999999999999, -9.3, -18.299999999999997, -8.3, -14.8, -5.4, -8.3, -18.7, -9.999999999999998, -9.2, -19.4, -8.999999999999998, -16.799999999999997, -7.2, -12.1, -10.2, -17.9, -7.8999999999999995, -8.999999999999988, -13.799999999999997, -12.899999999999999, -7.4, -7.5, -10.5, -8.6, -5.3, -11.899999999999997, -28.299999999999965, -4.4, -9.799999999999999, -11.2, -13.3, -6.799999999999999, -7.4, -20.4, -7.3, -17.10000000000001, -6.3, -10.899999999999999, -20.00000000000003, -11.299999999999997, -8.4, -10.1, -20.7, -10.4, -9.1, -18.100000000000005, -10.2, -12.4, -19.30000000000004, -4.800000000000001, -16.4, -8.299999999999999, -21.0, -7.4, -15.499999999999998, -8.2, -17.299999999999997, -4.4, -9.7, -15.29999999999999, -7.8, -12.899999999999999, -8.899999999999999, -11.399999999999999, -9.5, -6.4, -16.799999999999997, -16.199999999999996, -7.4, -18.099999999999994, -19.1, -6.4, -20.100000000000044, -10.599999999999998, -16.299999999999997, -22.2, -16.399999999999995, -17.8, -16.8, -4.3, -8.4, -10.3, -6.0, -24.799999999999997, -17.4, -11.2, -18.999999999999993, -6.3, -12.0, -14.9, -6.3, -84.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0032803174437122, "mean_inference_ms": 1.275740359300068, "mean_action_processing_ms": 0.07121528987675388, "mean_env_wait_ms": 5.769846365872028, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 228000, "timesteps_this_iter": 0, "agent_timesteps_total": 228000, "timers": {"sample_time_ms": 20528.213, "sample_throughput": 194.854, "load_time_ms": 0.445, "load_throughput": 8998238.67, "learn_time_ms": 10179.676, "learn_throughput": 392.94, "update_time_ms": 2.047}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.4025506723471867, "policy_loss": -0.007726036993065669, "vf_loss": 40.98582099624859, "vf_explained_var": 0.2862551923080157, "kl": 0.007440129886962343, "entropy": 0.19306025888810877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 228000, "num_agent_steps_sampled": 228000, "num_steps_trained": 228000, "num_agent_steps_trained": 228000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2300, "training_iteration": 57, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-23-59", "timestamp": 1643646239, "time_this_iter_s": 20.898942947387695, "time_total_s": 919.8187484741211, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 919.8187484741211, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 39.903333333333336, "ram_util_percent": 61.543333333333315}}
{"episode_reward_max": -3.2, "episode_reward_min": -84.4, "episode_reward_mean": -12.878, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.4, -20.4, -7.3, -17.10000000000001, -6.3, -10.899999999999999, -20.00000000000003, -11.299999999999997, -8.4, -10.1, -20.7, -10.4, -9.1, -18.100000000000005, -10.2, -12.4, -19.30000000000004, -4.800000000000001, -16.4, -8.299999999999999, -21.0, -7.4, -15.499999999999998, -8.2, -17.299999999999997, -4.4, -9.7, -15.29999999999999, -7.8, -12.899999999999999, -8.899999999999999, -11.399999999999999, -9.5, -6.4, -16.799999999999997, -16.199999999999996, -7.4, -18.099999999999994, -19.1, -6.4, -20.100000000000044, -10.599999999999998, -16.299999999999997, -22.2, -16.399999999999995, -17.8, -16.8, -4.3, -8.4, -10.3, -6.0, -24.799999999999997, -17.4, -11.2, -18.999999999999993, -6.3, -12.0, -14.9, -6.3, -84.4, -16.899999999999995, -14.3, -5.8999999999999995, -9.3, -7.4, -14.499999999999998, -10.4, -12.099999999999996, -14.3, -9.3, -24.3, -8.3, -7.3, -13.799999999999999, -23.7, -15.7, -3.2, -7.3, -4.3, -5.4, -5.800000000000001, -3.4, -10.7, -8.8, -13.3, -10.3, -14.499999999999995, -5.3, -14.8, -5.3, -16.5, -18.00000000000001, -20.800000000000004, -7.2, -10.4, -10.2, -15.2, -3.4, -13.3, -18.80000000000003], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0072482330287453, "mean_inference_ms": 1.2812806291747316, "mean_action_processing_ms": 0.07152812862824551, "mean_env_wait_ms": 5.794891161249756, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 232000, "timesteps_this_iter": 0, "agent_timesteps_total": 232000, "timers": {"sample_time_ms": 20831.127, "sample_throughput": 192.02, "load_time_ms": 0.447, "load_throughput": 8944032.413, "learn_time_ms": 10330.804, "learn_throughput": 387.192, "update_time_ms": 2.132}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.0842473615867196, "policy_loss": -0.015578949467469287, "vf_loss": 9.929242131786962, "vf_explained_var": 0.287357852151317, "kl": 0.009491429252862414, "entropy": 0.20394213609797981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 232000, "num_agent_steps_sampled": 232000, "num_steps_trained": 232000, "num_agent_steps_trained": 232000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2340, "training_iteration": 58, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-24-21", "timestamp": 1643646261, "time_this_iter_s": 21.996718168258667, "time_total_s": 941.8154666423798, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 941.8154666423798, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 41.10645161290322, "ram_util_percent": 61.629032258064534}}
{"episode_reward_max": -3.2, "episode_reward_min": -84.4, "episode_reward_mean": -13.566000000000004, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.100000000000044, -10.599999999999998, -16.299999999999997, -22.2, -16.399999999999995, -17.8, -16.8, -4.3, -8.4, -10.3, -6.0, -24.799999999999997, -17.4, -11.2, -18.999999999999993, -6.3, -12.0, -14.9, -6.3, -84.4, -16.899999999999995, -14.3, -5.8999999999999995, -9.3, -7.4, -14.499999999999998, -10.4, -12.099999999999996, -14.3, -9.3, -24.3, -8.3, -7.3, -13.799999999999999, -23.7, -15.7, -3.2, -7.3, -4.3, -5.4, -5.800000000000001, -3.4, -10.7, -8.8, -13.3, -10.3, -14.499999999999995, -5.3, -14.8, -5.3, -16.5, -18.00000000000001, -20.800000000000004, -7.2, -10.4, -10.2, -15.2, -3.4, -13.3, -18.80000000000003, -17.3, -4.300000000000001, -5.300000000000001, -21.800000000000004, -22.999999999999993, -6.899999999999997, -4.3, -18.500000000000004, -4.4, -12.999999999999998, -27.800000000000047, -3.3, -11.399999999999997, -9.699999999999998, -25.599999999999998, -18.400000000000006, -19.700000000000003, -6.300000000000001, -19.5, -4.4, -22.000000000000018, -10.899999999999999, -7.3, -6.299999999999999, -18.400000000000027, -16.29999999999998, -5.4, -67.3, -4.3, -15.299999999999983, -17.999999999999968, -5.4, -10.6, -17.4, -17.1, -9.299999999999986, -3.4, -10.4, -5.4, -22.00000000000002], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0117705203000755, "mean_inference_ms": 1.2873686332046035, "mean_action_processing_ms": 0.07187148250757323, "mean_env_wait_ms": 5.823524970230437, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 236000, "timesteps_this_iter": 0, "agent_timesteps_total": 236000, "timers": {"sample_time_ms": 21047.2, "sample_throughput": 190.049, "load_time_ms": 0.454, "load_throughput": 8801855.097, "learn_time_ms": 10533.768, "learn_throughput": 379.731, "update_time_ms": 2.182}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.28991784971527834, "policy_loss": -0.009280577879549275, "vf_loss": 29.86768763039702, "vf_explained_var": 0.03631803265181921, "kl": 0.009272218247184544, "entropy": 0.2067041150504543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 236000, "num_agent_steps_sampled": 236000, "num_steps_trained": 236000, "num_agent_steps_trained": 236000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2380, "training_iteration": 59, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-24-43", "timestamp": 1643646283, "time_this_iter_s": 21.66244626045227, "time_total_s": 963.477912902832, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 963.477912902832, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 39.99677419354839, "ram_util_percent": 61.70000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -67.3, "episode_reward_mean": -12.619000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.3, -10.3, -14.499999999999995, -5.3, -14.8, -5.3, -16.5, -18.00000000000001, -20.800000000000004, -7.2, -10.4, -10.2, -15.2, -3.4, -13.3, -18.80000000000003, -17.3, -4.300000000000001, -5.300000000000001, -21.800000000000004, -22.999999999999993, -6.899999999999997, -4.3, -18.500000000000004, -4.4, -12.999999999999998, -27.800000000000047, -3.3, -11.399999999999997, -9.699999999999998, -25.599999999999998, -18.400000000000006, -19.700000000000003, -6.300000000000001, -19.5, -4.4, -22.000000000000018, -10.899999999999999, -7.3, -6.299999999999999, -18.400000000000027, -16.29999999999998, -5.4, -67.3, -4.3, -15.299999999999983, -17.999999999999968, -5.4, -10.6, -17.4, -17.1, -9.299999999999986, -3.4, -10.4, -5.4, -22.00000000000002, -10.799999999999997, -10.0, -11.2, -10.299999999999997, -18.799999999999997, -7.499999999999998, -19.799999999999997, -17.9, -14.199999999999998, -3.4, -5.4, -3.2, -5.799999999999999, -15.099999999999998, -21.10000000000001, -7.3, -17.300000000000004, -18.099999999999994, -12.599999999999994, -20.3, -25.0, -10.1, -15.399999999999999, -10.899999999999977, -7.300000000000001, -9.6, -6.3, -22.400000000000006, -10.899999999999999, -13.799999999999999, -5.4, -7.300000000000001, -3.3, -9.3, -5.2, -6.4, -5.3, -10.5, -9.7, -3.3, -24.299999999999997, -17.200000000000003, -10.399999999999999, -7.799999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0170781603110273, "mean_inference_ms": 1.2930339292049648, "mean_action_processing_ms": 0.07226964754731008, "mean_env_wait_ms": 5.850982906384766, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"sample_time_ms": 21191.425, "sample_throughput": 188.756, "load_time_ms": 0.467, "load_throughput": 8564173.558, "learn_time_ms": 10524.648, "learn_throughput": 380.06, "update_time_ms": 2.286}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.10652610602718528, "policy_loss": -0.0008515517517764081, "vf_loss": 10.691169202712274, "vf_explained_var": 0.13328833310834823, "kl": 0.008283898808345952, "entropy": 0.2356981662973281, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 240000, "num_steps_trained": 240000, "num_agent_steps_trained": 240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2424, "training_iteration": 60, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-25-03", "timestamp": 1643646303, "time_this_iter_s": 19.9075129032135, "time_total_s": 983.3854258060455, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 983.3854258060455, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 39.482758620689665, "ram_util_percent": 61.70000000000002}}
{"episode_reward_max": -1.3, "episode_reward_min": -68.3, "episode_reward_mean": -13.038999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.400000000000027, -16.29999999999998, -5.4, -67.3, -4.3, -15.299999999999983, -17.999999999999968, -5.4, -10.6, -17.4, -17.1, -9.299999999999986, -3.4, -10.4, -5.4, -22.00000000000002, -10.799999999999997, -10.0, -11.2, -10.299999999999997, -18.799999999999997, -7.499999999999998, -19.799999999999997, -17.9, -14.199999999999998, -3.4, -5.4, -3.2, -5.799999999999999, -15.099999999999998, -21.10000000000001, -7.3, -17.300000000000004, -18.099999999999994, -12.599999999999994, -20.3, -25.0, -10.1, -15.399999999999999, -10.899999999999977, -7.300000000000001, -9.6, -6.3, -22.400000000000006, -10.899999999999999, -13.799999999999999, -5.4, -7.300000000000001, -3.3, -9.3, -5.2, -6.4, -5.3, -10.5, -9.7, -3.3, -24.299999999999997, -17.200000000000003, -10.399999999999999, -7.799999999999999, -13.699999999999998, -22.500000000000007, -11.2, -21.4, -1.3, -68.3, -5.300000000000001, -4.2, -17.2, -7.5, -7.3, -6.2, -17.099999999999998, -11.8, -4.3, -8.3, -28.400000000000006, -3.3, -3.3, -7.4, -34.9, -6.4, -28.1, -9.600000000000005, -24.200000000000003, -8.999999999999996, -1.3, -5.4, -5.9, -11.799999999999999, -13.499999999999998, -9.299999999999999, -17.9, -20.200000000000003, -16.9, -12.899999999999997, -21.800000000000004, -9.999999999999998, -10.100000000000001, -11.5], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0206747222893395, "mean_inference_ms": 1.2968332666353328, "mean_action_processing_ms": 0.07250624391646264, "mean_env_wait_ms": 5.86842381592662, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 244000, "timesteps_this_iter": 0, "agent_timesteps_total": 244000, "timers": {"sample_time_ms": 21176.941, "sample_throughput": 188.885, "load_time_ms": 0.467, "load_throughput": 8569860.551, "learn_time_ms": 10596.447, "learn_throughput": 377.485, "update_time_ms": 2.37}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.40584208918685316, "policy_loss": -0.0008038159259544905, "vf_loss": 40.618593018990694, "vf_explained_var": 0.264310480958672, "kl": 0.008177510878249496, "entropy": 0.21990897768447476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 244000, "num_agent_steps_sampled": 244000, "num_steps_trained": 244000, "num_agent_steps_trained": 244000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2464, "training_iteration": 61, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-25-23", "timestamp": 1643646323, "time_this_iter_s": 20.34326410293579, "time_total_s": 1003.7286899089813, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1003.7286899089813, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 40.44482758620689, "ram_util_percent": 61.72068965517242}}
{"episode_reward_max": -1.2, "episode_reward_min": -68.3, "episode_reward_mean": -11.65, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.300000000000001, -9.6, -6.3, -22.400000000000006, -10.899999999999999, -13.799999999999999, -5.4, -7.300000000000001, -3.3, -9.3, -5.2, -6.4, -5.3, -10.5, -9.7, -3.3, -24.299999999999997, -17.200000000000003, -10.399999999999999, -7.799999999999999, -13.699999999999998, -22.500000000000007, -11.2, -21.4, -1.3, -68.3, -5.300000000000001, -4.2, -17.2, -7.5, -7.3, -6.2, -17.099999999999998, -11.8, -4.3, -8.3, -28.400000000000006, -3.3, -3.3, -7.4, -34.9, -6.4, -28.1, -9.600000000000005, -24.200000000000003, -8.999999999999996, -1.3, -5.4, -5.9, -11.799999999999999, -13.499999999999998, -9.299999999999999, -17.9, -20.200000000000003, -16.9, -12.899999999999997, -21.800000000000004, -9.999999999999998, -10.100000000000001, -11.5, -6.4, -12.5, -8.4, -19.6, -7.3, -3.2, -13.799999999999999, -13.199999999999998, -13.2, -18.700000000000003, -16.7, -3.2, -6.4, -8.3, -6.300000000000001, -23.400000000000006, -10.399999999999999, -12.5, -8.099999999999998, -6.0, -5.3, -6.5, -5.3, -9.3, -9.3, -3.3, -11.5, -11.799999999999999, -11.500000000000002, -1.2, -5.2, -5.4, -38.3, -9.2, -8.2, -15.999999999999998, -3.3, -10.3, -9.8, -20.300000000000004], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0247509410361735, "mean_inference_ms": 1.30225640111271, "mean_action_processing_ms": 0.07278424655837065, "mean_env_wait_ms": 5.894640232392017, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 248000, "timesteps_this_iter": 0, "agent_timesteps_total": 248000, "timers": {"sample_time_ms": 21377.457, "sample_throughput": 187.113, "load_time_ms": 0.454, "load_throughput": 8811100.257, "learn_time_ms": 10544.668, "learn_throughput": 379.339, "update_time_ms": 2.304}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.09739660574473762, "policy_loss": -0.013248251336476495, "vf_loss": 10.97607549919236, "vf_explained_var": 0.331714980512537, "kl": 0.015717383384906213, "entropy": 0.20105798465189753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 248000, "num_agent_steps_sampled": 248000, "num_steps_trained": 248000, "num_agent_steps_trained": 248000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2504, "training_iteration": 62, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-25-46", "timestamp": 1643646346, "time_this_iter_s": 23.083242893218994, "time_total_s": 1026.8119328022003, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1026.8119328022003, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 49.557575757575755, "ram_util_percent": 62.07878787878788}}
{"episode_reward_max": -1.2, "episode_reward_min": -38.3, "episode_reward_mean": -11.673, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.9, -6.4, -28.1, -9.600000000000005, -24.200000000000003, -8.999999999999996, -1.3, -5.4, -5.9, -11.799999999999999, -13.499999999999998, -9.299999999999999, -17.9, -20.200000000000003, -16.9, -12.899999999999997, -21.800000000000004, -9.999999999999998, -10.100000000000001, -11.5, -6.4, -12.5, -8.4, -19.6, -7.3, -3.2, -13.799999999999999, -13.199999999999998, -13.2, -18.700000000000003, -16.7, -3.2, -6.4, -8.3, -6.300000000000001, -23.400000000000006, -10.399999999999999, -12.5, -8.099999999999998, -6.0, -5.3, -6.5, -5.3, -9.3, -9.3, -3.3, -11.5, -11.799999999999999, -11.500000000000002, -1.2, -5.2, -5.4, -38.3, -9.2, -8.2, -15.999999999999998, -3.3, -10.3, -9.8, -20.300000000000004, -10.9, -3.3, -8.999999999999998, -8.299999999999999, -8.399999999999999, -10.2, -8.3, -4.4, -3.3, -24.700000000000028, -16.1, -6.3, -9.3, -8.3, -4.3, -10.8, -17.2, -3.3, -26.6, -28.3, -7.2, -4.300000000000001, -2.3, -3.2, -25.9, -19.0, -15.799999999999999, -4.3, -4.2, -23.000000000000007, -4.4, -20.600000000000033, -12.699999999999996, -12.600000000000001, -3.2, -16.1, -15.899999999999999, -9.3, -29.599999999999998, -13.099999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0308136220450528, "mean_inference_ms": 1.3109242036449336, "mean_action_processing_ms": 0.07325933701325116, "mean_env_wait_ms": 5.936234200735573, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 252000, "timesteps_this_iter": 0, "agent_timesteps_total": 252000, "timers": {"sample_time_ms": 21421.254, "sample_throughput": 186.73, "load_time_ms": 0.432, "load_throughput": 9259971.299, "learn_time_ms": 10617.324, "learn_throughput": 376.743, "update_time_ms": 2.219}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.10685241752734748, "policy_loss": -0.0026956240130808725, "vf_loss": 10.904500081846791, "vf_explained_var": 0.35300502232325975, "kl": 0.00894303092299084, "entropy": 0.18257966874748147, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 252000, "num_agent_steps_sampled": 252000, "num_steps_trained": 252000, "num_agent_steps_trained": 252000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2544, "training_iteration": 63, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-26-11", "timestamp": 1643646371, "time_this_iter_s": 24.810357093811035, "time_total_s": 1051.6222898960114, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1051.6222898960114, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 52.597142857142856, "ram_util_percent": 62.14857142857144}}
{"episode_reward_max": -1.2, "episode_reward_min": -88.3, "episode_reward_mean": -11.625999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3, -6.5, -5.3, -9.3, -9.3, -3.3, -11.5, -11.799999999999999, -11.500000000000002, -1.2, -5.2, -5.4, -38.3, -9.2, -8.2, -15.999999999999998, -3.3, -10.3, -9.8, -20.300000000000004, -10.9, -3.3, -8.999999999999998, -8.299999999999999, -8.399999999999999, -10.2, -8.3, -4.4, -3.3, -24.700000000000028, -16.1, -6.3, -9.3, -8.3, -4.3, -10.8, -17.2, -3.3, -26.6, -28.3, -7.2, -4.300000000000001, -2.3, -3.2, -25.9, -19.0, -15.799999999999999, -4.3, -4.2, -23.000000000000007, -4.4, -20.600000000000033, -12.699999999999996, -12.600000000000001, -3.2, -16.1, -15.899999999999999, -9.3, -29.599999999999998, -13.099999999999998, -10.999999999999998, -9.0, -3.3, -5.300000000000001, -5.2, -3.3, -13.3, -3.2, -43.3, -4.300000000000001, -9.2, -4.300000000000001, -13.0, -88.3, -5.2, -10.2, -15.3, -4.200000000000001, -12.5, -10.5, -6.3, -16.799999999999997, -8.6, -16.2, -9.2, -20.999999999999996, -13.699999999999998, -15.099999999999994, -3.4, -18.700000000000003, -3.2, -7.199999999999999, -3.3, -17.299999999999997, -6.4, -4.2, -12.6, -3.3, -20.599999999999994, -12.6], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0372021005640777, "mean_inference_ms": 1.3204512724407491, "mean_action_processing_ms": 0.07379533186962092, "mean_env_wait_ms": 5.982149229617005, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 256000, "timesteps_this_iter": 0, "agent_timesteps_total": 256000, "timers": {"sample_time_ms": 21604.796, "sample_throughput": 185.144, "load_time_ms": 0.433, "load_throughput": 9227884.055, "learn_time_ms": 10486.477, "learn_throughput": 381.444, "update_time_ms": 2.191}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.4551538429403257, "policy_loss": -0.005340514090963669, "vf_loss": 46.01440160659052, "vf_explained_var": 0.1782521870828444, "kl": 0.006228419678746522, "entropy": 0.17057787452333717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 256000, "num_agent_steps_sampled": 256000, "num_steps_trained": 256000, "num_agent_steps_trained": 256000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2584, "training_iteration": 64, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-26-33", "timestamp": 1643646393, "time_this_iter_s": 22.12629771232605, "time_total_s": 1073.7485876083374, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1073.7485876083374, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 44.012903225806454, "ram_util_percent": 62.16451612903224}}
{"episode_reward_max": -2.3, "episode_reward_min": -88.3, "episode_reward_mean": -11.669999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.2, -4.300000000000001, -2.3, -3.2, -25.9, -19.0, -15.799999999999999, -4.3, -4.2, -23.000000000000007, -4.4, -20.600000000000033, -12.699999999999996, -12.600000000000001, -3.2, -16.1, -15.899999999999999, -9.3, -29.599999999999998, -13.099999999999998, -10.999999999999998, -9.0, -3.3, -5.300000000000001, -5.2, -3.3, -13.3, -3.2, -43.3, -4.300000000000001, -9.2, -4.300000000000001, -13.0, -88.3, -5.2, -10.2, -15.3, -4.200000000000001, -12.5, -10.5, -6.3, -16.799999999999997, -8.6, -16.2, -9.2, -20.999999999999996, -13.699999999999998, -15.099999999999994, -3.4, -18.700000000000003, -3.2, -7.199999999999999, -3.3, -17.299999999999997, -6.4, -4.2, -12.6, -3.3, -20.599999999999994, -12.6, -42.2, -3.2, -19.199999999999996, -11.3, -14.399999999999999, -3.3, -5.4, -4.300000000000001, -15.699999999999996, -9.3, -5.2, -4.300000000000001, -8.3, -6.3, -6.300000000000001, -13.999999999999998, -6.3, -6.4, -20.5, -11.299999999999999, -5.300000000000001, -15.999999999999998, -3.2, -8.3, -11.2, -3.2, -22.0, -19.299999999999997, -10.799999999999999, -17.700000000000003, -3.2, -7.8000000000000025, -4.3, -5.2, -9.5, -9.2, -11.3, -5.2, -15.599999999999998, -21.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.04152325022017, "mean_inference_ms": 1.3269923894795064, "mean_action_processing_ms": 0.07416583133683537, "mean_env_wait_ms": 6.012914619372213, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 260000, "timesteps_this_iter": 0, "agent_timesteps_total": 260000, "timers": {"sample_time_ms": 21520.355, "sample_throughput": 185.871, "load_time_ms": 0.437, "load_throughput": 9154371.146, "learn_time_ms": 10608.588, "learn_throughput": 377.053, "update_time_ms": 2.221}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.046201460661306495, "policy_loss": -0.0182429088735252, "vf_loss": 6.35743018190066, "vf_explained_var": 0.4130228267562005, "kl": 0.015467905543522129, "entropy": 0.14755583354221877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 260000, "num_agent_steps_sampled": 260000, "num_steps_trained": 260000, "num_agent_steps_trained": 260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2624, "training_iteration": 65, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-26-53", "timestamp": 1643646413, "time_this_iter_s": 20.24867296218872, "time_total_s": 1093.9972605705261, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1093.9972605705261, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 30.12413793103448, "ram_util_percent": 62.14827586206898}}
{"episode_reward_max": -3.2, "episode_reward_min": -42.2, "episode_reward_mean": -11.94, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.3, -16.799999999999997, -8.6, -16.2, -9.2, -20.999999999999996, -13.699999999999998, -15.099999999999994, -3.4, -18.700000000000003, -3.2, -7.199999999999999, -3.3, -17.299999999999997, -6.4, -4.2, -12.6, -3.3, -20.599999999999994, -12.6, -42.2, -3.2, -19.199999999999996, -11.3, -14.399999999999999, -3.3, -5.4, -4.300000000000001, -15.699999999999996, -9.3, -5.2, -4.300000000000001, -8.3, -6.3, -6.300000000000001, -13.999999999999998, -6.3, -6.4, -20.5, -11.299999999999999, -5.300000000000001, -15.999999999999998, -3.2, -8.3, -11.2, -3.2, -22.0, -19.299999999999997, -10.799999999999999, -17.700000000000003, -3.2, -7.8000000000000025, -4.3, -5.2, -9.5, -9.2, -11.3, -5.2, -15.599999999999998, -21.2, -4.2, -40.3, -12.799999999999999, -3.3, -13.599999999999996, -3.3, -8.7, -27.2, -8.0, -17.1, -3.2, -17.09999999999998, -22.4, -3.7, -3.4, -31.500000000000018, -4.3, -16.6, -29.2, -3.900000000000001, -22.4, -20.7, -4.4, -27.30000000000001, -6.0, -23.900000000000006, -7.3, -3.3, -5.2, -18.6, -11.3, -15.299999999999995, -6.1, -3.4, -13.3, -16.099999999999994, -3.3, -19.700000000000024, -27.4, -18.799999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0438142279304246, "mean_inference_ms": 1.3309021868081865, "mean_action_processing_ms": 0.0743919573153291, "mean_env_wait_ms": 6.030836108748535, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 264000, "timesteps_this_iter": 0, "agent_timesteps_total": 264000, "timers": {"sample_time_ms": 21679.671, "sample_throughput": 184.505, "load_time_ms": 0.437, "load_throughput": 9146386.087, "learn_time_ms": 10498.862, "learn_throughput": 380.994, "update_time_ms": 2.236}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.1664427490309081, "policy_loss": -0.01452983985980472, "vf_loss": 18.049098987989527, "vf_explained_var": 0.19704979004398468, "kl": 0.008561811480037996, "entropy": 0.19409335874101166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 264000, "num_agent_steps_sampled": 264000, "num_steps_trained": 264000, "num_agent_steps_trained": 264000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2664, "training_iteration": 66, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-27-14", "timestamp": 1643646434, "time_this_iter_s": 20.146263122558594, "time_total_s": 1114.1435236930847, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1114.1435236930847, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 31.444827586206898, "ram_util_percent": 62.20000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -40.3, "episode_reward_mean": -11.556000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -15.999999999999998, -3.2, -8.3, -11.2, -3.2, -22.0, -19.299999999999997, -10.799999999999999, -17.700000000000003, -3.2, -7.8000000000000025, -4.3, -5.2, -9.5, -9.2, -11.3, -5.2, -15.599999999999998, -21.2, -4.2, -40.3, -12.799999999999999, -3.3, -13.599999999999996, -3.3, -8.7, -27.2, -8.0, -17.1, -3.2, -17.09999999999998, -22.4, -3.7, -3.4, -31.500000000000018, -4.3, -16.6, -29.2, -3.900000000000001, -22.4, -20.7, -4.4, -27.30000000000001, -6.0, -23.900000000000006, -7.3, -3.3, -5.2, -18.6, -11.3, -15.299999999999995, -6.1, -3.4, -13.3, -16.099999999999994, -3.3, -19.700000000000024, -27.4, -18.799999999999997, -3.4, -19.799999999999997, -11.500000000000002, -6.4, -8.2, -7.6, -3.2, -3.3, -17.2, -5.3, -3.2, -4.4, -9.899999999999997, -4.700000000000001, -10.2, -18.1, -13.299999999999999, -3.3, -3.2, -11.499999999999998, -4.300000000000001, -5.2, -8.6, -16.699999999999996, -3.3, -15.699999999999998, -11.299999999999997, -7.800000000000001, -9.0, -19.299999999999997, -17.9, -15.3, -17.4, -9.2, -21.7, -7.199999999999999, -10.199999999999998, -3.4, -17.400000000000002, -9.899999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0451527985672868, "mean_inference_ms": 1.3335171003902615, "mean_action_processing_ms": 0.07454717069135977, "mean_env_wait_ms": 6.042963837278026, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 268000, "timesteps_this_iter": 0, "agent_timesteps_total": 268000, "timers": {"sample_time_ms": 21522.857, "sample_throughput": 185.849, "load_time_ms": 0.436, "load_throughput": 9177406.05, "learn_time_ms": 10408.538, "learn_throughput": 384.3, "update_time_ms": 2.256}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.07810585845251798, "policy_loss": -0.01059237598887174, "vf_loss": 8.827328134159888, "vf_explained_var": 0.30446761147950285, "kl": 0.007554780384361195, "entropy": 0.181599414905393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 268000, "num_agent_steps_sampled": 268000, "num_steps_trained": 268000, "num_agent_steps_trained": 268000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2704, "training_iteration": 67, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-27-33", "timestamp": 1643646453, "time_this_iter_s": 19.53057885169983, "time_total_s": 1133.6741025447845, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1133.6741025447845, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 35.614285714285714, "ram_util_percent": 62.20000000000001}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -27.4, "episode_reward_mean": -10.701999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.4, -20.7, -4.4, -27.30000000000001, -6.0, -23.900000000000006, -7.3, -3.3, -5.2, -18.6, -11.3, -15.299999999999995, -6.1, -3.4, -13.3, -16.099999999999994, -3.3, -19.700000000000024, -27.4, -18.799999999999997, -3.4, -19.799999999999997, -11.500000000000002, -6.4, -8.2, -7.6, -3.2, -3.3, -17.2, -5.3, -3.2, -4.4, -9.899999999999997, -4.700000000000001, -10.2, -18.1, -13.299999999999999, -3.3, -3.2, -11.499999999999998, -4.300000000000001, -5.2, -8.6, -16.699999999999996, -3.3, -15.699999999999998, -11.299999999999997, -7.800000000000001, -9.0, -19.299999999999997, -17.9, -15.3, -17.4, -9.2, -21.7, -7.199999999999999, -10.199999999999998, -3.4, -17.400000000000002, -9.899999999999999, -17.3, -3.3, -9.499999999999998, -16.9, -13.899999999999997, -3.3, -12.599999999999998, -7.699999999999999, -3.2, -3.4, -4.2, -14.3, -8.3, -24.5, -3.2, -11.899999999999993, -10.899999999999997, -10.5, -8.8, -3.3, -24.000000000000007, -12.099999999999998, -9.5, -17.5, -23.99999999999999, -3.3, -5.3, -7.3, -10.5, -7.499999999999999, -7.400000000000002, -3.3, -5.300000000000001, -13.199999999999998, -3.3, -3.3, -25.3, -2.4000000000000004, -3.3, -19.099999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0466829979305616, "mean_inference_ms": 1.3359682851785215, "mean_action_processing_ms": 0.07469079527265907, "mean_env_wait_ms": 6.054288579174345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 272000, "timesteps_this_iter": 0, "agent_timesteps_total": 272000, "timers": {"sample_time_ms": 21326.656, "sample_throughput": 187.559, "load_time_ms": 0.432, "load_throughput": 9249760.723, "learn_time_ms": 10224.7, "learn_throughput": 391.21, "update_time_ms": 2.206}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.0814462329311076, "policy_loss": -0.01741748324605406, "vf_loss": 9.8516842763911, "vf_explained_var": 0.2764560145075603, "kl": 0.006166693527217906, "entropy": 0.17394742261398063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 272000, "num_agent_steps_sampled": 272000, "num_steps_trained": 272000, "num_agent_steps_trained": 272000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2744, "training_iteration": 68, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-27-52", "timestamp": 1643646472, "time_this_iter_s": 19.090596914291382, "time_total_s": 1152.764699459076, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1152.764699459076, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 36.01481481481482, "ram_util_percent": 62.20000000000001}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -27.900000000000006, "episode_reward_mean": -10.29, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -5.2, -8.6, -16.699999999999996, -3.3, -15.699999999999998, -11.299999999999997, -7.800000000000001, -9.0, -19.299999999999997, -17.9, -15.3, -17.4, -9.2, -21.7, -7.199999999999999, -10.199999999999998, -3.4, -17.400000000000002, -9.899999999999999, -17.3, -3.3, -9.499999999999998, -16.9, -13.899999999999997, -3.3, -12.599999999999998, -7.699999999999999, -3.2, -3.4, -4.2, -14.3, -8.3, -24.5, -3.2, -11.899999999999993, -10.899999999999997, -10.5, -8.8, -3.3, -24.000000000000007, -12.099999999999998, -9.5, -17.5, -23.99999999999999, -3.3, -5.3, -7.3, -10.5, -7.499999999999999, -7.400000000000002, -3.3, -5.300000000000001, -13.199999999999998, -3.3, -3.3, -25.3, -2.4000000000000004, -3.3, -19.099999999999998, -14.199999999999998, -13.7, -27.900000000000006, -15.8, -8.3, -10.799999999999999, -5.2, -14.3, -4.300000000000001, -8.2, -4.2, -7.399999999999999, -4.300000000000001, -11.399999999999999, -11.7, -3.4, -20.199999999999996, -3.3, -11.499999999999995, -3.2, -17.3, -3.4, -4.2, -8.3, -3.3, -8.1, -3.2, -16.29999999999998, -17.2, -3.3, -22.4, -3.3, -14.999999999999998, -7.2, -12.699999999999998, -3.3, -9.2, -13.199999999999998, -7.599999999999999, -18.5], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0479476913413013, "mean_inference_ms": 1.3383740032753895, "mean_action_processing_ms": 0.074830152169293, "mean_env_wait_ms": 6.0655146728646345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 276000, "timesteps_this_iter": 0, "agent_timesteps_total": 276000, "timers": {"sample_time_ms": 21039.376, "sample_throughput": 190.12, "load_time_ms": 0.428, "load_throughput": 9349242.686, "learn_time_ms": 10164.5, "learn_throughput": 393.526, "update_time_ms": 2.252}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.08075665492284041, "policy_loss": -0.005849090919539493, "vf_loss": 8.631303316034296, "vf_explained_var": 0.20440784705582485, "kl": 0.005203823190322131, "entropy": 0.13570331911286038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 276000, "num_agent_steps_sampled": 276000, "num_steps_trained": 276000, "num_agent_steps_trained": 276000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2784, "training_iteration": 69, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-28-12", "timestamp": 1643646492, "time_this_iter_s": 20.04568314552307, "time_total_s": 1172.810382604599, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1172.810382604599, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 30.896551724137936, "ram_util_percent": 62.1344827586207}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -30.699999999999996, "episode_reward_mean": -10.009999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.99999999999999, -3.3, -5.3, -7.3, -10.5, -7.499999999999999, -7.400000000000002, -3.3, -5.300000000000001, -13.199999999999998, -3.3, -3.3, -25.3, -2.4000000000000004, -3.3, -19.099999999999998, -14.199999999999998, -13.7, -27.900000000000006, -15.8, -8.3, -10.799999999999999, -5.2, -14.3, -4.300000000000001, -8.2, -4.2, -7.399999999999999, -4.300000000000001, -11.399999999999999, -11.7, -3.4, -20.199999999999996, -3.3, -11.499999999999995, -3.2, -17.3, -3.4, -4.2, -8.3, -3.3, -8.1, -3.2, -16.29999999999998, -17.2, -3.3, -22.4, -3.3, -14.999999999999998, -7.2, -12.699999999999998, -3.3, -9.2, -13.199999999999998, -7.599999999999999, -18.5, -10.7, -3.3, -9.4, -17.39999999999997, -6.4999999999999964, -14.999999999999996, -10.2, -30.699999999999996, -11.3, -4.3, -4.300000000000001, -23.600000000000005, -17.3, -3.3, -3.4, -3.4, -4.2, -21.3, -9.5, -16.599999999999998, -3.2, -9.2, -7.3, -3.3, -3.4, -3.3, -15.5, -10.2, -12.5, -3.3, -10.2, -9.0, -9.4, -3.3, -16.099999999999998, -18.300000000000004, -12.5, -3.2, -13.600000000000001, -13.2, -23.200000000000003, -3.3, -21.4, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0503772845042993, "mean_inference_ms": 1.3416825994168806, "mean_action_processing_ms": 0.07507512874894201, "mean_env_wait_ms": 6.082229735101375, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 280000, "timesteps_this_iter": 0, "agent_timesteps_total": 280000, "timers": {"sample_time_ms": 21039.658, "sample_throughput": 190.117, "load_time_ms": 0.45, "load_throughput": 8897547.73, "learn_time_ms": 10225.779, "learn_throughput": 391.168, "update_time_ms": 2.168}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.06949718331177068, "policy_loss": -0.010630904522634321, "vf_loss": 7.958338191208019, "vf_explained_var": 0.41827351290692566, "kl": 0.009683684911780484, "entropy": 0.13093957800458195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 280000, "num_agent_steps_sampled": 280000, "num_steps_trained": 280000, "num_agent_steps_trained": 280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2828, "training_iteration": 70, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-28-34", "timestamp": 1643646514, "time_this_iter_s": 21.125541925430298, "time_total_s": 1193.9359245300293, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1193.9359245300293, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 34.79, "ram_util_percent": 62.146666666666654}}
{"episode_reward_max": -1.2, "episode_reward_min": -63.4, "episode_reward_mean": -11.565999999999995, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -8.1, -3.2, -16.29999999999998, -17.2, -3.3, -22.4, -3.3, -14.999999999999998, -7.2, -12.699999999999998, -3.3, -9.2, -13.199999999999998, -7.599999999999999, -18.5, -10.7, -3.3, -9.4, -17.39999999999997, -6.4999999999999964, -14.999999999999996, -10.2, -30.699999999999996, -11.3, -4.3, -4.300000000000001, -23.600000000000005, -17.3, -3.3, -3.4, -3.4, -4.2, -21.3, -9.5, -16.599999999999998, -3.2, -9.2, -7.3, -3.3, -3.4, -3.3, -15.5, -10.2, -12.5, -3.3, -10.2, -9.0, -9.4, -3.3, -16.099999999999998, -18.300000000000004, -12.5, -3.2, -13.600000000000001, -13.2, -23.200000000000003, -3.3, -21.4, -3.3, -11.9, -15.399999999999999, -9.7, -3.2, -16.6, -8.8, -6.2, -3.2, -22.6, -3.3, -21.400000000000016, -16.199999999999996, -41.2, -26.4, -17.7, -8.3, -63.4, -3.2, -20.0, -15.999999999999998, -4.2, -16.6, -6.3, -1.2, -17.6, -5.2, -13.7, -12.3, -6.2, -8.49999999999999, -12.699999999999998, -12.6, -9.599999999999998, -13.899999999999995, -8.499999999999998, -4.3, -3.3, -3.3, -20.599999999999998, -20.600000000000005], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.05371348067816, "mean_inference_ms": 1.3464398722918123, "mean_action_processing_ms": 0.0753488565178997, "mean_env_wait_ms": 6.10501220123546, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 284000, "timesteps_this_iter": 0, "agent_timesteps_total": 284000, "timers": {"sample_time_ms": 21322.08, "sample_throughput": 187.599, "load_time_ms": 0.499, "load_throughput": 8013190.046, "learn_time_ms": 10496.39, "learn_throughput": 381.083, "update_time_ms": 2.138}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.23247860640447626, "policy_loss": -0.0030670759218033926, "vf_loss": 23.495075495204617, "vf_explained_var": 0.16838224414856204, "kl": 0.010576502413179088, "entropy": 0.16255566237033695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 284000, "num_agent_steps_sampled": 284000, "num_steps_trained": 284000, "num_agent_steps_trained": 284000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2868, "training_iteration": 71, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-28-59", "timestamp": 1643646539, "time_this_iter_s": 25.304088830947876, "time_total_s": 1219.2400133609772, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1219.2400133609772, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 52.94444444444444, "ram_util_percent": 62.26666666666669}}
{"episode_reward_max": -1.2, "episode_reward_min": -111.09999999999988, "episode_reward_mean": -13.227999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -3.3, -15.5, -10.2, -12.5, -3.3, -10.2, -9.0, -9.4, -3.3, -16.099999999999998, -18.300000000000004, -12.5, -3.2, -13.600000000000001, -13.2, -23.200000000000003, -3.3, -21.4, -3.3, -11.9, -15.399999999999999, -9.7, -3.2, -16.6, -8.8, -6.2, -3.2, -22.6, -3.3, -21.400000000000016, -16.199999999999996, -41.2, -26.4, -17.7, -8.3, -63.4, -3.2, -20.0, -15.999999999999998, -4.2, -16.6, -6.3, -1.2, -17.6, -5.2, -13.7, -12.3, -6.2, -8.49999999999999, -12.699999999999998, -12.6, -9.599999999999998, -13.899999999999995, -8.499999999999998, -4.3, -3.3, -3.3, -20.599999999999998, -20.600000000000005, -7.499999999999999, -24.6, -18.800000000000004, -23.5, -15.999999999999998, -10.599999999999996, -16.0, -14.7, -9.299999999999997, -13.3, -16.6, -3.2, -14.899999999999999, -5.3, -12.7, -11.799999999999999, -3.4, -4.2, -111.09999999999988, -3.3, -12.7, -15.099999999999998, -12.7, -16.5, -8.899999999999999, -16.7, -9.799999999999999, -3.2, -9.6, -3.2, -20.7, -9.2, -15.7, -3.3, -24.100000000000048, -19.5, -12.7, -17.7, -3.3, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0578355368717345, "mean_inference_ms": 1.352243035575795, "mean_action_processing_ms": 0.07562968863984762, "mean_env_wait_ms": 6.13211368940799, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 288000, "timesteps_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"sample_time_ms": 21541.843, "sample_throughput": 185.685, "load_time_ms": 0.522, "load_throughput": 7658730.941, "learn_time_ms": 10413.692, "learn_throughput": 384.11, "update_time_ms": 2.142}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.47610468289874974, "policy_loss": -0.020033294243878254, "vf_loss": 49.422574699662064, "vf_explained_var": 0.2099749038296361, "kl": 0.03399544146081671, "entropy": 0.16360845322951034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 288000, "num_agent_steps_sampled": 288000, "num_steps_trained": 288000, "num_agent_steps_trained": 288000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2908, "training_iteration": 72, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-29-21", "timestamp": 1643646561, "time_this_iter_s": 21.757819890975952, "time_total_s": 1240.9978332519531, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1240.9978332519531, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 44.583870967741944, "ram_util_percent": 62.29999999999998}}
{"episode_reward_max": -1.2, "episode_reward_min": -111.09999999999988, "episode_reward_mean": -11.341999999999995, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -16.6, -6.3, -1.2, -17.6, -5.2, -13.7, -12.3, -6.2, -8.49999999999999, -12.699999999999998, -12.6, -9.599999999999998, -13.899999999999995, -8.499999999999998, -4.3, -3.3, -3.3, -20.599999999999998, -20.600000000000005, -7.499999999999999, -24.6, -18.800000000000004, -23.5, -15.999999999999998, -10.599999999999996, -16.0, -14.7, -9.299999999999997, -13.3, -16.6, -3.2, -14.899999999999999, -5.3, -12.7, -11.799999999999999, -3.4, -4.2, -111.09999999999988, -3.3, -12.7, -15.099999999999998, -12.7, -16.5, -8.899999999999999, -16.7, -9.799999999999999, -3.2, -9.6, -3.2, -20.7, -9.2, -15.7, -3.3, -24.100000000000048, -19.5, -12.7, -17.7, -3.3, -3.3, -10.2, -4.300000000000001, -3.3, -3.2, -11.299999999999997, -10.3, -8.1, -3.3, -10.7, -13.799999999999994, -4.300000000000001, -8.3, -3.4, -4.2, -3.2, -5.4, -15.9, -11.299999999999999, -16.999999999999996, -14.399999999999993, -3.3, -10.699999999999998, -8.099999999999998, -10.2, -3.3, -4.2, -11.2, -4.2, -3.3, -4.2, -22.600000000000005, -3.2, -7.699999999999999, -14.899999999999975, -3.3, -14.599999999999996, -4.300000000000001, -18.6, -18.400000000000027, -18.099999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0613567078844275, "mean_inference_ms": 1.357320369465532, "mean_action_processing_ms": 0.07590665240016241, "mean_env_wait_ms": 6.155848045964222, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 292000, "timesteps_this_iter": 0, "agent_timesteps_total": 292000, "timers": {"sample_time_ms": 21174.826, "sample_throughput": 188.904, "load_time_ms": 0.519, "load_throughput": 7713662.529, "learn_time_ms": 10280.546, "learn_throughput": 389.084, "update_time_ms": 2.155}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.031113977103884662, "policy_loss": -0.025570390285843965, "vf_loss": 5.597357912730145, "vf_explained_var": 0.3705827605980699, "kl": 0.008424183728905927, "entropy": 0.14359129954690253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 292000, "num_agent_steps_sampled": 292000, "num_steps_trained": 292000, "num_agent_steps_trained": 292000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2948, "training_iteration": 73, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-29-41", "timestamp": 1643646581, "time_this_iter_s": 20.629931926727295, "time_total_s": 1261.6277651786804, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1261.6277651786804, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 42.69655172413793, "ram_util_percent": 62.31379310344826}}
{"episode_reward_max": -3.2, "episode_reward_min": -44.09999999999999, "episode_reward_mean": -10.081999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.7, -15.099999999999998, -12.7, -16.5, -8.899999999999999, -16.7, -9.799999999999999, -3.2, -9.6, -3.2, -20.7, -9.2, -15.7, -3.3, -24.100000000000048, -19.5, -12.7, -17.7, -3.3, -3.3, -10.2, -4.300000000000001, -3.3, -3.2, -11.299999999999997, -10.3, -8.1, -3.3, -10.7, -13.799999999999994, -4.300000000000001, -8.3, -3.4, -4.2, -3.2, -5.4, -15.9, -11.299999999999999, -16.999999999999996, -14.399999999999993, -3.3, -10.699999999999998, -8.099999999999998, -10.2, -3.3, -4.2, -11.2, -4.2, -3.3, -4.2, -22.600000000000005, -3.2, -7.699999999999999, -14.899999999999975, -3.3, -14.599999999999996, -4.300000000000001, -18.6, -18.400000000000027, -18.099999999999998, -3.3, -20.900000000000006, -9.1, -13.3, -31.3, -15.099999999999998, -44.09999999999999, -4.300000000000001, -7.299999999999999, -3.3, -8.9, -4.300000000000001, -24.400000000000002, -14.599999999999998, -21.499999999999993, -3.2, -3.3, -3.2, -13.999999999999998, -3.2, -6.2, -13.099999999999998, -16.799999999999997, -3.3, -12.399999999999999, -3.8000000000000007, -6.499999999999999, -14.2, -3.3, -13.3, -15.3, -6.599999999999999, -3.3, -3.3, -3.3, -13.500000000000002, -13.199999999999994, -3.3, -4.300000000000001, -4.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0639885407895402, "mean_inference_ms": 1.3604118275709807, "mean_action_processing_ms": 0.07608241273754988, "mean_env_wait_ms": 6.170762242958396, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 296000, "timesteps_this_iter": 0, "agent_timesteps_total": 296000, "timers": {"sample_time_ms": 20818.914, "sample_throughput": 192.133, "load_time_ms": 0.522, "load_throughput": 7656284.397, "learn_time_ms": 10315.13, "learn_throughput": 387.78, "update_time_ms": 2.149}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.11066161541378386, "policy_loss": -0.00735686168535262, "vf_loss": 11.758569309836433, "vf_explained_var": 0.4357655546998465, "kl": 0.005129328082263942, "entropy": 0.12437182530280083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 296000, "num_agent_steps_sampled": 296000, "num_steps_trained": 296000, "num_agent_steps_trained": 296000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2988, "training_iteration": 74, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-30-02", "timestamp": 1643646602, "time_this_iter_s": 20.24372410774231, "time_total_s": 1281.8714892864227, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1281.8714892864227, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 40.268965517241384, "ram_util_percent": 62.31724137931033}}
{"episode_reward_max": -1.3, "episode_reward_min": -44.09999999999999, "episode_reward_mean": -10.792, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -10.699999999999998, -8.099999999999998, -10.2, -3.3, -4.2, -11.2, -4.2, -3.3, -4.2, -22.600000000000005, -3.2, -7.699999999999999, -14.899999999999975, -3.3, -14.599999999999996, -4.300000000000001, -18.6, -18.400000000000027, -18.099999999999998, -3.3, -20.900000000000006, -9.1, -13.3, -31.3, -15.099999999999998, -44.09999999999999, -4.300000000000001, -7.299999999999999, -3.3, -8.9, -4.300000000000001, -24.400000000000002, -14.599999999999998, -21.499999999999993, -3.2, -3.3, -3.2, -13.999999999999998, -3.2, -6.2, -13.099999999999998, -16.799999999999997, -3.3, -12.399999999999999, -3.8000000000000007, -6.499999999999999, -14.2, -3.3, -13.3, -15.3, -6.599999999999999, -3.3, -3.3, -3.3, -13.500000000000002, -13.199999999999994, -3.3, -4.300000000000001, -4.4, -16.4, -4.2, -7.3, -22.2, -3.3, -10.399999999999997, -16.299999999999997, -14.6, -8.0, -3.7000000000000006, -14.299999999999999, -4.300000000000001, -6.699999999999999, -40.3, -17.8, -8.6, -42.90000000000004, -9.3, -17.0, -14.9, -3.3, -8.3, -8.2, -4.2, -3.3, -8.2, -18.0, -1.3, -17.7, -16.7, -3.3, -20.1, -3.3, -11.2, -34.100000000000044, -8.399999999999999, -4.2, -4.300000000000001, -10.9, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.065927312472928, "mean_inference_ms": 1.3628005270483055, "mean_action_processing_ms": 0.07621696681723573, "mean_env_wait_ms": 6.182051168981489, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 300000, "timesteps_this_iter": 0, "agent_timesteps_total": 300000, "timers": {"sample_time_ms": 20903.626, "sample_throughput": 191.354, "load_time_ms": 0.53, "load_throughput": 7545069.257, "learn_time_ms": 10219.914, "learn_throughput": 391.393, "update_time_ms": 2.21}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.15197257167629658, "policy_loss": -0.008964117059624323, "vf_loss": 15.97355514655831, "vf_explained_var": 0.2923192131903864, "kl": 0.014235754819313337, "entropy": 0.15598498285017026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 300000, "num_agent_steps_sampled": 300000, "num_steps_trained": 300000, "num_agent_steps_trained": 300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3028, "training_iteration": 75, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-30-22", "timestamp": 1643646622, "time_this_iter_s": 19.78364896774292, "time_total_s": 1301.6551382541656, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1301.6551382541656, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 41.93571428571429, "ram_util_percent": 62.29999999999999}}
{"episode_reward_max": -1.3, "episode_reward_min": -42.90000000000004, "episode_reward_mean": -11.534, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -13.099999999999998, -16.799999999999997, -3.3, -12.399999999999999, -3.8000000000000007, -6.499999999999999, -14.2, -3.3, -13.3, -15.3, -6.599999999999999, -3.3, -3.3, -3.3, -13.500000000000002, -13.199999999999994, -3.3, -4.300000000000001, -4.4, -16.4, -4.2, -7.3, -22.2, -3.3, -10.399999999999997, -16.299999999999997, -14.6, -8.0, -3.7000000000000006, -14.299999999999999, -4.300000000000001, -6.699999999999999, -40.3, -17.8, -8.6, -42.90000000000004, -9.3, -17.0, -14.9, -3.3, -8.3, -8.2, -4.2, -3.3, -8.2, -18.0, -1.3, -17.7, -16.7, -3.3, -20.1, -3.3, -11.2, -34.100000000000044, -8.399999999999999, -4.2, -4.300000000000001, -10.9, -3.3, -15.2, -9.299999999999999, -3.3, -7.199999999999999, -16.5, -12.399999999999999, -21.5, -7.099999999999999, -15.399999999999995, -30.899999999999963, -3.2, -3.2, -12.599999999999996, -22.5, -8.799999999999997, -15.999999999999998, -16.699999999999996, -8.799999999999999, -10.799999999999997, -11.099999999999998, -23.900000000000006, -7.999999999999998, -10.3, -33.3, -3.3, -4.3, -23.6, -3.2, -4.300000000000001, -20.000000000000004, -10.2, -21.399999999999988, -3.2, -3.3, -20.100000000000005, -13.599999999999994, -20.4, -6.8999999999999995, -15.999999999999996, -13.399999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0678122083349564, "mean_inference_ms": 1.3651063137847825, "mean_action_processing_ms": 0.07634746359018499, "mean_env_wait_ms": 6.192719128334759, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 304000, "timesteps_this_iter": 0, "agent_timesteps_total": 304000, "timers": {"sample_time_ms": 20796.26, "sample_throughput": 192.342, "load_time_ms": 0.532, "load_throughput": 7515663.665, "learn_time_ms": 10218.431, "learn_throughput": 391.45, "update_time_ms": 2.202}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.12286407220908391, "policy_loss": -0.009620686576411288, "vf_loss": 13.148022513876679, "vf_explained_var": 0.15441956802081036, "kl": 0.011905613094461356, "entropy": 0.1760077735108714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 304000, "num_agent_steps_sampled": 304000, "num_steps_trained": 304000, "num_agent_steps_trained": 304000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3068, "training_iteration": 76, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-30-42", "timestamp": 1643646642, "time_this_iter_s": 20.011709928512573, "time_total_s": 1321.6668481826782, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1321.6668481826782, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 41.14137931034482, "ram_util_percent": 62.289655172413795}}
{"episode_reward_max": -1.3, "episode_reward_min": -79.3, "episode_reward_mean": -12.155999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -8.3, -8.2, -4.2, -3.3, -8.2, -18.0, -1.3, -17.7, -16.7, -3.3, -20.1, -3.3, -11.2, -34.100000000000044, -8.399999999999999, -4.2, -4.300000000000001, -10.9, -3.3, -15.2, -9.299999999999999, -3.3, -7.199999999999999, -16.5, -12.399999999999999, -21.5, -7.099999999999999, -15.399999999999995, -30.899999999999963, -3.2, -3.2, -12.599999999999996, -22.5, -8.799999999999997, -15.999999999999998, -16.699999999999996, -8.799999999999999, -10.799999999999997, -11.099999999999998, -23.900000000000006, -7.999999999999998, -10.3, -33.3, -3.3, -4.3, -23.6, -3.2, -4.300000000000001, -20.000000000000004, -10.2, -21.399999999999988, -3.2, -3.3, -20.100000000000005, -13.599999999999994, -20.4, -6.8999999999999995, -15.999999999999996, -13.399999999999999, -3.3000000000000003, -10.7, -3.2, -79.3, -23.800000000000004, -17.6, -12.3, -3.3, -4.300000000000001, -11.999999999999998, -4.2, -16.5, -17.799999999999997, -7.3, -4.2, -15.9, -8.899999999999999, -8.2, -2.5, -3.3, -3.3, -20.500000000000018, -30.000000000000036, -12.899999999999999, -9.2, -9.399999999999999, -3.3, -4.3, -9.6, -18.600000000000005, -5.3, -11.299999999999995, -17.6, -15.199999999999985, -28.60000000000001, -11.3, -14.799999999999997, -5.000000000000001, -5.3, -13.999999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0700667561669626, "mean_inference_ms": 1.367902484411243, "mean_action_processing_ms": 0.0765051046300839, "mean_env_wait_ms": 6.205698940700132, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 308000, "timesteps_this_iter": 0, "agent_timesteps_total": 308000, "timers": {"sample_time_ms": 20902.156, "sample_throughput": 191.368, "load_time_ms": 0.563, "load_throughput": 7105376.927, "learn_time_ms": 10427.313, "learn_throughput": 383.608, "update_time_ms": 2.174}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.4207828365927262, "policy_loss": -0.008009473230910077, "vf_loss": 42.81597475826099, "vf_explained_var": 0.26219768626715545, "kl": 0.007497113087597006, "entropy": 0.17654773060192344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 308000, "num_agent_steps_sampled": 308000, "num_steps_trained": 308000, "num_agent_steps_trained": 308000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3108, "training_iteration": 77, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-31-04", "timestamp": 1643646664, "time_this_iter_s": 22.68575167655945, "time_total_s": 1344.3525998592377, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1344.3525998592377, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 44.053124999999994, "ram_util_percent": 62.284375000000004}}
{"episode_reward_max": -2.5, "episode_reward_min": -79.3, "episode_reward_mean": -12.05, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.900000000000006, -7.999999999999998, -10.3, -33.3, -3.3, -4.3, -23.6, -3.2, -4.300000000000001, -20.000000000000004, -10.2, -21.399999999999988, -3.2, -3.3, -20.100000000000005, -13.599999999999994, -20.4, -6.8999999999999995, -15.999999999999996, -13.399999999999999, -3.3000000000000003, -10.7, -3.2, -79.3, -23.800000000000004, -17.6, -12.3, -3.3, -4.300000000000001, -11.999999999999998, -4.2, -16.5, -17.799999999999997, -7.3, -4.2, -15.9, -8.899999999999999, -8.2, -2.5, -3.3, -3.3, -20.500000000000018, -30.000000000000036, -12.899999999999999, -9.2, -9.399999999999999, -3.3, -4.3, -9.6, -18.600000000000005, -5.3, -11.299999999999995, -17.6, -15.199999999999985, -28.60000000000001, -11.3, -14.799999999999997, -5.000000000000001, -5.3, -13.999999999999998, -4.2, -7.299999999999999, -18.799999999999997, -7.3, -9.399999999999999, -21.299999999999997, -14.099999999999998, -17.3, -9.599999999999998, -3.3, -19.500000000000025, -3.3, -4.300000000000001, -11.100000000000001, -11.7, -12.299999999999999, -3.2, -18.100000000000005, -4.2, -4.4, -9.2, -12.3, -5.700000000000001, -3.3, -15.799999999999997, -16.4, -7.599999999999999, -8.8, -21.3, -7.299999999999999, -13.999999999999998, -13.299999999999997, -11.3, -16.2, -11.9, -3.2, -16.9, -9.2, -12.5, -13.299999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0725305998510495, "mean_inference_ms": 1.3716675793871749, "mean_action_processing_ms": 0.07671869943027745, "mean_env_wait_ms": 6.223809632105128, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 312000, "timesteps_this_iter": 0, "agent_timesteps_total": 312000, "timers": {"sample_time_ms": 21284.491, "sample_throughput": 187.93, "load_time_ms": 0.566, "load_throughput": 7068555.298, "learn_time_ms": 10748.542, "learn_throughput": 372.143, "update_time_ms": 2.191}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.08854318621858794, "policy_loss": -0.010526548594396602, "vf_loss": 9.831712857241271, "vf_explained_var": 0.15895704255309157, "kl": 0.008919829142017846, "entropy": 0.18025938137885064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 312000, "num_agent_steps_sampled": 312000, "num_steps_trained": 312000, "num_agent_steps_trained": 312000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3148, "training_iteration": 78, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-31-28", "timestamp": 1643646688, "time_this_iter_s": 24.028897047042847, "time_total_s": 1368.3814969062805, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1368.3814969062805, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 48.67352941176471, "ram_util_percent": 62.38529411764706}}
{"episode_reward_max": -3.2, "episode_reward_min": -30.000000000000036, "episode_reward_mean": -11.484000000000004, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -20.500000000000018, -30.000000000000036, -12.899999999999999, -9.2, -9.399999999999999, -3.3, -4.3, -9.6, -18.600000000000005, -5.3, -11.299999999999995, -17.6, -15.199999999999985, -28.60000000000001, -11.3, -14.799999999999997, -5.000000000000001, -5.3, -13.999999999999998, -4.2, -7.299999999999999, -18.799999999999997, -7.3, -9.399999999999999, -21.299999999999997, -14.099999999999998, -17.3, -9.599999999999998, -3.3, -19.500000000000025, -3.3, -4.300000000000001, -11.100000000000001, -11.7, -12.299999999999999, -3.2, -18.100000000000005, -4.2, -4.4, -9.2, -12.3, -5.700000000000001, -3.3, -15.799999999999997, -16.4, -7.599999999999999, -8.8, -21.3, -7.299999999999999, -13.999999999999998, -13.299999999999997, -11.3, -16.2, -11.9, -3.2, -16.9, -9.2, -12.5, -13.299999999999999, -12.399999999999999, -15.4, -15.499999999999996, -6.2, -9.2, -15.399999999999997, -6.3999999999999995, -6.4, -17.299999999999994, -19.099999999999998, -13.499999999999998, -6.8999999999999995, -10.199999999999998, -15.3, -12.6, -9.5, -3.2, -5.300000000000001, -19.799999999999997, -6.3, -22.4, -24.5, -9.700000000000001, -12.799999999999997, -5.2, -14.799999999999997, -3.3, -10.4, -7.699999999999999, -17.599999999999998, -15.4, -9.9, -3.2, -3.3, -19.5, -28.599999999999998, -5.0, -5.8999999999999995, -16.4, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0771823835709788, "mean_inference_ms": 1.3778576223152361, "mean_action_processing_ms": 0.07705731274598078, "mean_env_wait_ms": 6.254126388556751, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 316000, "timesteps_this_iter": 0, "agent_timesteps_total": 316000, "timers": {"sample_time_ms": 22015.023, "sample_throughput": 181.694, "load_time_ms": 0.568, "load_throughput": 7036537.348, "learn_time_ms": 11137.414, "learn_throughput": 359.15, "update_time_ms": 2.199}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.10792059495003634, "policy_loss": -0.009784494831116609, "vf_loss": 11.70598779955218, "vf_explained_var": 0.07591489367587592, "kl": 0.007646973677674948, "entropy": 0.18881274770985368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 316000, "num_agent_steps_sampled": 316000, "num_steps_trained": 316000, "num_agent_steps_trained": 316000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3188, "training_iteration": 79, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-31-56", "timestamp": 1643646716, "time_this_iter_s": 28.022033214569092, "time_total_s": 1396.4035301208496, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1396.4035301208496, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 57.879999999999995, "ram_util_percent": 62.55999999999999}}
{"episode_reward_max": -1.2, "episode_reward_min": -28.599999999999998, "episode_reward_mean": -11.067, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.799999999999997, -16.4, -7.599999999999999, -8.8, -21.3, -7.299999999999999, -13.999999999999998, -13.299999999999997, -11.3, -16.2, -11.9, -3.2, -16.9, -9.2, -12.5, -13.299999999999999, -12.399999999999999, -15.4, -15.499999999999996, -6.2, -9.2, -15.399999999999997, -6.3999999999999995, -6.4, -17.299999999999994, -19.099999999999998, -13.499999999999998, -6.8999999999999995, -10.199999999999998, -15.3, -12.6, -9.5, -3.2, -5.300000000000001, -19.799999999999997, -6.3, -22.4, -24.5, -9.700000000000001, -12.799999999999997, -5.2, -14.799999999999997, -3.3, -10.4, -7.699999999999999, -17.599999999999998, -15.4, -9.9, -3.2, -3.3, -19.5, -28.599999999999998, -5.0, -5.8999999999999995, -16.4, -3.2, -10.699999999999998, -8.700000000000001, -3.3, -4.300000000000001, -3.8000000000000007, -4.300000000000001, -8.2, -6.3, -3.4, -9.3, -28.500000000000018, -13.699999999999976, -7.6, -6.899999999999999, -27.800000000000008, -13.5, -8.2, -3.3, -16.299999999999997, -13.5, -12.3, -3.3, -4.300000000000001, -15.899999999999997, -7.3, -14.899999999999999, -21.5, -1.2, -3.2, -20.6, -13.399999999999999, -2.2, -7.4, -18.799999999999997, -11.3, -9.999999999999998, -10.899999999999999, -9.0, -7.2, -7.3, -11.199999999999998, -3.3, -11.7, -13.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0840031457612829, "mean_inference_ms": 1.3868333198994822, "mean_action_processing_ms": 0.07759470668892547, "mean_env_wait_ms": 6.298417501595347, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 320000, "timesteps_this_iter": 0, "agent_timesteps_total": 320000, "timers": {"sample_time_ms": 22738.301, "sample_throughput": 175.915, "load_time_ms": 0.544, "load_throughput": 7352301.153, "learn_time_ms": 11588.739, "learn_throughput": 345.163, "update_time_ms": 2.44}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.09528422186411517, "policy_loss": 0.0003085344669318968, "vf_loss": 9.439330684978476, "vf_explained_var": 0.2414024789487162, "kl": 0.0069023246897233145, "entropy": 0.1755646431117609, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 320000, "num_agent_steps_sampled": 320000, "num_steps_trained": 320000, "num_agent_steps_trained": 320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3232, "training_iteration": 80, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-32-26", "timestamp": 1643646746, "time_this_iter_s": 28.961361169815063, "time_total_s": 1425.3648912906647, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1425.3648912906647, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 37.58809523809524, "ram_util_percent": 62.599999999999994}}
{"episode_reward_max": -1.2, "episode_reward_min": -71.30000000000008, "episode_reward_mean": -11.233000000000004, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -14.799999999999997, -3.3, -10.4, -7.699999999999999, -17.599999999999998, -15.4, -9.9, -3.2, -3.3, -19.5, -28.599999999999998, -5.0, -5.8999999999999995, -16.4, -3.2, -10.699999999999998, -8.700000000000001, -3.3, -4.300000000000001, -3.8000000000000007, -4.300000000000001, -8.2, -6.3, -3.4, -9.3, -28.500000000000018, -13.699999999999976, -7.6, -6.899999999999999, -27.800000000000008, -13.5, -8.2, -3.3, -16.299999999999997, -13.5, -12.3, -3.3, -4.300000000000001, -15.899999999999997, -7.3, -14.899999999999999, -21.5, -1.2, -3.2, -20.6, -13.399999999999999, -2.2, -7.4, -18.799999999999997, -11.3, -9.999999999999998, -10.899999999999999, -9.0, -7.2, -7.3, -11.199999999999998, -3.3, -11.7, -13.2, -4.6000000000000005, -3.2000000000000006, -12.599999999999994, -8.2, -10.3, -4.2, -11.999999999999995, -10.4, -17.999999999999996, -12.699999999999998, -18.3, -3.4, -10.6, -7.299999999999999, -7.0, -3.3, -7.8999999999999995, -13.599999999999985, -8.7, -16.899999999999995, -3.4, -11.2, -29.4, -20.699999999999996, -7.800000000000001, -71.30000000000008, -11.100000000000001, -9.2, -10.3, -10.5, -17.1, -7.5, -10.2, -14.2, -10.3, -11.799999999999999, -18.700000000000003, -9.899999999999993, -23.399999999999988, -9.7], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.091398068385868, "mean_inference_ms": 1.3974629004204189, "mean_action_processing_ms": 0.07817575426058271, "mean_env_wait_ms": 6.3497102373165895, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 324000, "timesteps_this_iter": 0, "agent_timesteps_total": 324000, "timers": {"sample_time_ms": 23665.639, "sample_throughput": 169.021, "load_time_ms": 0.504, "load_throughput": 7937368.595, "learn_time_ms": 11509.501, "learn_throughput": 347.539, "update_time_ms": 2.459}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.30836323833428525, "policy_loss": -0.006107046921807592, "vf_loss": 31.367249706291382, "vf_explained_var": 0.1086897208485552, "kl": 0.009455414995129283, "entropy": 0.21407082247878276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 324000, "num_agent_steps_sampled": 324000, "num_steps_trained": 324000, "num_agent_steps_trained": 324000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3272, "training_iteration": 81, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-32-55", "timestamp": 1643646775, "time_this_iter_s": 29.144699811935425, "time_total_s": 1454.5095911026, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1454.5095911026, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 40.85609756097561, "ram_util_percent": 62.636585365853655}}
{"episode_reward_max": -1.2, "episode_reward_min": -71.30000000000008, "episode_reward_mean": -11.389000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.3, -14.899999999999999, -21.5, -1.2, -3.2, -20.6, -13.399999999999999, -2.2, -7.4, -18.799999999999997, -11.3, -9.999999999999998, -10.899999999999999, -9.0, -7.2, -7.3, -11.199999999999998, -3.3, -11.7, -13.2, -4.6000000000000005, -3.2000000000000006, -12.599999999999994, -8.2, -10.3, -4.2, -11.999999999999995, -10.4, -17.999999999999996, -12.699999999999998, -18.3, -3.4, -10.6, -7.299999999999999, -7.0, -3.3, -7.8999999999999995, -13.599999999999985, -8.7, -16.899999999999995, -3.4, -11.2, -29.4, -20.699999999999996, -7.800000000000001, -71.30000000000008, -11.100000000000001, -9.2, -10.3, -10.5, -17.1, -7.5, -10.2, -14.2, -10.3, -11.799999999999999, -18.700000000000003, -9.899999999999993, -23.399999999999988, -9.7, -11.2, -6.5, -3.2, -16.299999999999997, -23.5, -4.3, -6.699999999999999, -3.9000000000000004, -14.2, -14.799999999999997, -3.3, -19.299999999999997, -4.7, -3.3, -4.4, -13.1, -4.300000000000001, -3.3, -9.3, -42.4, -15.2, -8.2, -3.3, -11.5, -14.6, -10.4, -18.700000000000003, -17.8, -7.799999999999998, -3.9000000000000004, -15.3, -3.3, -12.7, -18.0, -3.3, -9.2, -13.399999999999999, -3.3, -7.399999999999999, -13.099999999999996], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0970550177007719, "mean_inference_ms": 1.4059235797883138, "mean_action_processing_ms": 0.07859666425541878, "mean_env_wait_ms": 6.390213174142192, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 328000, "timesteps_this_iter": 0, "agent_timesteps_total": 328000, "timers": {"sample_time_ms": 23540.114, "sample_throughput": 169.923, "load_time_ms": 0.486, "load_throughput": 8230177.091, "learn_time_ms": 11637.551, "learn_throughput": 343.715, "update_time_ms": 2.449}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.1008030882225402, "policy_loss": -0.01277382193353548, "vf_loss": 11.260688842945202, "vf_explained_var": 0.2191615508448693, "kl": 0.011496589472886861, "entropy": 0.17371483979526386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 328000, "num_agent_steps_sampled": 328000, "num_steps_trained": 328000, "num_agent_steps_trained": 328000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3312, "training_iteration": 82, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-33-17", "timestamp": 1643646797, "time_this_iter_s": 22.56320095062256, "time_total_s": 1477.0727920532227, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1477.0727920532227, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 27.3125, "ram_util_percent": 62.081250000000004}}
{"episode_reward_max": -3.2, "episode_reward_min": -71.30000000000008, "episode_reward_mean": -12.225000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -11.2, -29.4, -20.699999999999996, -7.800000000000001, -71.30000000000008, -11.100000000000001, -9.2, -10.3, -10.5, -17.1, -7.5, -10.2, -14.2, -10.3, -11.799999999999999, -18.700000000000003, -9.899999999999993, -23.399999999999988, -9.7, -11.2, -6.5, -3.2, -16.299999999999997, -23.5, -4.3, -6.699999999999999, -3.9000000000000004, -14.2, -14.799999999999997, -3.3, -19.299999999999997, -4.7, -3.3, -4.4, -13.1, -4.300000000000001, -3.3, -9.3, -42.4, -15.2, -8.2, -3.3, -11.5, -14.6, -10.4, -18.700000000000003, -17.8, -7.799999999999998, -3.9000000000000004, -15.3, -3.3, -12.7, -18.0, -3.3, -9.2, -13.399999999999999, -3.3, -7.399999999999999, -13.099999999999996, -12.799999999999999, -15.799999999999997, -10.899999999999999, -9.2, -13.399999999999999, -3.3, -5.2, -17.5, -18.899999999999988, -4.2, -16.099999999999994, -9.099999999999998, -10.5, -11.199999999999996, -16.099999999999994, -19.100000000000005, -17.0, -3.6000000000000005, -19.20000000000001, -5.2, -15.899999999999999, -13.5, -3.3, -3.3, -17.2, -15.299999999999997, -9.6, -6.199999999999999, -20.800000000000004, -10.9, -20.2, -15.3, -11.599999999999998, -35.0, -14.1, -7.6, -3.3, -4.4, -11.2, -5.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1011075696551855, "mean_inference_ms": 1.4119602989892177, "mean_action_processing_ms": 0.0789233378166456, "mean_env_wait_ms": 6.418910458213254, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 332000, "timesteps_this_iter": 0, "agent_timesteps_total": 332000, "timers": {"sample_time_ms": 23796.543, "sample_throughput": 168.092, "load_time_ms": 0.489, "load_throughput": 8182810.32, "learn_time_ms": 11693.032, "learn_throughput": 342.084, "update_time_ms": 2.472}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.09747092834353367, "policy_loss": -0.012075171509497268, "vf_loss": 10.892543459419281, "vf_explained_var": 0.2550312378714161, "kl": 0.0073560372752097935, "entropy": 0.21176651696203858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 332000, "num_agent_steps_sampled": 332000, "num_steps_trained": 332000, "num_agent_steps_trained": 332000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3352, "training_iteration": 83, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-33-40", "timestamp": 1643646820, "time_this_iter_s": 22.473933935165405, "time_total_s": 1499.546725988388, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1499.546725988388, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 38.378125, "ram_util_percent": 61.178125}}
{"episode_reward_max": -1.3, "episode_reward_min": -35.0, "episode_reward_mean": -10.770999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.2, -8.2, -3.3, -11.5, -14.6, -10.4, -18.700000000000003, -17.8, -7.799999999999998, -3.9000000000000004, -15.3, -3.3, -12.7, -18.0, -3.3, -9.2, -13.399999999999999, -3.3, -7.399999999999999, -13.099999999999996, -12.799999999999999, -15.799999999999997, -10.899999999999999, -9.2, -13.399999999999999, -3.3, -5.2, -17.5, -18.899999999999988, -4.2, -16.099999999999994, -9.099999999999998, -10.5, -11.199999999999996, -16.099999999999994, -19.100000000000005, -17.0, -3.6000000000000005, -19.20000000000001, -5.2, -15.899999999999999, -13.5, -3.3, -3.3, -17.2, -15.299999999999997, -9.6, -6.199999999999999, -20.800000000000004, -10.9, -20.2, -15.3, -11.599999999999998, -35.0, -14.1, -7.6, -3.3, -4.4, -11.2, -5.4, -9.899999999999997, -18.599999999999994, -6.3, -3.3, -11.899999999999999, -7.399999999999999, -15.099999999999998, -1.3, -4.800000000000001, -3.2, -8.899999999999999, -8.799999999999997, -10.199999999999998, -15.899999999999999, -14.499999999999998, -13.299999999999995, -8.3, -4.300000000000001, -2.3000000000000003, -11.2, -13.3, -3.3, -6.199999999999999, -4.699999999999998, -3.2, -12.099999999999998, -3.3, -6.899999999999999, -3.3, -3.3, -21.2, -17.500000000000004, -15.599999999999998, -20.8, -8.3, -10.799999999999999, -5.0, -12.5, -20.1, -13.399999999999993], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.104574958733633, "mean_inference_ms": 1.4169707735622685, "mean_action_processing_ms": 0.07921003111243263, "mean_env_wait_ms": 6.443026750661385, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 336000, "timesteps_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"sample_time_ms": 24158.417, "sample_throughput": 165.574, "load_time_ms": 0.487, "load_throughput": 8220901.607, "learn_time_ms": 12001.03, "learn_throughput": 333.305, "update_time_ms": 2.637}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.07498939427777485, "policy_loss": -0.006012920079933059, "vf_loss": 8.043869793094615, "vf_explained_var": 0.34361857483463903, "kl": 0.0066799414593494, "entropy": 0.22194458532237238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 336000, "num_agent_steps_sampled": 336000, "num_steps_trained": 336000, "num_agent_steps_trained": 336000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3392, "training_iteration": 84, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-34-06", "timestamp": 1643646846, "time_this_iter_s": 26.385896921157837, "time_total_s": 1525.932622909546, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1525.932622909546, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 47.42368421052631, "ram_util_percent": 61.48947368421051}}
{"episode_reward_max": -1.3, "episode_reward_min": -46.80000000000005, "episode_reward_mean": -12.1, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.899999999999999, -13.5, -3.3, -3.3, -17.2, -15.299999999999997, -9.6, -6.199999999999999, -20.800000000000004, -10.9, -20.2, -15.3, -11.599999999999998, -35.0, -14.1, -7.6, -3.3, -4.4, -11.2, -5.4, -9.899999999999997, -18.599999999999994, -6.3, -3.3, -11.899999999999999, -7.399999999999999, -15.099999999999998, -1.3, -4.800000000000001, -3.2, -8.899999999999999, -8.799999999999997, -10.199999999999998, -15.899999999999999, -14.499999999999998, -13.299999999999995, -8.3, -4.300000000000001, -2.3000000000000003, -11.2, -13.3, -3.3, -6.199999999999999, -4.699999999999998, -3.2, -12.099999999999998, -3.3, -6.899999999999999, -3.3, -3.3, -21.2, -17.500000000000004, -15.599999999999998, -20.8, -8.3, -10.799999999999999, -5.0, -12.5, -20.1, -13.399999999999993, -23.00000000000001, -46.80000000000005, -4.300000000000001, -15.899999999999999, -23.600000000000005, -11.599999999999998, -14.999999999999998, -4.300000000000001, -13.2, -25.3, -11.6, -11.299999999999999, -3.6000000000000005, -24.1, -16.2, -21.20000000000001, -13.699999999999982, -7.999999999999999, -12.999999999999998, -11.3, -16.799999999999997, -33.2, -3.2, -27.600000000000033, -16.2, -7.3, -3.3, -4.3, -10.999999999999998, -25.6, -3.3, -29.30000000000001, -16.7, -10.1, -19.200000000000003, -7.2, -8.2, -3.3, -3.2, -15.599999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1094627016086802, "mean_inference_ms": 1.4245448024345069, "mean_action_processing_ms": 0.07963644082896669, "mean_env_wait_ms": 6.478872283086548, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 340000, "timesteps_this_iter": 0, "agent_timesteps_total": 340000, "timers": {"sample_time_ms": 24968.344, "sample_throughput": 160.203, "load_time_ms": 0.484, "load_throughput": 8259349.185, "learn_time_ms": 12797.234, "learn_throughput": 312.568, "update_time_ms": 2.867}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.2042718541558071, "policy_loss": -0.0060744183999235915, "vf_loss": 20.983625290534828, "vf_explained_var": 0.19651653997359736, "kl": 0.006044699834205943, "entropy": 0.2208878328763349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 340000, "num_agent_steps_sampled": 340000, "num_steps_trained": 340000, "num_agent_steps_trained": 340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3432, "training_iteration": 85, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-34-39", "timestamp": 1643646879, "time_this_iter_s": 32.77525210380554, "time_total_s": 1558.7078750133514, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1558.7078750133514, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 62.36808510638299, "ram_util_percent": 62.05957446808509}}
{"episode_reward_max": -3.2, "episode_reward_min": -46.80000000000005, "episode_reward_mean": -12.779000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.3, -3.3, -6.199999999999999, -4.699999999999998, -3.2, -12.099999999999998, -3.3, -6.899999999999999, -3.3, -3.3, -21.2, -17.500000000000004, -15.599999999999998, -20.8, -8.3, -10.799999999999999, -5.0, -12.5, -20.1, -13.399999999999993, -23.00000000000001, -46.80000000000005, -4.300000000000001, -15.899999999999999, -23.600000000000005, -11.599999999999998, -14.999999999999998, -4.300000000000001, -13.2, -25.3, -11.6, -11.299999999999999, -3.6000000000000005, -24.1, -16.2, -21.20000000000001, -13.699999999999982, -7.999999999999999, -12.999999999999998, -11.3, -16.799999999999997, -33.2, -3.2, -27.600000000000033, -16.2, -7.3, -3.3, -4.3, -10.999999999999998, -25.6, -3.3, -29.30000000000001, -16.7, -10.1, -19.200000000000003, -7.2, -8.2, -3.3, -3.2, -15.599999999999998, -4.9, -3.3, -11.499999999999998, -19.099999999999994, -19.800000000000004, -4.3, -18.9, -6.300000000000001, -28.799999999999997, -16.5, -20.900000000000006, -3.3, -18.400000000000006, -11.2, -3.3, -16.099999999999994, -16.299999999999997, -7.5, -3.3, -3.3, -10.2, -29.799999999999997, -3.3, -15.799999999999999, -16.89999999999999, -11.7, -4.7, -3.2, -40.3, -3.2, -10.699999999999998, -11.799999999999997, -17.699999999999996, -3.2, -14.099999999999998, -10.1, -10.3, -21.90000000000003, -11.399999999999997, -4.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.119710836673677, "mean_inference_ms": 1.4386591346384403, "mean_action_processing_ms": 0.08045897975172896, "mean_env_wait_ms": 6.5499209779677185, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 344000, "timesteps_this_iter": 0, "agent_timesteps_total": 344000, "timers": {"sample_time_ms": 27056.055, "sample_throughput": 147.841, "load_time_ms": 0.52, "load_throughput": 7687507.331, "learn_time_ms": 13579.644, "learn_throughput": 294.559, "update_time_ms": 2.962}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.12569315724715752, "policy_loss": -0.008640518297831858, "vf_loss": 13.373741675705038, "vf_explained_var": 0.25237054805601794, "kl": 0.0070667930742507505, "entropy": 0.19411387544686115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 344000, "num_agent_steps_sampled": 344000, "num_steps_trained": 344000, "num_agent_steps_trained": 344000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3472, "training_iteration": 86, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-35-20", "timestamp": 1643646920, "time_this_iter_s": 40.70210099220276, "time_total_s": 1599.4099760055542, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1599.4099760055542, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 67.96724137931034, "ram_util_percent": 62.11206896551725}}
{"episode_reward_max": -1.0, "episode_reward_min": -40.3, "episode_reward_mean": -12.744000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.799999999999997, -33.2, -3.2, -27.600000000000033, -16.2, -7.3, -3.3, -4.3, -10.999999999999998, -25.6, -3.3, -29.30000000000001, -16.7, -10.1, -19.200000000000003, -7.2, -8.2, -3.3, -3.2, -15.599999999999998, -4.9, -3.3, -11.499999999999998, -19.099999999999994, -19.800000000000004, -4.3, -18.9, -6.300000000000001, -28.799999999999997, -16.5, -20.900000000000006, -3.3, -18.400000000000006, -11.2, -3.3, -16.099999999999994, -16.299999999999997, -7.5, -3.3, -3.3, -10.2, -29.799999999999997, -3.3, -15.799999999999999, -16.89999999999999, -11.7, -4.7, -3.2, -40.3, -3.2, -10.699999999999998, -11.799999999999997, -17.699999999999996, -3.2, -14.099999999999998, -10.1, -10.3, -21.90000000000003, -11.399999999999997, -4.2, -4.2, -13.999999999999998, -14.299999999999999, -17.6, -1.0, -14.2, -3.3, -4.300000000000001, -12.499999999999998, -13.799999999999999, -13.3, -6.4, -9.3, -17.0, -3.3, -25.10000000000001, -21.9, -18.800000000000004, -18.2, -8.8, -10.199999999999998, -11.999999999999996, -11.3, -14.5, -19.10000000000001, -36.100000000000044, -17.000000000000004, -15.3, -7.3, -23.6, -4.2, -5.4, -11.899999999999999, -20.0, -27.999999999999996, -3.5, -17.700000000000003, -9.3, -3.2, -7.399999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.131784064338515, "mean_inference_ms": 1.4543912167791213, "mean_action_processing_ms": 0.08138214574942067, "mean_env_wait_ms": 6.630420728018262, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 348000, "timesteps_this_iter": 0, "agent_timesteps_total": 348000, "timers": {"sample_time_ms": 28484.849, "sample_throughput": 140.426, "load_time_ms": 0.543, "load_throughput": 7369417.552, "learn_time_ms": 14205.994, "learn_throughput": 281.571, "update_time_ms": 3.046}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.1378288119185155, "policy_loss": -0.015133578751877111, "vf_loss": 15.209168346979284, "vf_explained_var": 0.2726113102769339, "kl": 0.010319499085576504, "entropy": 0.22742274492498368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 348000, "num_agent_steps_sampled": 348000, "num_steps_trained": 348000, "num_agent_steps_trained": 348000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3512, "training_iteration": 87, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-35-55", "timestamp": 1643646955, "time_this_iter_s": 35.40997338294983, "time_total_s": 1634.819949388504, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1634.819949388504, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 56.90199999999999, "ram_util_percent": 62.18199999999999}}
{"episode_reward_max": -1.0, "episode_reward_min": -129.2, "episode_reward_mean": -15.126000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.2, -29.799999999999997, -3.3, -15.799999999999999, -16.89999999999999, -11.7, -4.7, -3.2, -40.3, -3.2, -10.699999999999998, -11.799999999999997, -17.699999999999996, -3.2, -14.099999999999998, -10.1, -10.3, -21.90000000000003, -11.399999999999997, -4.2, -4.2, -13.999999999999998, -14.299999999999999, -17.6, -1.0, -14.2, -3.3, -4.300000000000001, -12.499999999999998, -13.799999999999999, -13.3, -6.4, -9.3, -17.0, -3.3, -25.10000000000001, -21.9, -18.800000000000004, -18.2, -8.8, -10.199999999999998, -11.999999999999996, -11.3, -14.5, -19.10000000000001, -36.100000000000044, -17.000000000000004, -15.3, -7.3, -23.6, -4.2, -5.4, -11.899999999999999, -20.0, -27.999999999999996, -3.5, -17.700000000000003, -9.3, -3.2, -7.399999999999999, -7.499999999999998, -21.00000000000003, -3.8000000000000003, -40.3, -8.2, -17.6, -3.2, -15.49999999999998, -3.4, -17.099999999999998, -16.099999999999998, -8.3, -7.899999999999999, -17.099999999999998, -19.900000000000006, -7.7, -15.099999999999998, -20.9, -9.099999999999996, -31.300000000000043, -12.0, -2.6000000000000005, -20.700000000000014, -3.2, -23.600000000000005, -3.3, -12.499999999999998, -36.5, -17.199999999999996, -81.2, -14.199999999999998, -3.3000000000000003, -3.2, -17.8, -4.3, -22.2, -18.299999999999997, -11.3, -129.2, -12.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1403580655192282, "mean_inference_ms": 1.4656302472777873, "mean_action_processing_ms": 0.0820298559398886, "mean_env_wait_ms": 6.686899560143521, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 352000, "timesteps_this_iter": 0, "agent_timesteps_total": 352000, "timers": {"sample_time_ms": 29197.671, "sample_throughput": 136.997, "load_time_ms": 0.545, "load_throughput": 7338472.575, "learn_time_ms": 14133.783, "learn_throughput": 283.01, "update_time_ms": 3.069}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 1.1246321233167182, "policy_loss": -0.008442795706752647, "vf_loss": 113.22770748369156, "vf_explained_var": -0.011732914306784189, "kl": 0.009456349670797481, "entropy": 0.240053890645504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 352000, "num_agent_steps_sampled": 352000, "num_steps_trained": 352000, "num_agent_steps_trained": 352000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3552, "training_iteration": 88, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-36-20", "timestamp": 1643646980, "time_this_iter_s": 24.175053119659424, "time_total_s": 1658.9950025081635, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1658.9950025081635, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 37.097142857142856, "ram_util_percent": 62.20285714285713}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -129.2, "episode_reward_mean": -14.812999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.199999999999998, -11.999999999999996, -11.3, -14.5, -19.10000000000001, -36.100000000000044, -17.000000000000004, -15.3, -7.3, -23.6, -4.2, -5.4, -11.899999999999999, -20.0, -27.999999999999996, -3.5, -17.700000000000003, -9.3, -3.2, -7.399999999999999, -7.499999999999998, -21.00000000000003, -3.8000000000000003, -40.3, -8.2, -17.6, -3.2, -15.49999999999998, -3.4, -17.099999999999998, -16.099999999999998, -8.3, -7.899999999999999, -17.099999999999998, -19.900000000000006, -7.7, -15.099999999999998, -20.9, -9.099999999999996, -31.300000000000043, -12.0, -2.6000000000000005, -20.700000000000014, -3.2, -23.600000000000005, -3.3, -12.499999999999998, -36.5, -17.199999999999996, -81.2, -14.199999999999998, -3.3000000000000003, -3.2, -17.8, -4.3, -22.2, -18.299999999999997, -11.3, -129.2, -12.2, -9.0, -26.299999999999997, -26.3, -12.699999999999998, -10.199999999999992, -33.6, -3.2, -8.2, -11.0, -22.5, -3.2, -8.3, -10.399999999999997, -7.9, -7.699999999999998, -3.3, -4.4, -11.7, -3.3, -4.300000000000001, -3.3, -4.4, -7.3, -3.2, -23.599999999999998, -17.799999999999997, -5.4, -17.699999999999996, -21.7, -11.5, -28.700000000000003, -3.4, -10.2, -5.6000000000000005, -23.200000000000003, -3.3, -3.3, -22.000000000000004, -7.399999999999999, -14.0], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1452586287275621, "mean_inference_ms": 1.4728309288184755, "mean_action_processing_ms": 0.08242595810857434, "mean_env_wait_ms": 6.7211997942864095, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 356000, "timesteps_this_iter": 0, "agent_timesteps_total": 356000, "timers": {"sample_time_ms": 29112.049, "sample_throughput": 137.4, "load_time_ms": 0.59, "load_throughput": 6781139.0, "learn_time_ms": 14143.489, "learn_throughput": 282.816, "update_time_ms": 3.054}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.17912495815450505, "policy_loss": -0.012180041187312654, "vf_loss": 19.075462323619472, "vf_explained_var": 0.10869667824878487, "kl": 0.006523048000089333, "entropy": 0.19039963180980374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 356000, "num_agent_steps_sampled": 356000, "num_steps_trained": 356000, "num_agent_steps_trained": 356000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3592, "training_iteration": 89, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-36-48", "timestamp": 1643647008, "time_this_iter_s": 27.97208595275879, "time_total_s": 1686.9670884609222, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1686.9670884609222, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 52.31794871794872, "ram_util_percent": 62.289743589743615}}
{"episode_reward_max": -2.2, "episode_reward_min": -129.2, "episode_reward_mean": -13.542, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.600000000000005, -3.3, -12.499999999999998, -36.5, -17.199999999999996, -81.2, -14.199999999999998, -3.3000000000000003, -3.2, -17.8, -4.3, -22.2, -18.299999999999997, -11.3, -129.2, -12.2, -9.0, -26.299999999999997, -26.3, -12.699999999999998, -10.199999999999992, -33.6, -3.2, -8.2, -11.0, -22.5, -3.2, -8.3, -10.399999999999997, -7.9, -7.699999999999998, -3.3, -4.4, -11.7, -3.3, -4.300000000000001, -3.3, -4.4, -7.3, -3.2, -23.599999999999998, -17.799999999999997, -5.4, -17.699999999999996, -21.7, -11.5, -28.700000000000003, -3.4, -10.2, -5.6000000000000005, -23.200000000000003, -3.3, -3.3, -22.000000000000004, -7.399999999999999, -14.0, -3.3, -24.00000000000006, -2.2, -10.099999999999998, -5.7, -5.9, -17.5, -9.199999999999998, -12.299999999999999, -19.1, -14.799999999999999, -10.3, -6.5, -3.2, -31.2, -3.3, -8.799999999999999, -14.299999999999995, -9.899999999999999, -4.7, -3.3, -13.899999999999997, -10.99999999999999, -13.3, -3.5000000000000004, -6.199999999999999, -7.800000000000001, -28.5, -6.299999999999999, -15.799999999999999, -11.6, -3.3, -3.2, -11.399999999999997, -7.2, -21.800000000000047, -29.0, -18.699999999999996, -10.2, -3.3, -3.3, -15.999999999999991, -6.2, -8.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1515542380184636, "mean_inference_ms": 1.4800843827697543, "mean_action_processing_ms": 0.08286773434102683, "mean_env_wait_ms": 6.756788767060024, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 360000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"sample_time_ms": 29171.497, "sample_throughput": 137.12, "load_time_ms": 0.639, "load_throughput": 6258987.502, "learn_time_ms": 13883.652, "learn_throughput": 288.109, "update_time_ms": 2.887}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.1295080780792701, "policy_loss": -0.015867782212914, "vf_loss": 14.453358880806995, "vf_explained_var": 0.16609693637458228, "kl": 0.009982516685289938, "entropy": 0.21539424720310396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 360000, "num_steps_trained": 360000, "num_agent_steps_trained": 360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3636, "training_iteration": 90, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-37-15", "timestamp": 1643647035, "time_this_iter_s": 26.874576091766357, "time_total_s": 1713.8416645526886, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1713.8416645526886, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 43.60256410256411, "ram_util_percent": 62.274358974359}}
{"episode_reward_max": -2.2, "episode_reward_min": -31.2, "episode_reward_mean": -11.667, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.599999999999998, -17.799999999999997, -5.4, -17.699999999999996, -21.7, -11.5, -28.700000000000003, -3.4, -10.2, -5.6000000000000005, -23.200000000000003, -3.3, -3.3, -22.000000000000004, -7.399999999999999, -14.0, -3.3, -24.00000000000006, -2.2, -10.099999999999998, -5.7, -5.9, -17.5, -9.199999999999998, -12.299999999999999, -19.1, -14.799999999999999, -10.3, -6.5, -3.2, -31.2, -3.3, -8.799999999999999, -14.299999999999995, -9.899999999999999, -4.7, -3.3, -13.899999999999997, -10.99999999999999, -13.3, -3.5000000000000004, -6.199999999999999, -7.800000000000001, -28.5, -6.299999999999999, -15.799999999999999, -11.6, -3.3, -3.2, -11.399999999999997, -7.2, -21.800000000000047, -29.0, -18.699999999999996, -10.2, -3.3, -3.3, -15.999999999999991, -6.2, -8.3, -7.2, -5.699999999999999, -5.300000000000001, -13.999999999999991, -5.899999999999999, -12.6, -9.2, -13.699999999999998, -17.2, -12.899999999999997, -6.4, -8.700000000000001, -3.8000000000000007, -3.3, -9.1, -3.3, -18.6, -12.999999999999998, -13.799999999999995, -3.4, -6.399999999999999, -14.7, -5.1, -15.999999999999998, -16.2, -12.999999999999998, -28.700000000000006, -16.2, -17.5, -20.200000000000028, -28.3, -8.9, -8.899999999999999, -3.3, -4.300000000000001, -18.5, -17.800000000000004, -12.7, -9.0, -15.7], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1575482715214833, "mean_inference_ms": 1.4876302821262917, "mean_action_processing_ms": 0.08327693812059389, "mean_env_wait_ms": 6.79352886786271, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 364000, "timesteps_this_iter": 0, "agent_timesteps_total": 364000, "timers": {"sample_time_ms": 28725.805, "sample_throughput": 139.248, "load_time_ms": 0.635, "load_throughput": 6300591.858, "learn_time_ms": 13952.369, "learn_throughput": 286.69, "update_time_ms": 2.865}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.0975413100082948, "policy_loss": -0.012074780860735525, "vf_loss": 10.890501722725489, "vf_explained_var": 0.07345500710189984, "kl": 0.008427579531163805, "entropy": 0.18955349898947182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 364000, "num_agent_steps_sampled": 364000, "num_steps_trained": 364000, "num_agent_steps_trained": 364000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3676, "training_iteration": 91, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-37-43", "timestamp": 1643647063, "time_this_iter_s": 28.098017930984497, "time_total_s": 1741.939682483673, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1741.939682483673, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 51.57000000000001, "ram_util_percent": 62.2925}}
{"episode_reward_max": -3.2, "episode_reward_min": -79.5000000000001, "episode_reward_mean": -12.819, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -6.199999999999999, -7.800000000000001, -28.5, -6.299999999999999, -15.799999999999999, -11.6, -3.3, -3.2, -11.399999999999997, -7.2, -21.800000000000047, -29.0, -18.699999999999996, -10.2, -3.3, -3.3, -15.999999999999991, -6.2, -8.3, -7.2, -5.699999999999999, -5.300000000000001, -13.999999999999991, -5.899999999999999, -12.6, -9.2, -13.699999999999998, -17.2, -12.899999999999997, -6.4, -8.700000000000001, -3.8000000000000007, -3.3, -9.1, -3.3, -18.6, -12.999999999999998, -13.799999999999995, -3.4, -6.399999999999999, -14.7, -5.1, -15.999999999999998, -16.2, -12.999999999999998, -28.700000000000006, -16.2, -17.5, -20.200000000000028, -28.3, -8.9, -8.899999999999999, -3.3, -4.300000000000001, -18.5, -17.800000000000004, -12.7, -9.0, -15.7, -8.7, -3.3, -8.3, -68.5, -9.3, -14.699999999999978, -11.1, -3.2, -10.0, -12.199999999999996, -10.399999999999999, -10.2, -19.7, -30.4, -4.4, -3.3, -3.4, -8.3, -21.89999999999999, -18.8, -21.5, -11.999999999999998, -9.6, -16.199999999999996, -9.2, -4.2, -27.500000000000046, -3.3, -20.3, -10.2, -9.2, -14.999999999999998, -5.4, -79.5000000000001, -8.3, -10.8, -4.2, -10.399999999999997, -26.6, -8.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1624073903027619, "mean_inference_ms": 1.4945822056127331, "mean_action_processing_ms": 0.08361723399960141, "mean_env_wait_ms": 6.827030871800186, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 368000, "timesteps_this_iter": 0, "agent_timesteps_total": 368000, "timers": {"sample_time_ms": 29011.084, "sample_throughput": 137.878, "load_time_ms": 0.666, "load_throughput": 6008816.303, "learn_time_ms": 14319.387, "learn_throughput": 279.342, "update_time_ms": 2.888}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.5967572824030574, "policy_loss": -0.0069902435555974, "vf_loss": 60.2648014656959, "vf_explained_var": 0.09156206666782338, "kl": 0.013031401252648806, "entropy": 0.2170408472458842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 368000, "num_agent_steps_sampled": 368000, "num_steps_trained": 368000, "num_agent_steps_trained": 368000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3716, "training_iteration": 92, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-38-11", "timestamp": 1643647091, "time_this_iter_s": 28.40703511238098, "time_total_s": 1770.346717596054, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1770.346717596054, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 50.529999999999994, "ram_util_percent": 62.245000000000005}}
{"episode_reward_max": -2.3, "episode_reward_min": -79.5000000000001, "episode_reward_mean": -12.774000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.399999999999999, -14.7, -5.1, -15.999999999999998, -16.2, -12.999999999999998, -28.700000000000006, -16.2, -17.5, -20.200000000000028, -28.3, -8.9, -8.899999999999999, -3.3, -4.300000000000001, -18.5, -17.800000000000004, -12.7, -9.0, -15.7, -8.7, -3.3, -8.3, -68.5, -9.3, -14.699999999999978, -11.1, -3.2, -10.0, -12.199999999999996, -10.399999999999999, -10.2, -19.7, -30.4, -4.4, -3.3, -3.4, -8.3, -21.89999999999999, -18.8, -21.5, -11.999999999999998, -9.6, -16.199999999999996, -9.2, -4.2, -27.500000000000046, -3.3, -20.3, -10.2, -9.2, -14.999999999999998, -5.4, -79.5000000000001, -8.3, -10.8, -4.2, -10.399999999999997, -26.6, -8.3, -15.899999999999975, -4.300000000000001, -5.699999999999999, -14.399999999999974, -8.0, -8.600000000000001, -3.3, -3.2, -10.299999999999997, -4.4, -13.999999999999996, -7.3, -4.300000000000001, -4.4, -9.5, -4.2, -4.2, -8.3, -10.199999999999998, -4.3, -4.2, -12.799999999999999, -24.499999999999996, -26.4, -10.7, -7.5, -18.099999999999998, -13.099999999999977, -3.5, -20.9, -3.3, -17.900000000000002, -2.3, -3.3, -10.1, -14.799999999999997, -8.2, -24.5, -26.1, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1659832712247094, "mean_inference_ms": 1.500368162674543, "mean_action_processing_ms": 0.08392250502648213, "mean_env_wait_ms": 6.853558140554217, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 372000, "timesteps_this_iter": 0, "agent_timesteps_total": 372000, "timers": {"sample_time_ms": 29414.634, "sample_throughput": 135.987, "load_time_ms": 0.692, "load_throughput": 5778870.212, "learn_time_ms": 14415.089, "learn_throughput": 277.487, "update_time_ms": 2.976}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.08872366124683971, "policy_loss": -0.011711987855053077, "vf_loss": 9.97980712818843, "vf_explained_var": 0.17412405558811722, "kl": 0.007556511605711589, "entropy": 0.204534899996173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 372000, "num_agent_steps_sampled": 372000, "num_steps_trained": 372000, "num_agent_steps_trained": 372000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3756, "training_iteration": 93, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-38-35", "timestamp": 1643647115, "time_this_iter_s": 23.80417776107788, "time_total_s": 1794.150895357132, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1794.150895357132, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 42.964705882352945, "ram_util_percent": 62.19999999999999}}
{"episode_reward_max": -2.3, "episode_reward_min": -79.5000000000001, "episode_reward_mean": -11.791000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.5, -11.999999999999998, -9.6, -16.199999999999996, -9.2, -4.2, -27.500000000000046, -3.3, -20.3, -10.2, -9.2, -14.999999999999998, -5.4, -79.5000000000001, -8.3, -10.8, -4.2, -10.399999999999997, -26.6, -8.3, -15.899999999999975, -4.300000000000001, -5.699999999999999, -14.399999999999974, -8.0, -8.600000000000001, -3.3, -3.2, -10.299999999999997, -4.4, -13.999999999999996, -7.3, -4.300000000000001, -4.4, -9.5, -4.2, -4.2, -8.3, -10.199999999999998, -4.3, -4.2, -12.799999999999999, -24.499999999999996, -26.4, -10.7, -7.5, -18.099999999999998, -13.099999999999977, -3.5, -20.9, -3.3, -17.900000000000002, -2.3, -3.3, -10.1, -14.799999999999997, -8.2, -24.5, -26.1, -3.2, -8.3, -9.599999999999998, -3.2, -20.200000000000003, -3.3, -4.300000000000001, -13.399999999999997, -4.4, -4.300000000000001, -18.5, -18.5, -15.499999999999996, -19.799999999999997, -19.5, -3.2, -17.9, -14.699999999999992, -13.8, -8.2, -25.3, -11.899999999999999, -15.899999999999997, -23.6, -5.2, -32.29999999999995, -4.3, -12.2, -13.199999999999998, -13.2, -19.599999999999998, -10.899999999999999, -7.599999999999999, -3.3, -4.2, -9.399999999999999, -3.3, -3.3, -4.300000000000001, -12.4, -7.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1685658241015302, "mean_inference_ms": 1.5038525221718038, "mean_action_processing_ms": 0.08410444345127101, "mean_env_wait_ms": 6.869568003385768, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 376000, "timesteps_this_iter": 0, "agent_timesteps_total": 376000, "timers": {"sample_time_ms": 29326.364, "sample_throughput": 136.396, "load_time_ms": 0.691, "load_throughput": 5789838.838, "learn_time_ms": 14185.266, "learn_throughput": 281.983, "update_time_ms": 2.831}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.0690025665066255, "policy_loss": -0.015727463363099003, "vf_loss": 8.431017947901962, "vf_explained_var": 0.3334084961363064, "kl": 0.004976035439764143, "entropy": 0.14655925300252695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 376000, "num_agent_steps_sampled": 376000, "num_steps_trained": 376000, "num_agent_steps_trained": 376000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3796, "training_iteration": 94, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-38-57", "timestamp": 1643647137, "time_this_iter_s": 22.24153709411621, "time_total_s": 1816.3924324512482, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1816.3924324512482, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 41.4375, "ram_util_percent": 62.150000000000006}}
{"episode_reward_max": -2.3, "episode_reward_min": -32.29999999999995, "episode_reward_mean": -10.405999999999997, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -12.799999999999999, -24.499999999999996, -26.4, -10.7, -7.5, -18.099999999999998, -13.099999999999977, -3.5, -20.9, -3.3, -17.900000000000002, -2.3, -3.3, -10.1, -14.799999999999997, -8.2, -24.5, -26.1, -3.2, -8.3, -9.599999999999998, -3.2, -20.200000000000003, -3.3, -4.300000000000001, -13.399999999999997, -4.4, -4.300000000000001, -18.5, -18.5, -15.499999999999996, -19.799999999999997, -19.5, -3.2, -17.9, -14.699999999999992, -13.8, -8.2, -25.3, -11.899999999999999, -15.899999999999997, -23.6, -5.2, -32.29999999999995, -4.3, -12.2, -13.199999999999998, -13.2, -19.599999999999998, -10.899999999999999, -7.599999999999999, -3.3, -4.2, -9.399999999999999, -3.3, -3.3, -4.300000000000001, -12.4, -7.2, -3.3, -3.3, -3.2, -3.3, -3.3, -24.2, -7.2, -3.3, -14.7, -10.100000000000001, -4.2, -3.4, -12.1, -9.999999999999998, -8.3, -3.3, -3.4, -12.9, -8.199999999999998, -9.7, -3.2, -3.3, -7.2, -11.999999999999998, -14.799999999999999, -29.5, -4.300000000000001, -3.3, -8.5, -3.2, -28.599999999999998, -3.3, -3.3, -3.3, -3.3, -3.3, -10.199999999999998, -9.0, -12.7, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1706212862461114, "mean_inference_ms": 1.5061187222981567, "mean_action_processing_ms": 0.08423538790216072, "mean_env_wait_ms": 6.881269016310473, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 380000, "timesteps_this_iter": 0, "agent_timesteps_total": 380000, "timers": {"sample_time_ms": 28708.248, "sample_throughput": 139.333, "load_time_ms": 0.702, "load_throughput": 5696654.103, "learn_time_ms": 13552.157, "learn_throughput": 295.156, "update_time_ms": 2.564}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.04154620529402808, "policy_loss": -0.008762900910830946, "vf_loss": 4.992129046133449, "vf_explained_var": 0.4436562900261212, "kl": 0.00919275262479012, "entropy": 0.11570951265673483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 380000, "num_agent_steps_sampled": 380000, "num_steps_trained": 380000, "num_agent_steps_trained": 380000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3836, "training_iteration": 95, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-39-20", "timestamp": 1643647160, "time_this_iter_s": 22.56733775138855, "time_total_s": 1838.9597702026367, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1838.9597702026367, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 45.109375, "ram_util_percent": 62.23125}}
{"episode_reward_max": -2.3, "episode_reward_min": -32.29999999999995, "episode_reward_mean": -9.54, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.899999999999999, -15.899999999999997, -23.6, -5.2, -32.29999999999995, -4.3, -12.2, -13.199999999999998, -13.2, -19.599999999999998, -10.899999999999999, -7.599999999999999, -3.3, -4.2, -9.399999999999999, -3.3, -3.3, -4.300000000000001, -12.4, -7.2, -3.3, -3.3, -3.2, -3.3, -3.3, -24.2, -7.2, -3.3, -14.7, -10.100000000000001, -4.2, -3.4, -12.1, -9.999999999999998, -8.3, -3.3, -3.4, -12.9, -8.199999999999998, -9.7, -3.2, -3.3, -7.2, -11.999999999999998, -14.799999999999999, -29.5, -4.300000000000001, -3.3, -8.5, -3.2, -28.599999999999998, -3.3, -3.3, -3.3, -3.3, -3.3, -10.199999999999998, -9.0, -12.7, -4.300000000000001, -14.899999999999999, -16.5, -3.3, -15.099999999999975, -3.3, -3.3, -25.400000000000013, -6.299999999999999, -6.6000000000000005, -3.2, -3.3, -16.799999999999997, -9.7, -10.700000000000001, -4.4, -28.500000000000004, -10.200000000000001, -9.1, -10.2, -4.300000000000001, -12.3, -11.7, -21.700000000000003, -7.5, -7.3, -22.099999999999998, -13.299999999999999, -2.3, -3.2, -16.09999999999998, -4.3, -3.3, -9.2, -15.199999999999996, -8.2, -3.3, -8.9, -7.3, -20.699999999999996, -11.7], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1725447592703646, "mean_inference_ms": 1.5083207703818438, "mean_action_processing_ms": 0.08435841046681318, "mean_env_wait_ms": 6.892491501332156, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 384000, "timesteps_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"sample_time_ms": 26945.231, "sample_throughput": 148.449, "load_time_ms": 0.668, "load_throughput": 5984595.848, "learn_time_ms": 13347.832, "learn_throughput": 299.674, "update_time_ms": 2.687}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.08850893580344736, "policy_loss": -0.016605851344604006, "vf_loss": 10.460067583348161, "vf_explained_var": 0.33903694851424104, "kl": 0.012186369912357409, "entropy": 0.17764107598572648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 384000, "num_agent_steps_sampled": 384000, "num_steps_trained": 384000, "num_agent_steps_trained": 384000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3876, "training_iteration": 96, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-39-47", "timestamp": 1643647187, "time_this_iter_s": 27.416099071502686, "time_total_s": 1866.3758692741394, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1866.3758692741394, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 56.17435897435897, "ram_util_percent": 62.30256410256413}}
{"episode_reward_max": -2.3, "episode_reward_min": -29.5, "episode_reward_mean": -9.989999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -3.3, -7.2, -11.999999999999998, -14.799999999999999, -29.5, -4.300000000000001, -3.3, -8.5, -3.2, -28.599999999999998, -3.3, -3.3, -3.3, -3.3, -3.3, -10.199999999999998, -9.0, -12.7, -4.300000000000001, -14.899999999999999, -16.5, -3.3, -15.099999999999975, -3.3, -3.3, -25.400000000000013, -6.299999999999999, -6.6000000000000005, -3.2, -3.3, -16.799999999999997, -9.7, -10.700000000000001, -4.4, -28.500000000000004, -10.200000000000001, -9.1, -10.2, -4.300000000000001, -12.3, -11.7, -21.700000000000003, -7.5, -7.3, -22.099999999999998, -13.299999999999999, -2.3, -3.2, -16.09999999999998, -4.3, -3.3, -9.2, -15.199999999999996, -8.2, -3.3, -8.9, -7.3, -20.699999999999996, -11.7, -9.600000000000001, -9.3, -12.799999999999995, -3.2, -8.3, -12.499999999999998, -4.2, -8.600000000000001, -16.79999999999999, -15.399999999999999, -5.5, -7.999999999999999, -15.599999999999975, -6.4, -28.200000000000014, -7.9, -11.3, -4.2, -4.2, -21.79999999999999, -11.700000000000001, -8.2, -18.199999999999996, -12.3, -8.2, -15.999999999999993, -3.8000000000000003, -10.399999999999999, -4.2, -8.3, -10.2, -3.3, -4.2, -10.8, -10.099999999999996, -7.2, -13.8, -13.3, -11.7, -14.0], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1789102221289378, "mean_inference_ms": 1.5168559113649902, "mean_action_processing_ms": 0.08484351197814481, "mean_env_wait_ms": 6.936665064202539, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 388000, "timesteps_this_iter": 0, "agent_timesteps_total": 388000, "timers": {"sample_time_ms": 27269.783, "sample_throughput": 146.683, "load_time_ms": 0.654, "load_throughput": 6114145.773, "learn_time_ms": 13002.922, "learn_throughput": 307.623, "update_time_ms": 2.719}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.08055847681588142, "policy_loss": -0.008519890447778086, "vf_loss": 8.867705684964374, "vf_explained_var": 0.35624676936416216, "kl": 0.009512579963299003, "entropy": 0.1867886037435583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 388000, "num_agent_steps_sampled": 388000, "num_steps_trained": 388000, "num_agent_steps_trained": 388000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3916, "training_iteration": 97, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-40-25", "timestamp": 1643647225, "time_this_iter_s": 37.214669942855835, "time_total_s": 1903.5905392169952, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1903.5905392169952, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 61.76037735849058, "ram_util_percent": 62.292452830188665}}
{"episode_reward_max": -2.3, "episode_reward_min": -52.20000000000004, "episode_reward_mean": -10.636999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.3, -11.7, -21.700000000000003, -7.5, -7.3, -22.099999999999998, -13.299999999999999, -2.3, -3.2, -16.09999999999998, -4.3, -3.3, -9.2, -15.199999999999996, -8.2, -3.3, -8.9, -7.3, -20.699999999999996, -11.7, -9.600000000000001, -9.3, -12.799999999999995, -3.2, -8.3, -12.499999999999998, -4.2, -8.600000000000001, -16.79999999999999, -15.399999999999999, -5.5, -7.999999999999999, -15.599999999999975, -6.4, -28.200000000000014, -7.9, -11.3, -4.2, -4.2, -21.79999999999999, -11.700000000000001, -8.2, -18.199999999999996, -12.3, -8.2, -15.999999999999993, -3.8000000000000003, -10.399999999999999, -4.2, -8.3, -10.2, -3.3, -4.2, -10.8, -10.099999999999996, -7.2, -13.8, -13.3, -11.7, -14.0, -3.2, -16.4, -3.2, -22.199999999999957, -4.2, -9.4, -4.2, -5.300000000000001, -17.199999999999996, -5.4, -9.3, -13.7, -3.3, -3.3, -14.099999999999996, -3.3, -18.599999999999998, -14.4, -8.1, -11.5, -19.6, -7.799999999999999, -8.2, -3.3, -23.2, -14.799999999999999, -9.999999999999998, -5.4, -4.300000000000001, -16.3, -5.300000000000001, -9.3, -3.2, -5.3, -12.799999999999999, -52.20000000000004, -19.6, -8.5, -8.6, -12.399999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1847194120953426, "mean_inference_ms": 1.5256140992814704, "mean_action_processing_ms": 0.08534061905281863, "mean_env_wait_ms": 6.981347308945499, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 392000, "timesteps_this_iter": 0, "agent_timesteps_total": 392000, "timers": {"sample_time_ms": 26859.648, "sample_throughput": 148.922, "load_time_ms": 0.654, "load_throughput": 6116151.799, "learn_time_ms": 13138.906, "learn_throughput": 304.439, "update_time_ms": 2.706}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.1543685363946102, "policy_loss": -0.010067533176412345, "vf_loss": 16.405960471912095, "vf_explained_var": 0.3125835205918999, "kl": 0.008923664756873444, "entropy": 0.14957267426915707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 392000, "num_agent_steps_sampled": 392000, "num_steps_trained": 392000, "num_agent_steps_trained": 392000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3956, "training_iteration": 98, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-40-50", "timestamp": 1643647250, "time_this_iter_s": 24.883754014968872, "time_total_s": 1928.474293231964, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1928.474293231964, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 39.51428571428572, "ram_util_percent": 62.20857142857142}}
{"episode_reward_max": -3.2, "episode_reward_min": -52.20000000000004, "episode_reward_mean": -10.977000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.2, -15.999999999999993, -3.8000000000000003, -10.399999999999999, -4.2, -8.3, -10.2, -3.3, -4.2, -10.8, -10.099999999999996, -7.2, -13.8, -13.3, -11.7, -14.0, -3.2, -16.4, -3.2, -22.199999999999957, -4.2, -9.4, -4.2, -5.300000000000001, -17.199999999999996, -5.4, -9.3, -13.7, -3.3, -3.3, -14.099999999999996, -3.3, -18.599999999999998, -14.4, -8.1, -11.5, -19.6, -7.799999999999999, -8.2, -3.3, -23.2, -14.799999999999999, -9.999999999999998, -5.4, -4.300000000000001, -16.3, -5.300000000000001, -9.3, -3.2, -5.3, -12.799999999999999, -52.20000000000004, -19.6, -8.5, -8.6, -12.399999999999997, -18.0, -7.2, -21.2, -4.300000000000001, -25.9, -24.900000000000002, -8.2, -5.8, -18.4, -17.299999999999997, -3.3, -3.2, -23.700000000000003, -18.700000000000024, -3.3, -13.799999999999999, -3.2, -10.5, -6.1, -3.4, -7.3, -9.3, -7.800000000000001, -16.3, -7.399999999999999, -6.3999999999999995, -12.999999999999998, -6.3, -13.1, -27.90000000000005, -3.4, -19.400000000000002, -3.2, -4.4, -21.09999999999999, -14.5, -4.8999999999999995, -13.899999999999979, -7.2, -3.3, -3.3, -30.900000000000006, -4.2, -18.900000000000002], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1901870741414127, "mean_inference_ms": 1.5319397052605095, "mean_action_processing_ms": 0.08574060619079898, "mean_env_wait_ms": 7.013944873683474, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 396000, "timesteps_this_iter": 0, "agent_timesteps_total": 396000, "timers": {"sample_time_ms": 26880.685, "sample_throughput": 148.806, "load_time_ms": 0.62, "load_throughput": 6451534.705, "learn_time_ms": 12935.804, "learn_throughput": 309.219, "update_time_ms": 2.753}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.17181926628835098, "policy_loss": -0.0020625149570806054, "vf_loss": 17.364205154552256, "vf_explained_var": 0.18555896205286826, "kl": 0.0056825410033425425, "entropy": 0.1676580527877455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 396000, "num_agent_steps_sampled": 396000, "num_steps_trained": 396000, "num_agent_steps_trained": 396000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4000, "training_iteration": 99, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-41-14", "timestamp": 1643647274, "time_this_iter_s": 24.82244300842285, "time_total_s": 1953.296736240387, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1953.296736240387, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 45.98055555555556, "ram_util_percent": 62.2777777777778}}
{"episode_reward_max": -1.2, "episode_reward_min": -52.20000000000004, "episode_reward_mean": -12.356, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.2, -14.799999999999999, -9.999999999999998, -5.4, -4.300000000000001, -16.3, -5.300000000000001, -9.3, -3.2, -5.3, -12.799999999999999, -52.20000000000004, -19.6, -8.5, -8.6, -12.399999999999997, -18.0, -7.2, -21.2, -4.300000000000001, -25.9, -24.900000000000002, -8.2, -5.8, -18.4, -17.299999999999997, -3.3, -3.2, -23.700000000000003, -18.700000000000024, -3.3, -13.799999999999999, -3.2, -10.5, -6.1, -3.4, -7.3, -9.3, -7.800000000000001, -16.3, -7.399999999999999, -6.3999999999999995, -12.999999999999998, -6.3, -13.1, -27.90000000000005, -3.4, -19.400000000000002, -3.2, -4.4, -21.09999999999999, -14.5, -4.8999999999999995, -13.899999999999979, -7.2, -3.3, -3.3, -30.900000000000006, -4.2, -18.900000000000002, -11.299999999999995, -7.2, -17.700000000000003, -6.3, -3.2, -22.199999999999996, -8.2, -8.200000000000003, -4.2, -8.2, -3.3, -10.3, -20.9, -29.8, -12.799999999999997, -17.6, -8.600000000000001, -1.2, -6.2, -26.0, -28.9, -10.099999999999985, -10.500000000000002, -18.799999999999997, -10.999999999999998, -19.399999999999995, -18.6, -3.2, -32.3, -5.2, -10.5, -15.999999999999998, -15.099999999999996, -18.0, -3.2, -12.3, -13.3, -3.3, -8.2, -25.300000000000015], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1947845309426568, "mean_inference_ms": 1.5369168202692152, "mean_action_processing_ms": 0.08600940880654122, "mean_env_wait_ms": 7.036464313370081, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 400000, "timesteps_this_iter": 0, "agent_timesteps_total": 400000, "timers": {"sample_time_ms": 26732.862, "sample_throughput": 149.629, "load_time_ms": 0.567, "load_throughput": 7051027.99, "learn_time_ms": 12992.101, "learn_throughput": 307.879, "update_time_ms": 2.641}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.12274306901024594, "policy_loss": -0.007122910225022865, "vf_loss": 12.933095813182092, "vf_explained_var": 0.23047504040502734, "kl": 0.012682093708339181, "entropy": 0.1888351471553887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 400000, "num_agent_steps_sampled": 400000, "num_steps_trained": 400000, "num_agent_steps_trained": 400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4040, "training_iteration": 100, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-41-42", "timestamp": 1643647302, "time_this_iter_s": 27.955673694610596, "time_total_s": 1981.2524099349976, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1981.2524099349976, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 41.779999999999994, "ram_util_percent": 62.30499999999999}}
{"episode_reward_max": -1.2, "episode_reward_min": -37.2, "episode_reward_mean": -12.024, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.399999999999999, -6.3999999999999995, -12.999999999999998, -6.3, -13.1, -27.90000000000005, -3.4, -19.400000000000002, -3.2, -4.4, -21.09999999999999, -14.5, -4.8999999999999995, -13.899999999999979, -7.2, -3.3, -3.3, -30.900000000000006, -4.2, -18.900000000000002, -11.299999999999995, -7.2, -17.700000000000003, -6.3, -3.2, -22.199999999999996, -8.2, -8.200000000000003, -4.2, -8.2, -3.3, -10.3, -20.9, -29.8, -12.799999999999997, -17.6, -8.600000000000001, -1.2, -6.2, -26.0, -28.9, -10.099999999999985, -10.500000000000002, -18.799999999999997, -10.999999999999998, -19.399999999999995, -18.6, -3.2, -32.3, -5.2, -10.5, -15.999999999999998, -15.099999999999996, -18.0, -3.2, -12.3, -13.3, -3.3, -8.2, -25.300000000000015, -33.80000000000004, -31.600000000000005, -3.3, -3.2, -26.800000000000043, -3.2, -23.90000000000001, -9.7, -13.699999999999998, -18.300000000000004, -37.2, -11.499999999999998, -5.1, -3.2, -4.4, -9.3, -4.800000000000001, -3.3, -4.3, -16.599999999999984, -11.2, -5.5, -3.2, -27.800000000000047, -11.399999999999999, -12.499999999999998, -3.2, -3.6000000000000005, -4.3, -20.699999999999996, -17.499999999999996, -16.2, -7.599999999999989, -10.199999999999998, -3.2, -3.3, -3.3, -16.799999999999997, -7.100000000000001, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1990980560026738, "mean_inference_ms": 1.5416040644070097, "mean_action_processing_ms": 0.08622315343645663, "mean_env_wait_ms": 7.057492997768657, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 404000, "timesteps_this_iter": 0, "agent_timesteps_total": 404000, "timers": {"sample_time_ms": 26504.487, "sample_throughput": 150.918, "load_time_ms": 0.564, "load_throughput": 7098462.45, "learn_time_ms": 12756.215, "learn_throughput": 313.573, "update_time_ms": 2.619}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.14681538788761983, "policy_loss": -0.010786989383319373, "vf_loss": 15.692424514344944, "vf_explained_var": 0.11649694904204339, "kl": 0.016074329214508937, "entropy": 0.1616789444479891, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 404000, "num_agent_steps_sampled": 404000, "num_steps_trained": 404000, "num_agent_steps_trained": 404000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4080, "training_iteration": 101, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-42-05", "timestamp": 1643647325, "time_this_iter_s": 22.889981985092163, "time_total_s": 2004.1423919200897, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2004.1423919200897, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 33.95, "ram_util_percent": 62.287499999999994}}
{"episode_reward_max": -3.2, "episode_reward_min": -40.2, "episode_reward_mean": -12.045000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.9, -10.099999999999985, -10.500000000000002, -18.799999999999997, -10.999999999999998, -19.399999999999995, -18.6, -3.2, -32.3, -5.2, -10.5, -15.999999999999998, -15.099999999999996, -18.0, -3.2, -12.3, -13.3, -3.3, -8.2, -25.300000000000015, -33.80000000000004, -31.600000000000005, -3.3, -3.2, -26.800000000000043, -3.2, -23.90000000000001, -9.7, -13.699999999999998, -18.300000000000004, -37.2, -11.499999999999998, -5.1, -3.2, -4.4, -9.3, -4.800000000000001, -3.3, -4.3, -16.599999999999984, -11.2, -5.5, -3.2, -27.800000000000047, -11.399999999999999, -12.499999999999998, -3.2, -3.6000000000000005, -4.3, -20.699999999999996, -17.499999999999996, -16.2, -7.599999999999989, -10.199999999999998, -3.2, -3.3, -3.3, -16.799999999999997, -7.100000000000001, -3.3, -14.499999999999996, -25.50000000000004, -4.4, -11.7, -15.700000000000001, -12.3, -17.4, -3.3, -3.3, -7.2, -10.2, -25.5, -13.999999999999998, -4.3, -3.3, -3.3, -8.199999999999998, -14.299999999999997, -4.3, -8.2, -11.3, -19.7, -19.300000000000004, -40.2, -4.2, -19.900000000000002, -4.4, -13.3, -16.3, -8.4, -4.300000000000001, -12.099999999999996, -3.900000000000001, -21.10000000000002, -4.3, -17.900000000000006, -19.39999999999999, -4.800000000000001, -3.2, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.201795584479024, "mean_inference_ms": 1.5449679310158337, "mean_action_processing_ms": 0.08640772626534028, "mean_env_wait_ms": 7.072244287358818, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 408000, "timesteps_this_iter": 0, "agent_timesteps_total": 408000, "timers": {"sample_time_ms": 26046.525, "sample_throughput": 153.571, "load_time_ms": 0.529, "load_throughput": 7564460.075, "learn_time_ms": 12611.297, "learn_throughput": 317.176, "update_time_ms": 2.628}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.12828557160082124, "policy_loss": -0.0036262264725581933, "vf_loss": 13.169869103098428, "vf_explained_var": 0.31477763082391474, "kl": 0.00505152522133533, "entropy": 0.16943502487033926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 408000, "num_agent_steps_sampled": 408000, "num_steps_trained": 408000, "num_agent_steps_trained": 408000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4120, "training_iteration": 102, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-42-30", "timestamp": 1643647350, "time_this_iter_s": 24.750680923461914, "time_total_s": 2028.8930728435516, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2028.8930728435516, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 38.525, "ram_util_percent": 62.263888888888914}}
{"episode_reward_max": -3.2, "episode_reward_min": -41.3, "episode_reward_mean": -11.848000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.2, -5.5, -3.2, -27.800000000000047, -11.399999999999999, -12.499999999999998, -3.2, -3.6000000000000005, -4.3, -20.699999999999996, -17.499999999999996, -16.2, -7.599999999999989, -10.199999999999998, -3.2, -3.3, -3.3, -16.799999999999997, -7.100000000000001, -3.3, -14.499999999999996, -25.50000000000004, -4.4, -11.7, -15.700000000000001, -12.3, -17.4, -3.3, -3.3, -7.2, -10.2, -25.5, -13.999999999999998, -4.3, -3.3, -3.3, -8.199999999999998, -14.299999999999997, -4.3, -8.2, -11.3, -19.7, -19.300000000000004, -40.2, -4.2, -19.900000000000002, -4.4, -13.3, -16.3, -8.4, -4.300000000000001, -12.099999999999996, -3.900000000000001, -21.10000000000002, -4.3, -17.900000000000006, -19.39999999999999, -4.800000000000001, -3.2, -3.3, -3.3, -3.2, -18.599999999999994, -11.399999999999999, -24.300000000000015, -12.899999999999999, -4.4, -3.3, -19.5, -8.699999999999998, -11.499999999999998, -3.2, -3.3, -23.199999999999996, -14.6, -5.2, -21.299999999999994, -3.3, -28.4, -15.299999999999997, -11.0, -10.2, -26.799999999999997, -3.2, -3.3, -32.0, -24.3, -11.3, -23.999999999999996, -6.8999999999999995, -17.799999999999997, -12.7, -41.3, -11.3, -3.2, -17.7, -15.0, -3.4, -13.2, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2042776593018543, "mean_inference_ms": 1.5480063524940157, "mean_action_processing_ms": 0.08658525337722438, "mean_env_wait_ms": 7.086193175965433, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 412000, "timesteps_this_iter": 0, "agent_timesteps_total": 412000, "timers": {"sample_time_ms": 26028.475, "sample_throughput": 153.678, "load_time_ms": 0.506, "load_throughput": 7897762.086, "learn_time_ms": 12653.628, "learn_throughput": 316.115, "update_time_ms": 2.506}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.11568106645017222, "policy_loss": -0.006216881263961074, "vf_loss": 12.156125727327922, "vf_explained_var": 0.21722149707937755, "kl": 0.007980849173999018, "entropy": 0.15004097948712047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 412000, "num_agent_steps_sampled": 412000, "num_steps_trained": 412000, "num_agent_steps_trained": 412000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4160, "training_iteration": 103, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-42-56", "timestamp": 1643647376, "time_this_iter_s": 25.482089042663574, "time_total_s": 2054.375161886215, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2054.375161886215, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 43.44166666666667, "ram_util_percent": 62.30000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -41.3, "episode_reward_mean": -12.366000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.3, -19.7, -19.300000000000004, -40.2, -4.2, -19.900000000000002, -4.4, -13.3, -16.3, -8.4, -4.300000000000001, -12.099999999999996, -3.900000000000001, -21.10000000000002, -4.3, -17.900000000000006, -19.39999999999999, -4.800000000000001, -3.2, -3.3, -3.3, -3.2, -18.599999999999994, -11.399999999999999, -24.300000000000015, -12.899999999999999, -4.4, -3.3, -19.5, -8.699999999999998, -11.499999999999998, -3.2, -3.3, -23.199999999999996, -14.6, -5.2, -21.299999999999994, -3.3, -28.4, -15.299999999999997, -11.0, -10.2, -26.799999999999997, -3.2, -3.3, -32.0, -24.3, -11.3, -23.999999999999996, -6.8999999999999995, -17.799999999999997, -12.7, -41.3, -11.3, -3.2, -17.7, -15.0, -3.4, -13.2, -3.2, -21.6, -3.2, -28.100000000000048, -3.3, -13.099999999999971, -7.7, -25.90000000000002, -3.3, -16.1, -8.2, -3.2, -10.799999999999997, -3.2, -9.799999999999999, -3.2, -24.199999999999996, -3.3, -18.800000000000004, -3.2, -4.2, -13.799999999999997, -17.199999999999996, -24.099999999999998, -4.2, -7.1, -8.999999999999998, -3.2, -12.699999999999996, -11.199999999999992, -11.999999999999996, -13.2, -17.599999999999998, -19.3, -3.2, -17.4, -22.800000000000008, -3.2, -7.3, -10.799999999999997, -10.899999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2063312620227615, "mean_inference_ms": 1.5510769224087269, "mean_action_processing_ms": 0.08676307374051564, "mean_env_wait_ms": 7.100798812362203, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 416000, "timesteps_this_iter": 0, "agent_timesteps_total": 416000, "timers": {"sample_time_ms": 26161.916, "sample_throughput": 152.894, "load_time_ms": 0.509, "load_throughput": 7862231.595, "learn_time_ms": 12759.227, "learn_throughput": 313.499, "update_time_ms": 2.497}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.07509183693997643, "policy_loss": -0.012656333188336063, "vf_loss": 8.687984881862517, "vf_explained_var": 0.41564206218206756, "kl": 0.0205824667290056, "entropy": 0.14285469762980937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 416000, "num_agent_steps_sampled": 416000, "num_steps_trained": 416000, "num_agent_steps_trained": 416000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4200, "training_iteration": 104, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-43-20", "timestamp": 1643647400, "time_this_iter_s": 24.20883798599243, "time_total_s": 2078.5839998722076, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2078.5839998722076, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 46.69117647058824, "ram_util_percent": 62.28235294117647}}
{"episode_reward_max": -3.2, "episode_reward_min": -41.3, "episode_reward_mean": -12.261, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, -10.2, -26.799999999999997, -3.2, -3.3, -32.0, -24.3, -11.3, -23.999999999999996, -6.8999999999999995, -17.799999999999997, -12.7, -41.3, -11.3, -3.2, -17.7, -15.0, -3.4, -13.2, -3.2, -21.6, -3.2, -28.100000000000048, -3.3, -13.099999999999971, -7.7, -25.90000000000002, -3.3, -16.1, -8.2, -3.2, -10.799999999999997, -3.2, -9.799999999999999, -3.2, -24.199999999999996, -3.3, -18.800000000000004, -3.2, -4.2, -13.799999999999997, -17.199999999999996, -24.099999999999998, -4.2, -7.1, -8.999999999999998, -3.2, -12.699999999999996, -11.199999999999992, -11.999999999999996, -13.2, -17.599999999999998, -19.3, -3.2, -17.4, -22.800000000000008, -3.2, -7.3, -10.799999999999997, -10.899999999999997, -25.6, -13.6, -3.3, -24.800000000000008, -8.2, -4.800000000000001, -8.499999999999998, -6.3, -8.4, -3.2, -6.199999999999999, -24.0, -13.0, -3.3, -23.400000000000016, -8.299999999999997, -5.2, -14.299999999999997, -20.5, -23.600000000000005, -15.7, -9.100000000000001, -3.3, -26.500000000000004, -3.2, -23.10000000000005, -20.700000000000003, -4.2, -3.3, -3.3, -4.300000000000001, -31.6, -3.3, -18.299999999999997, -10.599999999999996, -15.299999999999986, -7.999999999999999, -5.699999999999999, -13.5, -8.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2077259205016357, "mean_inference_ms": 1.5531028494911836, "mean_action_processing_ms": 0.0868831906102464, "mean_env_wait_ms": 7.110061349024245, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 420000, "timesteps_this_iter": 0, "agent_timesteps_total": 420000, "timers": {"sample_time_ms": 26168.18, "sample_throughput": 152.857, "load_time_ms": 0.495, "load_throughput": 8079953.766, "learn_time_ms": 12796.285, "learn_throughput": 312.591, "update_time_ms": 2.504}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 0.10042589582823297, "policy_loss": -0.011698622857370684, "vf_loss": 11.13735163173368, "vf_explained_var": 0.2155465824629671, "kl": 0.011867745730296484, "entropy": 0.1758149092155759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 420000, "num_agent_steps_sampled": 420000, "num_steps_trained": 420000, "num_agent_steps_trained": 420000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4240, "training_iteration": 105, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-43-42", "timestamp": 1643647422, "time_this_iter_s": 21.94367003440857, "time_total_s": 2100.527669906616, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2100.527669906616, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 32.859375, "ram_util_percent": 62.278125}}
{"episode_reward_max": -3.2, "episode_reward_min": -42.900000000000006, "episode_reward_mean": -12.371000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.799999999999997, -17.199999999999996, -24.099999999999998, -4.2, -7.1, -8.999999999999998, -3.2, -12.699999999999996, -11.199999999999992, -11.999999999999996, -13.2, -17.599999999999998, -19.3, -3.2, -17.4, -22.800000000000008, -3.2, -7.3, -10.799999999999997, -10.899999999999997, -25.6, -13.6, -3.3, -24.800000000000008, -8.2, -4.800000000000001, -8.499999999999998, -6.3, -8.4, -3.2, -6.199999999999999, -24.0, -13.0, -3.3, -23.400000000000016, -8.299999999999997, -5.2, -14.299999999999997, -20.5, -23.600000000000005, -15.7, -9.100000000000001, -3.3, -26.500000000000004, -3.2, -23.10000000000005, -20.700000000000003, -4.2, -3.3, -3.3, -4.300000000000001, -31.6, -3.3, -18.299999999999997, -10.599999999999996, -15.299999999999986, -7.999999999999999, -5.699999999999999, -13.5, -8.2, -11.899999999999995, -13.799999999999997, -8.3, -31.3, -16.6, -10.8, -9.7, -3.4, -8.3, -4.3, -4.500000000000002, -26.000000000000004, -13.799999999999997, -21.1, -18.5, -3.3, -3.2, -3.2, -42.900000000000006, -14.3, -22.3, -18.799999999999997, -20.2, -8.4, -10.499999999999996, -14.099999999999998, -3.3, -3.3, -21.5, -28.6, -12.2, -3.3, -3.3, -25.90000000000001, -5.2, -13.1, -7.399999999999999, -19.1, -3.3, -4.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2083714537203591, "mean_inference_ms": 1.5544498705169778, "mean_action_processing_ms": 0.0869622813946105, "mean_env_wait_ms": 7.115856695043406, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 424000, "timesteps_this_iter": 0, "agent_timesteps_total": 424000, "timers": {"sample_time_ms": 26177.424, "sample_throughput": 152.803, "load_time_ms": 0.494, "load_throughput": 8104543.742, "learn_time_ms": 12344.023, "learn_throughput": 324.043, "update_time_ms": 2.3}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 0.15117807882607623, "policy_loss": -0.008966636101925565, "vf_loss": 15.968572437699123, "vf_explained_var": 0.23495280659326942, "kl": 0.007253262455279734, "entropy": 0.17024231395253572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 424000, "num_agent_steps_sampled": 424000, "num_steps_trained": 424000, "num_agent_steps_trained": 424000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4280, "training_iteration": 106, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-44-05", "timestamp": 1643647445, "time_this_iter_s": 22.601062059402466, "time_total_s": 2123.1287319660187, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2123.1287319660187, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 39.5625, "ram_util_percent": 62.3}}
{"episode_reward_max": -3.2, "episode_reward_min": -134.2, "episode_reward_mean": -12.873999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.7, -9.100000000000001, -3.3, -26.500000000000004, -3.2, -23.10000000000005, -20.700000000000003, -4.2, -3.3, -3.3, -4.300000000000001, -31.6, -3.3, -18.299999999999997, -10.599999999999996, -15.299999999999986, -7.999999999999999, -5.699999999999999, -13.5, -8.2, -11.899999999999995, -13.799999999999997, -8.3, -31.3, -16.6, -10.8, -9.7, -3.4, -8.3, -4.3, -4.500000000000002, -26.000000000000004, -13.799999999999997, -21.1, -18.5, -3.3, -3.2, -3.2, -42.900000000000006, -14.3, -22.3, -18.799999999999997, -20.2, -8.4, -10.499999999999996, -14.099999999999998, -3.3, -3.3, -21.5, -28.6, -12.2, -3.3, -3.3, -25.90000000000001, -5.2, -13.1, -7.399999999999999, -19.1, -3.3, -4.2, -6.3, -8.3, -14.899999999999999, -13.0, -9.6, -14.399999999999999, -13.699999999999998, -3.2, -3.3, -6.3, -11.799999999999997, -3.3, -18.4, -3.3, -10.6, -3.3, -8.200000000000001, -12.5, -14.299999999999995, -3.3, -4.300000000000001, -11.399999999999999, -10.2, -3.3, -3.3, -6.999999999999999, -18.099999999999998, -18.500000000000004, -14.3, -25.699999999999996, -14.5, -7.299999999999999, -6.800000000000001, -7.4, -16.099999999999998, -3.2, -134.2, -14.799999999999997, -21.100000000000012, -15.499999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.209235497353305, "mean_inference_ms": 1.555654650629565, "mean_action_processing_ms": 0.08702999752094459, "mean_env_wait_ms": 7.1213494296885225, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 428000, "timesteps_this_iter": 0, "agent_timesteps_total": 428000, "timers": {"sample_time_ms": 24576.922, "sample_throughput": 162.754, "load_time_ms": 0.465, "load_throughput": 8601936.013, "learn_time_ms": 11958.342, "learn_throughput": 334.495, "update_time_ms": 2.181}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 0.41968554260875146, "policy_loss": -0.019189544975437144, "vf_loss": 43.783362980170914, "vf_explained_var": 0.13506777151938407, "kl": 0.01645771235117367, "entropy": 0.17391180320973357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 428000, "num_agent_steps_sampled": 428000, "num_steps_trained": 428000, "num_agent_steps_trained": 428000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4320, "training_iteration": 107, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-44-27", "timestamp": 1643647467, "time_this_iter_s": 21.916015148162842, "time_total_s": 2145.0447471141815, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2145.0447471141815, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 36.9, "ram_util_percent": 62.30645161290321}}
{"episode_reward_max": -3.2, "episode_reward_min": -134.2, "episode_reward_mean": -12.230999999999996, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.3, -18.799999999999997, -20.2, -8.4, -10.499999999999996, -14.099999999999998, -3.3, -3.3, -21.5, -28.6, -12.2, -3.3, -3.3, -25.90000000000001, -5.2, -13.1, -7.399999999999999, -19.1, -3.3, -4.2, -6.3, -8.3, -14.899999999999999, -13.0, -9.6, -14.399999999999999, -13.699999999999998, -3.2, -3.3, -6.3, -11.799999999999997, -3.3, -18.4, -3.3, -10.6, -3.3, -8.200000000000001, -12.5, -14.299999999999995, -3.3, -4.300000000000001, -11.399999999999999, -10.2, -3.3, -3.3, -6.999999999999999, -18.099999999999998, -18.500000000000004, -14.3, -25.699999999999996, -14.5, -7.299999999999999, -6.800000000000001, -7.4, -16.099999999999998, -3.2, -134.2, -14.799999999999997, -21.100000000000012, -15.499999999999998, -15.699999999999998, -11.599999999999998, -3.3, -6.0, -9.7, -25.9, -3.2, -8.3, -9.999999999999998, -4.800000000000001, -3.4, -12.2, -3.2, -7.599999999999999, -3.2, -4.2, -3.4, -5.3, -4.3, -20.2, -6.2, -51.89999999999996, -14.499999999999998, -5.6, -13.099999999999996, -23.9, -6.7, -3.3, -13.1, -27.6, -16.299999999999997, -3.3, -15.999999999999973, -3.3, -15.299999999999997, -8.1, -10.799999999999997, -4.2, -19.10000000000001, -8.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2103570869763414, "mean_inference_ms": 1.5568809103336616, "mean_action_processing_ms": 0.08710469889568259, "mean_env_wait_ms": 7.12713063581876, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 432000, "timesteps_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"sample_time_ms": 24140.836, "sample_throughput": 165.694, "load_time_ms": 0.462, "load_throughput": 8649387.019, "learn_time_ms": 11747.289, "learn_throughput": 340.504, "update_time_ms": 2.139}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 0.18539464756125404, "policy_loss": -0.021733595785354415, "vf_loss": 20.650546727898302, "vf_explained_var": 0.16218992958786668, "kl": 0.009841499569707472, "entropy": 0.1553727858689844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 432000, "num_agent_steps_sampled": 432000, "num_steps_trained": 432000, "num_agent_steps_trained": 432000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4360, "training_iteration": 108, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-44-49", "timestamp": 1643647489, "time_this_iter_s": 22.272964000701904, "time_total_s": 2167.3177111148834, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2167.3177111148834, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 37.184375, "ram_util_percent": 62.3}}
{"episode_reward_max": -1.3, "episode_reward_min": -134.2, "episode_reward_mean": -12.270999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -6.999999999999999, -18.099999999999998, -18.500000000000004, -14.3, -25.699999999999996, -14.5, -7.299999999999999, -6.800000000000001, -7.4, -16.099999999999998, -3.2, -134.2, -14.799999999999997, -21.100000000000012, -15.499999999999998, -15.699999999999998, -11.599999999999998, -3.3, -6.0, -9.7, -25.9, -3.2, -8.3, -9.999999999999998, -4.800000000000001, -3.4, -12.2, -3.2, -7.599999999999999, -3.2, -4.2, -3.4, -5.3, -4.3, -20.2, -6.2, -51.89999999999996, -14.499999999999998, -5.6, -13.099999999999996, -23.9, -6.7, -3.3, -13.1, -27.6, -16.299999999999997, -3.3, -15.999999999999973, -3.3, -15.299999999999997, -8.1, -10.799999999999997, -4.2, -19.10000000000001, -8.3, -3.2, -9.899999999999997, -12.600000000000001, -21.599999999999998, -1.3, -3.3, -20.3, -12.099999999999998, -3.2, -19.900000000000002, -6.0, -3.3, -3.3, -8.2, -4.300000000000001, -8.2, -21.80000000000003, -10.2, -15.999999999999996, -8.3, -18.8, -3.4, -10.6, -7.999999999999998, -4.2, -3.3, -15.99999999999998, -9.2, -4.4, -9.3, -13.8, -14.899999999999995, -32.9, -22.299999999999997, -18.5, -7.3, -9.3, -3.2, -4.2, -16.699999999999985, -10.9, -4.300000000000001, -4.4, -16.299999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2123445760842013, "mean_inference_ms": 1.5583632502122007, "mean_action_processing_ms": 0.08725183104327548, "mean_env_wait_ms": 7.134937333822313, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 436000, "timesteps_this_iter": 0, "agent_timesteps_total": 436000, "timers": {"sample_time_ms": 23811.543, "sample_throughput": 167.986, "load_time_ms": 0.456, "load_throughput": 8780205.15, "learn_time_ms": 11636.736, "learn_throughput": 343.739, "update_time_ms": 2.064}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 0.11719876613507989, "policy_loss": -0.0034662397403109778, "vf_loss": 12.012493351165967, "vf_explained_var": 0.191170185548003, "kl": 0.008534476312827027, "entropy": 0.1428543845872565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 436000, "num_agent_steps_sampled": 436000, "num_steps_trained": 436000, "num_agent_steps_trained": 436000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4404, "training_iteration": 109, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-45-11", "timestamp": 1643647511, "time_this_iter_s": 22.524558067321777, "time_total_s": 2189.842269182205, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2189.842269182205, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 37.071875, "ram_util_percent": 62.23125}}
{"episode_reward_max": -1.3, "episode_reward_min": -32.9, "episode_reward_mean": -10.198, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.099999999999996, -23.9, -6.7, -3.3, -13.1, -27.6, -16.299999999999997, -3.3, -15.999999999999973, -3.3, -15.299999999999997, -8.1, -10.799999999999997, -4.2, -19.10000000000001, -8.3, -3.2, -9.899999999999997, -12.600000000000001, -21.599999999999998, -1.3, -3.3, -20.3, -12.099999999999998, -3.2, -19.900000000000002, -6.0, -3.3, -3.3, -8.2, -4.300000000000001, -8.2, -21.80000000000003, -10.2, -15.999999999999996, -8.3, -18.8, -3.4, -10.6, -7.999999999999998, -4.2, -3.3, -15.99999999999998, -9.2, -4.4, -9.3, -13.8, -14.899999999999995, -32.9, -22.299999999999997, -18.5, -7.3, -9.3, -3.2, -4.2, -16.699999999999985, -10.9, -4.300000000000001, -4.4, -16.299999999999997, -9.500000000000002, -7.3, -6.3, -27.9, -10.699999999999998, -7.899999999999999, -3.2, -3.2, -3.3, -19.000000000000007, -20.400000000000002, -8.3, -3.2, -11.5, -9.3, -7.2, -3.2, -15.9, -3.3, -6.5, -5.0, -11.3, -15.999999999999996, -28.1, -3.2, -4.3, -10.5, -14.699999999999998, -8.999999999999996, -3.2, -2.3, -6.4, -3.2, -3.3, -4.300000000000001, -16.3, -5.3, -12.5, -3.2, -14.999999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2135134583996279, "mean_inference_ms": 1.5594302077735995, "mean_action_processing_ms": 0.08731551602093653, "mean_env_wait_ms": 7.139786172620939, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 440000, "timesteps_this_iter": 0, "agent_timesteps_total": 440000, "timers": {"sample_time_ms": 23256.577, "sample_throughput": 171.994, "load_time_ms": 0.452, "load_throughput": 8848275.935, "learn_time_ms": 11425.965, "learn_throughput": 350.08, "update_time_ms": 2.084}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 0.09051163776036632, "policy_loss": -0.0035299435998964054, "vf_loss": 9.366554098456136, "vf_explained_var": 0.378848212060108, "kl": 0.005942391085084995, "entropy": 0.12905350626316123, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 440000, "num_agent_steps_sampled": 440000, "num_steps_trained": 440000, "num_agent_steps_trained": 440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4444, "training_iteration": 110, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-45-33", "timestamp": 1643647533, "time_this_iter_s": 21.446815967559814, "time_total_s": 2211.289085149765, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2211.289085149765, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 40.436666666666675, "ram_util_percent": 62.20000000000002}}
{"episode_reward_max": -2.3, "episode_reward_min": -46.099999999999994, "episode_reward_mean": -11.277000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -3.3, -15.99999999999998, -9.2, -4.4, -9.3, -13.8, -14.899999999999995, -32.9, -22.299999999999997, -18.5, -7.3, -9.3, -3.2, -4.2, -16.699999999999985, -10.9, -4.300000000000001, -4.4, -16.299999999999997, -9.500000000000002, -7.3, -6.3, -27.9, -10.699999999999998, -7.899999999999999, -3.2, -3.2, -3.3, -19.000000000000007, -20.400000000000002, -8.3, -3.2, -11.5, -9.3, -7.2, -3.2, -15.9, -3.3, -6.5, -5.0, -11.3, -15.999999999999996, -28.1, -3.2, -4.3, -10.5, -14.699999999999998, -8.999999999999996, -3.2, -2.3, -6.4, -3.2, -3.3, -4.300000000000001, -16.3, -5.3, -12.5, -3.2, -14.999999999999998, -10.9, -9.1, -5.599999999999999, -15.599999999999998, -3.4, -4.300000000000001, -20.800000000000004, -4.9, -8.7, -39.5, -3.3, -3.3, -9.599999999999996, -8.599999999999994, -10.3, -24.799999999999997, -12.000000000000002, -23.4, -12.499999999999996, -21.5, -10.899999999999993, -27.800000000000004, -16.6, -10.699999999999998, -46.099999999999994, -7.999999999999998, -8.2, -17.500000000000004, -20.600000000000005, -17.3, -7.3, -9.3, -11.299999999999997, -12.099999999999971, -18.2, -19.799999999999997, -3.3, -8.3, -3.4, -9.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2138642104931714, "mean_inference_ms": 1.5600587973095152, "mean_action_processing_ms": 0.08730212035632398, "mean_env_wait_ms": 7.1420564180912045, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 444000, "timesteps_this_iter": 0, "agent_timesteps_total": 444000, "timers": {"sample_time_ms": 22901.627, "sample_throughput": 174.66, "load_time_ms": 0.453, "load_throughput": 8824076.158, "learn_time_ms": 11416.447, "learn_throughput": 350.372, "update_time_ms": 2.093}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 0.17068391101715225, "policy_loss": -0.01080152287588565, "vf_loss": 18.06368653184624, "vf_explained_var": 0.182780235621237, "kl": 0.013409569071735699, "entropy": 0.15838487713287275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 444000, "num_agent_steps_sampled": 444000, "num_steps_trained": 444000, "num_agent_steps_trained": 444000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4484, "training_iteration": 111, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-45-54", "timestamp": 1643647554, "time_this_iter_s": 21.35606288909912, "time_total_s": 2232.645148038864, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2232.645148038864, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 41.096774193548384, "ram_util_percent": 62.23870967741936}}
{"episode_reward_max": -2.3, "episode_reward_min": -56.7, "episode_reward_mean": -12.603, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, -11.3, -15.999999999999996, -28.1, -3.2, -4.3, -10.5, -14.699999999999998, -8.999999999999996, -3.2, -2.3, -6.4, -3.2, -3.3, -4.300000000000001, -16.3, -5.3, -12.5, -3.2, -14.999999999999998, -10.9, -9.1, -5.599999999999999, -15.599999999999998, -3.4, -4.300000000000001, -20.800000000000004, -4.9, -8.7, -39.5, -3.3, -3.3, -9.599999999999996, -8.599999999999994, -10.3, -24.799999999999997, -12.000000000000002, -23.4, -12.499999999999996, -21.5, -10.899999999999993, -27.800000000000004, -16.6, -10.699999999999998, -46.099999999999994, -7.999999999999998, -8.2, -17.500000000000004, -20.600000000000005, -17.3, -7.3, -9.3, -11.299999999999997, -12.099999999999971, -18.2, -19.799999999999997, -3.3, -8.3, -3.4, -9.3, -25.5, -12.999999999999998, -15.299999999999997, -9.899999999999999, -4.300000000000001, -3.3, -27.1, -3.2, -17.799999999999997, -21.1, -20.1, -8.3, -10.799999999999992, -12.899999999999999, -8.100000000000001, -17.699999999999996, -3.4, -5.200000000000001, -17.299999999999994, -13.4, -15.699999999999998, -4.300000000000001, -3.2, -17.699999999999996, -56.7, -10.6, -3.2, -16.699999999999996, -20.7, -16.2, -7.2, -30.799999999999997, -3.3, -3.2, -3.2, -20.200000000000003, -3.3, -21.400000000000006, -23.5, -6.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2139150043298048, "mean_inference_ms": 1.5601681706784518, "mean_action_processing_ms": 0.0873003430666255, "mean_env_wait_ms": 7.141008381793308, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 448000, "timesteps_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"sample_time_ms": 22723.353, "sample_throughput": 176.03, "load_time_ms": 0.465, "load_throughput": 8600172.237, "learn_time_ms": 11163.329, "learn_throughput": 358.316, "update_time_ms": 2.122}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 0.16040297736243536, "policy_loss": -0.00459591058052836, "vf_loss": 16.46010391725007, "vf_explained_var": 0.20920459352513796, "kl": 0.006287035927268682, "entropy": 0.13040522801619703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 448000, "num_agent_steps_sampled": 448000, "num_steps_trained": 448000, "num_agent_steps_trained": 448000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4524, "training_iteration": 112, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-46-15", "timestamp": 1643647575, "time_this_iter_s": 20.53280997276306, "time_total_s": 2253.177958011627, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2253.177958011627, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 37.22413793103448, "ram_util_percent": 62.29310344827586}}
{"episode_reward_max": -3.2, "episode_reward_min": -56.7, "episode_reward_mean": -12.373, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.899999999999993, -27.800000000000004, -16.6, -10.699999999999998, -46.099999999999994, -7.999999999999998, -8.2, -17.500000000000004, -20.600000000000005, -17.3, -7.3, -9.3, -11.299999999999997, -12.099999999999971, -18.2, -19.799999999999997, -3.3, -8.3, -3.4, -9.3, -25.5, -12.999999999999998, -15.299999999999997, -9.899999999999999, -4.300000000000001, -3.3, -27.1, -3.2, -17.799999999999997, -21.1, -20.1, -8.3, -10.799999999999992, -12.899999999999999, -8.100000000000001, -17.699999999999996, -3.4, -5.200000000000001, -17.299999999999994, -13.4, -15.699999999999998, -4.300000000000001, -3.2, -17.699999999999996, -56.7, -10.6, -3.2, -16.699999999999996, -20.7, -16.2, -7.2, -30.799999999999997, -3.3, -3.2, -3.2, -20.200000000000003, -3.3, -21.400000000000006, -23.5, -6.3, -3.2, -18.900000000000006, -4.3, -3.3, -3.2, -24.90000000000001, -13.799999999999972, -3.3, -4.3, -3.4, -17.4, -17.9, -3.3, -3.3, -19.9, -3.3, -4.2, -11.3, -5.2, -22.299999999999997, -15.299999999999999, -3.4, -6.699999999999999, -5.3, -3.4, -3.3, -26.700000000000006, -11.199999999999998, -8.3, -14.099999999999998, -3.2, -14.199999999999989, -10.499999999999998, -9.200000000000001, -3.3, -21.099999999999994, -18.2, -30.499999999999993, -4.300000000000001, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2140872632314599, "mean_inference_ms": 1.5600668906881827, "mean_action_processing_ms": 0.08729584504622384, "mean_env_wait_ms": 7.139637190087699, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 452000, "timesteps_this_iter": 0, "agent_timesteps_total": 452000, "timers": {"sample_time_ms": 22185.448, "sample_throughput": 180.298, "load_time_ms": 0.459, "load_throughput": 8724047.631, "learn_time_ms": 11013.62, "learn_throughput": 363.187, "update_time_ms": 2.138}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 0.07511757050455618, "policy_loss": -0.014986062672750284, "vf_loss": 8.974015852456452, "vf_explained_var": 0.3160161699018171, "kl": 0.005743868920456801, "entropy": 0.10664613266345314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 452000, "num_agent_steps_sampled": 452000, "num_steps_trained": 452000, "num_agent_steps_trained": 452000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4564, "training_iteration": 113, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-46-36", "timestamp": 1643647596, "time_this_iter_s": 21.14865207672119, "time_total_s": 2274.3266100883484, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2274.3266100883484, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 36.81666666666667, "ram_util_percent": 62.29999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -152.0000000000002, "episode_reward_mean": -13.135000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.699999999999998, -4.300000000000001, -3.2, -17.699999999999996, -56.7, -10.6, -3.2, -16.699999999999996, -20.7, -16.2, -7.2, -30.799999999999997, -3.3, -3.2, -3.2, -20.200000000000003, -3.3, -21.400000000000006, -23.5, -6.3, -3.2, -18.900000000000006, -4.3, -3.3, -3.2, -24.90000000000001, -13.799999999999972, -3.3, -4.3, -3.4, -17.4, -17.9, -3.3, -3.3, -19.9, -3.3, -4.2, -11.3, -5.2, -22.299999999999997, -15.299999999999999, -3.4, -6.699999999999999, -5.3, -3.4, -3.3, -26.700000000000006, -11.199999999999998, -8.3, -14.099999999999998, -3.2, -14.199999999999989, -10.499999999999998, -9.200000000000001, -3.3, -21.099999999999994, -18.2, -30.499999999999993, -4.300000000000001, -3.3, -12.6, -11.1, -7.7, -10.299999999999999, -3.2, -5.300000000000001, -22.000000000000007, -3.2, -4.300000000000001, -9.399999999999999, -3.4, -7.3, -3.2, -21.499999999999996, -4.300000000000001, -124.2, -16.299999999999997, -3.2, -13.2, -11.2, -7.5, -3.2, -23.3, -17.5, -3.3, -10.1, -3.3, -4.2, -3.3, -3.3, -24.400000000000013, -4.4, -4.3, -15.299999999999995, -13.499999999999998, -152.0000000000002, -3.4, -20.2, -3.2, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2143426741302457, "mean_inference_ms": 1.560089203499187, "mean_action_processing_ms": 0.08729791897077067, "mean_env_wait_ms": 7.139347361600036, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 456000, "timesteps_this_iter": 0, "agent_timesteps_total": 456000, "timers": {"sample_time_ms": 21884.888, "sample_throughput": 182.775, "load_time_ms": 0.463, "load_throughput": 8635141.284, "learn_time_ms": 10842.815, "learn_throughput": 368.908, "update_time_ms": 2.143}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 1.700167036988342, "policy_loss": -0.007273668499403103, "vf_loss": 170.69608779982212, "vf_explained_var": 0.2309471849472292, "kl": 0.007582758869474212, "entropy": 0.13552412731192445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 456000, "num_agent_steps_sampled": 456000, "num_steps_trained": 456000, "num_agent_steps_trained": 456000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4604, "training_iteration": 114, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-46-57", "timestamp": 1643647617, "time_this_iter_s": 20.987980604171753, "time_total_s": 2295.31459069252, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2295.31459069252, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 41.443333333333335, "ram_util_percent": 62.29666666666665}}
{"episode_reward_max": -3.2, "episode_reward_min": -152.0000000000002, "episode_reward_mean": -12.274000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.299999999999999, -3.4, -6.699999999999999, -5.3, -3.4, -3.3, -26.700000000000006, -11.199999999999998, -8.3, -14.099999999999998, -3.2, -14.199999999999989, -10.499999999999998, -9.200000000000001, -3.3, -21.099999999999994, -18.2, -30.499999999999993, -4.300000000000001, -3.3, -12.6, -11.1, -7.7, -10.299999999999999, -3.2, -5.300000000000001, -22.000000000000007, -3.2, -4.300000000000001, -9.399999999999999, -3.4, -7.3, -3.2, -21.499999999999996, -4.300000000000001, -124.2, -16.299999999999997, -3.2, -13.2, -11.2, -7.5, -3.2, -23.3, -17.5, -3.3, -10.1, -3.3, -4.2, -3.3, -3.3, -24.400000000000013, -4.4, -4.3, -15.299999999999995, -13.499999999999998, -152.0000000000002, -3.4, -20.2, -3.2, -3.3, -3.2, -12.7, -17.199999999999996, -14.6, -3.2, -3.3, -18.100000000000012, -3.3, -5.2, -16.199999999999985, -9.899999999999997, -3.2, -3.3, -23.800000000000004, -21.6, -9.5, -10.699999999999998, -9.3, -3.3, -4.300000000000001, -3.3, -3.3, -9.6, -14.2, -4.2, -3.2, -17.0, -9.099999999999998, -3.3, -3.2, -17.199999999999996, -20.4, -11.5, -3.4, -14.899999999999997, -11.099999999999996, -15.599999999999998, -21.1, -7.199999999999999, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2142600671188235, "mean_inference_ms": 1.5601437128583115, "mean_action_processing_ms": 0.08730378563507504, "mean_env_wait_ms": 7.139619992870223, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 460000, "timesteps_this_iter": 0, "agent_timesteps_total": 460000, "timers": {"sample_time_ms": 21696.845, "sample_throughput": 184.359, "load_time_ms": 0.461, "load_throughput": 8678468.86, "learn_time_ms": 10754.909, "learn_throughput": 371.923, "update_time_ms": 2.141}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 0.07529834142575662, "policy_loss": -0.014485831322368754, "vf_loss": 8.915680286961218, "vf_explained_var": 0.19730043251027343, "kl": 0.009914032517431413, "entropy": 0.13149698653048084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 460000, "num_agent_steps_sampled": 460000, "num_steps_trained": 460000, "num_agent_steps_trained": 460000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4644, "training_iteration": 115, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-47-18", "timestamp": 1643647638, "time_this_iter_s": 20.89511513710022, "time_total_s": 2316.2097058296204, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2316.2097058296204, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 38.97333333333334, "ram_util_percent": 62.29999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -152.0000000000002, "episode_reward_mean": -11.395, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.5, -3.2, -23.3, -17.5, -3.3, -10.1, -3.3, -4.2, -3.3, -3.3, -24.400000000000013, -4.4, -4.3, -15.299999999999995, -13.499999999999998, -152.0000000000002, -3.4, -20.2, -3.2, -3.3, -3.2, -12.7, -17.199999999999996, -14.6, -3.2, -3.3, -18.100000000000012, -3.3, -5.2, -16.199999999999985, -9.899999999999997, -3.2, -3.3, -23.800000000000004, -21.6, -9.5, -10.699999999999998, -9.3, -3.3, -4.300000000000001, -3.3, -3.3, -9.6, -14.2, -4.2, -3.2, -17.0, -9.099999999999998, -3.3, -3.2, -17.199999999999996, -20.4, -11.5, -3.4, -14.899999999999997, -11.099999999999996, -15.599999999999998, -21.1, -7.199999999999999, -3.3, -4.300000000000001, -12.7, -3.2, -27.09999999999999, -12.3, -18.499999999999993, -18.6, -4.300000000000001, -10.2, -9.8, -3.3, -10.799999999999999, -16.799999999999997, -12.899999999999999, -19.799999999999997, -3.3, -3.3, -21.6, -15.399999999999999, -4.2, -4.300000000000001, -3.3, -7.000000000000001, -3.3, -9.2, -3.2, -9.799999999999997, -18.899999999999995, -9.9, -3.3, -13.999999999999998, -3.3, -14.5, -11.899999999999999, -9.499999999999996, -9.5, -4.3, -29.599999999999998, -11.7, -11.6], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2140913476864257, "mean_inference_ms": 1.5602008118242496, "mean_action_processing_ms": 0.08731266497756789, "mean_env_wait_ms": 7.140080146222913, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 464000, "timesteps_this_iter": 0, "agent_timesteps_total": 464000, "timers": {"sample_time_ms": 21520.777, "sample_throughput": 185.867, "load_time_ms": 0.482, "load_throughput": 8302264.45, "learn_time_ms": 10750.176, "learn_throughput": 372.087, "update_time_ms": 2.124}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 0.08804058965936463, "policy_loss": -0.009736887145266738, "vf_loss": 9.736731265148808, "vf_explained_var": 0.33341193090202986, "kl": 0.006481655744786082, "entropy": 0.13034150482666107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 464000, "num_agent_steps_sampled": 464000, "num_steps_trained": 464000, "num_agent_steps_trained": 464000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4684, "training_iteration": 116, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-47-40", "timestamp": 1643647660, "time_this_iter_s": 21.671714067459106, "time_total_s": 2337.8814198970795, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2337.8814198970795, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 38.20645161290323, "ram_util_percent": 62.29999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -43.2, "episode_reward_mean": -10.17, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -3.3, -9.6, -14.2, -4.2, -3.2, -17.0, -9.099999999999998, -3.3, -3.2, -17.199999999999996, -20.4, -11.5, -3.4, -14.899999999999997, -11.099999999999996, -15.599999999999998, -21.1, -7.199999999999999, -3.3, -4.300000000000001, -12.7, -3.2, -27.09999999999999, -12.3, -18.499999999999993, -18.6, -4.300000000000001, -10.2, -9.8, -3.3, -10.799999999999999, -16.799999999999997, -12.899999999999999, -19.799999999999997, -3.3, -3.3, -21.6, -15.399999999999999, -4.2, -4.300000000000001, -3.3, -7.000000000000001, -3.3, -9.2, -3.2, -9.799999999999997, -18.899999999999995, -9.9, -3.3, -13.999999999999998, -3.3, -14.5, -11.899999999999999, -9.499999999999996, -9.5, -4.3, -29.599999999999998, -11.7, -11.6, -19.600000000000005, -3.3, -4.3, -4.3, -6.299999999999998, -10.0, -8.2, -43.2, -3.2, -9.3, -11.799999999999994, -4.3, -10.3, -9.5, -3.3, -3.3, -11.5, -32.400000000000006, -3.3, -6.300000000000001, -4.4, -16.1, -15.199999999999998, -16.699999999999996, -5.2, -3.4, -17.6, -3.3, -8.699999999999998, -26.800000000000004, -7.999999999999997, -9.899999999999999, -5.3, -3.3, -3.3, -3.4, -6.3999999999999995, -17.5, -7.4, -6.799999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2139601382850926, "mean_inference_ms": 1.560484556712463, "mean_action_processing_ms": 0.08733562325084114, "mean_env_wait_ms": 7.141443139392728, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 468000, "timesteps_this_iter": 0, "agent_timesteps_total": 468000, "timers": {"sample_time_ms": 21482.13, "sample_throughput": 186.201, "load_time_ms": 0.477, "load_throughput": 8387349.898, "learn_time_ms": 10752.229, "learn_throughput": 372.016, "update_time_ms": 2.208}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 0.1409245334325298, "policy_loss": -0.008710320161715631, "vf_loss": 14.929800411514057, "vf_explained_var": 0.25768672445768953, "kl": 0.0053231196307831396, "entropy": 0.1413286061657052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 468000, "num_agent_steps_sampled": 468000, "num_steps_trained": 468000, "num_agent_steps_trained": 468000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4724, "training_iteration": 117, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-48-01", "timestamp": 1643647681, "time_this_iter_s": 21.59978699684143, "time_total_s": 2359.481206893921, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2359.481206893921, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 31.519354838709674, "ram_util_percent": 62.29999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -43.2, "episode_reward_mean": -10.802, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -3.3, -7.000000000000001, -3.3, -9.2, -3.2, -9.799999999999997, -18.899999999999995, -9.9, -3.3, -13.999999999999998, -3.3, -14.5, -11.899999999999999, -9.499999999999996, -9.5, -4.3, -29.599999999999998, -11.7, -11.6, -19.600000000000005, -3.3, -4.3, -4.3, -6.299999999999998, -10.0, -8.2, -43.2, -3.2, -9.3, -11.799999999999994, -4.3, -10.3, -9.5, -3.3, -3.3, -11.5, -32.400000000000006, -3.3, -6.300000000000001, -4.4, -16.1, -15.199999999999998, -16.699999999999996, -5.2, -3.4, -17.6, -3.3, -8.699999999999998, -26.800000000000004, -7.999999999999997, -9.899999999999999, -5.3, -3.3, -3.3, -3.4, -6.3999999999999995, -17.5, -7.4, -6.799999999999999, -34.2, -9.3, -9.3, -4.300000000000001, -4.300000000000001, -3.3, -5.4, -13.299999999999999, -8.499999999999996, -21.799999999999997, -3.3, -38.3, -11.899999999999997, -11.499999999999993, -11.899999999999997, -16.6, -25.4, -7.2, -17.5, -5.2, -20.800000000000004, -7.699999999999998, -4.300000000000001, -3.3, -3.3, -17.700000000000003, -11.499999999999995, -3.2, -17.3, -17.9, -9.999999999999998, -3.4, -14.199999999999998, -13.599999999999998, -20.200000000000028, -3.3, -18.1, -4.300000000000001, -19.700000000000003, -15.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.214117086973228, "mean_inference_ms": 1.5615622931794382, "mean_action_processing_ms": 0.08737342799915958, "mean_env_wait_ms": 7.143952765120299, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 472000, "timesteps_this_iter": 0, "agent_timesteps_total": 472000, "timers": {"sample_time_ms": 21465.489, "sample_throughput": 186.346, "load_time_ms": 0.478, "load_throughput": 8363517.448, "learn_time_ms": 10727.533, "learn_throughput": 372.872, "update_time_ms": 2.276}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 0.11081830942752942, "policy_loss": -0.013362520198107406, "vf_loss": 12.334384868478262, "vf_explained_var": 0.32090125705606193, "kl": 0.013226424829199735, "entropy": 0.1525946131797247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 472000, "num_agent_steps_sampled": 472000, "num_steps_trained": 472000, "num_agent_steps_trained": 472000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4764, "training_iteration": 118, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-48-23", "timestamp": 1643647703, "time_this_iter_s": 21.841619968414307, "time_total_s": 2381.322826862335, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2381.322826862335, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 38.32258064516129, "ram_util_percent": 62.29999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -74.3, "episode_reward_mean": -11.993000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -3.4, -17.6, -3.3, -8.699999999999998, -26.800000000000004, -7.999999999999997, -9.899999999999999, -5.3, -3.3, -3.3, -3.4, -6.3999999999999995, -17.5, -7.4, -6.799999999999999, -34.2, -9.3, -9.3, -4.300000000000001, -4.300000000000001, -3.3, -5.4, -13.299999999999999, -8.499999999999996, -21.799999999999997, -3.3, -38.3, -11.899999999999997, -11.499999999999993, -11.899999999999997, -16.6, -25.4, -7.2, -17.5, -5.2, -20.800000000000004, -7.699999999999998, -4.300000000000001, -3.3, -3.3, -17.700000000000003, -11.499999999999995, -3.2, -17.3, -17.9, -9.999999999999998, -3.4, -14.199999999999998, -13.599999999999998, -20.200000000000028, -3.3, -18.1, -4.300000000000001, -19.700000000000003, -15.4, -9.6, -3.3, -3.3, -10.100000000000001, -17.2, -13.899999999999999, -8.8, -14.799999999999999, -12.5, -9.3, -8.3, -14.299999999999995, -10.799999999999999, -3.3, -3.4, -26.700000000000003, -8.5, -74.3, -4.2, -22.900000000000006, -12.799999999999999, -9.9, -3.3, -16.8, -10.899999999999999, -36.3, -3.3, -16.4, -14.0, -3.3, -21.0, -13.199999999999998, -3.2, -6.300000000000001, -16.899999999999995, -3.3, -26.10000000000001, -3.2, -18.200000000000003, -21.5, -11.799999999999999, -13.3, -3.4, -3.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2148962376439554, "mean_inference_ms": 1.5629886889595122, "mean_action_processing_ms": 0.08748247306246537, "mean_env_wait_ms": 7.149268156989574, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 476000, "timesteps_this_iter": 0, "agent_timesteps_total": 476000, "timers": {"sample_time_ms": 21390.986, "sample_throughput": 186.995, "load_time_ms": 0.476, "load_throughput": 8408789.094, "learn_time_ms": 10748.999, "learn_throughput": 372.128, "update_time_ms": 2.265}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 0.36734060887998393, "policy_loss": -0.013646751387865953, "vf_loss": 37.91786528723214, "vf_explained_var": -0.047349315497183034, "kl": 0.028582222768060706, "entropy": 0.1490020394445427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 476000, "num_agent_steps_sampled": 476000, "num_steps_trained": 476000, "num_agent_steps_trained": 476000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4808, "training_iteration": 119, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-48-46", "timestamp": 1643647726, "time_this_iter_s": 22.235108137130737, "time_total_s": 2403.557934999466, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2403.557934999466, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 38.6, "ram_util_percent": 62.3}}
{"episode_reward_max": -3.2, "episode_reward_min": -74.3, "episode_reward_mean": -13.083000000000004, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -17.700000000000003, -11.499999999999995, -3.2, -17.3, -17.9, -9.999999999999998, -3.4, -14.199999999999998, -13.599999999999998, -20.200000000000028, -3.3, -18.1, -4.300000000000001, -19.700000000000003, -15.4, -9.6, -3.3, -3.3, -10.100000000000001, -17.2, -13.899999999999999, -8.8, -14.799999999999999, -12.5, -9.3, -8.3, -14.299999999999995, -10.799999999999999, -3.3, -3.4, -26.700000000000003, -8.5, -74.3, -4.2, -22.900000000000006, -12.799999999999999, -9.9, -3.3, -16.8, -10.899999999999999, -36.3, -3.3, -16.4, -14.0, -3.3, -21.0, -13.199999999999998, -3.2, -6.300000000000001, -16.899999999999995, -3.3, -26.10000000000001, -3.2, -18.200000000000003, -21.5, -11.799999999999999, -13.3, -3.4, -3.4, -16.3, -4.4, -20.100000000000005, -3.2, -13.599999999999998, -19.099999999999994, -3.3, -17.2, -3.3, -37.2, -5.300000000000001, -22.200000000000003, -4.3, -12.7, -8.3, -6.9, -7.5, -19.5, -18.7, -7.999999999999997, -9.5, -3.4, -13.5, -14.8, -8.3, -37.2, -7.499999999999999, -27.500000000000046, -18.299999999999997, -6.899999999999999, -15.1, -3.3, -14.199999999999998, -11.799999999999999, -3.2, -24.799999999999997, -13.2, -29.2, -14.700000000000001, -16.399999999999995], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2154866141696565, "mean_inference_ms": 1.5640437937203742, "mean_action_processing_ms": 0.08753674719329117, "mean_env_wait_ms": 7.153476823957761, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"sample_time_ms": 21429.95, "sample_throughput": 186.655, "load_time_ms": 0.477, "load_throughput": 8380227.772, "learn_time_ms": 10776.656, "learn_throughput": 371.173, "update_time_ms": 2.242}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.17316803353718452, "policy_loss": -0.009009484283035241, "vf_loss": 18.10147619144891, "vf_explained_var": 0.16855761594669794, "kl": 0.012249642410854437, "entropy": 0.15167444228965749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 480000, "num_steps_trained": 480000, "num_agent_steps_trained": 480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4848, "training_iteration": 120, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-49-08", "timestamp": 1643647748, "time_this_iter_s": 21.898162126541138, "time_total_s": 2425.456097126007, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2425.456097126007, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 43.36129032258064, "ram_util_percent": 62.29677419354837}}
{"episode_reward_max": -3.2, "episode_reward_min": -37.2, "episode_reward_mean": -12.72, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.899999999999999, -36.3, -3.3, -16.4, -14.0, -3.3, -21.0, -13.199999999999998, -3.2, -6.300000000000001, -16.899999999999995, -3.3, -26.10000000000001, -3.2, -18.200000000000003, -21.5, -11.799999999999999, -13.3, -3.4, -3.4, -16.3, -4.4, -20.100000000000005, -3.2, -13.599999999999998, -19.099999999999994, -3.3, -17.2, -3.3, -37.2, -5.300000000000001, -22.200000000000003, -4.3, -12.7, -8.3, -6.9, -7.5, -19.5, -18.7, -7.999999999999997, -9.5, -3.4, -13.5, -14.8, -8.3, -37.2, -7.499999999999999, -27.500000000000046, -18.299999999999997, -6.899999999999999, -15.1, -3.3, -14.199999999999998, -11.799999999999999, -3.2, -24.799999999999997, -13.2, -29.2, -14.700000000000001, -16.399999999999995, -4.2, -5.3, -21.6, -14.899999999999997, -6.2, -17.5, -20.000000000000004, -9.5, -24.400000000000023, -14.5, -33.499999999999964, -10.799999999999999, -3.3, -3.3, -3.4, -10.3, -7.300000000000001, -4.4, -21.500000000000004, -20.000000000000007, -13.2, -4.999999999999998, -7.3, -10.7, -7.3, -19.6, -4.300000000000001, -8.3, -9.2, -18.3, -9.9, -9.3, -8.2, -14.1, -5.2, -15.6, -8.3, -18.600000000000005, -25.600000000000005, -5.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2158667032375559, "mean_inference_ms": 1.5648082042134464, "mean_action_processing_ms": 0.08753905071078741, "mean_env_wait_ms": 7.156440634258768, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 484000, "timesteps_this_iter": 0, "agent_timesteps_total": 484000, "timers": {"sample_time_ms": 21490.06, "sample_throughput": 186.133, "load_time_ms": 0.476, "load_throughput": 8399947.93, "learn_time_ms": 10771.919, "learn_throughput": 371.336, "update_time_ms": 2.224}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.08368211693020278, "policy_loss": -0.012735260209889823, "vf_loss": 9.56495374453965, "vf_explained_var": 0.3124636111080006, "kl": 0.00808921110278962, "entropy": 0.17369533214838273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 484000, "num_agent_steps_sampled": 484000, "num_steps_trained": 484000, "num_agent_steps_trained": 484000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4888, "training_iteration": 121, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-49-29", "timestamp": 1643647769, "time_this_iter_s": 21.6331570148468, "time_total_s": 2447.089254140854, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2447.089254140854, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 36.52666666666667, "ram_util_percent": 62.29999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -37.2, "episode_reward_mean": -12.520999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.5, -3.4, -13.5, -14.8, -8.3, -37.2, -7.499999999999999, -27.500000000000046, -18.299999999999997, -6.899999999999999, -15.1, -3.3, -14.199999999999998, -11.799999999999999, -3.2, -24.799999999999997, -13.2, -29.2, -14.700000000000001, -16.399999999999995, -4.2, -5.3, -21.6, -14.899999999999997, -6.2, -17.5, -20.000000000000004, -9.5, -24.400000000000023, -14.5, -33.499999999999964, -10.799999999999999, -3.3, -3.3, -3.4, -10.3, -7.300000000000001, -4.4, -21.500000000000004, -20.000000000000007, -13.2, -4.999999999999998, -7.3, -10.7, -7.3, -19.6, -4.300000000000001, -8.3, -9.2, -18.3, -9.9, -9.3, -8.2, -14.1, -5.2, -15.6, -8.3, -18.600000000000005, -25.600000000000005, -5.2, -4.3, -3.3, -25.000000000000078, -11.2, -4.300000000000001, -7.3, -4.300000000000001, -23.600000000000016, -10.7, -19.000000000000018, -17.299999999999997, -24.5, -14.799999999999974, -3.2, -12.799999999999997, -3.4, -18.9, -11.599999999999996, -11.799999999999997, -32.2, -14.899999999999999, -19.9, -28.6, -3.3, -8.100000000000001, -17.2, -8.8, -12.3, -9.100000000000001, -4.2, -6.3, -12.999999999999998, -14.999999999999996, -4.2, -15.3, -4.4, -11.1, -3.2, -3.3, -14.5], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2163851130226206, "mean_inference_ms": 1.565590833295965, "mean_action_processing_ms": 0.08758123419129606, "mean_env_wait_ms": 7.158998935638554, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 488000, "timesteps_this_iter": 0, "agent_timesteps_total": 488000, "timers": {"sample_time_ms": 21605.068, "sample_throughput": 185.142, "load_time_ms": 0.464, "load_throughput": 8611649.728, "learn_time_ms": 10741.413, "learn_throughput": 372.39, "update_time_ms": 2.167}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.1088746265257879, "policy_loss": -0.013448540730181561, "vf_loss": 12.109456990867534, "vf_explained_var": 0.30459598456659626, "kl": 0.012943297610790539, "entropy": 0.1818598003316951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 488000, "num_agent_steps_sampled": 488000, "num_steps_trained": 488000, "num_agent_steps_trained": 488000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4928, "training_iteration": 122, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-49-51", "timestamp": 1643647791, "time_this_iter_s": 21.420097827911377, "time_total_s": 2468.5093519687653, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2468.5093519687653, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 33.954838709677425, "ram_util_percent": 62.32580645161289}}
{"episode_reward_max": -3.2, "episode_reward_min": -45.1, "episode_reward_mean": -12.067000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.2, -4.999999999999998, -7.3, -10.7, -7.3, -19.6, -4.300000000000001, -8.3, -9.2, -18.3, -9.9, -9.3, -8.2, -14.1, -5.2, -15.6, -8.3, -18.600000000000005, -25.600000000000005, -5.2, -4.3, -3.3, -25.000000000000078, -11.2, -4.300000000000001, -7.3, -4.300000000000001, -23.600000000000016, -10.7, -19.000000000000018, -17.299999999999997, -24.5, -14.799999999999974, -3.2, -12.799999999999997, -3.4, -18.9, -11.599999999999996, -11.799999999999997, -32.2, -14.899999999999999, -19.9, -28.6, -3.3, -8.100000000000001, -17.2, -8.8, -12.3, -9.100000000000001, -4.2, -6.3, -12.999999999999998, -14.999999999999996, -4.2, -15.3, -4.4, -11.1, -3.2, -3.3, -14.5, -11.599999999999998, -20.6, -14.399999999999999, -15.2, -13.499999999999996, -3.3, -19.800000000000004, -28.2, -10.999999999999998, -3.7000000000000006, -6.300000000000001, -12.499999999999996, -15.2, -15.399999999999999, -18.700000000000003, -45.1, -20.39999999999999, -4.300000000000001, -17.199999999999996, -7.8999999999999995, -14.099999999999971, -20.700000000000003, -3.2, -13.099999999999998, -18.2, -26.900000000000002, -7.2, -7.199999999999998, -11.799999999999999, -8.3, -16.2, -8.3, -11.1, -3.3, -3.3, -4.2, -7.9, -3.3, -6.3, -4.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2167749967420574, "mean_inference_ms": 1.5659782832668647, "mean_action_processing_ms": 0.08760717734691696, "mean_env_wait_ms": 7.160581809211201, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 492000, "timesteps_this_iter": 0, "agent_timesteps_total": 492000, "timers": {"sample_time_ms": 21548.947, "sample_throughput": 185.624, "load_time_ms": 0.464, "load_throughput": 8618728.039, "learn_time_ms": 10911.512, "learn_throughput": 366.585, "update_time_ms": 2.17}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.14442337799456811, "policy_loss": -0.006909214105376954, "vf_loss": 15.074348375489635, "vf_explained_var": 0.20866503183559704, "kl": 0.006206264897437826, "entropy": 0.1367417244621182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 492000, "num_agent_steps_sampled": 492000, "num_steps_trained": 492000, "num_agent_steps_trained": 492000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4968, "training_iteration": 123, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-50-13", "timestamp": 1643647813, "time_this_iter_s": 22.601590156555176, "time_total_s": 2491.1109421253204, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2491.1109421253204, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 34.2875, "ram_util_percent": 62.33125}}
{"episode_reward_max": -3.2, "episode_reward_min": -45.1, "episode_reward_mean": -12.324000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.899999999999999, -19.9, -28.6, -3.3, -8.100000000000001, -17.2, -8.8, -12.3, -9.100000000000001, -4.2, -6.3, -12.999999999999998, -14.999999999999996, -4.2, -15.3, -4.4, -11.1, -3.2, -3.3, -14.5, -11.599999999999998, -20.6, -14.399999999999999, -15.2, -13.499999999999996, -3.3, -19.800000000000004, -28.2, -10.999999999999998, -3.7000000000000006, -6.300000000000001, -12.499999999999996, -15.2, -15.399999999999999, -18.700000000000003, -45.1, -20.39999999999999, -4.300000000000001, -17.199999999999996, -7.8999999999999995, -14.099999999999971, -20.700000000000003, -3.2, -13.099999999999998, -18.2, -26.900000000000002, -7.2, -7.199999999999998, -11.799999999999999, -8.3, -16.2, -8.3, -11.1, -3.3, -3.3, -4.2, -7.9, -3.3, -6.3, -4.4, -24.200000000000003, -18.9, -3.2, -19.800000000000004, -20.699999999999996, -10.5, -3.3, -4.300000000000001, -24.59999999999999, -5.2, -15.3, -21.2, -12.499999999999984, -4.300000000000001, -3.3, -8.299999999999999, -15.899999999999999, -23.700000000000003, -6.300000000000001, -4.4, -4.4, -13.6, -4.3, -14.599999999999993, -27.5, -16.3, -10.6, -3.3, -19.4, -12.299999999999995, -22.199999999999996, -8.7, -16.2, -17.0, -33.3, -4.300000000000001, -5.4, -11.699999999999998, -3.2, -14.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2172020392806224, "mean_inference_ms": 1.5667526655248019, "mean_action_processing_ms": 0.08765566245363406, "mean_env_wait_ms": 7.16401012422402, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 496000, "timesteps_this_iter": 0, "agent_timesteps_total": 496000, "timers": {"sample_time_ms": 21820.079, "sample_throughput": 183.317, "load_time_ms": 0.463, "load_throughput": 8633363.866, "learn_time_ms": 11067.189, "learn_throughput": 361.429, "update_time_ms": 2.17}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.08549969468506113, "policy_loss": -0.01109625613517178, "vf_loss": 9.600124119558641, "vf_explained_var": 0.2583126933343949, "kl": 0.006265263246848008, "entropy": 0.1450129923841325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 496000, "num_agent_steps_sampled": 496000, "num_steps_trained": 496000, "num_agent_steps_trained": 496000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5008, "training_iteration": 124, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-50-37", "timestamp": 1643647837, "time_this_iter_s": 23.561221837997437, "time_total_s": 2514.672163963318, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2514.672163963318, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 36.17941176470588, "ram_util_percent": 62.33529411764706}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.3, "episode_reward_mean": -10.651, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.099999999999971, -20.700000000000003, -3.2, -13.099999999999998, -18.2, -26.900000000000002, -7.2, -7.199999999999998, -11.799999999999999, -8.3, -16.2, -8.3, -11.1, -3.3, -3.3, -4.2, -7.9, -3.3, -6.3, -4.4, -24.200000000000003, -18.9, -3.2, -19.800000000000004, -20.699999999999996, -10.5, -3.3, -4.300000000000001, -24.59999999999999, -5.2, -15.3, -21.2, -12.499999999999984, -4.300000000000001, -3.3, -8.299999999999999, -15.899999999999999, -23.700000000000003, -6.300000000000001, -4.4, -4.4, -13.6, -4.3, -14.599999999999993, -27.5, -16.3, -10.6, -3.3, -19.4, -12.299999999999995, -22.199999999999996, -8.7, -16.2, -17.0, -33.3, -4.300000000000001, -5.4, -11.699999999999998, -3.2, -14.2, -23.3, -11.999999999999996, -4.2, -17.1, -5.2, -13.899999999999993, -17.3, -3.2, -17.700000000000003, -8.7, -8.7, -15.799999999999999, -3.3, -5.3, -6.3, -9.0, -10.600000000000001, -7.799999999999999, -3.3, -6.5, -3.3, -4.300000000000001, -3.3, -4.300000000000001, -3.2, -3.3, -4.2, -9.2, -15.5, -3.3, -17.5, -8.799999999999997, -3.2, -12.899999999999999, -10.799999999999999, -16.099999999999998, -19.4, -4.300000000000001, -3.3, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2189534488290719, "mean_inference_ms": 1.5694690068555095, "mean_action_processing_ms": 0.08780300681898229, "mean_env_wait_ms": 7.176593304055398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 500000, "timesteps_this_iter": 0, "agent_timesteps_total": 500000, "timers": {"sample_time_ms": 22407.41, "sample_throughput": 178.512, "load_time_ms": 0.523, "load_throughput": 7652442.985, "learn_time_ms": 11359.781, "learn_throughput": 352.119, "update_time_ms": 2.175}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.0445025421729091, "policy_loss": -0.009833094771070186, "vf_loss": 5.363606770448787, "vf_explained_var": 0.3564293128828849, "kl": 0.007369958241836601, "entropy": 0.15411104949051013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 500000, "num_agent_steps_sampled": 500000, "num_steps_trained": 500000, "num_agent_steps_trained": 500000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5048, "training_iteration": 125, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-51-05", "timestamp": 1643647865, "time_this_iter_s": 28.13029718399048, "time_total_s": 2542.8024611473083, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2542.8024611473083, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 49.495, "ram_util_percent": 62.3625}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.3, "episode_reward_mean": -10.574999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -13.6, -4.3, -14.599999999999993, -27.5, -16.3, -10.6, -3.3, -19.4, -12.299999999999995, -22.199999999999996, -8.7, -16.2, -17.0, -33.3, -4.300000000000001, -5.4, -11.699999999999998, -3.2, -14.2, -23.3, -11.999999999999996, -4.2, -17.1, -5.2, -13.899999999999993, -17.3, -3.2, -17.700000000000003, -8.7, -8.7, -15.799999999999999, -3.3, -5.3, -6.3, -9.0, -10.600000000000001, -7.799999999999999, -3.3, -6.5, -3.3, -4.300000000000001, -3.3, -4.300000000000001, -3.2, -3.3, -4.2, -9.2, -15.5, -3.3, -17.5, -8.799999999999997, -3.2, -12.899999999999999, -10.799999999999999, -16.099999999999998, -19.4, -4.300000000000001, -3.3, -4.300000000000001, -13.5, -10.5, -19.5, -9.8, -9.2, -13.7, -9.7, -17.9, -3.3, -21.099999999999998, -5.2, -14.799999999999995, -22.100000000000033, -20.300000000000008, -3.2, -7.2, -12.999999999999998, -8.3, -7.3, -3.3, -11.7, -18.7, -3.3, -7.899999999999999, -8.5, -9.799999999999999, -10.1, -4.9, -3.2, -14.799999999999999, -3.3, -22.499999999999996, -9.9, -3.3, -17.1, -5.2, -14.599999999999973, -9.499999999999998, -3.3, -26.799999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2217561827034205, "mean_inference_ms": 1.5730649825612675, "mean_action_processing_ms": 0.08800246320032533, "mean_env_wait_ms": 7.193524245039345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 504000, "timesteps_this_iter": 0, "agent_timesteps_total": 504000, "timers": {"sample_time_ms": 22974.553, "sample_throughput": 174.106, "load_time_ms": 0.525, "load_throughput": 7621849.9, "learn_time_ms": 11657.418, "learn_throughput": 343.129, "update_time_ms": 2.202}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.1076667014309155, "policy_loss": -0.009242005502024005, "vf_loss": 11.603260880003694, "vf_explained_var": 0.28628080660297023, "kl": 0.009229689410335895, "entropy": 0.17894638991484077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 504000, "num_agent_steps_sampled": 504000, "num_steps_trained": 504000, "num_agent_steps_trained": 504000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5088, "training_iteration": 126, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-51-33", "timestamp": 1643647893, "time_this_iter_s": 27.39052700996399, "time_total_s": 2570.1929881572723, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2570.1929881572723, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 49.08947368421053, "ram_util_percent": 62.315789473684234}}
{"episode_reward_max": -3.2, "episode_reward_min": -118.5, "episode_reward_mean": -11.378000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -4.300000000000001, -3.3, -4.300000000000001, -3.2, -3.3, -4.2, -9.2, -15.5, -3.3, -17.5, -8.799999999999997, -3.2, -12.899999999999999, -10.799999999999999, -16.099999999999998, -19.4, -4.300000000000001, -3.3, -4.300000000000001, -13.5, -10.5, -19.5, -9.8, -9.2, -13.7, -9.7, -17.9, -3.3, -21.099999999999998, -5.2, -14.799999999999995, -22.100000000000033, -20.300000000000008, -3.2, -7.2, -12.999999999999998, -8.3, -7.3, -3.3, -11.7, -18.7, -3.3, -7.899999999999999, -8.5, -9.799999999999999, -10.1, -4.9, -3.2, -14.799999999999999, -3.3, -22.499999999999996, -9.9, -3.3, -17.1, -5.2, -14.599999999999973, -9.499999999999998, -3.3, -26.799999999999997, -19.2, -3.3, -24.6, -13.2, -118.5, -17.2, -14.199999999999998, -15.5, -20.9, -3.4, -39.30000000000008, -3.2, -15.3, -21.099999999999998, -13.7, -3.3, -3.3, -7.300000000000001, -7.0, -19.099999999999998, -3.2, -22.5, -10.499999999999998, -3.4, -11.7, -12.599999999999996, -13.4, -8.9, -3.3, -3.3, -3.3, -5.4, -13.000000000000002, -3.2, -3.3, -4.3, -16.9, -3.2, -3.2, -10.799999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.224216641450644, "mean_inference_ms": 1.5762302444438614, "mean_action_processing_ms": 0.08817825452217669, "mean_env_wait_ms": 7.208618482862545, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 508000, "timesteps_this_iter": 0, "agent_timesteps_total": 508000, "timers": {"sample_time_ms": 23427.762, "sample_throughput": 170.738, "load_time_ms": 0.525, "load_throughput": 7616313.782, "learn_time_ms": 11804.044, "learn_throughput": 338.867, "update_time_ms": 2.149}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.36188138324882513, "policy_loss": -0.010794444802787996, "vf_loss": 37.17172169063681, "vf_explained_var": 0.22812457417929044, "kl": 0.010099064999188986, "entropy": 0.16169839976856146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 508000, "num_agent_steps_sampled": 508000, "num_steps_trained": 508000, "num_agent_steps_trained": 508000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5128, "training_iteration": 127, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-51-57", "timestamp": 1643647917, "time_this_iter_s": 24.62048101425171, "time_total_s": 2594.813469171524, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2594.813469171524, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 46.51666666666667, "ram_util_percent": 62.34444444444446}}
{"episode_reward_max": -3.2, "episode_reward_min": -118.5, "episode_reward_mean": -11.485000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.7, -18.7, -3.3, -7.899999999999999, -8.5, -9.799999999999999, -10.1, -4.9, -3.2, -14.799999999999999, -3.3, -22.499999999999996, -9.9, -3.3, -17.1, -5.2, -14.599999999999973, -9.499999999999998, -3.3, -26.799999999999997, -19.2, -3.3, -24.6, -13.2, -118.5, -17.2, -14.199999999999998, -15.5, -20.9, -3.4, -39.30000000000008, -3.2, -15.3, -21.099999999999998, -13.7, -3.3, -3.3, -7.300000000000001, -7.0, -19.099999999999998, -3.2, -22.5, -10.499999999999998, -3.4, -11.7, -12.599999999999996, -13.4, -8.9, -3.3, -3.3, -3.3, -5.4, -13.000000000000002, -3.2, -3.3, -4.3, -16.9, -3.2, -3.2, -10.799999999999999, -17.1, -9.2, -8.1, -8.1, -3.3, -4.0, -21.39999999999999, -4.300000000000001, -22.6, -12.5, -9.5, -3.3, -3.3, -9.2, -8.899999999999999, -7.2, -26.299999999999997, -3.2, -3.3, -16.9, -14.7, -7.899999999999999, -15.5, -5.4, -3.3, -17.700000000000003, -3.3, -33.50000000000005, -3.3, -9.899999999999999, -8.399999999999999, -15.80000000000001, -9.0, -4.2, -3.2, -14.099999999999998, -4.300000000000001, -3.2, -15.399999999999999, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.226060082159613, "mean_inference_ms": 1.5791524438762259, "mean_action_processing_ms": 0.088341027870089, "mean_env_wait_ms": 7.222821063848042, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 512000, "timesteps_this_iter": 0, "agent_timesteps_total": 512000, "timers": {"sample_time_ms": 23800.285, "sample_throughput": 168.065, "load_time_ms": 0.528, "load_throughput": 7577100.533, "learn_time_ms": 11850.551, "learn_throughput": 337.537, "update_time_ms": 2.185}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.07850426083670989, "policy_loss": -0.01969171200418264, "vf_loss": 9.708683006994185, "vf_explained_var": 0.19566739329727748, "kl": 0.011684808097929449, "entropy": 0.16964857876901665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 512000, "num_agent_steps_sampled": 512000, "num_steps_trained": 512000, "num_agent_steps_trained": 512000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5168, "training_iteration": 128, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-52-22", "timestamp": 1643647942, "time_this_iter_s": 24.554877758026123, "time_total_s": 2619.36834692955, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2619.36834692955, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 49.69142857142857, "ram_util_percent": 62.33428571428572}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.50000000000005, "episode_reward_mean": -8.828000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.7, -12.599999999999996, -13.4, -8.9, -3.3, -3.3, -3.3, -5.4, -13.000000000000002, -3.2, -3.3, -4.3, -16.9, -3.2, -3.2, -10.799999999999999, -17.1, -9.2, -8.1, -8.1, -3.3, -4.0, -21.39999999999999, -4.300000000000001, -22.6, -12.5, -9.5, -3.3, -3.3, -9.2, -8.899999999999999, -7.2, -26.299999999999997, -3.2, -3.3, -16.9, -14.7, -7.899999999999999, -15.5, -5.4, -3.3, -17.700000000000003, -3.3, -33.50000000000005, -3.3, -9.899999999999999, -8.399999999999999, -15.80000000000001, -9.0, -4.2, -3.2, -14.099999999999998, -4.300000000000001, -3.2, -15.399999999999999, -4.300000000000001, -12.899999999999999, -7.3, -14.4, -4.3, -8.7, -3.3, -11.599999999999996, -4.2, -9.1, -16.899999999999974, -14.099999999999998, -4.300000000000001, -8.200000000000001, -4.9, -13.1, -10.5, -3.3, -6.300000000000001, -8.6, -5.3, -4.3, -9.199999999999998, -3.2, -3.3, -8.8, -3.2, -14.599999999999998, -24.400000000000002, -4.300000000000001, -21.50000000000001, -3.4, -8.3, -8.700000000000001, -13.7, -9.499999999999995, -3.700000000000001, -9.899999999999997, -3.2, -4.3, -5.3, -4.2, -15.099999999999996, -3.2, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2276979771221315, "mean_inference_ms": 1.581547406066261, "mean_action_processing_ms": 0.08852908443936712, "mean_env_wait_ms": 7.235415400363368, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 516000, "timesteps_this_iter": 0, "agent_timesteps_total": 516000, "timers": {"sample_time_ms": 23857.251, "sample_throughput": 167.664, "load_time_ms": 0.527, "load_throughput": 7594937.076, "learn_time_ms": 11926.004, "learn_throughput": 335.402, "update_time_ms": 2.178}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.05160520798126136, "policy_loss": -0.008193289565663505, "vf_loss": 5.924118838996016, "vf_explained_var": 0.3389643988301677, "kl": 0.005871259515811165, "entropy": 0.17330603858716384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 516000, "num_agent_steps_sampled": 516000, "num_steps_trained": 516000, "num_agent_steps_trained": 516000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5212, "training_iteration": 129, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-52-45", "timestamp": 1643647965, "time_this_iter_s": 23.09631109237671, "time_total_s": 2642.464658021927, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2642.464658021927, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 31.478787878787877, "ram_util_percent": 62.306060606060605}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.50000000000005, "episode_reward_mean": -9.118, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -17.700000000000003, -3.3, -33.50000000000005, -3.3, -9.899999999999999, -8.399999999999999, -15.80000000000001, -9.0, -4.2, -3.2, -14.099999999999998, -4.300000000000001, -3.2, -15.399999999999999, -4.300000000000001, -12.899999999999999, -7.3, -14.4, -4.3, -8.7, -3.3, -11.599999999999996, -4.2, -9.1, -16.899999999999974, -14.099999999999998, -4.300000000000001, -8.200000000000001, -4.9, -13.1, -10.5, -3.3, -6.300000000000001, -8.6, -5.3, -4.3, -9.199999999999998, -3.2, -3.3, -8.8, -3.2, -14.599999999999998, -24.400000000000002, -4.300000000000001, -21.50000000000001, -3.4, -8.3, -8.700000000000001, -13.7, -9.499999999999995, -3.700000000000001, -9.899999999999997, -3.2, -4.3, -5.3, -4.2, -15.099999999999996, -3.2, -4.300000000000001, -3.2, -3.2, -13.0, -5.3, -4.3, -13.09999999999999, -15.299999999999997, -19.3, -15.6, -10.3, -3.3, -3.3, -13.799999999999995, -5.999999999999993, -7.8999999999999995, -6.499999999999999, -5.2, -16.4, -14.5, -22.099999999999998, -4.3, -3.4, -32.199999999999996, -9.499999999999996, -12.399999999999997, -7.699999999999999, -3.2, -10.499999999999996, -15.899999999999999, -4.300000000000001, -3.3, -9.299999999999999, -8.3, -3.3, -8.199999999999998, -12.6, -14.3, -3.3, -4.2, -22.200000000000003], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2303565236279852, "mean_inference_ms": 1.5844673856777445, "mean_action_processing_ms": 0.08869749203615336, "mean_env_wait_ms": 7.249404626286183, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 520000, "timesteps_this_iter": 0, "agent_timesteps_total": 520000, "timers": {"sample_time_ms": 24356.612, "sample_throughput": 164.226, "load_time_ms": 0.55, "load_throughput": 7267898.111, "learn_time_ms": 12200.274, "learn_throughput": 327.861, "update_time_ms": 2.221}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.09129520399916556, "policy_loss": -0.0004343085071092011, "vf_loss": 9.114719255861417, "vf_explained_var": 0.30622549806871724, "kl": 0.00613476491872772, "entropy": 0.16060426008477005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 520000, "num_agent_steps_sampled": 520000, "num_steps_trained": 520000, "num_agent_steps_trained": 520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5252, "training_iteration": 130, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-53-14", "timestamp": 1643647994, "time_this_iter_s": 28.859044790267944, "time_total_s": 2671.323702812195, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2671.323702812195, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 40.01219512195122, "ram_util_percent": 62.38780487804878}}
{"episode_reward_max": -3.2, "episode_reward_min": -48.499999999999936, "episode_reward_mean": -10.208999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.8, -3.2, -14.599999999999998, -24.400000000000002, -4.300000000000001, -21.50000000000001, -3.4, -8.3, -8.700000000000001, -13.7, -9.499999999999995, -3.700000000000001, -9.899999999999997, -3.2, -4.3, -5.3, -4.2, -15.099999999999996, -3.2, -4.300000000000001, -3.2, -3.2, -13.0, -5.3, -4.3, -13.09999999999999, -15.299999999999997, -19.3, -15.6, -10.3, -3.3, -3.3, -13.799999999999995, -5.999999999999993, -7.8999999999999995, -6.499999999999999, -5.2, -16.4, -14.5, -22.099999999999998, -4.3, -3.4, -32.199999999999996, -9.499999999999996, -12.399999999999997, -7.699999999999999, -3.2, -10.499999999999996, -15.899999999999999, -4.300000000000001, -3.3, -9.299999999999999, -8.3, -3.3, -8.199999999999998, -12.6, -14.3, -3.3, -4.2, -22.200000000000003, -19.099999999999994, -10.899999999999999, -7.099999999999998, -13.999999999999998, -7.7, -5.3, -10.2, -3.4, -8.3, -5.4, -3.3, -7.4, -6.6000000000000005, -7.099999999999998, -14.999999999999996, -48.499999999999936, -3.2, -12.399999999999999, -21.500000000000004, -5.599999999999999, -4.2, -17.400000000000002, -3.4, -15.399999999999999, -34.80000000000006, -22.600000000000005, -5.3, -3.2, -8.799999999999997, -12.799999999999999, -10.7, -3.6000000000000005, -3.2, -20.5, -11.999999999999998, -29.0, -3.4, -6.899999999999999, -10.8, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2337274400792666, "mean_inference_ms": 1.588227570324768, "mean_action_processing_ms": 0.08886475494526974, "mean_env_wait_ms": 7.266655247463557, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 524000, "timesteps_this_iter": 0, "agent_timesteps_total": 524000, "timers": {"sample_time_ms": 24923.143, "sample_throughput": 160.493, "load_time_ms": 0.562, "load_throughput": 7119548.483, "learn_time_ms": 12386.726, "learn_throughput": 322.926, "update_time_ms": 2.298}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.16501330684329713, "policy_loss": -0.005996156171444923, "vf_loss": 17.029066760565645, "vf_explained_var": 0.21624455663465683, "kl": 0.007572537118928845, "entropy": 0.19827324807724003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 524000, "num_agent_steps_sampled": 524000, "num_steps_trained": 524000, "num_agent_steps_trained": 524000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5292, "training_iteration": 131, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-53-40", "timestamp": 1643648020, "time_this_iter_s": 26.412877082824707, "time_total_s": 2697.7365798950195, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2697.7365798950195, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 37.36756756756756, "ram_util_percent": 62.3891891891892}}
{"episode_reward_max": -3.2, "episode_reward_min": -48.499999999999936, "episode_reward_mean": -11.145, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -3.4, -32.199999999999996, -9.499999999999996, -12.399999999999997, -7.699999999999999, -3.2, -10.499999999999996, -15.899999999999999, -4.300000000000001, -3.3, -9.299999999999999, -8.3, -3.3, -8.199999999999998, -12.6, -14.3, -3.3, -4.2, -22.200000000000003, -19.099999999999994, -10.899999999999999, -7.099999999999998, -13.999999999999998, -7.7, -5.3, -10.2, -3.4, -8.3, -5.4, -3.3, -7.4, -6.6000000000000005, -7.099999999999998, -14.999999999999996, -48.499999999999936, -3.2, -12.399999999999999, -21.500000000000004, -5.599999999999999, -4.2, -17.400000000000002, -3.4, -15.399999999999999, -34.80000000000006, -22.600000000000005, -5.3, -3.2, -8.799999999999997, -12.799999999999999, -10.7, -3.6000000000000005, -3.2, -20.5, -11.999999999999998, -29.0, -3.4, -6.899999999999999, -10.8, -3.3, -3.4, -13.799999999999995, -4.2, -9.9, -15.799999999999997, -13.499999999999998, -15.6, -3.3, -24.3, -3.3, -7.2, -7.799999999999999, -17.2, -8.1, -3.3, -3.3, -11.599999999999978, -40.4, -4.300000000000001, -15.299999999999999, -10.2, -23.3, -18.799999999999997, -3.3, -7.3, -5.3, -13.799999999999994, -4.3, -26.700000000000003, -27.7, -14.799999999999999, -3.900000000000001, -10.099999999999998, -17.999999999999993, -14.8, -8.999999999999996, -8.799999999999997, -3.4, -16.5, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2367706913821928, "mean_inference_ms": 1.5921373760844204, "mean_action_processing_ms": 0.08907711838223001, "mean_env_wait_ms": 7.284298133470781, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 528000, "timesteps_this_iter": 0, "agent_timesteps_total": 528000, "timers": {"sample_time_ms": 25337.972, "sample_throughput": 157.866, "load_time_ms": 0.563, "load_throughput": 7110496.292, "learn_time_ms": 12431.068, "learn_throughput": 321.774, "update_time_ms": 2.303}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.11873816980840138, "policy_loss": -0.003519224195230392, "vf_loss": 12.17577836843588, "vf_explained_var": 0.20895276050413808, "kl": 0.005263420522722617, "entropy": 0.17152032665307484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 528000, "num_agent_steps_sampled": 528000, "num_steps_trained": 528000, "num_agent_steps_trained": 528000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5332, "training_iteration": 132, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-54-05", "timestamp": 1643648045, "time_this_iter_s": 24.139716863632202, "time_total_s": 2721.8762967586517, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2721.8762967586517, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 45.754285714285714, "ram_util_percent": 62.35714285714287}}
{"episode_reward_max": -3.2, "episode_reward_min": -40.4, "episode_reward_mean": -10.999999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -17.400000000000002, -3.4, -15.399999999999999, -34.80000000000006, -22.600000000000005, -5.3, -3.2, -8.799999999999997, -12.799999999999999, -10.7, -3.6000000000000005, -3.2, -20.5, -11.999999999999998, -29.0, -3.4, -6.899999999999999, -10.8, -3.3, -3.4, -13.799999999999995, -4.2, -9.9, -15.799999999999997, -13.499999999999998, -15.6, -3.3, -24.3, -3.3, -7.2, -7.799999999999999, -17.2, -8.1, -3.3, -3.3, -11.599999999999978, -40.4, -4.300000000000001, -15.299999999999999, -10.2, -23.3, -18.799999999999997, -3.3, -7.3, -5.3, -13.799999999999994, -4.3, -26.700000000000003, -27.7, -14.799999999999999, -3.900000000000001, -10.099999999999998, -17.999999999999993, -14.8, -8.999999999999996, -8.799999999999997, -3.4, -16.5, -3.2, -9.2, -11.2, -4.2, -25.7, -3.4, -7.3, -9.8, -13.7, -4.3, -5.2, -3.2, -11.6, -5.5, -13.3, -3.3, -12.899999999999999, -18.5, -23.799999999999997, -18.699999999999996, -12.999999999999982, -11.3, -7.699999999999998, -12.499999999999996, -4.300000000000001, -9.1, -18.1, -4.4, -18.900000000000006, -10.3, -3.3, -3.3, -7.2, -18.699999999999996, -8.2, -3.2, -4.4, -7.599999999999999, -14.799999999999997, -7.2, -7.6000000000000005], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2382667114410721, "mean_inference_ms": 1.5940841979572036, "mean_action_processing_ms": 0.08918572218649017, "mean_env_wait_ms": 7.293435346291606, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 532000, "timesteps_this_iter": 0, "agent_timesteps_total": 532000, "timers": {"sample_time_ms": 25392.15, "sample_throughput": 157.529, "load_time_ms": 0.563, "load_throughput": 7101467.09, "learn_time_ms": 12289.133, "learn_throughput": 325.491, "update_time_ms": 2.303}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.06816638055738182, "policy_loss": -0.008720037066728198, "vf_loss": 7.606514691104812, "vf_explained_var": 0.3925549191813315, "kl": 0.008652096245401033, "entropy": 0.18722931784928165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 532000, "num_agent_steps_sampled": 532000, "num_steps_trained": 532000, "num_agent_steps_trained": 532000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5372, "training_iteration": 133, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-54-26", "timestamp": 1643648066, "time_this_iter_s": 21.28165602684021, "time_total_s": 2743.157952785492, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2743.157952785492, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 40.35333333333333, "ram_util_percent": 62.35666666666668}}
{"episode_reward_max": -3.2, "episode_reward_min": -114.60000000000018, "episode_reward_mean": -12.28, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.2, -23.3, -18.799999999999997, -3.3, -7.3, -5.3, -13.799999999999994, -4.3, -26.700000000000003, -27.7, -14.799999999999999, -3.900000000000001, -10.099999999999998, -17.999999999999993, -14.8, -8.999999999999996, -8.799999999999997, -3.4, -16.5, -3.2, -9.2, -11.2, -4.2, -25.7, -3.4, -7.3, -9.8, -13.7, -4.3, -5.2, -3.2, -11.6, -5.5, -13.3, -3.3, -12.899999999999999, -18.5, -23.799999999999997, -18.699999999999996, -12.999999999999982, -11.3, -7.699999999999998, -12.499999999999996, -4.300000000000001, -9.1, -18.1, -4.4, -18.900000000000006, -10.3, -3.3, -3.3, -7.2, -18.699999999999996, -8.2, -3.2, -4.4, -7.599999999999999, -14.799999999999997, -7.2, -7.6000000000000005, -16.4, -3.3, -17.8, -4.2, -3.3, -16.099999999999998, -3.3, -19.7, -15.499999999999979, -7.2, -16.700000000000003, -20.2, -13.799999999999997, -12.1, -3.2, -3.2, -4.4, -6.9, -3.3, -21.999999999999996, -9.3, -17.3, -10.299999999999999, -7.2, -25.5, -23.799999999999997, -6.499999999999999, -17.8, -5.2, -29.90000000000002, -3.3, -114.60000000000018, -10.999999999999996, -15.399999999999975, -20.299999999999997, -5.5, -17.60000000000002, -17.900000000000002, -8.3, -5.6], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2392700760394992, "mean_inference_ms": 1.5954350791022056, "mean_action_processing_ms": 0.08926850751201734, "mean_env_wait_ms": 7.299755594146628, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 536000, "timesteps_this_iter": 0, "agent_timesteps_total": 536000, "timers": {"sample_time_ms": 25347.078, "sample_throughput": 157.809, "load_time_ms": 0.614, "load_throughput": 6517448.528, "learn_time_ms": 12436.244, "learn_throughput": 321.641, "update_time_ms": 2.421}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.5771359089919696, "policy_loss": -0.01859090543322025, "vf_loss": 59.390510655859465, "vf_explained_var": 0.18772747125676884, "kl": 0.019191918862186737, "entropy": 0.2040247971532486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 536000, "num_agent_steps_sampled": 536000, "num_steps_trained": 536000, "num_agent_steps_trained": 536000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5412, "training_iteration": 134, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-54-52", "timestamp": 1643648092, "time_this_iter_s": 26.017555236816406, "time_total_s": 2769.1755080223083, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2769.1755080223083, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 49.53243243243243, "ram_util_percent": 62.39729729729731}}
{"episode_reward_max": -3.2, "episode_reward_min": -114.60000000000018, "episode_reward_mean": -12.306000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.3, -7.699999999999998, -12.499999999999996, -4.300000000000001, -9.1, -18.1, -4.4, -18.900000000000006, -10.3, -3.3, -3.3, -7.2, -18.699999999999996, -8.2, -3.2, -4.4, -7.599999999999999, -14.799999999999997, -7.2, -7.6000000000000005, -16.4, -3.3, -17.8, -4.2, -3.3, -16.099999999999998, -3.3, -19.7, -15.499999999999979, -7.2, -16.700000000000003, -20.2, -13.799999999999997, -12.1, -3.2, -3.2, -4.4, -6.9, -3.3, -21.999999999999996, -9.3, -17.3, -10.299999999999999, -7.2, -25.5, -23.799999999999997, -6.499999999999999, -17.8, -5.2, -29.90000000000002, -3.3, -114.60000000000018, -10.999999999999996, -15.399999999999975, -20.299999999999997, -5.5, -17.60000000000002, -17.900000000000002, -8.3, -5.6, -16.199999999999996, -20.700000000000006, -23.799999999999997, -3.3, -3.4, -4.3, -18.9, -3.4, -3.3, -21.099999999999998, -16.6, -4.3, -3.3, -15.5, -13.999999999999979, -3.3, -7.2, -3.3, -75.00000000000003, -4.300000000000001, -9.0, -3.3, -3.3, -5.3, -3.3, -11.399999999999999, -13.3, -23.7, -4.300000000000001, -8.2, -5.4, -5.3, -3.2, -8.199999999999996, -26.2, -12.4, -17.2, -4.3, -17.0, -14.099999999999996], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2410302933020236, "mean_inference_ms": 1.5979203616769428, "mean_action_processing_ms": 0.0894124694158513, "mean_env_wait_ms": 7.311582542394085, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 540000, "timesteps_this_iter": 0, "agent_timesteps_total": 540000, "timers": {"sample_time_ms": 25468.216, "sample_throughput": 157.059, "load_time_ms": 0.561, "load_throughput": 7126806.848, "learn_time_ms": 12486.503, "learn_throughput": 320.346, "update_time_ms": 2.5}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.15139967854665493, "policy_loss": -0.005910231340275977, "vf_loss": 15.675949495389897, "vf_explained_var": 0.1516197895490995, "kl": 0.00579865849323852, "entropy": 0.16545600601902571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 540000, "num_agent_steps_sampled": 540000, "num_steps_trained": 540000, "num_agent_steps_trained": 540000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5452, "training_iteration": 135, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-55-20", "timestamp": 1643648120, "time_this_iter_s": 28.357330322265625, "time_total_s": 2797.532838344574, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2797.532838344574, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 42.72439024390244, "ram_util_percent": 62.33902439024391}}
{"episode_reward_max": -1.3, "episode_reward_min": -114.60000000000018, "episode_reward_mean": -12.763000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.3, -17.3, -10.299999999999999, -7.2, -25.5, -23.799999999999997, -6.499999999999999, -17.8, -5.2, -29.90000000000002, -3.3, -114.60000000000018, -10.999999999999996, -15.399999999999975, -20.299999999999997, -5.5, -17.60000000000002, -17.900000000000002, -8.3, -5.6, -16.199999999999996, -20.700000000000006, -23.799999999999997, -3.3, -3.4, -4.3, -18.9, -3.4, -3.3, -21.099999999999998, -16.6, -4.3, -3.3, -15.5, -13.999999999999979, -3.3, -7.2, -3.3, -75.00000000000003, -4.300000000000001, -9.0, -3.3, -3.3, -5.3, -3.3, -11.399999999999999, -13.3, -23.7, -4.300000000000001, -8.2, -5.4, -5.3, -3.2, -8.199999999999996, -26.2, -12.4, -17.2, -4.3, -17.0, -14.099999999999996, -1.3, -43.3, -6.700000000000001, -8.3, -14.999999999999993, -14.3, -22.3, -12.099999999999971, -13.999999999999995, -21.9, -11.199999999999998, -10.399999999999999, -9.5, -12.3, -20.9, -7.700000000000001, -3.3, -9.699999999999998, -18.2, -3.2, -16.599999999999994, -9.8, -3.3, -3.3, -11.299999999999997, -3.3, -3.2, -3.2, -19.8, -5.0, -8.5, -14.199999999999998, -11.8, -13.6, -9.899999999999999, -5.9, -7.3, -15.2, -5.2, -4.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2433596729440355, "mean_inference_ms": 1.601087490683536, "mean_action_processing_ms": 0.08958980414493371, "mean_env_wait_ms": 7.326318224814713, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 544000, "timesteps_this_iter": 0, "agent_timesteps_total": 544000, "timers": {"sample_time_ms": 25498.173, "sample_throughput": 156.874, "load_time_ms": 0.541, "load_throughput": 7395079.12, "learn_time_ms": 12214.477, "learn_throughput": 327.48, "update_time_ms": 2.562}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.13131685484531186, "policy_loss": -0.008800516029198964, "vf_loss": 13.949731427431107, "vf_explained_var": 0.2670979415216754, "kl": 0.006532325849963533, "entropy": 0.16565985432074917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 544000, "num_agent_steps_sampled": 544000, "num_steps_trained": 544000, "num_agent_steps_trained": 544000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5492, "training_iteration": 136, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-55-45", "timestamp": 1643648145, "time_this_iter_s": 24.44004988670349, "time_total_s": 2821.9728882312775, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2821.9728882312775, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 39.54117647058823, "ram_util_percent": 62.36176470588236}}
{"episode_reward_max": -1.3, "episode_reward_min": -75.59999999999991, "episode_reward_mean": -11.411999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, -3.3, -3.3, -5.3, -3.3, -11.399999999999999, -13.3, -23.7, -4.300000000000001, -8.2, -5.4, -5.3, -3.2, -8.199999999999996, -26.2, -12.4, -17.2, -4.3, -17.0, -14.099999999999996, -1.3, -43.3, -6.700000000000001, -8.3, -14.999999999999993, -14.3, -22.3, -12.099999999999971, -13.999999999999995, -21.9, -11.199999999999998, -10.399999999999999, -9.5, -12.3, -20.9, -7.700000000000001, -3.3, -9.699999999999998, -18.2, -3.2, -16.599999999999994, -9.8, -3.3, -3.3, -11.299999999999997, -3.3, -3.2, -3.2, -19.8, -5.0, -8.5, -14.199999999999998, -11.8, -13.6, -9.899999999999999, -5.9, -7.3, -15.2, -5.2, -4.4, -18.2, -5.7, -14.7, -9.2, -3.2, -9.3, -3.2, -14.299999999999997, -9.6, -10.5, -21.80000000000002, -3.3, -4.2, -17.6, -3.2, -13.5, -12.099999999999998, -3.3, -7.2, -75.59999999999991, -14.999999999999998, -12.6, -12.3, -8.3, -8.1, -3.2, -4.300000000000001, -11.5, -5.2, -18.3, -13.9, -10.499999999999998, -16.5, -15.9, -13.999999999999996, -3.3, -26.799999999999997, -9.100000000000001, -17.19999999999997, -16.7], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2455289749693563, "mean_inference_ms": 1.6040351484275766, "mean_action_processing_ms": 0.08974707122566246, "mean_env_wait_ms": 7.339873183001271, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 548000, "timesteps_this_iter": 0, "agent_timesteps_total": 548000, "timers": {"sample_time_ms": 25287.334, "sample_throughput": 158.182, "load_time_ms": 0.541, "load_throughput": 7393449.674, "learn_time_ms": 12241.887, "learn_throughput": 326.747, "update_time_ms": 2.677}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.274809354529666, "policy_loss": -0.010663827552249835, "vf_loss": 28.47349761660381, "vf_explained_var": 0.2215784195289817, "kl": 0.007777027278912013, "entropy": 0.18923014792543585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 548000, "num_agent_steps_sampled": 548000, "num_steps_trained": 548000, "num_agent_steps_trained": 548000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5532, "training_iteration": 137, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-56-10", "timestamp": 1643648170, "time_this_iter_s": 25.51592516899109, "time_total_s": 2847.4888134002686, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2847.4888134002686, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 47.810810810810814, "ram_util_percent": 62.39729729729731}}
{"episode_reward_max": -3.2, "episode_reward_min": -75.59999999999991, "episode_reward_mean": -11.597999999999997, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.599999999999994, -9.8, -3.3, -3.3, -11.299999999999997, -3.3, -3.2, -3.2, -19.8, -5.0, -8.5, -14.199999999999998, -11.8, -13.6, -9.899999999999999, -5.9, -7.3, -15.2, -5.2, -4.4, -18.2, -5.7, -14.7, -9.2, -3.2, -9.3, -3.2, -14.299999999999997, -9.6, -10.5, -21.80000000000002, -3.3, -4.2, -17.6, -3.2, -13.5, -12.099999999999998, -3.3, -7.2, -75.59999999999991, -14.999999999999998, -12.6, -12.3, -8.3, -8.1, -3.2, -4.300000000000001, -11.5, -5.2, -18.3, -13.9, -10.499999999999998, -16.5, -15.9, -13.999999999999996, -3.3, -26.799999999999997, -9.100000000000001, -17.19999999999997, -16.7, -4.2, -4.2, -6.3999999999999995, -3.4, -22.000000000000007, -4.2, -23.299999999999997, -7.999999999999998, -7.5, -8.8, -7.3, -22.6, -7.2, -15.899999999999997, -6.3, -15.3, -7.2, -10.499999999999995, -67.20000000000002, -3.3, -8.099999999999998, -19.5, -12.1, -7.199999999999999, -8.3, -3.2, -7.3, -20.6, -7.2, -9.399999999999999, -18.599999999999998, -10.8, -8.3, -20.499999999999996, -3.3, -18.400000000000006, -19.099999999999994, -3.3, -19.300000000000008, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.248114364210113, "mean_inference_ms": 1.607219400876944, "mean_action_processing_ms": 0.08991896047941544, "mean_env_wait_ms": 7.354791029602512, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 552000, "timesteps_this_iter": 0, "agent_timesteps_total": 552000, "timers": {"sample_time_ms": 25426.607, "sample_throughput": 157.316, "load_time_ms": 0.55, "load_throughput": 7275146.785, "learn_time_ms": 12701.439, "learn_throughput": 314.925, "update_time_ms": 2.668}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.2827799677032657, "policy_loss": -0.007528275316230632, "vf_loss": 28.943593529091086, "vf_explained_var": 0.04344875171620359, "kl": 0.009189789130072883, "entropy": 0.17198922773723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 552000, "num_agent_steps_sampled": 552000, "num_steps_trained": 552000, "num_agent_steps_trained": 552000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5572, "training_iteration": 138, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-56-41", "timestamp": 1643648201, "time_this_iter_s": 30.260338306427002, "time_total_s": 2877.7491517066956, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2877.7491517066956, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 51.12558139534883, "ram_util_percent": 62.34651162790699}}
{"episode_reward_max": -3.2, "episode_reward_min": -67.20000000000002, "episode_reward_mean": -11.536, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.1, -3.2, -4.300000000000001, -11.5, -5.2, -18.3, -13.9, -10.499999999999998, -16.5, -15.9, -13.999999999999996, -3.3, -26.799999999999997, -9.100000000000001, -17.19999999999997, -16.7, -4.2, -4.2, -6.3999999999999995, -3.4, -22.000000000000007, -4.2, -23.299999999999997, -7.999999999999998, -7.5, -8.8, -7.3, -22.6, -7.2, -15.899999999999997, -6.3, -15.3, -7.2, -10.499999999999995, -67.20000000000002, -3.3, -8.099999999999998, -19.5, -12.1, -7.199999999999999, -8.3, -3.2, -7.3, -20.6, -7.2, -9.399999999999999, -18.599999999999998, -10.8, -8.3, -20.499999999999996, -3.3, -18.400000000000006, -19.099999999999994, -3.3, -19.300000000000008, -3.3, -19.7, -3.2, -8.2, -10.299999999999995, -3.8000000000000007, -7.3, -18.5, -21.8, -3.2, -8.3, -15.499999999999996, -3.2, -5.3, -12.2, -4.300000000000001, -27.2, -5.6, -7.2, -5.300000000000001, -18.4, -3.4, -16.299999999999997, -7.3, -15.899999999999999, -12.0, -3.2, -26.700000000000006, -4.2, -3.3, -13.6, -29.59999999999996, -12.799999999999999, -4.2, -3.3, -8.2, -3.4, -3.3, -11.499999999999998, -3.4, -16.9, -9.3, -12.5, -27.3, -16.400000000000002], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2523926850774547, "mean_inference_ms": 1.611360255590414, "mean_action_processing_ms": 0.0901984514616556, "mean_env_wait_ms": 7.375120240394417, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 556000, "timesteps_this_iter": 0, "agent_timesteps_total": 556000, "timers": {"sample_time_ms": 26243.951, "sample_throughput": 152.416, "load_time_ms": 0.592, "load_throughput": 6757377.155, "learn_time_ms": 12625.263, "learn_throughput": 316.825, "update_time_ms": 2.708}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.12867821912476493, "policy_loss": -0.0010400298361976942, "vf_loss": 12.916061290233365, "vf_explained_var": 0.18839963623272477, "kl": 0.005874732253230404, "entropy": 0.18242764960453717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 556000, "num_agent_steps_sampled": 556000, "num_steps_trained": 556000, "num_agent_steps_trained": 556000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5616, "training_iteration": 139, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-57-07", "timestamp": 1643648227, "time_this_iter_s": 25.89128088951111, "time_total_s": 2903.6404325962067, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2903.6404325962067, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 52.6972972972973, "ram_util_percent": 62.28918918918921}}
{"episode_reward_max": -2.2, "episode_reward_min": -31.299999999999958, "episode_reward_mean": -10.591999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.3, -3.2, -7.3, -20.6, -7.2, -9.399999999999999, -18.599999999999998, -10.8, -8.3, -20.499999999999996, -3.3, -18.400000000000006, -19.099999999999994, -3.3, -19.300000000000008, -3.3, -19.7, -3.2, -8.2, -10.299999999999995, -3.8000000000000007, -7.3, -18.5, -21.8, -3.2, -8.3, -15.499999999999996, -3.2, -5.3, -12.2, -4.300000000000001, -27.2, -5.6, -7.2, -5.300000000000001, -18.4, -3.4, -16.299999999999997, -7.3, -15.899999999999999, -12.0, -3.2, -26.700000000000006, -4.2, -3.3, -13.6, -29.59999999999996, -12.799999999999999, -4.2, -3.3, -8.2, -3.4, -3.3, -11.499999999999998, -3.4, -16.9, -9.3, -12.5, -27.3, -16.400000000000002, -17.999999999999968, -11.2, -12.3, -3.3, -3.1, -3.2, -31.299999999999958, -3.2, -16.299999999999994, -3.2, -14.999999999999998, -7.9, -3.4, -14.3, -3.2, -19.799999999999997, -14.3, -4.5, -3.2, -13.799999999999999, -3.3, -3.2, -18.0, -25.1, -8.3, -7.3, -3.4, -17.299999999999994, -10.6, -3.2, -4.800000000000001, -18.099999999999998, -3.3, -12.3, -11.499999999999996, -13.399999999999984, -13.199999999999998, -2.2, -7.299999999999999, -11.499999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2569097925094577, "mean_inference_ms": 1.6155775736311986, "mean_action_processing_ms": 0.09042979067397507, "mean_env_wait_ms": 7.395400214216959, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 560000, "timesteps_this_iter": 0, "agent_timesteps_total": 560000, "timers": {"sample_time_ms": 26216.983, "sample_throughput": 152.573, "load_time_ms": 0.605, "load_throughput": 6606763.802, "learn_time_ms": 12788.004, "learn_throughput": 312.793, "update_time_ms": 2.736}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.08288822874867467, "policy_loss": -0.006597621813015912, "vf_loss": 8.875155080774778, "vf_explained_var": 0.33901966278271006, "kl": 0.007735873728531774, "entropy": 0.18569158517945838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 560000, "num_agent_steps_sampled": 560000, "num_steps_trained": 560000, "num_agent_steps_trained": 560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5656, "training_iteration": 140, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-57-38", "timestamp": 1643648258, "time_this_iter_s": 30.969074964523315, "time_total_s": 2934.60950756073, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2934.60950756073, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 55.55681818181818, "ram_util_percent": 62.32045454545455}}
{"episode_reward_max": -2.2, "episode_reward_min": -60.699999999999996, "episode_reward_mean": -11.946999999999996, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -3.2, -26.700000000000006, -4.2, -3.3, -13.6, -29.59999999999996, -12.799999999999999, -4.2, -3.3, -8.2, -3.4, -3.3, -11.499999999999998, -3.4, -16.9, -9.3, -12.5, -27.3, -16.400000000000002, -17.999999999999968, -11.2, -12.3, -3.3, -3.1, -3.2, -31.299999999999958, -3.2, -16.299999999999994, -3.2, -14.999999999999998, -7.9, -3.4, -14.3, -3.2, -19.799999999999997, -14.3, -4.5, -3.2, -13.799999999999999, -3.3, -3.2, -18.0, -25.1, -8.3, -7.3, -3.4, -17.299999999999994, -10.6, -3.2, -4.800000000000001, -18.099999999999998, -3.3, -12.3, -11.499999999999996, -13.399999999999984, -13.199999999999998, -2.2, -7.299999999999999, -11.499999999999998, -21.6, -23.500000000000057, -3.3, -44.2, -11.899999999999993, -11.2, -26.100000000000037, -3.4, -4.300000000000001, -7.200000000000001, -28.500000000000004, -3.3, -31.3, -60.699999999999996, -13.899999999999999, -56.400000000000034, -18.90000000000001, -3.2, -3.3, -7.3, -13.599999999999998, -11.100000000000001, -16.299999999999997, -12.2, -4.3, -20.700000000000003, -4.3, -7.3, -3.2, -10.6, -3.3, -8.5, -8.1, -11.799999999999999, -14.099999999999998, -11.399999999999997, -3.3, -10.1, -4.300000000000001, -5.800000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2623018051745307, "mean_inference_ms": 1.6213174779261896, "mean_action_processing_ms": 0.0906928570502128, "mean_env_wait_ms": 7.423590331870148, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 564000, "timesteps_this_iter": 0, "agent_timesteps_total": 564000, "timers": {"sample_time_ms": 26874.203, "sample_throughput": 148.842, "load_time_ms": 0.608, "load_throughput": 6579300.392, "learn_time_ms": 13043.312, "learn_throughput": 306.671, "update_time_ms": 2.684}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.4470534084379793, "policy_loss": -0.008538680297312556, "vf_loss": 45.478260305107284, "vf_explained_var": -0.05114471912384033, "kl": 0.00852805664711505, "entropy": 0.19576541235049566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 564000, "num_agent_steps_sampled": 564000, "num_steps_trained": 564000, "num_agent_steps_trained": 564000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5696, "training_iteration": 141, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-58-12", "timestamp": 1643648292, "time_this_iter_s": 33.91102600097656, "time_total_s": 2968.5205335617065, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2968.5205335617065, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 61.94583333333333, "ram_util_percent": 62.38749999999999}}
{"episode_reward_max": -2.2, "episode_reward_min": -60.699999999999996, "episode_reward_mean": -11.831000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -3.2, -18.0, -25.1, -8.3, -7.3, -3.4, -17.299999999999994, -10.6, -3.2, -4.800000000000001, -18.099999999999998, -3.3, -12.3, -11.499999999999996, -13.399999999999984, -13.199999999999998, -2.2, -7.299999999999999, -11.499999999999998, -21.6, -23.500000000000057, -3.3, -44.2, -11.899999999999993, -11.2, -26.100000000000037, -3.4, -4.300000000000001, -7.200000000000001, -28.500000000000004, -3.3, -31.3, -60.699999999999996, -13.899999999999999, -56.400000000000034, -18.90000000000001, -3.2, -3.3, -7.3, -13.599999999999998, -11.100000000000001, -16.299999999999997, -12.2, -4.3, -20.700000000000003, -4.3, -7.3, -3.2, -10.6, -3.3, -8.5, -8.1, -11.799999999999999, -14.099999999999998, -11.399999999999997, -3.3, -10.1, -4.300000000000001, -5.800000000000001, -3.5, -5.4, -5.5, -7.2, -5.3, -3.2, -9.599999999999998, -8.9, -3.2, -19.300000000000004, -23.6, -3.2, -11.0, -4.2, -11.3, -20.2, -16.6, -42.1, -11.0, -5.0, -4.300000000000001, -16.6, -22.70000000000001, -9.799999999999999, -11.899999999999999, -6.6, -14.5, -3.3, -23.599999999999994, -9.0, -17.0, -4.3, -5.000000000000001, -6.999999999999999, -5.8, -5.3, -3.3, -21.20000000000003, -4.2, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.26752056380243, "mean_inference_ms": 1.6278876505279778, "mean_action_processing_ms": 0.09104470294683047, "mean_env_wait_ms": 7.454928360926842, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 568000, "timesteps_this_iter": 0, "agent_timesteps_total": 568000, "timers": {"sample_time_ms": 27408.937, "sample_throughput": 145.938, "load_time_ms": 0.617, "load_throughput": 6478940.336, "learn_time_ms": 13526.126, "learn_throughput": 295.724, "update_time_ms": 2.843}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.11899150891069282, "policy_loss": -0.009310012338783152, "vf_loss": 12.775433301028386, "vf_explained_var": 0.1662606015000292, "kl": 0.005764666490212893, "entropy": 0.19303576778820766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 568000, "num_agent_steps_sampled": 568000, "num_steps_trained": 568000, "num_agent_steps_trained": 568000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5736, "training_iteration": 142, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-58-43", "timestamp": 1643648323, "time_this_iter_s": 31.764454126358032, "time_total_s": 3000.2849876880646, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3000.2849876880646, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 57.25777777777778, "ram_util_percent": 62.413333333333334}}
{"episode_reward_max": -1.3, "episode_reward_min": -94.09999999999987, "episode_reward_mean": -11.4, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.599999999999998, -11.100000000000001, -16.299999999999997, -12.2, -4.3, -20.700000000000003, -4.3, -7.3, -3.2, -10.6, -3.3, -8.5, -8.1, -11.799999999999999, -14.099999999999998, -11.399999999999997, -3.3, -10.1, -4.300000000000001, -5.800000000000001, -3.5, -5.4, -5.5, -7.2, -5.3, -3.2, -9.599999999999998, -8.9, -3.2, -19.300000000000004, -23.6, -3.2, -11.0, -4.2, -11.3, -20.2, -16.6, -42.1, -11.0, -5.0, -4.300000000000001, -16.6, -22.70000000000001, -9.799999999999999, -11.899999999999999, -6.6, -14.5, -3.3, -23.599999999999994, -9.0, -17.0, -4.3, -5.000000000000001, -6.999999999999999, -5.8, -5.3, -3.3, -21.20000000000003, -4.2, -3.3, -9.3, -3.2, -4.3, -13.5, -3.4, -21.699999999999996, -3.3, -21.800000000000015, -94.09999999999987, -8.3, -7.2, -30.300000000000008, -13.399999999999999, -4.800000000000001, -18.700000000000006, -6.3, -6.4, -11.2, -16.2, -6.2, -6.599999999999999, -9.799999999999999, -7.3, -3.2, -10.899999999999999, -3.4, -22.800000000000008, -10.899999999999999, -11.2, -8.099999999999998, -17.099999999999998, -13.299999999999999, -21.3, -6.5, -1.3, -20.900000000000013, -3.3, -3.3, -11.699999999999992, -41.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2716947909290226, "mean_inference_ms": 1.633436507762396, "mean_action_processing_ms": 0.09134970965331879, "mean_env_wait_ms": 7.481359138185365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 572000, "timesteps_this_iter": 0, "agent_timesteps_total": 572000, "timers": {"sample_time_ms": 28331.792, "sample_throughput": 141.184, "load_time_ms": 0.628, "load_throughput": 6365856.953, "learn_time_ms": 13684.59, "learn_throughput": 292.3, "update_time_ms": 2.898}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.2361071727529008, "policy_loss": -0.006897100920398389, "vf_loss": 24.22098234795755, "vf_explained_var": 0.11097235160489236, "kl": 0.008369582647968898, "entropy": 0.21369628556152825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 572000, "num_agent_steps_sampled": 572000, "num_steps_trained": 572000, "num_agent_steps_trained": 572000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5776, "training_iteration": 143, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-59-11", "timestamp": 1643648351, "time_this_iter_s": 27.24115014076233, "time_total_s": 3027.526137828827, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3027.526137828827, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 45.78717948717949, "ram_util_percent": 62.43846153846154}}
{"episode_reward_max": -1.3, "episode_reward_min": -94.09999999999987, "episode_reward_mean": -12.429, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -16.6, -22.70000000000001, -9.799999999999999, -11.899999999999999, -6.6, -14.5, -3.3, -23.599999999999994, -9.0, -17.0, -4.3, -5.000000000000001, -6.999999999999999, -5.8, -5.3, -3.3, -21.20000000000003, -4.2, -3.3, -9.3, -3.2, -4.3, -13.5, -3.4, -21.699999999999996, -3.3, -21.800000000000015, -94.09999999999987, -8.3, -7.2, -30.300000000000008, -13.399999999999999, -4.800000000000001, -18.700000000000006, -6.3, -6.4, -11.2, -16.2, -6.2, -6.599999999999999, -9.799999999999999, -7.3, -3.2, -10.899999999999999, -3.4, -22.800000000000008, -10.899999999999999, -11.2, -8.099999999999998, -17.099999999999998, -13.299999999999999, -21.3, -6.5, -1.3, -20.900000000000013, -3.3, -3.3, -11.699999999999992, -41.2, -3.4, -22.3, -3.2, -20.39999999999999, -9.099999999999998, -17.6, -23.0, -16.099999999999994, -9.2, -17.5, -12.399999999999999, -19.800000000000004, -13.700000000000001, -2.3, -12.599999999999984, -20.700000000000003, -3.3, -19.7, -22.600000000000012, -14.0, -18.799999999999997, -12.499999999999998, -4.300000000000001, -8.899999999999999, -12.3, -4.6000000000000005, -9.599999999999998, -5.800000000000001, -4.7, -9.5, -3.2, -15.6, -14.3, -20.6, -36.3, -10.599999999999998, -13.599999999999998, -6.700000000000001, -7.3, -4.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2740969265763655, "mean_inference_ms": 1.6366313876584666, "mean_action_processing_ms": 0.09152290063049102, "mean_env_wait_ms": 7.49594828622146, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 576000, "timesteps_this_iter": 0, "agent_timesteps_total": 576000, "timers": {"sample_time_ms": 28411.202, "sample_throughput": 140.79, "load_time_ms": 0.572, "load_throughput": 6991089.257, "learn_time_ms": 13452.179, "learn_throughput": 297.35, "update_time_ms": 2.782}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.151056763723052, "policy_loss": -0.008621411117654975, "vf_loss": 15.91036902986547, "vf_explained_var": 0.08073728706247063, "kl": 0.006052236036717431, "entropy": 0.17309641355388267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 576000, "num_agent_steps_sampled": 576000, "num_steps_trained": 576000, "num_agent_steps_trained": 576000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5816, "training_iteration": 144, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-59-34", "timestamp": 1643648374, "time_this_iter_s": 22.888570308685303, "time_total_s": 3050.414708137512, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3050.414708137512, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 38.96666666666667, "ram_util_percent": 62.44545454545455}}
{"episode_reward_max": -1.3, "episode_reward_min": -92.49999999999989, "episode_reward_mean": -12.908000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.599999999999999, -9.799999999999999, -7.3, -3.2, -10.899999999999999, -3.4, -22.800000000000008, -10.899999999999999, -11.2, -8.099999999999998, -17.099999999999998, -13.299999999999999, -21.3, -6.5, -1.3, -20.900000000000013, -3.3, -3.3, -11.699999999999992, -41.2, -3.4, -22.3, -3.2, -20.39999999999999, -9.099999999999998, -17.6, -23.0, -16.099999999999994, -9.2, -17.5, -12.399999999999999, -19.800000000000004, -13.700000000000001, -2.3, -12.599999999999984, -20.700000000000003, -3.3, -19.7, -22.600000000000012, -14.0, -18.799999999999997, -12.499999999999998, -4.300000000000001, -8.899999999999999, -12.3, -4.6000000000000005, -9.599999999999998, -5.800000000000001, -4.7, -9.5, -3.2, -15.6, -14.3, -20.6, -36.3, -10.599999999999998, -13.599999999999998, -6.700000000000001, -7.3, -4.4, -4.4, -3.4, -18.3, -10.2, -7.699999999999999, -3.3, -3.3, -10.200000000000001, -23.000000000000004, -10.2, -41.3, -21.400000000000002, -14.7, -17.3, -3.2, -19.900000000000002, -4.2, -10.1, -3.2, -3.3, -53.3, -4.3, -15.699999999999998, -14.499999999999998, -8.399999999999999, -3.2, -12.3, -3.4, -3.3, -7.2, -3.4, -26.3, -6.2, -92.49999999999989, -19.4, -14.999999999999998, -3.2, -10.399999999999999, -3.2, -12.399999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2751240772982488, "mean_inference_ms": 1.6379299973118577, "mean_action_processing_ms": 0.09159680726688055, "mean_env_wait_ms": 7.502122976224878, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 580000, "timesteps_this_iter": 0, "agent_timesteps_total": 580000, "timers": {"sample_time_ms": 27864.647, "sample_throughput": 143.551, "load_time_ms": 0.564, "load_throughput": 7095460.351, "learn_time_ms": 13142.998, "learn_throughput": 304.345, "update_time_ms": 2.699}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.46736574227851563, "policy_loss": -0.0064096396012852585, "vf_loss": 47.32607498598355, "vf_explained_var": 0.22226367881221157, "kl": 0.005421759030754364, "entropy": 0.1475564431218851, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 580000, "num_agent_steps_sampled": 580000, "num_steps_trained": 580000, "num_agent_steps_trained": 580000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5856, "training_iteration": 145, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_16-59-56", "timestamp": 1643648396, "time_this_iter_s": 22.131319046020508, "time_total_s": 3072.5460271835327, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3072.5460271835327, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 41.96774193548387, "ram_util_percent": 62.470967741935496}}
{"episode_reward_max": -3.2, "episode_reward_min": -92.49999999999989, "episode_reward_mean": -12.368999999999994, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.799999999999997, -12.499999999999998, -4.300000000000001, -8.899999999999999, -12.3, -4.6000000000000005, -9.599999999999998, -5.800000000000001, -4.7, -9.5, -3.2, -15.6, -14.3, -20.6, -36.3, -10.599999999999998, -13.599999999999998, -6.700000000000001, -7.3, -4.4, -4.4, -3.4, -18.3, -10.2, -7.699999999999999, -3.3, -3.3, -10.200000000000001, -23.000000000000004, -10.2, -41.3, -21.400000000000002, -14.7, -17.3, -3.2, -19.900000000000002, -4.2, -10.1, -3.2, -3.3, -53.3, -4.3, -15.699999999999998, -14.499999999999998, -8.399999999999999, -3.2, -12.3, -3.4, -3.3, -7.2, -3.4, -26.3, -6.2, -92.49999999999989, -19.4, -14.999999999999998, -3.2, -10.399999999999999, -3.2, -12.399999999999997, -15.999999999999998, -7.7, -46.2, -10.7, -3.6, -9.2, -4.2, -5.2, -5.2, -16.299999999999997, -12.499999999999996, -3.3, -3.4000000000000004, -12.799999999999997, -6.3, -8.1, -21.799999999999997, -4.300000000000001, -14.9, -8.2, -14.999999999999995, -12.7, -3.3, -12.499999999999995, -8.2, -10.3, -9.700000000000001, -12.399999999999995, -34.2, -20.1, -8.2, -10.099999999999996, -3.4, -19.700000000000003, -8.099999999999998, -9.899999999999999, -17.3, -14.299999999999999, -10.6, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.274956285836434, "mean_inference_ms": 1.638107632519744, "mean_action_processing_ms": 0.09160800106006939, "mean_env_wait_ms": 7.503040185114853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 584000, "timesteps_this_iter": 0, "agent_timesteps_total": 584000, "timers": {"sample_time_ms": 27297.884, "sample_throughput": 146.532, "load_time_ms": 0.56, "load_throughput": 7141368.067, "learn_time_ms": 13153.164, "learn_throughput": 304.109, "update_time_ms": 2.71}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.1033647227962251, "policy_loss": -0.01451189308277061, "vf_loss": 11.651330976845117, "vf_explained_var": 0.27764464219411217, "kl": 0.014362452374579452, "entropy": 0.1976439615090688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 584000, "num_agent_steps_sampled": 584000, "num_steps_trained": 584000, "num_agent_steps_trained": 584000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5896, "training_iteration": 146, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-00-18", "timestamp": 1643648418, "time_this_iter_s": 21.98923897743225, "time_total_s": 3094.535266160965, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3094.535266160965, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 41.146874999999994, "ram_util_percent": 62.36875}}
{"episode_reward_max": -3.2, "episode_reward_min": -92.49999999999989, "episode_reward_mean": -11.758999999999997, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-53.3, -4.3, -15.699999999999998, -14.499999999999998, -8.399999999999999, -3.2, -12.3, -3.4, -3.3, -7.2, -3.4, -26.3, -6.2, -92.49999999999989, -19.4, -14.999999999999998, -3.2, -10.399999999999999, -3.2, -12.399999999999997, -15.999999999999998, -7.7, -46.2, -10.7, -3.6, -9.2, -4.2, -5.2, -5.2, -16.299999999999997, -12.499999999999996, -3.3, -3.4000000000000004, -12.799999999999997, -6.3, -8.1, -21.799999999999997, -4.300000000000001, -14.9, -8.2, -14.999999999999995, -12.7, -3.3, -12.499999999999995, -8.2, -10.3, -9.700000000000001, -12.399999999999995, -34.2, -20.1, -8.2, -10.099999999999996, -3.4, -19.700000000000003, -8.099999999999998, -9.899999999999999, -17.3, -14.299999999999999, -10.6, -3.2, -14.6, -11.200000000000001, -3.2, -3.2, -12.099999999999996, -3.4, -13.099999999999998, -8.399999999999999, -6.199999999999999, -10.1, -10.199999999999998, -16.6, -4.3, -4.2, -12.399999999999999, -16.89999999999998, -11.999999999999998, -7.3, -3.3, -14.199999999999998, -16.199999999999996, -16.4, -16.7, -3.3, -8.3, -4.2, -11.1, -3.4, -7.2, -4.2, -9.600000000000001, -20.999999999999996, -13.899999999999986, -10.699999999999996, -3.4, -3.3, -17.5, -14.3, -13.3, -10.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.274665699040412, "mean_inference_ms": 1.6384440890363243, "mean_action_processing_ms": 0.09162933274972548, "mean_env_wait_ms": 7.504681884985269, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 588000, "timesteps_this_iter": 0, "agent_timesteps_total": 588000, "timers": {"sample_time_ms": 27189.77, "sample_throughput": 147.114, "load_time_ms": 0.584, "load_throughput": 6845607.965, "learn_time_ms": 12999.499, "learn_throughput": 307.704, "update_time_ms": 2.555}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.048488906431462496, "policy_loss": -0.017225919643877655, "vf_loss": 6.530852299031391, "vf_explained_var": 0.3750736848000557, "kl": 0.004280424639607138, "entropy": 0.17455496310546834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 588000, "num_agent_steps_sampled": 588000, "num_steps_trained": 588000, "num_agent_steps_trained": 588000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5936, "training_iteration": 147, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-00-41", "timestamp": 1643648441, "time_this_iter_s": 22.78236222267151, "time_total_s": 3117.3176283836365, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3117.3176283836365, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 43.096875, "ram_util_percent": 62.421875}}
{"episode_reward_max": -2.0, "episode_reward_min": -34.2, "episode_reward_mean": -10.268999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.999999999999995, -12.7, -3.3, -12.499999999999995, -8.2, -10.3, -9.700000000000001, -12.399999999999995, -34.2, -20.1, -8.2, -10.099999999999996, -3.4, -19.700000000000003, -8.099999999999998, -9.899999999999999, -17.3, -14.299999999999999, -10.6, -3.2, -14.6, -11.200000000000001, -3.2, -3.2, -12.099999999999996, -3.4, -13.099999999999998, -8.399999999999999, -6.199999999999999, -10.1, -10.199999999999998, -16.6, -4.3, -4.2, -12.399999999999999, -16.89999999999998, -11.999999999999998, -7.3, -3.3, -14.199999999999998, -16.199999999999996, -16.4, -16.7, -3.3, -8.3, -4.2, -11.1, -3.4, -7.2, -4.2, -9.600000000000001, -20.999999999999996, -13.899999999999986, -10.699999999999996, -3.4, -3.3, -17.5, -14.3, -13.3, -10.3, -10.5, -4.300000000000001, -16.699999999999996, -10.600000000000001, -15.599999999999998, -13.899999999999999, -3.4, -2.0, -12.899999999999999, -5.3, -8.100000000000001, -15.799999999999999, -19.199999999999996, -12.599999999999993, -3.3, -10.299999999999999, -2.4000000000000004, -23.6, -7.299999999999998, -13.899999999999999, -21.20000000000001, -5.0, -3.2, -3.3, -3.2, -14.1, -3.3, -3.3, -3.2, -5.3, -23.7, -4.4, -22.5, -16.6, -7.800000000000001, -3.3, -19.499999999999996, -4.4, -3.3, -6.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.274799252527393, "mean_inference_ms": 1.6388801354958744, "mean_action_processing_ms": 0.09165496222367406, "mean_env_wait_ms": 7.506661262337461, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 592000, "timesteps_this_iter": 0, "agent_timesteps_total": 592000, "timers": {"sample_time_ms": 26711.033, "sample_throughput": 149.751, "load_time_ms": 0.607, "load_throughput": 6591967.31, "learn_time_ms": 12607.872, "learn_throughput": 317.262, "update_time_ms": 2.559}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.06568667125457557, "policy_loss": -0.009366966801525285, "vf_loss": 7.476708487477354, "vf_explained_var": 0.3164481609739283, "kl": 0.006037718861581316, "entropy": 0.13679223449159694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 592000, "num_agent_steps_sampled": 592000, "num_steps_trained": 592000, "num_agent_steps_trained": 592000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5976, "training_iteration": 148, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-01-04", "timestamp": 1643648464, "time_this_iter_s": 23.11784791946411, "time_total_s": 3140.4354763031006, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3140.4354763031006, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 45.00909090909091, "ram_util_percent": 62.44242424242424}}
{"episode_reward_max": -1.3, "episode_reward_min": -90.3, "episode_reward_mean": -10.288, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.3, -4.2, -11.1, -3.4, -7.2, -4.2, -9.600000000000001, -20.999999999999996, -13.899999999999986, -10.699999999999996, -3.4, -3.3, -17.5, -14.3, -13.3, -10.3, -10.5, -4.300000000000001, -16.699999999999996, -10.600000000000001, -15.599999999999998, -13.899999999999999, -3.4, -2.0, -12.899999999999999, -5.3, -8.100000000000001, -15.799999999999999, -19.199999999999996, -12.599999999999993, -3.3, -10.299999999999999, -2.4000000000000004, -23.6, -7.299999999999998, -13.899999999999999, -21.20000000000001, -5.0, -3.2, -3.3, -3.2, -14.1, -3.3, -3.3, -3.2, -5.3, -23.7, -4.4, -22.5, -16.6, -7.800000000000001, -3.3, -19.499999999999996, -4.4, -3.3, -6.2, -9.599999999999998, -3.3, -5.6000000000000005, -16.4, -90.3, -10.1, -11.7, -15.699999999999998, -8.7, -3.2, -5.800000000000001, -3.3, -17.2, -3.3, -9.899999999999997, -13.599999999999998, -3.3, -18.0, -12.899999999999972, -4.4, -31.70000000000004, -7.800000000000001, -5.1, -3.4, -3.4, -17.6, -3.3, -3.2, -17.1, -3.2, -13.4, -4.800000000000001, -7.3999999999999995, -4.300000000000001, -13.2, -7.5, -1.3, -24.9, -5.799999999999999, -3.3, -3.3, -16.599999999999994, -4.800000000000001, -11.9], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2756101114154628, "mean_inference_ms": 1.6401048871581114, "mean_action_processing_ms": 0.09177846623696718, "mean_env_wait_ms": 7.513846666702387, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 596000, "timesteps_this_iter": 0, "agent_timesteps_total": 596000, "timers": {"sample_time_ms": 26155.1, "sample_throughput": 152.934, "load_time_ms": 0.567, "load_throughput": 7057256.552, "learn_time_ms": 12654.225, "learn_throughput": 316.1, "update_time_ms": 2.534}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.38841972175424777, "policy_loss": -0.010282976616434352, "vf_loss": 39.8259768353675, "vf_explained_var": 0.12917245594404078, "kl": 0.009332660754160331, "entropy": 0.13699344864055032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 596000, "num_agent_steps_sampled": 596000, "num_steps_trained": 596000, "num_agent_steps_trained": 596000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6020, "training_iteration": 149, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-01-29", "timestamp": 1643648489, "time_this_iter_s": 24.727504014968872, "time_total_s": 3165.1629803180695, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3165.1629803180695, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 46.50000000000001, "ram_util_percent": 62.465714285714306}}
{"episode_reward_max": -1.3, "episode_reward_min": -90.3, "episode_reward_mean": -10.648000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -14.1, -3.3, -3.3, -3.2, -5.3, -23.7, -4.4, -22.5, -16.6, -7.800000000000001, -3.3, -19.499999999999996, -4.4, -3.3, -6.2, -9.599999999999998, -3.3, -5.6000000000000005, -16.4, -90.3, -10.1, -11.7, -15.699999999999998, -8.7, -3.2, -5.800000000000001, -3.3, -17.2, -3.3, -9.899999999999997, -13.599999999999998, -3.3, -18.0, -12.899999999999972, -4.4, -31.70000000000004, -7.800000000000001, -5.1, -3.4, -3.4, -17.6, -3.3, -3.2, -17.1, -3.2, -13.4, -4.800000000000001, -7.3999999999999995, -4.300000000000001, -13.2, -7.5, -1.3, -24.9, -5.799999999999999, -3.3, -3.3, -16.599999999999994, -4.800000000000001, -11.9, -21.4, -1.3, -3.4000000000000004, -25.400000000000052, -3.3, -4.2, -12.200000000000001, -4.800000000000001, -12.2, -5.2, -22.4, -21.3, -12.200000000000001, -11.399999999999999, -14.199999999999996, -11.299999999999997, -14.299999999999999, -21.599999999999998, -6.1, -3.9000000000000004, -6.699999999999999, -19.2, -10.3, -3.4, -22.600000000000005, -4.3, -17.499999999999993, -5.0, -10.2, -3.3, -12.4, -7.799999999999998, -20.000000000000007, -12.599999999999998, -2.5000000000000004, -3.2, -18.4, -5.2, -7.299999999999999, -12.099999999999996], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2762477541456512, "mean_inference_ms": 1.6409554819034593, "mean_action_processing_ms": 0.09182521204619404, "mean_env_wait_ms": 7.518085562855812, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 600000, "timesteps_this_iter": 0, "agent_timesteps_total": 600000, "timers": {"sample_time_ms": 25731.409, "sample_throughput": 155.452, "load_time_ms": 0.548, "load_throughput": 7298249.521, "learn_time_ms": 12213.381, "learn_throughput": 327.51, "update_time_ms": 2.509}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.12780958106741308, "policy_loss": -0.006047586623018467, "vf_loss": 13.341381153624544, "vf_explained_var": 0.05524157753554724, "kl": 0.009341589893564248, "entropy": 0.15883807676934428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 600000, "num_agent_steps_sampled": 600000, "num_steps_trained": 600000, "num_agent_steps_trained": 600000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6060, "training_iteration": 150, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-01-51", "timestamp": 1643648511, "time_this_iter_s": 21.888595819473267, "time_total_s": 3187.0515761375427, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3187.0515761375427, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 43.209375, "ram_util_percent": 62.275}}
{"episode_reward_max": -1.2, "episode_reward_min": -36.80000000000002, "episode_reward_mean": -10.259, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -17.6, -3.3, -3.2, -17.1, -3.2, -13.4, -4.800000000000001, -7.3999999999999995, -4.300000000000001, -13.2, -7.5, -1.3, -24.9, -5.799999999999999, -3.3, -3.3, -16.599999999999994, -4.800000000000001, -11.9, -21.4, -1.3, -3.4000000000000004, -25.400000000000052, -3.3, -4.2, -12.200000000000001, -4.800000000000001, -12.2, -5.2, -22.4, -21.3, -12.200000000000001, -11.399999999999999, -14.199999999999996, -11.299999999999997, -14.299999999999999, -21.599999999999998, -6.1, -3.9000000000000004, -6.699999999999999, -19.2, -10.3, -3.4, -22.600000000000005, -4.3, -17.499999999999993, -5.0, -10.2, -3.3, -12.4, -7.799999999999998, -20.000000000000007, -12.599999999999998, -2.5000000000000004, -3.2, -18.4, -5.2, -7.299999999999999, -12.099999999999996, -12.299999999999999, -3.2, -36.80000000000002, -7.3, -4.300000000000001, -8.3, -10.2, -10.799999999999999, -3.9000000000000004, -21.5, -16.5, -3.2, -3.3, -11.500000000000002, -3.2, -7.2, -3.4, -19.3, -11.5, -7.3, -16.199999999999974, -12.499999999999984, -16.5, -7.099999999999999, -1.2, -10.0, -18.400000000000002, -6.2, -3.4, -16.3, -17.5, -4.3, -5.6, -11.3, -15.799999999999999, -10.2, -4.2, -11.600000000000001, -13.3, -12.9], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.27671672278396, "mean_inference_ms": 1.641337850955503, "mean_action_processing_ms": 0.09179799117896081, "mean_env_wait_ms": 7.519284385185679, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 604000, "timesteps_this_iter": 0, "agent_timesteps_total": 604000, "timers": {"sample_time_ms": 24515.317, "sample_throughput": 163.163, "load_time_ms": 0.54, "load_throughput": 7404870.901, "learn_time_ms": 11870.882, "learn_throughput": 336.959, "update_time_ms": 2.517}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.06598627116926696, "policy_loss": -0.004934882235422891, "vf_loss": 7.052591118857425, "vf_explained_var": 0.20632663715270258, "kl": 0.008327766387950849, "entropy": 0.18419866037545024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 604000, "num_agent_steps_sampled": 604000, "num_steps_trained": 604000, "num_agent_steps_trained": 604000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6100, "training_iteration": 151, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-02-13", "timestamp": 1643648533, "time_this_iter_s": 22.741050958633423, "time_total_s": 3209.792627096176, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3209.792627096176, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 45.784375, "ram_util_percent": 62.34375}}
{"episode_reward_max": -1.2, "episode_reward_min": -36.80000000000002, "episode_reward_mean": -9.745, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.699999999999999, -19.2, -10.3, -3.4, -22.600000000000005, -4.3, -17.499999999999993, -5.0, -10.2, -3.3, -12.4, -7.799999999999998, -20.000000000000007, -12.599999999999998, -2.5000000000000004, -3.2, -18.4, -5.2, -7.299999999999999, -12.099999999999996, -12.299999999999999, -3.2, -36.80000000000002, -7.3, -4.300000000000001, -8.3, -10.2, -10.799999999999999, -3.9000000000000004, -21.5, -16.5, -3.2, -3.3, -11.500000000000002, -3.2, -7.2, -3.4, -19.3, -11.5, -7.3, -16.199999999999974, -12.499999999999984, -16.5, -7.099999999999999, -1.2, -10.0, -18.400000000000002, -6.2, -3.4, -16.3, -17.5, -4.3, -5.6, -11.3, -15.799999999999999, -10.2, -4.2, -11.600000000000001, -13.3, -12.9, -4.2, -10.7, -3.3, -9.5, -17.599999999999998, -7.099999999999999, -18.700000000000006, -3.2, -6.2, -8.5, -4.300000000000001, -6.899999999999999, -3.3, -21.400000000000006, -8.3, -13.299999999999997, -4.6000000000000005, -7.199999999999998, -4.6000000000000005, -19.099999999999994, -5.2, -11.5, -15.3, -14.3, -4.6000000000000005, -7.2, -3.3, -10.3, -7.8, -6.2, -4.6000000000000005, -15.200000000000001, -3.3, -10.299999999999997, -3.2, -4.300000000000001, -3.2, -11.3, -13.799999999999976, -14.099999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.277121321365769, "mean_inference_ms": 1.6419955320808426, "mean_action_processing_ms": 0.09183011865262829, "mean_env_wait_ms": 7.521324600635062, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 608000, "timesteps_this_iter": 0, "agent_timesteps_total": 608000, "timers": {"sample_time_ms": 23785.135, "sample_throughput": 168.172, "load_time_ms": 0.57, "load_throughput": 7013299.891, "learn_time_ms": 11537.256, "learn_throughput": 346.703, "update_time_ms": 2.361}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.04311877207890634, "policy_loss": -0.010089025525276058, "vf_loss": 5.294103273781397, "vf_explained_var": 0.45609727630051233, "kl": 0.005620772290967999, "entropy": 0.14981047217884372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 608000, "num_agent_steps_sampled": 608000, "num_steps_trained": 608000, "num_agent_steps_trained": 608000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6140, "training_iteration": 152, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-02-38", "timestamp": 1643648558, "time_this_iter_s": 24.548122882843018, "time_total_s": 3234.340749979019, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3234.340749979019, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 38.56571428571429, "ram_util_percent": 62.408571428571435}}
{"episode_reward_max": -1.2, "episode_reward_min": -25.1, "episode_reward_mean": -9.877, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.199999999999974, -12.499999999999984, -16.5, -7.099999999999999, -1.2, -10.0, -18.400000000000002, -6.2, -3.4, -16.3, -17.5, -4.3, -5.6, -11.3, -15.799999999999999, -10.2, -4.2, -11.600000000000001, -13.3, -12.9, -4.2, -10.7, -3.3, -9.5, -17.599999999999998, -7.099999999999999, -18.700000000000006, -3.2, -6.2, -8.5, -4.300000000000001, -6.899999999999999, -3.3, -21.400000000000006, -8.3, -13.299999999999997, -4.6000000000000005, -7.199999999999998, -4.6000000000000005, -19.099999999999994, -5.2, -11.5, -15.3, -14.3, -4.6000000000000005, -7.2, -3.3, -10.3, -7.8, -6.2, -4.6000000000000005, -15.200000000000001, -3.3, -10.299999999999997, -3.2, -4.300000000000001, -3.2, -11.3, -13.799999999999976, -14.099999999999998, -22.099999999999998, -3.4, -2.2, -18.400000000000002, -10.6, -7.999999999999998, -3.3, -3.2, -5.300000000000001, -3.2, -8.799999999999997, -9.1, -23.2, -12.600000000000001, -13.899999999999997, -14.8, -4.2, -16.5, -7.3, -4.5, -3.3000000000000003, -10.0, -15.999999999999998, -16.0, -3.2, -17.900000000000002, -25.1, -3.7000000000000006, -15.799999999999999, -14.1, -12.899999999999999, -3.2, -5.699999999999999, -12.999999999999998, -16.7, -14.3, -9.200000000000001, -13.2, -3.2, -11.099999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2781060126474828, "mean_inference_ms": 1.6433115574923078, "mean_action_processing_ms": 0.09190417008614088, "mean_env_wait_ms": 7.527153103042511, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 612000, "timesteps_this_iter": 0, "agent_timesteps_total": 612000, "timers": {"sample_time_ms": 23260.789, "sample_throughput": 171.963, "load_time_ms": 0.567, "load_throughput": 7053696.027, "learn_time_ms": 11735.199, "learn_throughput": 340.855, "update_time_ms": 2.317}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.06818416447088282, "policy_loss": -0.01212140824846042, "vf_loss": 7.987914818044632, "vf_explained_var": 0.23598578892728334, "kl": 0.008984761368459241, "entropy": 0.1692898790642459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 612000, "num_agent_steps_sampled": 612000, "num_steps_trained": 612000, "num_agent_steps_trained": 612000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6180, "training_iteration": 153, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-03-05", "timestamp": 1643648585, "time_this_iter_s": 27.330493927001953, "time_total_s": 3261.671243906021, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3261.671243906021, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 49.341025641025645, "ram_util_percent": 62.36410256410258}}
{"episode_reward_max": -2.2, "episode_reward_min": -38.3, "episode_reward_mean": -10.464, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -11.5, -15.3, -14.3, -4.6000000000000005, -7.2, -3.3, -10.3, -7.8, -6.2, -4.6000000000000005, -15.200000000000001, -3.3, -10.299999999999997, -3.2, -4.300000000000001, -3.2, -11.3, -13.799999999999976, -14.099999999999998, -22.099999999999998, -3.4, -2.2, -18.400000000000002, -10.6, -7.999999999999998, -3.3, -3.2, -5.300000000000001, -3.2, -8.799999999999997, -9.1, -23.2, -12.600000000000001, -13.899999999999997, -14.8, -4.2, -16.5, -7.3, -4.5, -3.3000000000000003, -10.0, -15.999999999999998, -16.0, -3.2, -17.900000000000002, -25.1, -3.7000000000000006, -15.799999999999999, -14.1, -12.899999999999999, -3.2, -5.699999999999999, -12.999999999999998, -16.7, -14.3, -9.200000000000001, -13.2, -3.2, -11.099999999999998, -4.300000000000001, -3.2, -6.4, -13.6, -8.2, -24.5, -14.999999999999996, -8.9, -6.199999999999999, -13.099999999999998, -7.3, -30.3, -9.7, -8.1, -9.4, -10.0, -3.3, -15.4, -13.1, -4.4, -12.099999999999998, -7.4, -3.2, -3.3, -14.5, -14.399999999999999, -8.699999999999998, -22.799999999999997, -14.199999999999998, -38.3, -14.9, -10.2, -5.999999999999999, -3.2, -24.500000000000004, -15.499999999999995, -7.2, -4.300000000000001, -11.69999999999998, -4.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2798052134770694, "mean_inference_ms": 1.6459212064962976, "mean_action_processing_ms": 0.09204998849560227, "mean_env_wait_ms": 7.539051796656187, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 616000, "timesteps_this_iter": 0, "agent_timesteps_total": 616000, "timers": {"sample_time_ms": 23767.294, "sample_throughput": 168.299, "load_time_ms": 0.592, "load_throughput": 6761462.137, "learn_time_ms": 12298.017, "learn_throughput": 325.256, "update_time_ms": 2.345}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.12410670083456783, "policy_loss": -0.009042387538819864, "vf_loss": 13.255683558025668, "vf_explained_var": 0.2976631790079096, "kl": 0.012478806310884586, "entropy": 0.17262463257998548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 616000, "num_agent_steps_sampled": 616000, "num_steps_trained": 616000, "num_agent_steps_trained": 616000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6220, "training_iteration": 154, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-03-37", "timestamp": 1643648617, "time_this_iter_s": 31.577337741851807, "time_total_s": 3293.248581647873, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3293.248581647873, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 52.44888888888889, "ram_util_percent": 62.459999999999994}}
{"episode_reward_max": -3.2, "episode_reward_min": -70.2, "episode_reward_mean": -12.140999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -10.0, -15.999999999999998, -16.0, -3.2, -17.900000000000002, -25.1, -3.7000000000000006, -15.799999999999999, -14.1, -12.899999999999999, -3.2, -5.699999999999999, -12.999999999999998, -16.7, -14.3, -9.200000000000001, -13.2, -3.2, -11.099999999999998, -4.300000000000001, -3.2, -6.4, -13.6, -8.2, -24.5, -14.999999999999996, -8.9, -6.199999999999999, -13.099999999999998, -7.3, -30.3, -9.7, -8.1, -9.4, -10.0, -3.3, -15.4, -13.1, -4.4, -12.099999999999998, -7.4, -3.2, -3.3, -14.5, -14.399999999999999, -8.699999999999998, -22.799999999999997, -14.199999999999998, -38.3, -14.9, -10.2, -5.999999999999999, -3.2, -24.500000000000004, -15.499999999999995, -7.2, -4.300000000000001, -11.69999999999998, -4.4, -8.8, -28.20000000000001, -3.3, -3.3, -3.2, -13.999999999999996, -70.2, -9.2, -17.5, -12.299999999999995, -8.099999999999998, -3.3, -53.60000000000001, -3.3, -3.3, -3.2, -16.9, -21.500000000000004, -8.299999999999999, -5.2, -24.799999999999997, -3.2, -17.1, -3.3, -3.3, -11.299999999999999, -16.8, -14.099999999999973, -11.999999999999998, -4.7, -10.8, -17.2, -3.500000000000001, -3.2, -8.599999999999998, -10.8, -25.2, -12.899999999999999, -17.299999999999997, -14.5], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2833468499153637, "mean_inference_ms": 1.6505219519210634, "mean_action_processing_ms": 0.0923171256979943, "mean_env_wait_ms": 7.562011484160703, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 620000, "timesteps_this_iter": 0, "agent_timesteps_total": 620000, "timers": {"sample_time_ms": 25039.884, "sample_throughput": 159.745, "load_time_ms": 0.623, "load_throughput": 6421655.056, "learn_time_ms": 12488.468, "learn_throughput": 320.295, "update_time_ms": 2.307}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.1289128873652468, "policy_loss": -0.014836266159670809, "vf_loss": 14.335087512129096, "vf_explained_var": 0.13578264117240907, "kl": 0.008391765498739774, "entropy": 0.15545803821215065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 620000, "num_agent_steps_sampled": 620000, "num_steps_trained": 620000, "num_agent_steps_trained": 620000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6260, "training_iteration": 155, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-04-08", "timestamp": 1643648648, "time_this_iter_s": 31.139278173446655, "time_total_s": 3324.3878598213196, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3324.3878598213196, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 58.23409090909092, "ram_util_percent": 62.5}}
{"episode_reward_max": -3.2, "episode_reward_min": -92.70000000000014, "episode_reward_mean": -12.495000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.099999999999998, -7.4, -3.2, -3.3, -14.5, -14.399999999999999, -8.699999999999998, -22.799999999999997, -14.199999999999998, -38.3, -14.9, -10.2, -5.999999999999999, -3.2, -24.500000000000004, -15.499999999999995, -7.2, -4.300000000000001, -11.69999999999998, -4.4, -8.8, -28.20000000000001, -3.3, -3.3, -3.2, -13.999999999999996, -70.2, -9.2, -17.5, -12.299999999999995, -8.099999999999998, -3.3, -53.60000000000001, -3.3, -3.3, -3.2, -16.9, -21.500000000000004, -8.299999999999999, -5.2, -24.799999999999997, -3.2, -17.1, -3.3, -3.3, -11.299999999999999, -16.8, -14.099999999999973, -11.999999999999998, -4.7, -10.8, -17.2, -3.500000000000001, -3.2, -8.599999999999998, -10.8, -25.2, -12.899999999999999, -17.299999999999997, -14.5, -13.3, -4.2, -14.099999999999998, -11.7, -8.3, -18.7, -10.6, -3.3, -12.799999999999997, -5.300000000000001, -4.2, -4.2, -92.70000000000014, -3.3, -6.2, -8.3, -10.499999999999998, -13.799999999999997, -9.5, -13.999999999999982, -3.3, -3.3, -27.100000000000065, -3.3, -4.2, -15.0, -15.3, -5.799999999999999, -13.399999999999997, -12.7, -11.2, -17.2, -3.4, -4.2, -14.999999999999996, -4.800000000000001, -8.6, -14.399999999999999, -14.899999999999999, -11.299999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.286896415028512, "mean_inference_ms": 1.6548704347824554, "mean_action_processing_ms": 0.0925682602972076, "mean_env_wait_ms": 7.584135265080693, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 624000, "timesteps_this_iter": 0, "agent_timesteps_total": 624000, "timers": {"sample_time_ms": 25526.174, "sample_throughput": 156.702, "load_time_ms": 0.626, "load_throughput": 6388886.519, "learn_time_ms": 12407.212, "learn_throughput": 322.393, "update_time_ms": 2.183}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.24035458596703665, "policy_loss": -0.016650549380449197, "vf_loss": 25.636909965225446, "vf_explained_var": 0.09731513800159577, "kl": 0.013401451364946883, "entropy": 0.1596045230545344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 624000, "num_agent_steps_sampled": 624000, "num_steps_trained": 624000, "num_agent_steps_trained": 624000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6300, "training_iteration": 156, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-04-32", "timestamp": 1643648672, "time_this_iter_s": 24.14094114303589, "time_total_s": 3348.5288009643555, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3348.5288009643555, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 43.84285714285714, "ram_util_percent": 62.51428571428571}}
{"episode_reward_max": -3.2, "episode_reward_min": -92.70000000000014, "episode_reward_mean": -11.118000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.799999999999997, -3.2, -17.1, -3.3, -3.3, -11.299999999999999, -16.8, -14.099999999999973, -11.999999999999998, -4.7, -10.8, -17.2, -3.500000000000001, -3.2, -8.599999999999998, -10.8, -25.2, -12.899999999999999, -17.299999999999997, -14.5, -13.3, -4.2, -14.099999999999998, -11.7, -8.3, -18.7, -10.6, -3.3, -12.799999999999997, -5.300000000000001, -4.2, -4.2, -92.70000000000014, -3.3, -6.2, -8.3, -10.499999999999998, -13.799999999999997, -9.5, -13.999999999999982, -3.3, -3.3, -27.100000000000065, -3.3, -4.2, -15.0, -15.3, -5.799999999999999, -13.399999999999997, -12.7, -11.2, -17.2, -3.4, -4.2, -14.999999999999996, -4.800000000000001, -8.6, -14.399999999999999, -14.899999999999999, -11.299999999999997, -15.199999999999998, -6.3999999999999995, -3.2, -10.099999999999996, -14.899999999999999, -12.199999999999998, -10.199999999999998, -12.7, -11.600000000000001, -7.2, -49.2, -17.199999999999996, -7.299999999999999, -3.2, -13.799999999999999, -3.3, -4.6000000000000005, -3.4, -22.699999999999996, -3.7, -5.799999999999999, -3.3, -15.4, -8.3, -9.4, -3.3, -12.499999999999998, -7.2, -7.299999999999999, -14.2, -3.2, -15.099999999999998, -7.799999999999997, -4.3, -4.300000000000001, -4.300000000000001, -10.2, -24.299999999999997, -3.2, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2886090644539274, "mean_inference_ms": 1.657106127953956, "mean_action_processing_ms": 0.09269174531089563, "mean_env_wait_ms": 7.5952641291306735, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 628000, "timesteps_this_iter": 0, "agent_timesteps_total": 628000, "timers": {"sample_time_ms": 25364.371, "sample_throughput": 157.702, "load_time_ms": 0.603, "load_throughput": 6629214.478, "learn_time_ms": 12496.389, "learn_throughput": 320.092, "update_time_ms": 2.347}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.08130759944718692, "policy_loss": -0.017838277643726717, "vf_loss": 9.87983747259263, "vf_explained_var": 0.20269266892504947, "kl": 0.007321947073292969, "entropy": 0.14521305122843353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 628000, "num_agent_steps_sampled": 628000, "num_steps_trained": 628000, "num_agent_steps_trained": 628000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6340, "training_iteration": 157, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-04-55", "timestamp": 1643648695, "time_this_iter_s": 22.884455919265747, "time_total_s": 3371.413256883621, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3371.413256883621, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 36.821875000000006, "ram_util_percent": 62.553124999999994}}
{"episode_reward_max": -3.2, "episode_reward_min": -49.2, "episode_reward_mean": -9.645, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -3.3, -27.100000000000065, -3.3, -4.2, -15.0, -15.3, -5.799999999999999, -13.399999999999997, -12.7, -11.2, -17.2, -3.4, -4.2, -14.999999999999996, -4.800000000000001, -8.6, -14.399999999999999, -14.899999999999999, -11.299999999999997, -15.199999999999998, -6.3999999999999995, -3.2, -10.099999999999996, -14.899999999999999, -12.199999999999998, -10.199999999999998, -12.7, -11.600000000000001, -7.2, -49.2, -17.199999999999996, -7.299999999999999, -3.2, -13.799999999999999, -3.3, -4.6000000000000005, -3.4, -22.699999999999996, -3.7, -5.799999999999999, -3.3, -15.4, -8.3, -9.4, -3.3, -12.499999999999998, -7.2, -7.299999999999999, -14.2, -3.2, -15.099999999999998, -7.799999999999997, -4.3, -4.300000000000001, -4.300000000000001, -10.2, -24.299999999999997, -3.2, -4.300000000000001, -3.3, -3.2, -4.4, -3.2, -4.300000000000001, -9.3, -3.3, -23.700000000000003, -18.6, -9.2, -3.2, -3.3, -12.799999999999999, -3.2, -4.300000000000001, -7.199999999999999, -25.400000000000002, -11.399999999999999, -16.8, -3.2, -9.600000000000001, -3.2, -16.499999999999996, -3.2, -14.499999999999996, -3.2, -7.5, -15.899999999999999, -7.299999999999999, -3.2, -34.20000000000001, -3.2, -3.3, -3.2, -4.2, -11.999999999999998, -11.6, -13.0, -10.39999999999999, -3.8000000000000003], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2900729392961034, "mean_inference_ms": 1.6595790862381141, "mean_action_processing_ms": 0.09282183231856593, "mean_env_wait_ms": 7.607120359806358, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 632000, "timesteps_this_iter": 0, "agent_timesteps_total": 632000, "timers": {"sample_time_ms": 25981.084, "sample_throughput": 153.958, "load_time_ms": 0.592, "load_throughput": 6752481.687, "learn_time_ms": 12789.497, "learn_throughput": 312.757, "update_time_ms": 2.356}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.09548375482861234, "policy_loss": -0.011712678774229941, "vf_loss": 10.638088720075546, "vf_explained_var": 0.2602633282702456, "kl": 0.017183551978831677, "entropy": 0.1369399161628818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 632000, "num_agent_steps_sampled": 632000, "num_steps_trained": 632000, "num_agent_steps_trained": 632000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6380, "training_iteration": 158, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-05-27", "timestamp": 1643648727, "time_this_iter_s": 31.28290104866028, "time_total_s": 3402.6961579322815, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3402.6961579322815, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 58.90888888888889, "ram_util_percent": 62.57777777777777}}
{"episode_reward_max": -2.5, "episode_reward_min": -48.7, "episode_reward_mean": -10.119, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.4, -3.3, -12.499999999999998, -7.2, -7.299999999999999, -14.2, -3.2, -15.099999999999998, -7.799999999999997, -4.3, -4.300000000000001, -4.300000000000001, -10.2, -24.299999999999997, -3.2, -4.300000000000001, -3.3, -3.2, -4.4, -3.2, -4.300000000000001, -9.3, -3.3, -23.700000000000003, -18.6, -9.2, -3.2, -3.3, -12.799999999999999, -3.2, -4.300000000000001, -7.199999999999999, -25.400000000000002, -11.399999999999999, -16.8, -3.2, -9.600000000000001, -3.2, -16.499999999999996, -3.2, -14.499999999999996, -3.2, -7.5, -15.899999999999999, -7.299999999999999, -3.2, -34.20000000000001, -3.2, -3.3, -3.2, -4.2, -11.999999999999998, -11.6, -13.0, -10.39999999999999, -3.8000000000000003, -32.099999999999994, -17.8, -10.8, -3.3, -16.199999999999996, -22.8, -5.2, -4.2, -8.2, -5.300000000000001, -14.5, -15.899999999999999, -3.2, -26.90000000000002, -5.5, -18.800000000000008, -48.7, -14.0, -4.3, -8.399999999999997, -3.2, -23.400000000000016, -4.2, -8.2, -16.099999999999998, -3.3, -9.0, -3.3, -3.3, -24.2, -2.5, -23.900000000000002, -8.3, -7.3, -3.3, -3.3, -21.5, -13.3, -14.5, -11.699999999999998, -14.7, -3.6, -5.2, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2931334589987906, "mean_inference_ms": 1.6636226582473659, "mean_action_processing_ms": 0.09308918183652982, "mean_env_wait_ms": 7.627171964882475, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 636000, "timesteps_this_iter": 0, "agent_timesteps_total": 636000, "timers": {"sample_time_ms": 26507.457, "sample_throughput": 150.901, "load_time_ms": 0.592, "load_throughput": 6753840.828, "learn_time_ms": 13097.064, "learn_throughput": 305.412, "update_time_ms": 2.424}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.1983563946139428, "policy_loss": -0.006294922694884321, "vf_loss": 20.436482944251388, "vf_explained_var": 0.1863166004739782, "kl": 0.006036378212539558, "entropy": 0.16137850570182005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 636000, "num_agent_steps_sampled": 636000, "num_steps_trained": 636000, "num_agent_steps_trained": 636000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6424, "training_iteration": 159, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-05-57", "timestamp": 1643648757, "time_this_iter_s": 30.121665954589844, "time_total_s": 3432.8178238868713, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3432.8178238868713, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 55.344186046511645, "ram_util_percent": 62.60930232558139}}
{"episode_reward_max": -2.5, "episode_reward_min": -48.7, "episode_reward_mean": -11.364, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.499999999999996, -3.2, -7.5, -15.899999999999999, -7.299999999999999, -3.2, -34.20000000000001, -3.2, -3.3, -3.2, -4.2, -11.999999999999998, -11.6, -13.0, -10.39999999999999, -3.8000000000000003, -32.099999999999994, -17.8, -10.8, -3.3, -16.199999999999996, -22.8, -5.2, -4.2, -8.2, -5.300000000000001, -14.5, -15.899999999999999, -3.2, -26.90000000000002, -5.5, -18.800000000000008, -48.7, -14.0, -4.3, -8.399999999999997, -3.2, -23.400000000000016, -4.2, -8.2, -16.099999999999998, -3.3, -9.0, -3.3, -3.3, -24.2, -2.5, -23.900000000000002, -8.3, -7.3, -3.3, -3.3, -21.5, -13.3, -14.5, -11.699999999999998, -14.7, -3.6, -5.2, -3.3, -10.799999999999999, -11.5, -4.2, -8.2, -4.2, -13.200000000000001, -18.400000000000002, -6.899999999999999, -5.5, -12.200000000000001, -19.0, -23.500000000000004, -21.199999999999996, -5.2, -5.300000000000001, -15.799999999999995, -10.0, -14.0, -3.2, -26.600000000000005, -17.1, -18.1, -3.3, -26.700000000000042, -14.099999999999998, -3.2, -3.3, -4.300000000000001, -19.2, -15.3, -3.4, -8.0, -20.000000000000004, -3.4, -11.6, -10.7, -7.2, -21.5, -4.2, -11.699999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2958530470082754, "mean_inference_ms": 1.667235952679091, "mean_action_processing_ms": 0.09327985785355797, "mean_env_wait_ms": 7.643847914897177, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 640000, "timesteps_this_iter": 0, "agent_timesteps_total": 640000, "timers": {"sample_time_ms": 27125.428, "sample_throughput": 147.463, "load_time_ms": 0.592, "load_throughput": 6754928.534, "learn_time_ms": 13291.688, "learn_throughput": 300.94, "update_time_ms": 2.43}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.087733322634582, "policy_loss": -0.0036476868011998714, "vf_loss": 9.065246723592281, "vf_explained_var": 0.35083370484331605, "kl": 0.01535038691827233, "entropy": 0.17617355475943255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 640000, "num_agent_steps_sampled": 640000, "num_steps_trained": 640000, "num_agent_steps_trained": 640000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6464, "training_iteration": 160, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-06-24", "timestamp": 1643648784, "time_this_iter_s": 26.90532398223877, "time_total_s": 3459.72314786911, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3459.72314786911, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 51.38157894736842, "ram_util_percent": 62.584210526315786}}
{"episode_reward_max": -2.5, "episode_reward_min": -26.700000000000042, "episode_reward_mean": -10.867, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.099999999999998, -3.3, -9.0, -3.3, -3.3, -24.2, -2.5, -23.900000000000002, -8.3, -7.3, -3.3, -3.3, -21.5, -13.3, -14.5, -11.699999999999998, -14.7, -3.6, -5.2, -3.3, -10.799999999999999, -11.5, -4.2, -8.2, -4.2, -13.200000000000001, -18.400000000000002, -6.899999999999999, -5.5, -12.200000000000001, -19.0, -23.500000000000004, -21.199999999999996, -5.2, -5.300000000000001, -15.799999999999995, -10.0, -14.0, -3.2, -26.600000000000005, -17.1, -18.1, -3.3, -26.700000000000042, -14.099999999999998, -3.2, -3.3, -4.300000000000001, -19.2, -15.3, -3.4, -8.0, -20.000000000000004, -3.4, -11.6, -10.7, -7.2, -21.5, -4.2, -11.699999999999998, -13.1, -18.7, -3.2, -4.300000000000001, -17.600000000000005, -6.1, -14.3, -13.899999999999999, -9.299999999999999, -10.4, -11.2, -3.7, -21.4, -10.399999999999999, -12.0, -8.700000000000001, -4.2, -8.3, -8.3, -11.100000000000001, -5.2, -3.2, -10.4, -17.099999999999998, -18.099999999999987, -11.5, -18.700000000000003, -4.2, -5.9, -11.399999999999997, -11.8, -11.4, -3.3, -15.2, -12.1, -15.599999999999998, -14.0, -3.2, -18.600000000000005, -4.800000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2979881484817617, "mean_inference_ms": 1.670079194369692, "mean_action_processing_ms": 0.09338389532966175, "mean_env_wait_ms": 7.656637652894221, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 644000, "timesteps_this_iter": 0, "agent_timesteps_total": 644000, "timers": {"sample_time_ms": 27636.854, "sample_throughput": 144.734, "load_time_ms": 0.589, "load_throughput": 6794320.658, "learn_time_ms": 13359.075, "learn_throughput": 299.422, "update_time_ms": 2.424}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.048696573687497004, "policy_loss": -0.018118652573195837, "vf_loss": 6.632351901646583, "vf_explained_var": 0.3004158627602362, "kl": 0.010360307648726098, "entropy": 0.18310661333543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 644000, "num_agent_steps_sampled": 644000, "num_steps_trained": 644000, "num_agent_steps_trained": 644000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6504, "training_iteration": 161, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-06-50", "timestamp": 1643648810, "time_this_iter_s": 26.57743215560913, "time_total_s": 3486.3005800247192, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3486.3005800247192, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 54.36842105263158, "ram_util_percent": 62.67105263157894}}
{"episode_reward_max": -3.2, "episode_reward_min": -40.3, "episode_reward_mean": -10.945, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.1, -18.1, -3.3, -26.700000000000042, -14.099999999999998, -3.2, -3.3, -4.300000000000001, -19.2, -15.3, -3.4, -8.0, -20.000000000000004, -3.4, -11.6, -10.7, -7.2, -21.5, -4.2, -11.699999999999998, -13.1, -18.7, -3.2, -4.300000000000001, -17.600000000000005, -6.1, -14.3, -13.899999999999999, -9.299999999999999, -10.4, -11.2, -3.7, -21.4, -10.399999999999999, -12.0, -8.700000000000001, -4.2, -8.3, -8.3, -11.100000000000001, -5.2, -3.2, -10.4, -17.099999999999998, -18.099999999999987, -11.5, -18.700000000000003, -4.2, -5.9, -11.399999999999997, -11.8, -11.4, -3.3, -15.2, -12.1, -15.599999999999998, -14.0, -3.2, -18.600000000000005, -4.800000000000001, -7.099999999999999, -8.099999999999998, -9.699999999999996, -11.999999999999998, -3.4, -9.7, -10.499999999999998, -3.3, -8.899999999999999, -9.600000000000001, -17.699999999999996, -9.2, -4.2, -4.300000000000001, -4.2, -13.8, -12.199999999999985, -40.3, -4.300000000000001, -3.4, -3.3, -15.499999999999998, -14.1, -10.399999999999997, -28.800000000000036, -5.700000000000001, -20.299999999999994, -5.2, -4.2, -16.799999999999997, -13.2, -12.399999999999999, -8.799999999999997, -15.399999999999999, -15.399999999999999, -31.00000000000001, -14.199999999999985, -3.3, -4.2, -4.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.299740278747048, "mean_inference_ms": 1.6727591222137652, "mean_action_processing_ms": 0.09352700485106741, "mean_env_wait_ms": 7.6682928405249235, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 648000, "timesteps_this_iter": 0, "agent_timesteps_total": 648000, "timers": {"sample_time_ms": 27862.105, "sample_throughput": 143.564, "load_time_ms": 0.548, "load_throughput": 7296027.832, "learn_time_ms": 13252.78, "learn_throughput": 301.823, "update_time_ms": 2.381}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.10683862966915933, "policy_loss": -0.013789777186328685, "vf_loss": 12.025059092942104, "vf_explained_var": 0.2804678254230048, "kl": 0.00796063535531667, "entropy": 0.15906504842462718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 648000, "num_agent_steps_sampled": 648000, "num_steps_trained": 648000, "num_agent_steps_trained": 648000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6544, "training_iteration": 162, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-07-16", "timestamp": 1643648836, "time_this_iter_s": 25.063611030578613, "time_total_s": 3511.364191055298, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3511.364191055298, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 50.827777777777776, "ram_util_percent": 62.68888888888887}}
{"episode_reward_max": -2.2, "episode_reward_min": -40.3, "episode_reward_mean": -10.606000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -3.2, -10.4, -17.099999999999998, -18.099999999999987, -11.5, -18.700000000000003, -4.2, -5.9, -11.399999999999997, -11.8, -11.4, -3.3, -15.2, -12.1, -15.599999999999998, -14.0, -3.2, -18.600000000000005, -4.800000000000001, -7.099999999999999, -8.099999999999998, -9.699999999999996, -11.999999999999998, -3.4, -9.7, -10.499999999999998, -3.3, -8.899999999999999, -9.600000000000001, -17.699999999999996, -9.2, -4.2, -4.300000000000001, -4.2, -13.8, -12.199999999999985, -40.3, -4.300000000000001, -3.4, -3.3, -15.499999999999998, -14.1, -10.399999999999997, -28.800000000000036, -5.700000000000001, -20.299999999999994, -5.2, -4.2, -16.799999999999997, -13.2, -12.399999999999999, -8.799999999999997, -15.399999999999999, -15.399999999999999, -31.00000000000001, -14.199999999999985, -3.3, -4.2, -4.2, -6.0, -8.3, -15.29999999999999, -24.5, -8.699999999999998, -11.999999999999998, -12.899999999999999, -9.899999999999999, -3.3, -3.3, -4.4, -7.299999999999999, -19.800000000000004, -11.6, -8.2, -9.2, -24.200000000000085, -3.3, -12.5, -14.199999999999998, -2.4000000000000004, -2.8000000000000003, -10.1, -4.6000000000000005, -13.6, -12.6, -12.699999999999998, -5.1, -18.5, -5.2, -13.899999999999997, -22.500000000000004, -6.699999999999999, -8.9, -19.0, -3.3, -3.3, -8.199999999999998, -8.1, -2.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3014911017032282, "mean_inference_ms": 1.6753842597109432, "mean_action_processing_ms": 0.09366804567736359, "mean_env_wait_ms": 7.681528202208734, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 652000, "timesteps_this_iter": 0, "agent_timesteps_total": 652000, "timers": {"sample_time_ms": 27934.682, "sample_throughput": 143.191, "load_time_ms": 0.584, "load_throughput": 6852318.249, "learn_time_ms": 13233.733, "learn_throughput": 302.258, "update_time_ms": 2.334}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.09191145971016858, "policy_loss": -0.004642175156522983, "vf_loss": 9.623745211077633, "vf_explained_var": 0.19252992554377485, "kl": 0.006662003970929988, "entropy": 0.1762244565993227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 652000, "num_agent_steps_sampled": 652000, "num_steps_trained": 652000, "num_agent_steps_trained": 652000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6584, "training_iteration": 163, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-07-44", "timestamp": 1643648864, "time_this_iter_s": 28.930125951766968, "time_total_s": 3540.294317007065, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3540.294317007065, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 56.20975609756096, "ram_util_percent": 62.699999999999996}}
{"episode_reward_max": -2.2, "episode_reward_min": -60.000000000000036, "episode_reward_mean": -10.822000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -15.499999999999998, -14.1, -10.399999999999997, -28.800000000000036, -5.700000000000001, -20.299999999999994, -5.2, -4.2, -16.799999999999997, -13.2, -12.399999999999999, -8.799999999999997, -15.399999999999999, -15.399999999999999, -31.00000000000001, -14.199999999999985, -3.3, -4.2, -4.2, -6.0, -8.3, -15.29999999999999, -24.5, -8.699999999999998, -11.999999999999998, -12.899999999999999, -9.899999999999999, -3.3, -3.3, -4.4, -7.299999999999999, -19.800000000000004, -11.6, -8.2, -9.2, -24.200000000000085, -3.3, -12.5, -14.199999999999998, -2.4000000000000004, -2.8000000000000003, -10.1, -4.6000000000000005, -13.6, -12.6, -12.699999999999998, -5.1, -18.5, -5.2, -13.899999999999997, -22.500000000000004, -6.699999999999999, -8.9, -19.0, -3.3, -3.3, -8.199999999999998, -8.1, -2.2, -3.2, -13.1, -60.000000000000036, -7.4, -22.6, -3.2, -4.4, -5.2, -7.499999999999999, -7.899999999999998, -3.3, -19.200000000000003, -9.2, -3.2, -15.399999999999999, -5.4, -4.4, -5.300000000000001, -9.2, -18.1, -4.2, -24.399999999999974, -7.499999999999999, -3.4, -4.300000000000001, -18.299999999999997, -8.2, -4.300000000000001, -4.300000000000001, -4.300000000000001, -3.3, -8.600000000000001, -7.199999999999999, -4.4, -16.699999999999996, -3.3, -17.699999999999996, -27.7, -11.700000000000001, -22.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.302411120064361, "mean_inference_ms": 1.677399194113852, "mean_action_processing_ms": 0.09377569512987087, "mean_env_wait_ms": 7.692046564367474, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 656000, "timesteps_this_iter": 0, "agent_timesteps_total": 656000, "timers": {"sample_time_ms": 27650.542, "sample_throughput": 144.663, "load_time_ms": 0.562, "load_throughput": 7114416.08, "learn_time_ms": 12643.974, "learn_throughput": 316.356, "update_time_ms": 2.303}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.13605360083171839, "policy_loss": -0.007779153680769346, "vf_loss": 14.342123616430708, "vf_explained_var": 0.32545813668158746, "kl": 0.0086707047447966, "entropy": 0.14293385117404883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 656000, "num_agent_steps_sampled": 656000, "num_steps_trained": 656000, "num_agent_steps_trained": 656000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6624, "training_iteration": 164, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-08-08", "timestamp": 1643648888, "time_this_iter_s": 23.05850887298584, "time_total_s": 3563.3528258800507, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3563.3528258800507, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 44.07878787878788, "ram_util_percent": 62.699999999999996}}
{"episode_reward_max": -2.2, "episode_reward_min": -60.000000000000036, "episode_reward_mean": -10.26, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000004, -2.8000000000000003, -10.1, -4.6000000000000005, -13.6, -12.6, -12.699999999999998, -5.1, -18.5, -5.2, -13.899999999999997, -22.500000000000004, -6.699999999999999, -8.9, -19.0, -3.3, -3.3, -8.199999999999998, -8.1, -2.2, -3.2, -13.1, -60.000000000000036, -7.4, -22.6, -3.2, -4.4, -5.2, -7.499999999999999, -7.899999999999998, -3.3, -19.200000000000003, -9.2, -3.2, -15.399999999999999, -5.4, -4.4, -5.300000000000001, -9.2, -18.1, -4.2, -24.399999999999974, -7.499999999999999, -3.4, -4.300000000000001, -18.299999999999997, -8.2, -4.300000000000001, -4.300000000000001, -4.300000000000001, -3.3, -8.600000000000001, -7.199999999999999, -4.4, -16.699999999999996, -3.3, -17.699999999999996, -27.7, -11.700000000000001, -22.2, -3.3, -22.799999999999997, -10.999999999999998, -20.8, -12.2, -7.1, -5.4, -4.300000000000001, -5.9, -19.800000000000004, -8.699999999999998, -4.2, -13.699999999999998, -3.2, -11.299999999999997, -4.700000000000001, -7.3, -10.8, -9.1, -10.199999999999998, -4.4, -3.4, -4.300000000000001, -14.099999999999998, -3.4, -11.799999999999999, -3.3, -12.899999999999997, -14.099999999999996, -16.9, -16.3, -9.299999999999999, -15.3, -9.099999999999998, -14.6, -9.3, -5.3, -15.5, -13.2, -16.8], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3021651246825243, "mean_inference_ms": 1.677948130579676, "mean_action_processing_ms": 0.09380178875327666, "mean_env_wait_ms": 7.695243021539308, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 660000, "timesteps_this_iter": 0, "agent_timesteps_total": 660000, "timers": {"sample_time_ms": 26216.805, "sample_throughput": 152.574, "load_time_ms": 0.534, "load_throughput": 7494512.642, "learn_time_ms": 12413.273, "learn_throughput": 322.236, "update_time_ms": 2.452}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.06798453987826424, "policy_loss": -0.002503185707234567, "vf_loss": 7.005318141288014, "vf_explained_var": 0.3758580741061959, "kl": 0.009155856069604968, "entropy": 0.15978827002227947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 660000, "num_agent_steps_sampled": 660000, "num_steps_trained": 660000, "num_agent_steps_trained": 660000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6664, "training_iteration": 165, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-08-28", "timestamp": 1643648908, "time_this_iter_s": 20.398300886154175, "time_total_s": 3583.751126766205, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3583.751126766205, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 41.80344827586206, "ram_util_percent": 62.70000000000002}}
{"episode_reward_max": 0.0, "episode_reward_min": -133.0999999999999, "episode_reward_mean": -11.230000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -24.399999999999974, -7.499999999999999, -3.4, -4.300000000000001, -18.299999999999997, -8.2, -4.300000000000001, -4.300000000000001, -4.300000000000001, -3.3, -8.600000000000001, -7.199999999999999, -4.4, -16.699999999999996, -3.3, -17.699999999999996, -27.7, -11.700000000000001, -22.2, -3.3, -22.799999999999997, -10.999999999999998, -20.8, -12.2, -7.1, -5.4, -4.300000000000001, -5.9, -19.800000000000004, -8.699999999999998, -4.2, -13.699999999999998, -3.2, -11.299999999999997, -4.700000000000001, -7.3, -10.8, -9.1, -10.199999999999998, -4.4, -3.4, -4.300000000000001, -14.099999999999998, -3.4, -11.799999999999999, -3.3, -12.899999999999997, -14.099999999999996, -16.9, -16.3, -9.299999999999999, -15.3, -9.099999999999998, -14.6, -9.3, -5.3, -15.5, -13.2, -16.8, -3.4, -35.3, -9.2, -5.4, -4.4, -11.499999999999998, -14.2, -18.800000000000008, -5.000000000000001, -3.3, -3.2, -10.0, -7.699999999999999, -11.399999999999999, -17.4, -3.900000000000001, -3.4, -22.4, -11.0, -4.7, 0.0, -9.8, -11.099999999999998, -9.3, -7.2, -12.5, -7.699999999999998, -133.0999999999999, -10.3, -4.300000000000001, -8.3, -3.4000000000000004, -9.6, -14.199999999999996, -6.9, -17.099999999999998, -9.399999999999999, -6.400000000000002, -15.699999999999992, -6.0], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3013628305606213, "mean_inference_ms": 1.6771779861397318, "mean_action_processing_ms": 0.09375653613119857, "mean_env_wait_ms": 7.691439799436928, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 664000, "timesteps_this_iter": 0, "agent_timesteps_total": 664000, "timers": {"sample_time_ms": 25603.08, "sample_throughput": 156.231, "load_time_ms": 0.541, "load_throughput": 7396383.194, "learn_time_ms": 12348.18, "learn_throughput": 323.934, "update_time_ms": 2.509}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.8706000058223263, "policy_loss": -0.006382865804217515, "vf_loss": 87.66106169778173, "vf_explained_var": 0.05923604023072027, "kl": 0.007843934153922079, "entropy": 0.17963769060148987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 664000, "num_agent_steps_sampled": 664000, "num_steps_trained": 664000, "num_agent_steps_trained": 664000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6704, "training_iteration": 166, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-08-48", "timestamp": 1643648928, "time_this_iter_s": 19.64806604385376, "time_total_s": 3603.3991928100586, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3603.3991928100586, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 40.982142857142854, "ram_util_percent": 62.70000000000001}}
{"episode_reward_max": 0.0, "episode_reward_min": -133.0999999999999, "episode_reward_mean": -11.246999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -3.4, -4.300000000000001, -14.099999999999998, -3.4, -11.799999999999999, -3.3, -12.899999999999997, -14.099999999999996, -16.9, -16.3, -9.299999999999999, -15.3, -9.099999999999998, -14.6, -9.3, -5.3, -15.5, -13.2, -16.8, -3.4, -35.3, -9.2, -5.4, -4.4, -11.499999999999998, -14.2, -18.800000000000008, -5.000000000000001, -3.3, -3.2, -10.0, -7.699999999999999, -11.399999999999999, -17.4, -3.900000000000001, -3.4, -22.4, -11.0, -4.7, 0.0, -9.8, -11.099999999999998, -9.3, -7.2, -12.5, -7.699999999999998, -133.0999999999999, -10.3, -4.300000000000001, -8.3, -3.4000000000000004, -9.6, -14.199999999999996, -6.9, -17.099999999999998, -9.399999999999999, -6.400000000000002, -15.699999999999992, -6.0, -14.8, -12.600000000000001, -4.4, -18.0, -10.2, -12.499999999999996, -14.899999999999999, -20.4, -4.4, -7.300000000000001, -8.3, -6.999999999999999, -8.599999999999998, -3.900000000000001, -10.999999999999998, -3.3, -4.2, -3.3, -16.399999999999988, -7.799999999999999, -4.300000000000001, -10.5, -4.4, -30.700000000000056, -9.2, -5.6000000000000005, -10.099999999999996, -10.099999999999998, -13.599999999999998, -1.2, -20.199999999999996, -12.2, -13.899999999999975, -4.4, -9.1, -3.3, -7.8, -20.6, -5.3, -13.699999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3006874357009643, "mean_inference_ms": 1.676033229145055, "mean_action_processing_ms": 0.09369057983165846, "mean_env_wait_ms": 7.685426900533809, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 668000, "timesteps_this_iter": 0, "agent_timesteps_total": 668000, "timers": {"sample_time_ms": 25431.536, "sample_throughput": 157.285, "load_time_ms": 0.534, "load_throughput": 7491500.781, "learn_time_ms": 12187.094, "learn_throughput": 328.216, "update_time_ms": 2.391}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.11533421861678762, "policy_loss": -0.014884275133391061, "vf_loss": 12.982018949395867, "vf_explained_var": 0.0636504368756407, "kl": 0.008392279643713207, "entropy": 0.16050303232685853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 668000, "num_agent_steps_sampled": 668000, "num_steps_trained": 668000, "num_agent_steps_trained": 668000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6744, "training_iteration": 167, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-09-08", "timestamp": 1643648948, "time_this_iter_s": 20.19236922264099, "time_total_s": 3623.5915620326996, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3623.5915620326996, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 41.48620689655172, "ram_util_percent": 62.70000000000002}}
{"episode_reward_max": 0.0, "episode_reward_min": -133.0999999999999, "episode_reward_mean": -11.36, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -9.8, -11.099999999999998, -9.3, -7.2, -12.5, -7.699999999999998, -133.0999999999999, -10.3, -4.300000000000001, -8.3, -3.4000000000000004, -9.6, -14.199999999999996, -6.9, -17.099999999999998, -9.399999999999999, -6.400000000000002, -15.699999999999992, -6.0, -14.8, -12.600000000000001, -4.4, -18.0, -10.2, -12.499999999999996, -14.899999999999999, -20.4, -4.4, -7.300000000000001, -8.3, -6.999999999999999, -8.599999999999998, -3.900000000000001, -10.999999999999998, -3.3, -4.2, -3.3, -16.399999999999988, -7.799999999999999, -4.300000000000001, -10.5, -4.4, -30.700000000000056, -9.2, -5.6000000000000005, -10.099999999999996, -10.099999999999998, -13.599999999999998, -1.2, -20.199999999999996, -12.2, -13.899999999999975, -4.4, -9.1, -3.3, -7.8, -20.6, -5.3, -13.699999999999998, -17.89999999999999, -18.600000000000005, -3.2, -22.7, -6.5, -4.300000000000001, -6.4, -7.800000000000001, -12.299999999999999, -19.2, -18.199999999999992, -9.3, -9.6, -8.299999999999999, -11.699999999999998, -3.3, -4.2, -4.2, -2.3000000000000003, -12.2, -3.3, -15.2, -9.600000000000001, -19.0, -29.600000000000026, -1.2, -17.399999999999988, -3.4, -11.2, -3.6000000000000005, -21.8, -4.300000000000001, -4.6000000000000005, -6.199999999999999, -23.29999999999999, -14.499999999999998, -3.7, -24.100000000000048, -3.2, -8.799999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.300083192557623, "mean_inference_ms": 1.6749714271720535, "mean_action_processing_ms": 0.09362951102132183, "mean_env_wait_ms": 7.679765532278191, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 672000, "timesteps_this_iter": 0, "agent_timesteps_total": 672000, "timers": {"sample_time_ms": 24618.776, "sample_throughput": 162.478, "load_time_ms": 0.511, "load_throughput": 7827749.732, "learn_time_ms": 11732.988, "learn_throughput": 340.919, "update_time_ms": 2.308}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.1392710538320644, "policy_loss": -0.005381564342326695, "vf_loss": 14.436177760362625, "vf_explained_var": 0.0936805776370469, "kl": 0.006128094086470262, "entropy": 0.1536543212310281, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 672000, "num_agent_steps_sampled": 672000, "num_steps_trained": 672000, "num_agent_steps_trained": 672000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6784, "training_iteration": 168, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-09-28", "timestamp": 1643648968, "time_this_iter_s": 20.266202211380005, "time_total_s": 3643.8577642440796, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3643.8577642440796, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 32.268965517241384, "ram_util_percent": 62.70000000000002}}
{"episode_reward_max": -1.2, "episode_reward_min": -29.600000000000026, "episode_reward_mean": -9.892999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.2, -5.6000000000000005, -10.099999999999996, -10.099999999999998, -13.599999999999998, -1.2, -20.199999999999996, -12.2, -13.899999999999975, -4.4, -9.1, -3.3, -7.8, -20.6, -5.3, -13.699999999999998, -17.89999999999999, -18.600000000000005, -3.2, -22.7, -6.5, -4.300000000000001, -6.4, -7.800000000000001, -12.299999999999999, -19.2, -18.199999999999992, -9.3, -9.6, -8.299999999999999, -11.699999999999998, -3.3, -4.2, -4.2, -2.3000000000000003, -12.2, -3.3, -15.2, -9.600000000000001, -19.0, -29.600000000000026, -1.2, -17.399999999999988, -3.4, -11.2, -3.6000000000000005, -21.8, -4.300000000000001, -4.6000000000000005, -6.199999999999999, -23.29999999999999, -14.499999999999998, -3.7, -24.100000000000048, -3.2, -8.799999999999999, -20.6, -12.6, -12.0, -23.799999999999997, -20.999999999999996, -4.9, -4.800000000000001, -3.3, -4.2, -9.2, -8.700000000000001, -5.300000000000001, -3.4000000000000004, -7.3, -10.7, -12.0, -5.4, -22.2, -11.2, -4.2, -11.700000000000001, -3.900000000000001, -9.7, -7.4, -4.2, -3.2, -15.5, -25.5, -13.999999999999998, -5.3, -11.299999999999999, -3.2, -12.0, -2.2, -9.599999999999998, -7.700000000000001, -3.3, -4.300000000000001, -5.4, -4.2, -7.5, -3.6000000000000005, -13.0, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2995481323355502, "mean_inference_ms": 1.6737804281012232, "mean_action_processing_ms": 0.09361955464778368, "mean_env_wait_ms": 7.674440206920621, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 676000, "timesteps_this_iter": 0, "agent_timesteps_total": 676000, "timers": {"sample_time_ms": 23570.122, "sample_throughput": 169.706, "load_time_ms": 0.506, "load_throughput": 7901481.656, "learn_time_ms": 11301.828, "learn_throughput": 353.925, "update_time_ms": 2.247}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.06840255411181559, "policy_loss": -0.01103876441046195, "vf_loss": 7.904335189490549, "vf_explained_var": 0.26083009890330733, "kl": 0.008385172474289136, "entropy": 0.15773800102372965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 676000, "num_agent_steps_sampled": 676000, "num_steps_trained": 676000, "num_agent_steps_trained": 676000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6828, "training_iteration": 169, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-09-48", "timestamp": 1643648988, "time_this_iter_s": 19.886574745178223, "time_total_s": 3663.744338989258, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3663.744338989258, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 37.25, "ram_util_percent": 62.70000000000001}}
{"episode_reward_max": -1.2, "episode_reward_min": -89.09999999999991, "episode_reward_mean": -11.258000000000004, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.600000000000026, -1.2, -17.399999999999988, -3.4, -11.2, -3.6000000000000005, -21.8, -4.300000000000001, -4.6000000000000005, -6.199999999999999, -23.29999999999999, -14.499999999999998, -3.7, -24.100000000000048, -3.2, -8.799999999999999, -20.6, -12.6, -12.0, -23.799999999999997, -20.999999999999996, -4.9, -4.800000000000001, -3.3, -4.2, -9.2, -8.700000000000001, -5.300000000000001, -3.4000000000000004, -7.3, -10.7, -12.0, -5.4, -22.2, -11.2, -4.2, -11.700000000000001, -3.900000000000001, -9.7, -7.4, -4.2, -3.2, -15.5, -25.5, -13.999999999999998, -5.3, -11.299999999999999, -3.2, -12.0, -2.2, -9.599999999999998, -7.700000000000001, -3.3, -4.300000000000001, -5.4, -4.2, -7.5, -3.6000000000000005, -13.0, -4.300000000000001, -6.999999999999999, -3.3, -4.4, -18.2, -3.2, -13.1, -15.8, -3.4, -15.3, -3.2, -19.0, -17.899999999999995, -13.799999999999999, -20.9, -3.2, -5.300000000000001, -4.2, -14.7, -3.4, -16.7, -7.499999999999998, -43.6, -7.999999999999998, -89.09999999999991, -4.4, -12.999999999999998, -7.3, -3.3, -4.4, -4.2, -4.800000000000001, -9.1, -26.599999999999998, -22.3, -3.3, -4.300000000000001, -49.800000000000075, -6.199999999999999, -14.199999999999998, -14.7], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2988330486843103, "mean_inference_ms": 1.6727406637762283, "mean_action_processing_ms": 0.09356299725998934, "mean_env_wait_ms": 7.669286416983757, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 680000, "timesteps_this_iter": 0, "agent_timesteps_total": 680000, "timers": {"sample_time_ms": 22742.249, "sample_throughput": 175.884, "load_time_ms": 0.494, "load_throughput": 8096721.201, "learn_time_ms": 11010.642, "learn_throughput": 363.285, "update_time_ms": 2.151}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.47947460661932667, "policy_loss": -0.00673612064671933, "vf_loss": 48.58398001165159, "vf_explained_var": 0.07877222914849558, "kl": 0.0078155483462756, "entropy": 0.1346794937186504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 680000, "num_agent_steps_sampled": 680000, "num_steps_trained": 680000, "num_agent_steps_trained": 680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6868, "training_iteration": 170, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-10-08", "timestamp": 1643649008, "time_this_iter_s": 20.062856197357178, "time_total_s": 3683.807195186615, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3683.807195186615, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 31.49655172413793, "ram_util_percent": 62.613793103448266}}
{"episode_reward_max": -2.2, "episode_reward_min": -89.09999999999991, "episode_reward_mean": -11.008999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -3.2, -15.5, -25.5, -13.999999999999998, -5.3, -11.299999999999999, -3.2, -12.0, -2.2, -9.599999999999998, -7.700000000000001, -3.3, -4.300000000000001, -5.4, -4.2, -7.5, -3.6000000000000005, -13.0, -4.300000000000001, -6.999999999999999, -3.3, -4.4, -18.2, -3.2, -13.1, -15.8, -3.4, -15.3, -3.2, -19.0, -17.899999999999995, -13.799999999999999, -20.9, -3.2, -5.300000000000001, -4.2, -14.7, -3.4, -16.7, -7.499999999999998, -43.6, -7.999999999999998, -89.09999999999991, -4.4, -12.999999999999998, -7.3, -3.3, -4.4, -4.2, -4.800000000000001, -9.1, -26.599999999999998, -22.3, -3.3, -4.300000000000001, -49.800000000000075, -6.199999999999999, -14.199999999999998, -14.7, -4.2, -8.2, -9.5, -5.0, -6.2, -13.8, -8.3, -16.5, -4.3, -7.300000000000001, -14.2, -7.000000000000001, -9.2, -3.3, -4.5, -3.2, -8.1, -19.299999999999997, -11.1, -28.3, -8.8, -7.3, -4.4, -10.899999999999999, -10.7, -3.3, -5.4, -4.300000000000001, -38.3, -4.300000000000001, -4.4, -22.7, -8.3, -15.499999999999998, -7.799999999999999, -15.9, -8.2, -14.799999999999997, -3.3, -5.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2979328052251615, "mean_inference_ms": 1.6716869196651054, "mean_action_processing_ms": 0.09345142535786845, "mean_env_wait_ms": 7.664039945618376, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 684000, "timesteps_this_iter": 0, "agent_timesteps_total": 684000, "timers": {"sample_time_ms": 22007.577, "sample_throughput": 181.756, "load_time_ms": 0.496, "load_throughput": 8067132.76, "learn_time_ms": 10838.915, "learn_throughput": 369.041, "update_time_ms": 2.093}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.08608484141508578, "policy_loss": -0.013725124095236102, "vf_loss": 9.946407289722915, "vf_explained_var": 0.26450466455951815, "kl": 0.007287985956665556, "entropy": 0.13093102481015909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 684000, "num_agent_steps_sampled": 684000, "num_steps_trained": 684000, "num_agent_steps_trained": 684000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6908, "training_iteration": 171, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-10-29", "timestamp": 1643649029, "time_this_iter_s": 20.43944811820984, "time_total_s": 3704.246643304825, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3704.246643304825, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 41.3551724137931, "ram_util_percent": 62.5655172413793}}
{"episode_reward_max": -3.2, "episode_reward_min": -89.09999999999991, "episode_reward_mean": -11.713999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.499999999999998, -43.6, -7.999999999999998, -89.09999999999991, -4.4, -12.999999999999998, -7.3, -3.3, -4.4, -4.2, -4.800000000000001, -9.1, -26.599999999999998, -22.3, -3.3, -4.300000000000001, -49.800000000000075, -6.199999999999999, -14.199999999999998, -14.7, -4.2, -8.2, -9.5, -5.0, -6.2, -13.8, -8.3, -16.5, -4.3, -7.300000000000001, -14.2, -7.000000000000001, -9.2, -3.3, -4.5, -3.2, -8.1, -19.299999999999997, -11.1, -28.3, -8.8, -7.3, -4.4, -10.899999999999999, -10.7, -3.3, -5.4, -4.300000000000001, -38.3, -4.300000000000001, -4.4, -22.7, -8.3, -15.499999999999998, -7.799999999999999, -15.9, -8.2, -14.799999999999997, -3.3, -5.4, -12.399999999999997, -4.2, -17.700000000000003, -14.09999999999998, -7.1, -3.4, -4.300000000000001, -5.300000000000001, -4.2, -9.6, -20.599999999999977, -15.5, -13.6, -4.300000000000001, -42.4, -5.9, -5.4, -22.300000000000004, -29.299999999999997, -6.6000000000000005, -4.300000000000001, -19.1, -3.3, -11.200000000000001, -13.799999999999999, -15.5, -23.099999999999998, -9.3, -10.5, -6.2, -6.999999999999998, -5.2, -9.099999999999998, -6.199999999999999, -5.300000000000001, -5.4, -4.300000000000001, -16.099999999999998, -8.399999999999999, -4.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2970484596295668, "mean_inference_ms": 1.6708491630986275, "mean_action_processing_ms": 0.09340093759617489, "mean_env_wait_ms": 7.6592189029763675, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 688000, "timesteps_this_iter": 0, "agent_timesteps_total": 688000, "timers": {"sample_time_ms": 21491.038, "sample_throughput": 186.124, "load_time_ms": 0.493, "load_throughput": 8106110.064, "learn_time_ms": 10734.177, "learn_throughput": 372.642, "update_time_ms": 2.084}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.08492457509761857, "policy_loss": -0.0047624218908529125, "vf_loss": 8.932640979238736, "vf_explained_var": 0.20749561825106222, "kl": 0.0075975727800600195, "entropy": 0.11887486267794845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 688000, "num_agent_steps_sampled": 688000, "num_steps_trained": 688000, "num_agent_steps_trained": 688000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6948, "training_iteration": 172, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-10-49", "timestamp": 1643649049, "time_this_iter_s": 20.578227758407593, "time_total_s": 3724.8248710632324, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3724.8248710632324, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 39.772413793103446, "ram_util_percent": 62.59999999999999}}
{"episode_reward_max": -3.3, "episode_reward_min": -42.4, "episode_reward_mean": -10.247, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.8, -7.3, -4.4, -10.899999999999999, -10.7, -3.3, -5.4, -4.300000000000001, -38.3, -4.300000000000001, -4.4, -22.7, -8.3, -15.499999999999998, -7.799999999999999, -15.9, -8.2, -14.799999999999997, -3.3, -5.4, -12.399999999999997, -4.2, -17.700000000000003, -14.09999999999998, -7.1, -3.4, -4.300000000000001, -5.300000000000001, -4.2, -9.6, -20.599999999999977, -15.5, -13.6, -4.300000000000001, -42.4, -5.9, -5.4, -22.300000000000004, -29.299999999999997, -6.6000000000000005, -4.300000000000001, -19.1, -3.3, -11.200000000000001, -13.799999999999999, -15.5, -23.099999999999998, -9.3, -10.5, -6.2, -6.999999999999998, -5.2, -9.099999999999998, -6.199999999999999, -5.300000000000001, -5.4, -4.300000000000001, -16.099999999999998, -8.399999999999999, -4.3, -14.5, -22.8, -3.4, -14.5, -14.8, -7.2, -6.0, -5.4, -9.600000000000001, -13.099999999999987, -14.399999999999999, -4.4, -4.4, -14.4, -11.399999999999999, -4.2, -10.099999999999996, -8.3, -4.2, -8.2, -5.9, -5.300000000000001, -10.999999999999998, -8.9, -9.3, -3.3, -8.5, -10.8, -7.8, -3.4, -13.5, -11.9, -10.6, -3.4, -8.099999999999998, -21.300000000000047, -3.3, -8.5, -20.1, -14.700000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2966592776702461, "mean_inference_ms": 1.670373001179246, "mean_action_processing_ms": 0.09337545608230677, "mean_env_wait_ms": 7.656748003577833, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 692000, "timesteps_this_iter": 0, "agent_timesteps_total": 692000, "timers": {"sample_time_ms": 21041.55, "sample_throughput": 190.1, "load_time_ms": 0.448, "load_throughput": 8919780.956, "learn_time_ms": 10545.825, "learn_throughput": 379.297, "update_time_ms": 2.1}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.06977335357342557, "policy_loss": -0.002719441981565568, "vf_loss": 7.19872647773835, "vf_explained_var": 0.3679269190116595, "kl": 0.010651569301050557, "entropy": 0.15445983040757397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 692000, "num_agent_steps_sampled": 692000, "num_steps_trained": 692000, "num_agent_steps_trained": 692000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6988, "training_iteration": 173, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-11-13", "timestamp": 1643649073, "time_this_iter_s": 23.607789039611816, "time_total_s": 3748.4326601028442, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3748.4326601028442, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 43.926470588235304, "ram_util_percent": 62.6970588235294}}
{"episode_reward_max": -3.3, "episode_reward_min": -43.4, "episode_reward_mean": -10.094, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -19.1, -3.3, -11.200000000000001, -13.799999999999999, -15.5, -23.099999999999998, -9.3, -10.5, -6.2, -6.999999999999998, -5.2, -9.099999999999998, -6.199999999999999, -5.300000000000001, -5.4, -4.300000000000001, -16.099999999999998, -8.399999999999999, -4.3, -14.5, -22.8, -3.4, -14.5, -14.8, -7.2, -6.0, -5.4, -9.600000000000001, -13.099999999999987, -14.399999999999999, -4.4, -4.4, -14.4, -11.399999999999999, -4.2, -10.099999999999996, -8.3, -4.2, -8.2, -5.9, -5.300000000000001, -10.999999999999998, -8.9, -9.3, -3.3, -8.5, -10.8, -7.8, -3.4, -13.5, -11.9, -10.6, -3.4, -8.099999999999998, -21.300000000000047, -3.3, -8.5, -20.1, -14.700000000000001, -24.7, -3.3, -9.599999999999998, -6.2, -6.4, -26.6, -21.5, -3.3, -8.2, -3.3, -13.799999999999999, -9.6, -8.3, -18.5, -3.900000000000001, -3.8000000000000007, -5.2, -43.4, -3.6, -3.3, -30.60000000000003, -3.3, -40.4, -8.4, -4.4, -9.9, -11.3, -3.4, -6.8999999999999995, -5.1, -4.9, -6.499999999999999, -10.799999999999999, -10.2, -3.4, -14.699999999999998, -18.2, -4.300000000000001, -10.4, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2973130347455981, "mean_inference_ms": 1.6712505732053395, "mean_action_processing_ms": 0.09342373047127506, "mean_env_wait_ms": 7.660817900952193, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 696000, "timesteps_this_iter": 0, "agent_timesteps_total": 696000, "timers": {"sample_time_ms": 21039.739, "sample_throughput": 190.116, "load_time_ms": 0.445, "load_throughput": 8998238.67, "learn_time_ms": 10784.525, "learn_throughput": 370.902, "update_time_ms": 2.087}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.11316210406842411, "policy_loss": -0.008402650372716047, "vf_loss": 12.12249827026039, "vf_explained_var": 0.20064926634552657, "kl": 0.00715905081071887, "entropy": 0.15973052206619454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 696000, "num_agent_steps_sampled": 696000, "num_steps_trained": 696000, "num_agent_steps_trained": 696000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7028, "training_iteration": 174, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-11-40", "timestamp": 1643649100, "time_this_iter_s": 27.301069259643555, "time_total_s": 3775.733729362488, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3775.733729362488, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 51.48717948717948, "ram_util_percent": 62.71025641025642}}
{"episode_reward_max": -3.3, "episode_reward_min": -43.4, "episode_reward_mean": -10.406, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.9, -5.300000000000001, -10.999999999999998, -8.9, -9.3, -3.3, -8.5, -10.8, -7.8, -3.4, -13.5, -11.9, -10.6, -3.4, -8.099999999999998, -21.300000000000047, -3.3, -8.5, -20.1, -14.700000000000001, -24.7, -3.3, -9.599999999999998, -6.2, -6.4, -26.6, -21.5, -3.3, -8.2, -3.3, -13.799999999999999, -9.6, -8.3, -18.5, -3.900000000000001, -3.8000000000000007, -5.2, -43.4, -3.6, -3.3, -30.60000000000003, -3.3, -40.4, -8.4, -4.4, -9.9, -11.3, -3.4, -6.8999999999999995, -5.1, -4.9, -6.499999999999999, -10.799999999999999, -10.2, -3.4, -14.699999999999998, -18.2, -4.300000000000001, -10.4, -3.3, -4.2, -7.299999999999999, -3.4, -8.7, -10.8, -12.3, -13.1, -13.0, -6.300000000000001, -5.4, -17.5, -8.4, -5.300000000000001, -15.1, -16.2, -20.8, -9.0, -3.7, -3.3, -12.700000000000001, -14.999999999999996, -7.099999999999999, -22.4, -24.30000000000001, -9.399999999999997, -3.3, -23.70000000000002, -6.300000000000001, -22.6, -4.4, -4.700000000000001, -4.300000000000001, -8.2, -9.2, -8.400000000000002, -12.699999999999998, -9.7, -8.2, -10.399999999999999, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2987998379569428, "mean_inference_ms": 1.6732575900858364, "mean_action_processing_ms": 0.09353629398808433, "mean_env_wait_ms": 7.670378423482732, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 700000, "timesteps_this_iter": 0, "agent_timesteps_total": 700000, "timers": {"sample_time_ms": 21684.517, "sample_throughput": 184.463, "load_time_ms": 0.447, "load_throughput": 8955968.612, "learn_time_ms": 11017.958, "learn_throughput": 363.044, "update_time_ms": 1.958}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.06736613648057345, "policy_loss": -0.009330942524817361, "vf_loss": 7.6444789227618966, "vf_explained_var": 0.18811005494927846, "kl": 0.005315739715347073, "entropy": 0.15007369249298047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 700000, "num_agent_steps_sampled": 700000, "num_steps_trained": 700000, "num_agent_steps_trained": 700000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7068, "training_iteration": 175, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-12-07", "timestamp": 1643649127, "time_this_iter_s": 26.792316913604736, "time_total_s": 3802.5260462760925, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3802.5260462760925, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 54.557894736842115, "ram_util_percent": 62.705263157894706}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -107.90000000000003, "episode_reward_mean": -11.019000000000004, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.60000000000003, -3.3, -40.4, -8.4, -4.4, -9.9, -11.3, -3.4, -6.8999999999999995, -5.1, -4.9, -6.499999999999999, -10.799999999999999, -10.2, -3.4, -14.699999999999998, -18.2, -4.300000000000001, -10.4, -3.3, -4.2, -7.299999999999999, -3.4, -8.7, -10.8, -12.3, -13.1, -13.0, -6.300000000000001, -5.4, -17.5, -8.4, -5.300000000000001, -15.1, -16.2, -20.8, -9.0, -3.7, -3.3, -12.700000000000001, -14.999999999999996, -7.099999999999999, -22.4, -24.30000000000001, -9.399999999999997, -3.3, -23.70000000000002, -6.300000000000001, -22.6, -4.4, -4.700000000000001, -4.300000000000001, -8.2, -9.2, -8.400000000000002, -12.699999999999998, -9.7, -8.2, -10.399999999999999, -3.3, -4.300000000000001, -21.1, -7.2, -12.599999999999998, -3.4, -6.2, -13.899999999999993, -10.2, -19.600000000000005, -6.0, -4.2, -21.900000000000006, -14.899999999999995, -19.5, -14.5, -6.5, -24.0, -107.90000000000003, -10.299999999999999, -6.700000000000001, -4.2, -12.4, -2.3000000000000003, -4.3, -4.6000000000000005, -13.2, -3.5, -4.4, -12.699999999999998, -8.3, -4.300000000000001, -8.999999999999998, -3.3, -4.300000000000001, -4.300000000000001, -7.5, -3.4, -9.7, -18.500000000000007, -8.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.30041123316224, "mean_inference_ms": 1.6754834529041553, "mean_action_processing_ms": 0.09366018776012705, "mean_env_wait_ms": 7.68073491318898, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 704000, "timesteps_this_iter": 0, "agent_timesteps_total": 704000, "timers": {"sample_time_ms": 22293.533, "sample_throughput": 179.424, "load_time_ms": 0.448, "load_throughput": 8927850.149, "learn_time_ms": 11649.395, "learn_throughput": 343.365, "update_time_ms": 2.104}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.6019940692262964, "policy_loss": -0.014188437065189725, "vf_loss": 61.575900913246215, "vf_explained_var": 0.08145151176760274, "kl": 0.008923406973109066, "entropy": 0.18024111750225227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 704000, "num_agent_steps_sampled": 704000, "num_steps_trained": 704000, "num_agent_steps_trained": 704000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7108, "training_iteration": 176, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-12-37", "timestamp": 1643649157, "time_this_iter_s": 29.73318910598755, "time_total_s": 3832.25923538208, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3832.25923538208, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 51.352380952380955, "ram_util_percent": 62.68571428571427}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -107.90000000000003, "episode_reward_mean": -11.499, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.999999999999996, -7.099999999999999, -22.4, -24.30000000000001, -9.399999999999997, -3.3, -23.70000000000002, -6.300000000000001, -22.6, -4.4, -4.700000000000001, -4.300000000000001, -8.2, -9.2, -8.400000000000002, -12.699999999999998, -9.7, -8.2, -10.399999999999999, -3.3, -4.300000000000001, -21.1, -7.2, -12.599999999999998, -3.4, -6.2, -13.899999999999993, -10.2, -19.600000000000005, -6.0, -4.2, -21.900000000000006, -14.899999999999995, -19.5, -14.5, -6.5, -24.0, -107.90000000000003, -10.299999999999999, -6.700000000000001, -4.2, -12.4, -2.3000000000000003, -4.3, -4.6000000000000005, -13.2, -3.5, -4.4, -12.699999999999998, -8.3, -4.300000000000001, -8.999999999999998, -3.3, -4.300000000000001, -4.300000000000001, -7.5, -3.4, -9.7, -18.500000000000007, -8.3, -13.5, -3.2, -12.79999999999998, -16.2, -7.9, -7.2, -18.7, -7.3, -12.7, -3.2, -7.2, -13.899999999999999, -16.4, -46.3, -6.0, -17.700000000000003, -2.6000000000000005, -11.999999999999995, -7.7, -4.300000000000001, -4.300000000000001, -19.2, -17.0, -5.4, -4.300000000000001, -10.7, -4.2, -12.2, -3.2, -4.300000000000001, -8.3, -26.3, -28.3, -14.4, -17.099999999999998, -8.3, -4.2, -8.2, -14.899999999999999, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3022402985496415, "mean_inference_ms": 1.6778308015679155, "mean_action_processing_ms": 0.0937897867128785, "mean_env_wait_ms": 7.691633879615524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 708000, "timesteps_this_iter": 0, "agent_timesteps_total": 708000, "timers": {"sample_time_ms": 23377.106, "sample_throughput": 171.108, "load_time_ms": 0.488, "load_throughput": 8202012.222, "learn_time_ms": 12000.844, "learn_throughput": 333.31, "update_time_ms": 2.267}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.13111294564861123, "policy_loss": -0.011370003630997993, "vf_loss": 14.207768824792677, "vf_explained_var": 0.1384408237472657, "kl": 0.008538898414187814, "entropy": 0.16239571548517673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 708000, "num_agent_steps_sampled": 708000, "num_steps_trained": 708000, "num_agent_steps_trained": 708000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7148, "training_iteration": 177, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-13-05", "timestamp": 1643649185, "time_this_iter_s": 28.176433324813843, "time_total_s": 3860.435668706894, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3860.435668706894, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 53.842499999999994, "ram_util_percent": 62.7}}
{"episode_reward_max": -2.2, "episode_reward_min": -46.3, "episode_reward_mean": -10.394999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -12.4, -2.3000000000000003, -4.3, -4.6000000000000005, -13.2, -3.5, -4.4, -12.699999999999998, -8.3, -4.300000000000001, -8.999999999999998, -3.3, -4.300000000000001, -4.300000000000001, -7.5, -3.4, -9.7, -18.500000000000007, -8.3, -13.5, -3.2, -12.79999999999998, -16.2, -7.9, -7.2, -18.7, -7.3, -12.7, -3.2, -7.2, -13.899999999999999, -16.4, -46.3, -6.0, -17.700000000000003, -2.6000000000000005, -11.999999999999995, -7.7, -4.300000000000001, -4.300000000000001, -19.2, -17.0, -5.4, -4.300000000000001, -10.7, -4.2, -12.2, -3.2, -4.300000000000001, -8.3, -26.3, -28.3, -14.4, -17.099999999999998, -8.3, -4.2, -8.2, -14.899999999999999, -3.3, -9.899999999999999, -7.5, -6.2, -5.6, -13.699999999999998, -4.2, -11.299999999999997, -4.9, -4.300000000000001, -8.2, -18.1, -4.300000000000001, -42.4, -13.4, -23.800000000000004, -3.2, -17.3, -9.5, -12.5, -9.6, -24.8, -7.499999999999998, -21.0, -10.2, -3.3, -7.7, -9.799999999999999, -11.000000000000002, -2.2, -17.4, -4.2, -15.8, -17.9, -5.0, -8.3, -6.300000000000001, -14.899999999999999, -3.3, -11.099999999999998, -10.5], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3048375160507368, "mean_inference_ms": 1.6810430318800715, "mean_action_processing_ms": 0.09396462672441455, "mean_env_wait_ms": 7.706273279863144, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 712000, "timesteps_this_iter": 0, "agent_timesteps_total": 712000, "timers": {"sample_time_ms": 24351.319, "sample_throughput": 164.262, "load_time_ms": 0.54, "load_throughput": 7408140.593, "learn_time_ms": 12261.494, "learn_throughput": 326.225, "update_time_ms": 2.326}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.12797546078280736, "policy_loss": -0.009811759437935086, "vf_loss": 13.735781141122182, "vf_explained_var": 0.12824818024071313, "kl": 0.009047689385354569, "entropy": 0.17852718594173592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 712000, "num_agent_steps_sampled": 712000, "num_steps_trained": 712000, "num_agent_steps_trained": 712000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7188, "training_iteration": 178, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-13-34", "timestamp": 1643649214, "time_this_iter_s": 29.074328899383545, "time_total_s": 3889.5099976062775, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3889.5099976062775, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 42.642857142857146, "ram_util_percent": 62.711904761904755}}
{"episode_reward_max": -2.2, "episode_reward_min": -42.4, "episode_reward_mean": -10.503999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -10.7, -4.2, -12.2, -3.2, -4.300000000000001, -8.3, -26.3, -28.3, -14.4, -17.099999999999998, -8.3, -4.2, -8.2, -14.899999999999999, -3.3, -9.899999999999999, -7.5, -6.2, -5.6, -13.699999999999998, -4.2, -11.299999999999997, -4.9, -4.300000000000001, -8.2, -18.1, -4.300000000000001, -42.4, -13.4, -23.800000000000004, -3.2, -17.3, -9.5, -12.5, -9.6, -24.8, -7.499999999999998, -21.0, -10.2, -3.3, -7.7, -9.799999999999999, -11.000000000000002, -2.2, -17.4, -4.2, -15.8, -17.9, -5.0, -8.3, -6.300000000000001, -14.899999999999999, -3.3, -11.099999999999998, -10.5, -4.2, -8.8, -5.3999999999999995, -13.799999999999999, -5.1, -9.3, -6.3999999999999995, -8.3, -12.399999999999999, -7.3, -13.700000000000001, -3.2, -8.2, -4.300000000000001, -11.9, -26.5, -9.3, -4.300000000000001, -21.5, -16.4, -13.7, -8.999999999999998, -9.199999999999998, -8.5, -6.4, -10.799999999999999, -9.1, -4.4, -12.0, -20.2, -14.799999999999974, -5.2, -13.399999999999999, -3.2, -5.2, -4.300000000000001, -20.1, -21.099999999999998, -15.599999999999998, -3.3, -9.8, -3.900000000000001, -4.3, -8.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.308052121631671, "mean_inference_ms": 1.684417742505035, "mean_action_processing_ms": 0.09420785316528998, "mean_env_wait_ms": 7.7223412863782475, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 716000, "timesteps_this_iter": 0, "agent_timesteps_total": 716000, "timers": {"sample_time_ms": 25030.931, "sample_throughput": 159.802, "load_time_ms": 0.589, "load_throughput": 6794320.658, "learn_time_ms": 12762.419, "learn_throughput": 313.42, "update_time_ms": 2.439}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.08301406086820569, "policy_loss": -0.007771420891907427, "vf_loss": 9.052248250220412, "vf_explained_var": 0.26918916849679847, "kl": 0.005541410206891351, "entropy": 0.14649679881510555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 716000, "num_agent_steps_sampled": 716000, "num_steps_trained": 716000, "num_agent_steps_trained": 716000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7232, "training_iteration": 179, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-14-04", "timestamp": 1643649244, "time_this_iter_s": 29.067435026168823, "time_total_s": 3918.5774326324463, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3918.5774326324463, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 46.573170731707314, "ram_util_percent": 62.721951219512206}}
{"episode_reward_max": -2.2, "episode_reward_min": -45.599999999999994, "episode_reward_mean": -10.326, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -7.7, -9.799999999999999, -11.000000000000002, -2.2, -17.4, -4.2, -15.8, -17.9, -5.0, -8.3, -6.300000000000001, -14.899999999999999, -3.3, -11.099999999999998, -10.5, -4.2, -8.8, -5.3999999999999995, -13.799999999999999, -5.1, -9.3, -6.3999999999999995, -8.3, -12.399999999999999, -7.3, -13.700000000000001, -3.2, -8.2, -4.300000000000001, -11.9, -26.5, -9.3, -4.300000000000001, -21.5, -16.4, -13.7, -8.999999999999998, -9.199999999999998, -8.5, -6.4, -10.799999999999999, -9.1, -4.4, -12.0, -20.2, -14.799999999999974, -5.2, -13.399999999999999, -3.2, -5.2, -4.300000000000001, -20.1, -21.099999999999998, -15.599999999999998, -3.3, -9.8, -3.900000000000001, -4.3, -8.3, -10.999999999999998, -3.5000000000000004, -3.4, -10.4, -11.699999999999998, -6.6000000000000005, -12.2, -4.4, -7.1, -9.799999999999999, -14.799999999999997, -45.10000000000007, -3.3, -8.799999999999999, -5.000000000000001, -4.4, -13.7, -8.600000000000001, -4.300000000000001, -13.799999999999999, -6.999999999999998, -8.3, -3.2, -9.999999999999998, -17.5, -8.600000000000001, -12.999999999999995, -9.2, -5.2, -4.3, -29.800000000000043, -3.3, -4.300000000000001, -2.3000000000000003, -45.599999999999994, -7.3, -21.000000000000007, -21.9, -7.2, -16.9], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.310147571097062, "mean_inference_ms": 1.6869433569067969, "mean_action_processing_ms": 0.09434243512685303, "mean_env_wait_ms": 7.73393722356857, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 720000, "timesteps_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"sample_time_ms": 25955.26, "sample_throughput": 154.111, "load_time_ms": 0.589, "load_throughput": 6795146.213, "learn_time_ms": 13077.908, "learn_throughput": 305.859, "update_time_ms": 2.468}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.15572590712678208, "policy_loss": -0.0073737850655571265, "vf_loss": 16.27525435346429, "vf_explained_var": 0.2161137621248922, "kl": 0.0073145488354015116, "entropy": 0.1649841218786214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 720000, "num_agent_steps_sampled": 720000, "num_steps_trained": 720000, "num_agent_steps_trained": 720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7272, "training_iteration": 180, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-14-31", "timestamp": 1643649271, "time_this_iter_s": 27.43605399131775, "time_total_s": 3946.013486623764, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3946.013486623764, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 49.946153846153855, "ram_util_percent": 62.78717948717951}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -46.2, "episode_reward_mean": -10.795, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.4, -10.799999999999999, -9.1, -4.4, -12.0, -20.2, -14.799999999999974, -5.2, -13.399999999999999, -3.2, -5.2, -4.300000000000001, -20.1, -21.099999999999998, -15.599999999999998, -3.3, -9.8, -3.900000000000001, -4.3, -8.3, -10.999999999999998, -3.5000000000000004, -3.4, -10.4, -11.699999999999998, -6.6000000000000005, -12.2, -4.4, -7.1, -9.799999999999999, -14.799999999999997, -45.10000000000007, -3.3, -8.799999999999999, -5.000000000000001, -4.4, -13.7, -8.600000000000001, -4.300000000000001, -13.799999999999999, -6.999999999999998, -8.3, -3.2, -9.999999999999998, -17.5, -8.600000000000001, -12.999999999999995, -9.2, -5.2, -4.3, -29.800000000000043, -3.3, -4.300000000000001, -2.3000000000000003, -45.599999999999994, -7.3, -21.000000000000007, -21.9, -7.2, -16.9, -6.300000000000001, -3.3, -22.30000000000001, -10.7, -36.3, -4.4, -5.300000000000001, -4.300000000000001, -46.2, -12.9, -3.3, -20.099999999999998, -17.3, -7.3, -5.4, -23.2, -14.2, -11.199999999999998, -7.2, -4.300000000000001, -17.9, -5.300000000000001, -4.300000000000001, -16.5, -12.000000000000002, -10.599999999999998, -3.4, -7.2, -10.5, -4.2, -13.999999999999998, -4.2, -9.1, -19.2, -9.9, -2.5, -8.2, -3.2, -4.300000000000001, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3116771275473895, "mean_inference_ms": 1.688952162974232, "mean_action_processing_ms": 0.09439776243128, "mean_env_wait_ms": 7.743201669575804, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 724000, "timesteps_this_iter": 0, "agent_timesteps_total": 724000, "timers": {"sample_time_ms": 26627.175, "sample_throughput": 150.222, "load_time_ms": 0.608, "load_throughput": 6582656.256, "learn_time_ms": 13308.013, "learn_throughput": 300.571, "update_time_ms": 2.609}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.08717439855093397, "policy_loss": -0.03410143482008128, "vf_loss": 12.077153537991226, "vf_explained_var": 0.2626918315887451, "kl": 0.010625589183247243, "entropy": 0.14743037438320536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 724000, "num_agent_steps_sampled": 724000, "num_steps_trained": 724000, "num_agent_steps_trained": 724000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7312, "training_iteration": 181, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-14-57", "timestamp": 1643649297, "time_this_iter_s": 26.30161690711975, "time_total_s": 3972.315103530884, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3972.315103530884, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 50.94210526315789, "ram_util_percent": 62.686842105263146}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -46.2, "episode_reward_mean": -10.898, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.999999999999998, -8.3, -3.2, -9.999999999999998, -17.5, -8.600000000000001, -12.999999999999995, -9.2, -5.2, -4.3, -29.800000000000043, -3.3, -4.300000000000001, -2.3000000000000003, -45.599999999999994, -7.3, -21.000000000000007, -21.9, -7.2, -16.9, -6.300000000000001, -3.3, -22.30000000000001, -10.7, -36.3, -4.4, -5.300000000000001, -4.300000000000001, -46.2, -12.9, -3.3, -20.099999999999998, -17.3, -7.3, -5.4, -23.2, -14.2, -11.199999999999998, -7.2, -4.300000000000001, -17.9, -5.300000000000001, -4.300000000000001, -16.5, -12.000000000000002, -10.599999999999998, -3.4, -7.2, -10.5, -4.2, -13.999999999999998, -4.2, -9.1, -19.2, -9.9, -2.5, -8.2, -3.2, -4.300000000000001, -4.300000000000001, -8.7, -14.3, -12.799999999999999, -17.700000000000003, -5.3, -38.2, -5.2, -13.6, -3.2, -7.599999999999999, -4.2, -17.0, -4.5, -4.3, -10.3, -6.5, -4.2, -10.3, -12.8, -4.3, -7.300000000000001, -7.5, -11.799999999999999, -19.10000000000001, -18.5, -4.300000000000001, -4.300000000000001, -17.4, -9.399999999999999, -12.999999999999998, -11.3, -8.5, -12.799999999999997, -3.3, -9.3, -3.6, -18.400000000000002, -3.3, -11.2, -8.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3126813668105728, "mean_inference_ms": 1.690684965185988, "mean_action_processing_ms": 0.09449128866202818, "mean_env_wait_ms": 7.75047111727564, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 728000, "timesteps_this_iter": 0, "agent_timesteps_total": 728000, "timers": {"sample_time_ms": 27076.033, "sample_throughput": 147.732, "load_time_ms": 0.614, "load_throughput": 6509609.281, "learn_time_ms": 13535.75, "learn_throughput": 295.514, "update_time_ms": 2.672}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.09196666827805901, "policy_loss": -0.012986343057565792, "vf_loss": 10.466371879590454, "vf_explained_var": 0.2719699646836968, "kl": 0.006095482838393111, "entropy": 0.16496220005535953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 728000, "num_agent_steps_sampled": 728000, "num_steps_trained": 728000, "num_agent_steps_trained": 728000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7352, "training_iteration": 182, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-15-22", "timestamp": 1643649322, "time_this_iter_s": 24.999046325683594, "time_total_s": 3997.3141498565674, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3997.3141498565674, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 52.79142857142857, "ram_util_percent": 62.6142857142857}}
{"episode_reward_max": -2.5, "episode_reward_min": -38.2, "episode_reward_mean": -10.556000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.9, -5.300000000000001, -4.300000000000001, -16.5, -12.000000000000002, -10.599999999999998, -3.4, -7.2, -10.5, -4.2, -13.999999999999998, -4.2, -9.1, -19.2, -9.9, -2.5, -8.2, -3.2, -4.300000000000001, -4.300000000000001, -8.7, -14.3, -12.799999999999999, -17.700000000000003, -5.3, -38.2, -5.2, -13.6, -3.2, -7.599999999999999, -4.2, -17.0, -4.5, -4.3, -10.3, -6.5, -4.2, -10.3, -12.8, -4.3, -7.300000000000001, -7.5, -11.799999999999999, -19.10000000000001, -18.5, -4.300000000000001, -4.300000000000001, -17.4, -9.399999999999999, -12.999999999999998, -11.3, -8.5, -12.799999999999997, -3.3, -9.3, -3.6, -18.400000000000002, -3.3, -11.2, -8.3, -17.9, -5.2, -3.3, -9.2, -18.7, -7.799999999999998, -6.300000000000001, -7.6, -14.799999999999999, -3.3, -22.900000000000023, -4.2, -14.5, -12.099999999999996, -26.2, -17.9, -16.999999999999996, -15.5, -13.100000000000001, -12.099999999999971, -6.1, -3.2, -13.1, -12.099999999999996, -12.899999999999979, -17.5, -8.2, -17.099999999999994, -9.3, -5.3, -26.0, -9.2, -4.2, -14.899999999999997, -13.2, -7.2, -15.5, -14.7, -13.499999999999996, -4.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.313636613979206, "mean_inference_ms": 1.6920001685895054, "mean_action_processing_ms": 0.0945925718448501, "mean_env_wait_ms": 7.7563792960412385, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 732000, "timesteps_this_iter": 0, "agent_timesteps_total": 732000, "timers": {"sample_time_ms": 27463.339, "sample_throughput": 145.649, "load_time_ms": 0.617, "load_throughput": 6485452.086, "learn_time_ms": 13499.99, "learn_throughput": 296.297, "update_time_ms": 2.761}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.054721389979284295, "policy_loss": -0.014429780632577917, "vf_loss": 6.865439010820081, "vf_explained_var": 0.35205087174651445, "kl": 0.010467191435418103, "entropy": 0.18081773138174448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 732000, "num_agent_steps_sampled": 732000, "num_steps_trained": 732000, "num_agent_steps_trained": 732000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7392, "training_iteration": 183, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-15-47", "timestamp": 1643649347, "time_this_iter_s": 24.835259914398193, "time_total_s": 4022.1494097709656, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4022.1494097709656, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 43.89722222222222, "ram_util_percent": 62.516666666666666}}
{"episode_reward_max": -3.2, "episode_reward_min": -43.3, "episode_reward_mean": -11.508, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.300000000000001, -7.5, -11.799999999999999, -19.10000000000001, -18.5, -4.300000000000001, -4.300000000000001, -17.4, -9.399999999999999, -12.999999999999998, -11.3, -8.5, -12.799999999999997, -3.3, -9.3, -3.6, -18.400000000000002, -3.3, -11.2, -8.3, -17.9, -5.2, -3.3, -9.2, -18.7, -7.799999999999998, -6.300000000000001, -7.6, -14.799999999999999, -3.3, -22.900000000000023, -4.2, -14.5, -12.099999999999996, -26.2, -17.9, -16.999999999999996, -15.5, -13.100000000000001, -12.099999999999971, -6.1, -3.2, -13.1, -12.099999999999996, -12.899999999999979, -17.5, -8.2, -17.099999999999994, -9.3, -5.3, -26.0, -9.2, -4.2, -14.899999999999997, -13.2, -7.2, -15.5, -14.7, -13.499999999999996, -4.4, -10.699999999999996, -7.5, -11.0, -16.799999999999997, -16.0, -5.300000000000001, -19.0, -6.4, -11.3, -12.2, -6.199999999999999, -10.1, -3.3, -5.2, -4.2, -13.599999999999998, -9.0, -7.3, -19.1, -14.7, -17.900000000000002, -12.899999999999999, -4.2, -24.4, -4.600000000000001, -8.1, -7.300000000000001, -3.3, -23.9, -10.5, -11.099999999999977, -20.6, -7.2, -43.3, -10.2, -4.2, -13.1, -11.699999999999998, -8.899999999999999, -14.7], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.314184878993362, "mean_inference_ms": 1.6929393154860373, "mean_action_processing_ms": 0.09466980197952451, "mean_env_wait_ms": 7.760599803124692, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 736000, "timesteps_this_iter": 0, "agent_timesteps_total": 736000, "timers": {"sample_time_ms": 27196.678, "sample_throughput": 147.077, "load_time_ms": 0.636, "load_throughput": 6292557.198, "learn_time_ms": 13382.437, "learn_throughput": 298.899, "update_time_ms": 2.84}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.0963207472110748, "policy_loss": -0.007375283389081878, "vf_loss": 10.343011919657389, "vf_explained_var": 0.2876336613649963, "kl": 0.005602842820639163, "entropy": 0.17400930744185242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 736000, "num_agent_steps_sampled": 736000, "num_steps_trained": 736000, "num_agent_steps_trained": 736000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7432, "training_iteration": 184, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-16-11", "timestamp": 1643649371, "time_this_iter_s": 23.83174228668213, "time_total_s": 4045.9811520576477, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4045.9811520576477, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 44.247058823529414, "ram_util_percent": 62.59117647058823}}
{"episode_reward_max": -2.5, "episode_reward_min": -43.3, "episode_reward_mean": -11.925999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.1, -3.2, -13.1, -12.099999999999996, -12.899999999999979, -17.5, -8.2, -17.099999999999994, -9.3, -5.3, -26.0, -9.2, -4.2, -14.899999999999997, -13.2, -7.2, -15.5, -14.7, -13.499999999999996, -4.4, -10.699999999999996, -7.5, -11.0, -16.799999999999997, -16.0, -5.300000000000001, -19.0, -6.4, -11.3, -12.2, -6.199999999999999, -10.1, -3.3, -5.2, -4.2, -13.599999999999998, -9.0, -7.3, -19.1, -14.7, -17.900000000000002, -12.899999999999999, -4.2, -24.4, -4.600000000000001, -8.1, -7.300000000000001, -3.3, -23.9, -10.5, -11.099999999999977, -20.6, -7.2, -43.3, -10.2, -4.2, -13.1, -11.699999999999998, -8.899999999999999, -14.7, -13.599999999999985, -12.499999999999993, -18.099999999999994, -4.3, -9.3, -13.799999999999999, -2.5, -3.4, -12.2, -4.4, -3.3, -4.2, -3.3, -11.099999999999977, -5.2, -39.2, -12.7, -9.399999999999997, -3.8000000000000003, -40.2, -7.4, -41.4, -17.3, -9.6, -5.4, -10.2, -6.300000000000001, -7.399999999999999, -19.80000000000001, -25.3, -4.3, -4.300000000000001, -22.799999999999997, -13.099999999999996, -7.700000000000001, -5.2, -7.2, -9.3, -19.9, -23.6], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3153347099856934, "mean_inference_ms": 1.6947662383433817, "mean_action_processing_ms": 0.09477442423576442, "mean_env_wait_ms": 7.769487837099657, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 740000, "timesteps_this_iter": 0, "agent_timesteps_total": 740000, "timers": {"sample_time_ms": 27240.419, "sample_throughput": 146.841, "load_time_ms": 0.638, "load_throughput": 6267638.972, "learn_time_ms": 13380.786, "learn_throughput": 298.936, "update_time_ms": 2.887}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.1660854386666449, "policy_loss": -0.01676617090900739, "vf_loss": 18.213405373243877, "vf_explained_var": 0.1756711197155778, "kl": 0.015118966444592095, "entropy": 0.17990463935840195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 740000, "num_agent_steps_sampled": 740000, "num_steps_trained": 740000, "num_agent_steps_trained": 740000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7472, "training_iteration": 185, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-16-40", "timestamp": 1643649400, "time_this_iter_s": 28.37085509300232, "time_total_s": 4074.35200715065, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4074.35200715065, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 49.209999999999994, "ram_util_percent": 62.760000000000005}}
{"episode_reward_max": -2.5, "episode_reward_min": -43.3, "episode_reward_mean": -12.142000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.900000000000002, -12.899999999999999, -4.2, -24.4, -4.600000000000001, -8.1, -7.300000000000001, -3.3, -23.9, -10.5, -11.099999999999977, -20.6, -7.2, -43.3, -10.2, -4.2, -13.1, -11.699999999999998, -8.899999999999999, -14.7, -13.599999999999985, -12.499999999999993, -18.099999999999994, -4.3, -9.3, -13.799999999999999, -2.5, -3.4, -12.2, -4.4, -3.3, -4.2, -3.3, -11.099999999999977, -5.2, -39.2, -12.7, -9.399999999999997, -3.8000000000000003, -40.2, -7.4, -41.4, -17.3, -9.6, -5.4, -10.2, -6.300000000000001, -7.399999999999999, -19.80000000000001, -25.3, -4.3, -4.300000000000001, -22.799999999999997, -13.099999999999996, -7.700000000000001, -5.2, -7.2, -9.3, -19.9, -23.6, -4.2, -13.0, -4.9, -25.400000000000006, -18.700000000000003, -3.6000000000000005, -9.2, -25.400000000000002, -6.399999999999999, -12.600000000000001, -11.3, -6.299999999999994, -15.099999999999998, -8.1, -3.2, -6.2, -14.099999999999998, -5.2, -23.5, -8.3, -3.3, -21.6, -9.2, -8.699999999999998, -3.2, -6.300000000000001, -10.3, -27.499999999999993, -15.899999999999999, -11.5, -7.3, -10.3, -8.2, -39.3, -20.10000000000001, -6.3999999999999995, -6.3, -3.2, -3.5000000000000004, -11.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.316774626368522, "mean_inference_ms": 1.696852763031663, "mean_action_processing_ms": 0.09489252003119596, "mean_env_wait_ms": 7.779489446563726, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 744000, "timesteps_this_iter": 0, "agent_timesteps_total": 744000, "timers": {"sample_time_ms": 27221.866, "sample_throughput": 146.941, "load_time_ms": 0.636, "load_throughput": 6292085.209, "learn_time_ms": 12966.491, "learn_throughput": 308.487, "update_time_ms": 2.755}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.14337653703186462, "policy_loss": -0.012230585793894464, "vf_loss": 15.529220817422354, "vf_explained_var": 0.10455964355058567, "kl": 0.006635332657225123, "entropy": 0.2118692684317789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 744000, "num_agent_steps_sampled": 744000, "num_steps_trained": 744000, "num_agent_steps_trained": 744000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7512, "training_iteration": 186, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-17-05", "timestamp": 1643649425, "time_this_iter_s": 25.406075954437256, "time_total_s": 4099.758083105087, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4099.758083105087, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 51.325, "ram_util_percent": 62.80000000000002}}
{"episode_reward_max": -1.3, "episode_reward_min": -41.4, "episode_reward_mean": -11.86, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.4, -41.4, -17.3, -9.6, -5.4, -10.2, -6.300000000000001, -7.399999999999999, -19.80000000000001, -25.3, -4.3, -4.300000000000001, -22.799999999999997, -13.099999999999996, -7.700000000000001, -5.2, -7.2, -9.3, -19.9, -23.6, -4.2, -13.0, -4.9, -25.400000000000006, -18.700000000000003, -3.6000000000000005, -9.2, -25.400000000000002, -6.399999999999999, -12.600000000000001, -11.3, -6.299999999999994, -15.099999999999998, -8.1, -3.2, -6.2, -14.099999999999998, -5.2, -23.5, -8.3, -3.3, -21.6, -9.2, -8.699999999999998, -3.2, -6.300000000000001, -10.3, -27.499999999999993, -15.899999999999999, -11.5, -7.3, -10.3, -8.2, -39.3, -20.10000000000001, -6.3999999999999995, -6.3, -3.2, -3.5000000000000004, -11.3, -6.5, -11.8, -5.3, -9.3, -2.6000000000000005, -12.2, -17.099999999999998, -15.2, -6.3999999999999995, -29.099999999999962, -10.3, -10.5, -14.6, -5.2, -17.300000000000004, -7.599999999999999, -5.8999999999999995, -15.999999999999998, -12.899999999999997, -9.100000000000001, -15.299999999999999, -10.699999999999998, -3.3, -4.300000000000001, -9.199999999999998, -10.7, -7.3, -22.5, -9.599999999999998, -14.2, -13.1, -1.3, -34.2, -10.399999999999999, -12.099999999999971, -12.299999999999999, -10.799999999999999, -6.9, -17.1, -10.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.318008736338399, "mean_inference_ms": 1.698466751300294, "mean_action_processing_ms": 0.09498349582419569, "mean_env_wait_ms": 7.787003938460848, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 748000, "timesteps_this_iter": 0, "agent_timesteps_total": 748000, "timers": {"sample_time_ms": 26583.376, "sample_throughput": 150.47, "load_time_ms": 0.597, "load_throughput": 6699898.566, "learn_time_ms": 12746.813, "learn_throughput": 313.804, "update_time_ms": 2.56}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.20102946827468532, "policy_loss": -0.01143698690719502, "vf_loss": 21.193888223299417, "vf_explained_var": 0.07564395698167944, "kl": 0.011115999026955634, "entropy": 0.2085819258885358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 748000, "num_agent_steps_sampled": 748000, "num_steps_trained": 748000, "num_agent_steps_trained": 748000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7552, "training_iteration": 187, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-17-29", "timestamp": 1643649449, "time_this_iter_s": 23.794521808624268, "time_total_s": 4123.552604913712, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4123.552604913712, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 43.26470588235294, "ram_util_percent": 62.80000000000001}}
{"episode_reward_max": -1.3, "episode_reward_min": -45.59999999999994, "episode_reward_mean": -10.836999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -21.6, -9.2, -8.699999999999998, -3.2, -6.300000000000001, -10.3, -27.499999999999993, -15.899999999999999, -11.5, -7.3, -10.3, -8.2, -39.3, -20.10000000000001, -6.3999999999999995, -6.3, -3.2, -3.5000000000000004, -11.3, -6.5, -11.8, -5.3, -9.3, -2.6000000000000005, -12.2, -17.099999999999998, -15.2, -6.3999999999999995, -29.099999999999962, -10.3, -10.5, -14.6, -5.2, -17.300000000000004, -7.599999999999999, -5.8999999999999995, -15.999999999999998, -12.899999999999997, -9.100000000000001, -15.299999999999999, -10.699999999999998, -3.3, -4.300000000000001, -9.199999999999998, -10.7, -7.3, -22.5, -9.599999999999998, -14.2, -13.1, -1.3, -34.2, -10.399999999999999, -12.099999999999971, -12.299999999999999, -10.799999999999999, -6.9, -17.1, -10.2, -45.59999999999994, -3.2, -13.299999999999997, -10.5, -3.2, -17.6, -11.5, -10.3, -8.799999999999999, -13.0, -4.3, -5.300000000000001, -8.599999999999998, -3.2, -4.300000000000001, -14.700000000000001, -7.1999999999999975, -3.2, -4.300000000000001, -8.3, -20.6, -6.3, -10.9, -13.799999999999999, -3.2, -6.799999999999999, -3.2, -9.5, -9.899999999999999, -5.0, -3.2, -23.700000000000003, -7.6000000000000005, -5.300000000000001, -4.2, -30.80000000000003, -7.2, -10.7, -3.3, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3184105899686163, "mean_inference_ms": 1.6991293454327918, "mean_action_processing_ms": 0.09502594907188167, "mean_env_wait_ms": 7.790211851553627, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 752000, "timesteps_this_iter": 0, "agent_timesteps_total": 752000, "timers": {"sample_time_ms": 25893.366, "sample_throughput": 154.48, "load_time_ms": 0.557, "load_throughput": 7187257.85, "learn_time_ms": 12563.503, "learn_throughput": 318.383, "update_time_ms": 2.5}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.07758061974159171, "policy_loss": -0.012496154316731038, "vf_loss": 8.96728259607028, "vf_explained_var": 0.12580772766502954, "kl": 0.008511212228320165, "entropy": 0.15973310601567067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 752000, "num_agent_steps_sampled": 752000, "num_steps_trained": 752000, "num_agent_steps_trained": 752000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7592, "training_iteration": 188, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-17-52", "timestamp": 1643649472, "time_this_iter_s": 22.55890703201294, "time_total_s": 4146.1115119457245, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4146.1115119457245, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 37.46875, "ram_util_percent": 62.79062499999999}}
{"episode_reward_max": -1.3, "episode_reward_min": -45.59999999999994, "episode_reward_mean": -10.190999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.199999999999998, -10.7, -7.3, -22.5, -9.599999999999998, -14.2, -13.1, -1.3, -34.2, -10.399999999999999, -12.099999999999971, -12.299999999999999, -10.799999999999999, -6.9, -17.1, -10.2, -45.59999999999994, -3.2, -13.299999999999997, -10.5, -3.2, -17.6, -11.5, -10.3, -8.799999999999999, -13.0, -4.3, -5.300000000000001, -8.599999999999998, -3.2, -4.300000000000001, -14.700000000000001, -7.1999999999999975, -3.2, -4.300000000000001, -8.3, -20.6, -6.3, -10.9, -13.799999999999999, -3.2, -6.799999999999999, -3.2, -9.5, -9.899999999999999, -5.0, -3.2, -23.700000000000003, -7.6000000000000005, -5.300000000000001, -4.2, -30.80000000000003, -7.2, -10.7, -3.3, -4.300000000000001, -3.2, -22.9, -8.399999999999999, -7.000000000000001, -3.3, -15.999999999999998, -24.500000000000004, -17.1, -17.400000000000002, -3.4, -9.899999999999999, -6.6000000000000005, -3.5000000000000004, -3.3, -12.999999999999998, -25.599999999999998, -4.6000000000000005, -15.599999999999994, -4.4, -23.700000000000003, -8.399999999999999, -3.3, -4.2, -4.2, -18.9, -11.2, -5.300000000000001, -16.099999999999998, -3.2, -6.4, -10.600000000000001, -3.900000000000001, -14.1, -5.300000000000001, -3.2, -11.899999999999999, -13.799999999999999, -4.2, -5.300000000000001, -10.9, -12.299999999999999, -8.8, -5.2, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3187918089270219, "mean_inference_ms": 1.6992127611159626, "mean_action_processing_ms": 0.09509566879260235, "mean_env_wait_ms": 7.791446699528219, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 756000, "timesteps_this_iter": 0, "agent_timesteps_total": 756000, "timers": {"sample_time_ms": 25429.311, "sample_throughput": 157.299, "load_time_ms": 0.508, "load_throughput": 7869607.392, "learn_time_ms": 12136.788, "learn_throughput": 329.576, "update_time_ms": 2.389}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.08716888244298877, "policy_loss": -0.00992082406876869, "vf_loss": 9.669685038828082, "vf_explained_var": 0.17372519322620925, "kl": 0.008277470157665699, "entropy": 0.19649604325413064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 756000, "num_agent_steps_sampled": 756000, "num_steps_trained": 756000, "num_agent_steps_trained": 756000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7636, "training_iteration": 189, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-18-14", "timestamp": 1643649494, "time_this_iter_s": 21.99970507621765, "time_total_s": 4168.111217021942, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4168.111217021942, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 40.509375, "ram_util_percent": 62.768750000000004}}
{"episode_reward_max": -3.2, "episode_reward_min": -62.3, "episode_reward_mean": -9.669, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -6.799999999999999, -3.2, -9.5, -9.899999999999999, -5.0, -3.2, -23.700000000000003, -7.6000000000000005, -5.300000000000001, -4.2, -30.80000000000003, -7.2, -10.7, -3.3, -4.300000000000001, -3.2, -22.9, -8.399999999999999, -7.000000000000001, -3.3, -15.999999999999998, -24.500000000000004, -17.1, -17.400000000000002, -3.4, -9.899999999999999, -6.6000000000000005, -3.5000000000000004, -3.3, -12.999999999999998, -25.599999999999998, -4.6000000000000005, -15.599999999999994, -4.4, -23.700000000000003, -8.399999999999999, -3.3, -4.2, -4.2, -18.9, -11.2, -5.300000000000001, -16.099999999999998, -3.2, -6.4, -10.600000000000001, -3.900000000000001, -14.1, -5.300000000000001, -3.2, -11.899999999999999, -13.799999999999999, -4.2, -5.300000000000001, -10.9, -12.299999999999999, -8.8, -5.2, -3.2, -18.900000000000006, -3.3, -7.099999999999999, -3.3, -13.7, -9.6, -62.3, -4.300000000000001, -10.2, -3.2, -4.2, -7.2, -9.2, -11.899999999999997, -3.3, -13.1, -3.2, -18.799999999999997, -16.2, -9.899999999999999, -3.2, -11.5, -12.6, -5.300000000000001, -5.300000000000001, -9.5, -11.399999999999999, -6.2, -4.3, -5.300000000000001, -7.4, -14.999999999999998, -11.9, -19.9, -3.2, -8.7, -3.2, -6.0, -10.699999999999998, -8.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3187077049428928, "mean_inference_ms": 1.6990488803081103, "mean_action_processing_ms": 0.09508784007296583, "mean_env_wait_ms": 7.7906877155309004, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 760000, "timesteps_this_iter": 0, "agent_timesteps_total": 760000, "timers": {"sample_time_ms": 24665.309, "sample_throughput": 162.171, "load_time_ms": 0.526, "load_throughput": 7600786.481, "learn_time_ms": 11940.086, "learn_throughput": 335.006, "update_time_ms": 2.444}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.16303282725669804, "policy_loss": -0.009805569344110065, "vf_loss": 17.24473896728408, "vf_explained_var": 0.34703795518926395, "kl": 0.008238617528220032, "entropy": 0.168367499317373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 760000, "num_agent_steps_sampled": 760000, "num_steps_trained": 760000, "num_agent_steps_trained": 760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7676, "training_iteration": 190, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-18-36", "timestamp": 1643649516, "time_this_iter_s": 22.108326196670532, "time_total_s": 4190.219543218613, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4190.219543218613, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 45.81612903225806, "ram_util_percent": 62.75806451612904}}
{"episode_reward_max": -2.5, "episode_reward_min": -62.3, "episode_reward_mean": -9.223999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.9, -11.2, -5.300000000000001, -16.099999999999998, -3.2, -6.4, -10.600000000000001, -3.900000000000001, -14.1, -5.300000000000001, -3.2, -11.899999999999999, -13.799999999999999, -4.2, -5.300000000000001, -10.9, -12.299999999999999, -8.8, -5.2, -3.2, -18.900000000000006, -3.3, -7.099999999999999, -3.3, -13.7, -9.6, -62.3, -4.300000000000001, -10.2, -3.2, -4.2, -7.2, -9.2, -11.899999999999997, -3.3, -13.1, -3.2, -18.799999999999997, -16.2, -9.899999999999999, -3.2, -11.5, -12.6, -5.300000000000001, -5.300000000000001, -9.5, -11.399999999999999, -6.2, -4.3, -5.300000000000001, -7.4, -14.999999999999998, -11.9, -19.9, -3.2, -8.7, -3.2, -6.0, -10.699999999999998, -8.2, -9.799999999999999, -9.3, -5.4, -5.300000000000001, -6.300000000000001, -2.5, -18.0, -4.4, -4.300000000000001, -9.499999999999998, -5.4, -4.2, -4.300000000000001, -13.599999999999998, -7.499999999999998, -10.600000000000001, -11.4, -3.4, -9.9, -3.2, -9.8, -3.3, -17.2, -3.3, -10.2, -3.4, -7.300000000000001, -15.5, -4.6000000000000005, -4.2, -13.199999999999998, -12.599999999999998, -4.300000000000001, -8.3, -4.300000000000001, -5.300000000000001, -4.2, -10.5, -27.3, -29.800000000000004], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.319088702210544, "mean_inference_ms": 1.6995941466277134, "mean_action_processing_ms": 0.09506096537216172, "mean_env_wait_ms": 7.793355969671606, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 764000, "timesteps_this_iter": 0, "agent_timesteps_total": 764000, "timers": {"sample_time_ms": 24509.416, "sample_throughput": 163.203, "load_time_ms": 0.503, "load_throughput": 7946767.715, "learn_time_ms": 11885.599, "learn_throughput": 336.542, "update_time_ms": 2.353}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.05691863164225573, "policy_loss": -0.009572019279804281, "vf_loss": 6.60617116450943, "vf_explained_var": 0.36123709646604396, "kl": 0.009037777733702448, "entropy": 0.15563630152153232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 764000, "num_agent_steps_sampled": 764000, "num_steps_trained": 764000, "num_agent_steps_trained": 764000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7716, "training_iteration": 191, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-19-02", "timestamp": 1643649542, "time_this_iter_s": 26.14326810836792, "time_total_s": 4216.362811326981, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4216.362811326981, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 53.26756756756756, "ram_util_percent": 62.7216216216216}}
{"episode_reward_max": -2.5, "episode_reward_min": -53.6, "episode_reward_mean": -9.459999999999997, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -11.5, -12.6, -5.300000000000001, -5.300000000000001, -9.5, -11.399999999999999, -6.2, -4.3, -5.300000000000001, -7.4, -14.999999999999998, -11.9, -19.9, -3.2, -8.7, -3.2, -6.0, -10.699999999999998, -8.2, -9.799999999999999, -9.3, -5.4, -5.300000000000001, -6.300000000000001, -2.5, -18.0, -4.4, -4.300000000000001, -9.499999999999998, -5.4, -4.2, -4.300000000000001, -13.599999999999998, -7.499999999999998, -10.600000000000001, -11.4, -3.4, -9.9, -3.2, -9.8, -3.3, -17.2, -3.3, -10.2, -3.4, -7.300000000000001, -15.5, -4.6000000000000005, -4.2, -13.199999999999998, -12.599999999999998, -4.300000000000001, -8.3, -4.300000000000001, -5.300000000000001, -4.2, -10.5, -27.3, -29.800000000000004, -4.3, -53.6, -14.899999999999999, -5.3, -11.0, -14.899999999999999, -6.4, -19.7, -19.599999999999998, -10.9, -4.2, -4.300000000000001, -14.7, -3.3, -6.4, -4.2, -10.100000000000001, -25.2, -3.3, -9.3, -9.5, -3.2, -5.2, -23.100000000000026, -5.899999999999999, -15.299999999999995, -12.1, -3.7000000000000006, -12.5, -13.4, -6.3, -10.3, -11.399999999999995, -3.3, -4.2, -8.399999999999999, -13.999999999999998, -10.299999999999999, -8.3, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3204306526493426, "mean_inference_ms": 1.7015194532724955, "mean_action_processing_ms": 0.095160084056919, "mean_env_wait_ms": 7.802113090921092, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 768000, "timesteps_this_iter": 0, "agent_timesteps_total": 768000, "timers": {"sample_time_ms": 24721.42, "sample_throughput": 161.803, "load_time_ms": 0.521, "load_throughput": 7683282.653, "learn_time_ms": 12030.473, "learn_throughput": 332.489, "update_time_ms": 2.343}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.13871504544776173, "policy_loss": -0.00928728467915007, "vf_loss": 14.760332195861364, "vf_explained_var": 0.2727985728171564, "kl": 0.008407101239395537, "entropy": 0.182689242641772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 768000, "num_agent_steps_sampled": 768000, "num_steps_trained": 768000, "num_agent_steps_trained": 768000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7756, "training_iteration": 192, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-19-31", "timestamp": 1643649571, "time_this_iter_s": 29.135346174240112, "time_total_s": 4245.498157501221, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4245.498157501221, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 53.82619047619047, "ram_util_percent": 62.833333333333336}}
{"episode_reward_max": -3.2, "episode_reward_min": -53.6, "episode_reward_mean": -10.41, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.8, -3.3, -17.2, -3.3, -10.2, -3.4, -7.300000000000001, -15.5, -4.6000000000000005, -4.2, -13.199999999999998, -12.599999999999998, -4.300000000000001, -8.3, -4.300000000000001, -5.300000000000001, -4.2, -10.5, -27.3, -29.800000000000004, -4.3, -53.6, -14.899999999999999, -5.3, -11.0, -14.899999999999999, -6.4, -19.7, -19.599999999999998, -10.9, -4.2, -4.300000000000001, -14.7, -3.3, -6.4, -4.2, -10.100000000000001, -25.2, -3.3, -9.3, -9.5, -3.2, -5.2, -23.100000000000026, -5.899999999999999, -15.299999999999995, -12.1, -3.7000000000000006, -12.5, -13.4, -6.3, -10.3, -11.399999999999995, -3.3, -4.2, -8.399999999999999, -13.999999999999998, -10.299999999999999, -8.3, -4.300000000000001, -4.9, -5.0, -4.300000000000001, -18.3, -13.1, -24.2, -14.399999999999995, -16.799999999999997, -8.3, -3.4, -8.8, -13.099999999999996, -3.3, -4.2, -20.800000000000004, -7.2, -4.2, -10.999999999999996, -23.500000000000007, -3.4, -4.3, -8.2, -18.2, -3.4, -20.3, -10.399999999999999, -3.2, -17.3, -4.3, -5.300000000000001, -5.300000000000001, -4.300000000000001, -18.6, -12.2, -19.700000000000006, -9.0, -12.700000000000001, -5.9, -3.3, -13.999999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3218163712242386, "mean_inference_ms": 1.7032999009414755, "mean_action_processing_ms": 0.0952533746562524, "mean_env_wait_ms": 7.8107018320056145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 772000, "timesteps_this_iter": 0, "agent_timesteps_total": 772000, "timers": {"sample_time_ms": 24815.515, "sample_throughput": 161.189, "load_time_ms": 0.539, "load_throughput": 7426504.36, "learn_time_ms": 11965.811, "learn_throughput": 334.286, "update_time_ms": 2.248}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.08377870075124245, "policy_loss": -0.013333885302086191, "vf_loss": 9.664333287778721, "vf_explained_var": 0.35408248612957616, "kl": 0.009887190422714279, "entropy": 0.1928600466139214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 772000, "num_agent_steps_sampled": 772000, "num_steps_trained": 772000, "num_agent_steps_trained": 772000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7796, "training_iteration": 193, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-19-55", "timestamp": 1643649595, "time_this_iter_s": 23.687995195388794, "time_total_s": 4269.1861526966095, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4269.1861526966095, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 40.75882352941176, "ram_util_percent": 62.452941176470574}}
{"episode_reward_max": -2.5, "episode_reward_min": -123.2, "episode_reward_mean": -13.186999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.5, -3.2, -5.2, -23.100000000000026, -5.899999999999999, -15.299999999999995, -12.1, -3.7000000000000006, -12.5, -13.4, -6.3, -10.3, -11.399999999999995, -3.3, -4.2, -8.399999999999999, -13.999999999999998, -10.299999999999999, -8.3, -4.300000000000001, -4.9, -5.0, -4.300000000000001, -18.3, -13.1, -24.2, -14.399999999999995, -16.799999999999997, -8.3, -3.4, -8.8, -13.099999999999996, -3.3, -4.2, -20.800000000000004, -7.2, -4.2, -10.999999999999996, -23.500000000000007, -3.4, -4.3, -8.2, -18.2, -3.4, -20.3, -10.399999999999999, -3.2, -17.3, -4.3, -5.300000000000001, -5.300000000000001, -4.300000000000001, -18.6, -12.2, -19.700000000000006, -9.0, -12.700000000000001, -5.9, -3.3, -13.999999999999998, -9.700000000000001, -4.2, -48.2, -5.300000000000001, -121.0, -4.300000000000001, -7.099999999999999, -9.3, -123.2, -10.2, -10.2, -11.1, -9.3, -10.499999999999998, -12.099999999999996, -7.3, -24.10000000000001, -13.699999999999996, -4.4, -17.8, -29.900000000000013, -23.299999999999997, -31.2, -3.3, -19.9, -4.3, -4.300000000000001, -19.1, -2.5, -3.4, -4.300000000000001, -4.300000000000001, -27.0, -7.699999999999998, -4.2, -11.2, -24.6, -3.3, -21.8, -9.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3223153406102939, "mean_inference_ms": 1.7038945515979322, "mean_action_processing_ms": 0.09528551213045967, "mean_env_wait_ms": 7.813648088939543, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 776000, "timesteps_this_iter": 0, "agent_timesteps_total": 776000, "timers": {"sample_time_ms": 24642.399, "sample_throughput": 162.322, "load_time_ms": 0.518, "load_throughput": 7723250.012, "learn_time_ms": 11774.912, "learn_throughput": 339.705, "update_time_ms": 2.207}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.4542174996427631, "policy_loss": -0.008528956645969503, "vf_loss": 46.23007927947147, "vf_explained_var": 0.2656236117885959, "kl": 0.00939038362841113, "entropy": 0.1922387058776553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 776000, "num_agent_steps_sampled": 776000, "num_steps_trained": 776000, "num_agent_steps_trained": 776000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7836, "training_iteration": 194, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-20-16", "timestamp": 1643649616, "time_this_iter_s": 20.823153018951416, "time_total_s": 4290.009305715561, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4290.009305715561, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 40.40689655172414, "ram_util_percent": 62.17931034482758}}
{"episode_reward_max": -2.5, "episode_reward_min": -123.2, "episode_reward_mean": -14.639, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -8.2, -18.2, -3.4, -20.3, -10.399999999999999, -3.2, -17.3, -4.3, -5.300000000000001, -5.300000000000001, -4.300000000000001, -18.6, -12.2, -19.700000000000006, -9.0, -12.700000000000001, -5.9, -3.3, -13.999999999999998, -9.700000000000001, -4.2, -48.2, -5.300000000000001, -121.0, -4.300000000000001, -7.099999999999999, -9.3, -123.2, -10.2, -10.2, -11.1, -9.3, -10.499999999999998, -12.099999999999996, -7.3, -24.10000000000001, -13.699999999999996, -4.4, -17.8, -29.900000000000013, -23.299999999999997, -31.2, -3.3, -19.9, -4.3, -4.300000000000001, -19.1, -2.5, -3.4, -4.300000000000001, -4.300000000000001, -27.0, -7.699999999999998, -4.2, -11.2, -24.6, -3.3, -21.8, -9.3, -4.2, -8.799999999999999, -13.899999999999997, -16.699999999999996, -9.9, -23.3, -5.2, -8.3, -46.3, -10.899999999999977, -3.2, -11.2, -13.499999999999996, -25.199999999999996, -13.5, -5.799999999999999, -3.4, -22.700000000000006, -6.199999999999999, -7.800000000000001, -10.999999999999998, -11.8, -11.3, -4.3, -7.2, -4.3, -77.9, -9.3, -3.5000000000000004, -17.6, -8.2, -3.4, -5.300000000000001, -12.899999999999999, -3.2, -24.9, -40.2, -4.300000000000001, -4.300000000000001, -17.200000000000003], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3217540134780799, "mean_inference_ms": 1.7032128910369144, "mean_action_processing_ms": 0.09524932311864177, "mean_env_wait_ms": 7.810473789959299, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 780000, "timesteps_this_iter": 0, "agent_timesteps_total": 780000, "timers": {"sample_time_ms": 23829.972, "sample_throughput": 167.856, "load_time_ms": 0.508, "load_throughput": 7876997.042, "learn_time_ms": 11496.297, "learn_throughput": 347.938, "update_time_ms": 2.139}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.2659071023826317, "policy_loss": -0.008777034599133718, "vf_loss": 27.41558293168263, "vf_explained_var": 0.2121766948571769, "kl": 0.011131501305017338, "entropy": 0.17515010350854487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 780000, "num_agent_steps_sampled": 780000, "num_steps_trained": 780000, "num_agent_steps_trained": 780000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7876, "training_iteration": 195, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-20-35", "timestamp": 1643649635, "time_this_iter_s": 19.37900424003601, "time_total_s": 4309.388309955597, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4309.388309955597, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 39.38571428571429, "ram_util_percent": 62.13214285714287}}
{"episode_reward_max": -2.2, "episode_reward_min": -77.9, "episode_reward_mean": -12.286000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.900000000000013, -23.299999999999997, -31.2, -3.3, -19.9, -4.3, -4.300000000000001, -19.1, -2.5, -3.4, -4.300000000000001, -4.300000000000001, -27.0, -7.699999999999998, -4.2, -11.2, -24.6, -3.3, -21.8, -9.3, -4.2, -8.799999999999999, -13.899999999999997, -16.699999999999996, -9.9, -23.3, -5.2, -8.3, -46.3, -10.899999999999977, -3.2, -11.2, -13.499999999999996, -25.199999999999996, -13.5, -5.799999999999999, -3.4, -22.700000000000006, -6.199999999999999, -7.800000000000001, -10.999999999999998, -11.8, -11.3, -4.3, -7.2, -4.3, -77.9, -9.3, -3.5000000000000004, -17.6, -8.2, -3.4, -5.300000000000001, -12.899999999999999, -3.2, -24.9, -40.2, -4.300000000000001, -4.300000000000001, -17.200000000000003, -4.4, -20.000000000000004, -3.3, -5.700000000000001, -3.3, -11.7, -8.2, -20.000000000000043, -5.2, -8.2, -14.899999999999997, -9.6, -10.9, -4.3, -9.7, -3.3, -4.300000000000001, -8.3, -11.8, -33.5, -4.4, -4.300000000000001, -11.099999999999998, -2.2, -12.699999999999998, -11.399999999999997, -3.3, -20.899999999999988, -27.400000000000023, -4.4, -5.5, -20.699999999999996, -26.3, -6.9, -3.3, -4.2, -6.4, -10.3, -24.5, -16.8], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3207557054217633, "mean_inference_ms": 1.7020226627827713, "mean_action_processing_ms": 0.0951830203662768, "mean_env_wait_ms": 7.80467754719115, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 784000, "timesteps_this_iter": 0, "agent_timesteps_total": 784000, "timers": {"sample_time_ms": 23192.103, "sample_throughput": 172.473, "load_time_ms": 0.55, "load_throughput": 7275462.272, "learn_time_ms": 11282.191, "learn_throughput": 354.541, "update_time_ms": 2.079}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.2945749095751233, "policy_loss": -0.010623364039866995, "vf_loss": 30.478614229156126, "vf_explained_var": 0.2549425090512922, "kl": 0.008683650434174774, "entropy": 0.17364502729026862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 784000, "num_agent_steps_sampled": 784000, "num_steps_trained": 784000, "num_agent_steps_trained": 784000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7916, "training_iteration": 196, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-20-55", "timestamp": 1643649655, "time_this_iter_s": 19.69359588623047, "time_total_s": 4329.081905841827, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4329.081905841827, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 41.65714285714285, "ram_util_percent": 62.271428571428565}}
{"episode_reward_max": -2.2, "episode_reward_min": -96.60000000000014, "episode_reward_mean": -12.953000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.999999999999998, -11.8, -11.3, -4.3, -7.2, -4.3, -77.9, -9.3, -3.5000000000000004, -17.6, -8.2, -3.4, -5.300000000000001, -12.899999999999999, -3.2, -24.9, -40.2, -4.300000000000001, -4.300000000000001, -17.200000000000003, -4.4, -20.000000000000004, -3.3, -5.700000000000001, -3.3, -11.7, -8.2, -20.000000000000043, -5.2, -8.2, -14.899999999999997, -9.6, -10.9, -4.3, -9.7, -3.3, -4.300000000000001, -8.3, -11.8, -33.5, -4.4, -4.300000000000001, -11.099999999999998, -2.2, -12.699999999999998, -11.399999999999997, -3.3, -20.899999999999988, -27.400000000000023, -4.4, -5.5, -20.699999999999996, -26.3, -6.9, -3.3, -4.2, -6.4, -10.3, -24.5, -16.8, -96.60000000000014, -3.3, -9.5, -34.599999999999994, -3.6000000000000005, -5.4, -37.2, -15.999999999999998, -11.9, -20.5, -3.4, -13.8, -3.4, -11.3, -7.3, -3.3, -4.300000000000001, -16.499999999999996, -6.599999999999999, -18.000000000000004, -4.2, -20.199999999999996, -13.899999999999997, -12.299999999999999, -4.4, -4.2, -4.2, -30.500000000000004, -15.099999999999998, -11.8, -11.2, -19.29999999999999, -3.3, -37.3, -5.4, -8.6, -18.099999999999998, -9.2, -15.7, -10.199999999999989], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.319704414141932, "mean_inference_ms": 1.7007070292059825, "mean_action_processing_ms": 0.09510955660960332, "mean_env_wait_ms": 7.79833251119043, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 788000, "timesteps_this_iter": 0, "agent_timesteps_total": 788000, "timers": {"sample_time_ms": 22721.532, "sample_throughput": 176.044, "load_time_ms": 0.548, "load_throughput": 7299202.088, "learn_time_ms": 11161.204, "learn_throughput": 358.384, "update_time_ms": 2.077}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.1908711696063639, "policy_loss": -0.0073954019244880445, "vf_loss": 19.792309278057466, "vf_explained_var": 0.10658389445274107, "kl": 0.007237197828025454, "entropy": 0.19013288847060614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 788000, "num_agent_steps_sampled": 788000, "num_steps_trained": 788000, "num_agent_steps_trained": 788000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7956, "training_iteration": 197, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-21-15", "timestamp": 1643649675, "time_this_iter_s": 20.026580095291138, "time_total_s": 4349.1084859371185, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4349.1084859371185, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 37.73448275862069, "ram_util_percent": 62.310344827586206}}
{"episode_reward_max": -3.2, "episode_reward_min": -96.60000000000014, "episode_reward_mean": -12.672, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.699999999999998, -11.399999999999997, -3.3, -20.899999999999988, -27.400000000000023, -4.4, -5.5, -20.699999999999996, -26.3, -6.9, -3.3, -4.2, -6.4, -10.3, -24.5, -16.8, -96.60000000000014, -3.3, -9.5, -34.599999999999994, -3.6000000000000005, -5.4, -37.2, -15.999999999999998, -11.9, -20.5, -3.4, -13.8, -3.4, -11.3, -7.3, -3.3, -4.300000000000001, -16.499999999999996, -6.599999999999999, -18.000000000000004, -4.2, -20.199999999999996, -13.899999999999997, -12.299999999999999, -4.4, -4.2, -4.2, -30.500000000000004, -15.099999999999998, -11.8, -11.2, -19.29999999999999, -3.3, -37.3, -5.4, -8.6, -18.099999999999998, -9.2, -15.7, -10.199999999999989, -24.300000000000004, -14.999999999999996, -9.8, -15.0, -23.600000000000005, -21.80000000000001, -3.4, -6.4, -5.300000000000001, -4.300000000000001, -9.899999999999999, -6.399999999999999, -4.7, -3.2, -4.4, -18.699999999999996, -3.3, -27.1, -3.4, -8.3, -16.399999999999995, -4.6000000000000005, -5.6, -11.199999999999998, -9.1, -4.9, -28.0, -8.3, -4.300000000000001, -7.5, -6.700000000000001, -14.099999999999998, -3.4, -7.2, -3.4, -12.399999999999991, -12.2, -20.8, -10.499999999999998, -10.399999999999999, -14.799999999999999, -22.6, -16.7, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3196245170566585, "mean_inference_ms": 1.699842413178585, "mean_action_processing_ms": 0.09512455494046833, "mean_env_wait_ms": 7.794827778973481, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 792000, "timesteps_this_iter": 0, "agent_timesteps_total": 792000, "timers": {"sample_time_ms": 22572.497, "sample_throughput": 177.207, "load_time_ms": 0.533, "load_throughput": 7502220.632, "learn_time_ms": 11113.991, "learn_throughput": 359.907, "update_time_ms": 2.036}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.15969518382022138, "policy_loss": -0.008225229342207712, "vf_loss": 16.76666502664166, "vf_explained_var": 0.11374602176809824, "kl": 0.005346889274872996, "entropy": 0.1749984077728724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 792000, "num_agent_steps_sampled": 792000, "num_steps_trained": 792000, "num_agent_steps_trained": 792000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8000, "training_iteration": 198, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-21-37", "timestamp": 1643649697, "time_this_iter_s": 21.807193994522095, "time_total_s": 4370.915679931641, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4370.915679931641, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 41.21935483870966, "ram_util_percent": 62.464516129032255}}
{"episode_reward_max": -3.2, "episode_reward_min": -37.3, "episode_reward_mean": -11.128000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -4.2, -4.2, -30.500000000000004, -15.099999999999998, -11.8, -11.2, -19.29999999999999, -3.3, -37.3, -5.4, -8.6, -18.099999999999998, -9.2, -15.7, -10.199999999999989, -24.300000000000004, -14.999999999999996, -9.8, -15.0, -23.600000000000005, -21.80000000000001, -3.4, -6.4, -5.300000000000001, -4.300000000000001, -9.899999999999999, -6.399999999999999, -4.7, -3.2, -4.4, -18.699999999999996, -3.3, -27.1, -3.4, -8.3, -16.399999999999995, -4.6000000000000005, -5.6, -11.199999999999998, -9.1, -4.9, -28.0, -8.3, -4.300000000000001, -7.5, -6.700000000000001, -14.099999999999998, -3.4, -7.2, -3.4, -12.399999999999991, -12.2, -20.8, -10.499999999999998, -10.399999999999999, -14.799999999999999, -22.6, -16.7, -3.2, -4.2, -6.2, -3.2, -28.600000000000005, -16.4, -8.3, -7.799999999999998, -4.300000000000001, -4.2, -4.4, -3.2, -13.2, -5.4, -24.10000000000001, -20.0, -5.6, -32.2, -3.2, -23.700000000000003, -15.799999999999999, -20.400000000000002, -4.2, -11.9, -7.3, -14.7, -11.3, -4.2, -5.300000000000001, -12.899999999999999, -17.6, -16.799999999999997, -3.2, -4.2, -4.300000000000001, -16.1, -11.399999999999999, -16.199999999999992, -3.3, -4.2, -4.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.319325292148888, "mean_inference_ms": 1.6992357454670883, "mean_action_processing_ms": 0.09509405787696448, "mean_env_wait_ms": 7.792003978925092, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 796000, "timesteps_this_iter": 0, "agent_timesteps_total": 796000, "timers": {"sample_time_ms": 22456.131, "sample_throughput": 178.125, "load_time_ms": 0.549, "load_throughput": 7280197.874, "learn_time_ms": 11047.083, "learn_throughput": 362.087, "update_time_ms": 1.982}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.09884325004813652, "policy_loss": -0.010178262310763521, "vf_loss": 10.874161275980933, "vf_explained_var": 0.3866136904044818, "kl": 0.005897553673602462, "entropy": 0.14948581918192808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 796000, "num_agent_steps_sampled": 796000, "num_steps_trained": 796000, "num_agent_steps_trained": 796000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8040, "training_iteration": 199, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-21-57", "timestamp": 1643649717, "time_this_iter_s": 20.650275945663452, "time_total_s": 4391.565955877304, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4391.565955877304, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 41.26896551724137, "ram_util_percent": 62.49655172413794}}
{"episode_reward_max": -3.2, "episode_reward_min": -95.2, "episode_reward_mean": -10.530000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.1, -4.9, -28.0, -8.3, -4.300000000000001, -7.5, -6.700000000000001, -14.099999999999998, -3.4, -7.2, -3.4, -12.399999999999991, -12.2, -20.8, -10.499999999999998, -10.399999999999999, -14.799999999999999, -22.6, -16.7, -3.2, -4.2, -6.2, -3.2, -28.600000000000005, -16.4, -8.3, -7.799999999999998, -4.300000000000001, -4.2, -4.4, -3.2, -13.2, -5.4, -24.10000000000001, -20.0, -5.6, -32.2, -3.2, -23.700000000000003, -15.799999999999999, -20.400000000000002, -4.2, -11.9, -7.3, -14.7, -11.3, -4.2, -5.300000000000001, -12.899999999999999, -17.6, -16.799999999999997, -3.2, -4.2, -4.300000000000001, -16.1, -11.399999999999999, -16.199999999999992, -3.3, -4.2, -4.2, -4.2, -17.799999999999997, -4.2, -6.300000000000001, -4.000000000000001, -19.2, -6.5, -15.399999999999997, -11.7, -3.4, -7.299999999999999, -95.2, -5.9, -3.3, -7.700000000000001, -3.2, -10.0, -9.2, -9.3, -5.4, -10.0, -4.4, -4.700000000000001, -3.3, -18.500000000000004, -4.300000000000001, -4.2, -3.5000000000000004, -5.9, -3.4, -15.799999999999999, -3.7000000000000015, -12.5, -6.300000000000001, -11.799999999999999, -3.3, -17.7, -11.2, -4.9, -6.199999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3187441417381043, "mean_inference_ms": 1.698291292723531, "mean_action_processing_ms": 0.09498646444496867, "mean_env_wait_ms": 7.787357565198481, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 800000, "timesteps_this_iter": 0, "agent_timesteps_total": 800000, "timers": {"sample_time_ms": 22261.292, "sample_throughput": 179.684, "load_time_ms": 0.52, "load_throughput": 7688916.59, "learn_time_ms": 10979.306, "learn_throughput": 364.322, "update_time_ms": 1.937}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.44024635418418356, "policy_loss": -0.004891822857642046, "vf_loss": 44.488467615330094, "vf_explained_var": 0.03202221220539462, "kl": 0.00534154576965778, "entropy": 0.16664574071764945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 800000, "num_agent_steps_sampled": 800000, "num_steps_trained": 800000, "num_agent_steps_trained": 800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8080, "training_iteration": 200, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-22-18", "timestamp": 1643649738, "time_this_iter_s": 20.155317068099976, "time_total_s": 4411.721272945404, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4411.721272945404, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 40.85862068965518, "ram_util_percent": 62.5}}
{"episode_reward_max": -1.3, "episode_reward_min": -95.2, "episode_reward_mean": -10.364, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.400000000000002, -4.2, -11.9, -7.3, -14.7, -11.3, -4.2, -5.300000000000001, -12.899999999999999, -17.6, -16.799999999999997, -3.2, -4.2, -4.300000000000001, -16.1, -11.399999999999999, -16.199999999999992, -3.3, -4.2, -4.2, -4.2, -17.799999999999997, -4.2, -6.300000000000001, -4.000000000000001, -19.2, -6.5, -15.399999999999997, -11.7, -3.4, -7.299999999999999, -95.2, -5.9, -3.3, -7.700000000000001, -3.2, -10.0, -9.2, -9.3, -5.4, -10.0, -4.4, -4.700000000000001, -3.3, -18.500000000000004, -4.300000000000001, -4.2, -3.5000000000000004, -5.9, -3.4, -15.799999999999999, -3.7000000000000015, -12.5, -6.300000000000001, -11.799999999999999, -3.3, -17.7, -11.2, -4.9, -6.199999999999999, -3.5000000000000004, -22.400000000000013, -4.4, -4.4, -9.799999999999999, -5.3, -18.900000000000006, -12.899999999999999, -13.2, -10.299999999999999, -12.8, -12.599999999999998, -3.4, -20.799999999999997, -15.899999999999995, -3.3, -12.9, -16.4, -10.7, -22.5, -5.300000000000001, -15.7, -11.599999999999998, -4.3, -4.4, -4.700000000000001, -2.6000000000000005, -3.3, -14.2, -16.199999999999996, -3.2, -18.699999999999996, -9.3, -13.2, -12.399999999999997, -3.8000000000000003, -11.7, -34.30000000000007, -1.3, -11.299999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.318103024852743, "mean_inference_ms": 1.6977330655428537, "mean_action_processing_ms": 0.09495293776186553, "mean_env_wait_ms": 7.784232542219263, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 804000, "timesteps_this_iter": 0, "agent_timesteps_total": 804000, "timers": {"sample_time_ms": 21970.881, "sample_throughput": 182.059, "load_time_ms": 0.553, "load_throughput": 7228754.363, "learn_time_ms": 11300.03, "learn_throughput": 353.981, "update_time_ms": 1.958}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.09114059460179139, "policy_loss": -0.011984322012291961, "vf_loss": 10.261276514267408, "vf_explained_var": 0.23223118365451853, "kl": 0.010791087409466419, "entropy": 0.19964807184152705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 804000, "num_agent_steps_sampled": 804000, "num_steps_trained": 804000, "num_agent_steps_trained": 804000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8120, "training_iteration": 201, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-22-45", "timestamp": 1643649765, "time_this_iter_s": 27.149757862091064, "time_total_s": 4438.871030807495, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4438.871030807495, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 53.08947368421053, "ram_util_percent": 62.54999999999999}}
{"episode_reward_max": -1.3, "episode_reward_min": -87.70000000000012, "episode_reward_mean": -10.981000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, -4.4, -4.700000000000001, -3.3, -18.500000000000004, -4.300000000000001, -4.2, -3.5000000000000004, -5.9, -3.4, -15.799999999999999, -3.7000000000000015, -12.5, -6.300000000000001, -11.799999999999999, -3.3, -17.7, -11.2, -4.9, -6.199999999999999, -3.5000000000000004, -22.400000000000013, -4.4, -4.4, -9.799999999999999, -5.3, -18.900000000000006, -12.899999999999999, -13.2, -10.299999999999999, -12.8, -12.599999999999998, -3.4, -20.799999999999997, -15.899999999999995, -3.3, -12.9, -16.4, -10.7, -22.5, -5.300000000000001, -15.7, -11.599999999999998, -4.3, -4.4, -4.700000000000001, -2.6000000000000005, -3.3, -14.2, -16.199999999999996, -3.2, -18.699999999999996, -9.3, -13.2, -12.399999999999997, -3.8000000000000003, -11.7, -34.30000000000007, -1.3, -11.299999999999997, -9.3, -19.099999999999994, -87.70000000000012, -20.4, -3.3, -9.299999999999997, -20.199999999999996, -9.200000000000001, -8.3, -21.700000000000006, -8.600000000000001, -3.3, -13.499999999999998, -10.3, -4.2, -4.4, -8.600000000000001, -6.1, -17.6, -7.799999999999998, -8.2, -12.299999999999999, -8.5, -4.4, -4.2, -9.3, -4.2, -29.4, -7.2, -7.3999999999999995, -5.300000000000001, -13.0, -11.799999999999997, -3.3, -13.799999999999997, -4.2, -53.69999999999999, -3.8000000000000003, -3.4, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3181972060695668, "mean_inference_ms": 1.6980289145786385, "mean_action_processing_ms": 0.09496865466800206, "mean_env_wait_ms": 7.785519071068229, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 808000, "timesteps_this_iter": 0, "agent_timesteps_total": 808000, "timers": {"sample_time_ms": 22055.181, "sample_throughput": 181.363, "load_time_ms": 0.536, "load_throughput": 7464502.581, "learn_time_ms": 11087.334, "learn_throughput": 360.772, "update_time_ms": 1.977}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.236597476483533, "policy_loss": -0.007916181919074828, "vf_loss": 24.423443510135016, "vf_explained_var": 0.24051509896914164, "kl": 0.005883272503875343, "entropy": 0.15783160751465186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 808000, "num_agent_steps_sampled": 808000, "num_steps_trained": 808000, "num_agent_steps_trained": 808000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8160, "training_iteration": 202, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-23-10", "timestamp": 1643649790, "time_this_iter_s": 24.661433935165405, "time_total_s": 4463.5324647426605, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4463.5324647426605, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 46.72857142857143, "ram_util_percent": 62.55714285714286}}
{"episode_reward_max": -1.3, "episode_reward_min": -87.70000000000012, "episode_reward_mean": -11.816, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -15.7, -11.599999999999998, -4.3, -4.4, -4.700000000000001, -2.6000000000000005, -3.3, -14.2, -16.199999999999996, -3.2, -18.699999999999996, -9.3, -13.2, -12.399999999999997, -3.8000000000000003, -11.7, -34.30000000000007, -1.3, -11.299999999999997, -9.3, -19.099999999999994, -87.70000000000012, -20.4, -3.3, -9.299999999999997, -20.199999999999996, -9.200000000000001, -8.3, -21.700000000000006, -8.600000000000001, -3.3, -13.499999999999998, -10.3, -4.2, -4.4, -8.600000000000001, -6.1, -17.6, -7.799999999999998, -8.2, -12.299999999999999, -8.5, -4.4, -4.2, -9.3, -4.2, -29.4, -7.2, -7.3999999999999995, -5.300000000000001, -13.0, -11.799999999999997, -3.3, -13.799999999999997, -4.2, -53.69999999999999, -3.8000000000000003, -3.4, -4.300000000000001, -17.2, -7.0, -26.2, -23.300000000000004, -26.000000000000075, -14.499999999999977, -11.9, -3.4, -9.499999999999998, -9.799999999999997, -3.3, -5.0, -11.4, -3.4, -9.199999999999998, -11.099999999999998, -10.100000000000001, -20.4, -3.8000000000000003, -9.6, -13.499999999999998, -7.2, -14.399999999999999, -5.300000000000001, -19.199999999999996, -8.999999999999998, -40.3, -5.300000000000001, -9.5, -9.2, -6.4, -4.300000000000001, -9.299999999999999, -22.3, -3.2, -9.3, -17.9, -14.9, -15.6, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.318317559492317, "mean_inference_ms": 1.6985779205426874, "mean_action_processing_ms": 0.09499845230226384, "mean_env_wait_ms": 7.78783436221346, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 812000, "timesteps_this_iter": 0, "agent_timesteps_total": 812000, "timers": {"sample_time_ms": 21741.534, "sample_throughput": 183.98, "load_time_ms": 0.515, "load_throughput": 7764353.943, "learn_time_ms": 11007.774, "learn_throughput": 363.38, "update_time_ms": 2.0}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.08286898857363129, "policy_loss": -0.017069911841623566, "vf_loss": 9.939197124076147, "vf_explained_var": 0.2413656703246537, "kl": 0.011523802155486365, "entropy": 0.18978743964946398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 812000, "num_agent_steps_sampled": 812000, "num_steps_trained": 812000, "num_agent_steps_trained": 812000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8200, "training_iteration": 203, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-23-31", "timestamp": 1643649811, "time_this_iter_s": 21.851140022277832, "time_total_s": 4485.383604764938, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4485.383604764938, "timesteps_since_restore": 0, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 39.715625, "ram_util_percent": 62.587500000000006}}
{"episode_reward_max": -2.2, "episode_reward_min": -67.2, "episode_reward_mean": -12.227, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.2, -12.299999999999999, -8.5, -4.4, -4.2, -9.3, -4.2, -29.4, -7.2, -7.3999999999999995, -5.300000000000001, -13.0, -11.799999999999997, -3.3, -13.799999999999997, -4.2, -53.69999999999999, -3.8000000000000003, -3.4, -4.300000000000001, -17.2, -7.0, -26.2, -23.300000000000004, -26.000000000000075, -14.499999999999977, -11.9, -3.4, -9.499999999999998, -9.799999999999997, -3.3, -5.0, -11.4, -3.4, -9.199999999999998, -11.099999999999998, -10.100000000000001, -20.4, -3.8000000000000003, -9.6, -13.499999999999998, -7.2, -14.399999999999999, -5.300000000000001, -19.199999999999996, -8.999999999999998, -40.3, -5.300000000000001, -9.5, -9.2, -6.4, -4.300000000000001, -9.299999999999999, -22.3, -3.2, -9.3, -17.9, -14.9, -15.6, -3.3, -22.2, -15.799999999999999, -12.999999999999986, -3.3, -22.100000000000005, -3.3, -7.9, -14.9, -37.89999999999996, -12.8, -19.5, -4.800000000000001, -4.7, -3.4, -4.2, -21.09999999999998, -12.299999999999999, -12.999999999999998, -3.3, -13.999999999999998, -15.6, -5.5, -15.399999999999999, -15.600000000000001, -5.8, -20.7, -19.9, -2.2, -14.100000000000001, -9.100000000000001, -17.7, -6.2, -4.4, -4.4, -26.2, -13.0, -67.2, -3.2, -10.499999999999996, -5.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3184168573337953, "mean_inference_ms": 1.698701644604008, "mean_action_processing_ms": 0.09500556685339027, "mean_env_wait_ms": 7.788250934892521, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 816000, "timesteps_this_iter": 0, "agent_timesteps_total": 816000, "timers": {"sample_time_ms": 21681.12, "sample_throughput": 184.492, "load_time_ms": 0.537, "load_throughput": 7453227.899, "learn_time_ms": 11112.795, "learn_throughput": 359.945, "update_time_ms": 1.977}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.13655587576670192, "policy_loss": -0.014830459279799334, "vf_loss": 15.104141212535161, "vf_explained_var": 0.18030098106271478, "kl": 0.007267615371686551, "entropy": 0.2005782358949223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 816000, "num_agent_steps_sampled": 816000, "num_steps_trained": 816000, "num_agent_steps_trained": 816000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8240, "training_iteration": 204, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-23-54", "timestamp": 1643649834, "time_this_iter_s": 22.07881188392639, "time_total_s": 4507.462416648865, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4507.462416648865, "timesteps_since_restore": 0, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 46.738709677419344, "ram_util_percent": 62.583870967741916}}
{"episode_reward_max": -2.2, "episode_reward_min": -67.2, "episode_reward_mean": -12.714999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.499999999999998, -7.2, -14.399999999999999, -5.300000000000001, -19.199999999999996, -8.999999999999998, -40.3, -5.300000000000001, -9.5, -9.2, -6.4, -4.300000000000001, -9.299999999999999, -22.3, -3.2, -9.3, -17.9, -14.9, -15.6, -3.3, -22.2, -15.799999999999999, -12.999999999999986, -3.3, -22.100000000000005, -3.3, -7.9, -14.9, -37.89999999999996, -12.8, -19.5, -4.800000000000001, -4.7, -3.4, -4.2, -21.09999999999998, -12.299999999999999, -12.999999999999998, -3.3, -13.999999999999998, -15.6, -5.5, -15.399999999999999, -15.600000000000001, -5.8, -20.7, -19.9, -2.2, -14.100000000000001, -9.100000000000001, -17.7, -6.2, -4.4, -4.4, -26.2, -13.0, -67.2, -3.2, -10.499999999999996, -5.300000000000001, -7.899999999999998, -11.8, -3.2, -18.100000000000005, -23.900000000000016, -2.4000000000000004, -3.3, -27.500000000000004, -4.2, -4.2, -18.90000000000001, -7.3, -4.300000000000001, -7.9, -18.500000000000004, -42.2, -5.4, -14.09999999999997, -17.3, -3.2, -18.799999999999997, -9.5, -18.799999999999997, -45.3, -4.2, -5.300000000000001, -9.4, -4.2, -3.3, -18.3, -14.8, -12.79999999999999, -26.6, -8.3, -11.999999999999998, -3.7, -3.3, -23.900000000000006, -3.3, -5.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3181333929103627, "mean_inference_ms": 1.6986545406605222, "mean_action_processing_ms": 0.0950036797286454, "mean_env_wait_ms": 7.7881561580308905, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 820000, "timesteps_this_iter": 0, "agent_timesteps_total": 820000, "timers": {"sample_time_ms": 22006.011, "sample_throughput": 181.769, "load_time_ms": 0.543, "load_throughput": 7368122.969, "learn_time_ms": 11223.192, "learn_throughput": 356.405, "update_time_ms": 1.978}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.15541793147242197, "policy_loss": -0.017449116069943673, "vf_loss": 17.205617808142016, "vf_explained_var": 0.12972410199462728, "kl": 0.017085067552410675, "entropy": 0.16983762103062805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 820000, "num_agent_steps_sampled": 820000, "num_steps_trained": 820000, "num_agent_steps_trained": 820000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8280, "training_iteration": 205, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-24-16", "timestamp": 1643649856, "time_this_iter_s": 22.689323902130127, "time_total_s": 4530.151740550995, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4530.151740550995, "timesteps_since_restore": 0, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 44.756249999999994, "ram_util_percent": 62.6}}
{"episode_reward_max": -1.0, "episode_reward_min": -89.4, "episode_reward_mean": -12.456000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.6, -5.5, -15.399999999999999, -15.600000000000001, -5.8, -20.7, -19.9, -2.2, -14.100000000000001, -9.100000000000001, -17.7, -6.2, -4.4, -4.4, -26.2, -13.0, -67.2, -3.2, -10.499999999999996, -5.300000000000001, -7.899999999999998, -11.8, -3.2, -18.100000000000005, -23.900000000000016, -2.4000000000000004, -3.3, -27.500000000000004, -4.2, -4.2, -18.90000000000001, -7.3, -4.300000000000001, -7.9, -18.500000000000004, -42.2, -5.4, -14.09999999999997, -17.3, -3.2, -18.799999999999997, -9.5, -18.799999999999997, -45.3, -4.2, -5.300000000000001, -9.4, -4.2, -3.3, -18.3, -14.8, -12.79999999999999, -26.6, -8.3, -11.999999999999998, -3.7, -3.3, -23.900000000000006, -3.3, -5.2, -9.0, -4.300000000000001, -4.6000000000000005, -17.5, -5.3, -1.0, -3.9000000000000004, -4.300000000000001, -6.300000000000001, -89.4, -11.099999999999998, -7.2, -12.499999999999998, -12.99999999999998, -10.3, -9.3, -8.3, -6.699999999999999, -13.5, -16.499999999999996, -5.4, -5.4, -4.300000000000001, -21.3, -8.799999999999999, -3.2, -3.3, -19.9, -17.5, -20.099999999999998, -10.299999999999997, -7.3, -16.699999999999996, -3.4, -4.300000000000001, -4.4, -8.2, -31.30000000000003, -11.999999999999996, -5.9], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3178275055029358, "mean_inference_ms": 1.6987342492836675, "mean_action_processing_ms": 0.09501188600184507, "mean_env_wait_ms": 7.788770437048608, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 824000, "timesteps_this_iter": 0, "agent_timesteps_total": 824000, "timers": {"sample_time_ms": 22309.787, "sample_throughput": 179.294, "load_time_ms": 0.493, "load_throughput": 8110812.666, "learn_time_ms": 11499.882, "learn_throughput": 347.83, "update_time_ms": 2.08}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.35943448955758966, "policy_loss": -0.009796825349731472, "vf_loss": 36.90327447729726, "vf_explained_var": -0.21622353849872467, "kl": 0.004184042989330069, "entropy": 0.15225843399242367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 824000, "num_agent_steps_sampled": 824000, "num_steps_trained": 824000, "num_agent_steps_trained": 824000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8320, "training_iteration": 206, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-24-41", "timestamp": 1643649881, "time_this_iter_s": 24.39294195175171, "time_total_s": 4554.544682502747, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4554.544682502747, "timesteps_since_restore": 0, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 47.934285714285714, "ram_util_percent": 62.60857142857142}}
{"episode_reward_max": -1.0, "episode_reward_min": -89.4, "episode_reward_mean": -12.005, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.799999999999997, -9.5, -18.799999999999997, -45.3, -4.2, -5.300000000000001, -9.4, -4.2, -3.3, -18.3, -14.8, -12.79999999999999, -26.6, -8.3, -11.999999999999998, -3.7, -3.3, -23.900000000000006, -3.3, -5.2, -9.0, -4.300000000000001, -4.6000000000000005, -17.5, -5.3, -1.0, -3.9000000000000004, -4.300000000000001, -6.300000000000001, -89.4, -11.099999999999998, -7.2, -12.499999999999998, -12.99999999999998, -10.3, -9.3, -8.3, -6.699999999999999, -13.5, -16.499999999999996, -5.4, -5.4, -4.300000000000001, -21.3, -8.799999999999999, -3.2, -3.3, -19.9, -17.5, -20.099999999999998, -10.299999999999997, -7.3, -16.699999999999996, -3.4, -4.300000000000001, -4.4, -8.2, -31.30000000000003, -11.999999999999996, -5.9, -3.3, -16.2, -4.3, -15.499999999999998, -16.0, -3.2, -11.899999999999997, -10.899999999999999, -3.3, -12.199999999999998, -9.9, -3.3, -16.199999999999996, -52.50000000000004, -4.800000000000001, -3.2, -17.3, -3.2, -17.600000000000005, -14.999999999999998, -3.3, -8.6, -12.299999999999999, -4.2, -11.799999999999999, -3.3, -13.1, -4.000000000000001, -18.300000000000022, -14.29999999999998, -10.0, -7.800000000000001, -6.3, -8.999999999999998, -77.59999999999998, -6.499999999999999, -14.600000000000001, -3.2, -10.2, -4.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3179828050736386, "mean_inference_ms": 1.699464895756435, "mean_action_processing_ms": 0.09505275811843507, "mean_env_wait_ms": 7.792584533352384, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 828000, "timesteps_this_iter": 0, "agent_timesteps_total": 828000, "timers": {"sample_time_ms": 22959.263, "sample_throughput": 174.222, "load_time_ms": 0.497, "load_throughput": 8052033.02, "learn_time_ms": 11683.508, "learn_throughput": 342.363, "update_time_ms": 2.116}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.34197009776979287, "policy_loss": -0.015285934531380252, "vf_loss": 35.708118096346496, "vf_explained_var": 0.08074819676337704, "kl": 0.007368450252995223, "entropy": 0.18155565082385977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 828000, "num_agent_steps_sampled": 828000, "num_steps_trained": 828000, "num_agent_steps_trained": 828000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8360, "training_iteration": 207, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-25-06", "timestamp": 1643649906, "time_this_iter_s": 25.583889722824097, "time_total_s": 4580.128572225571, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4580.128572225571, "timesteps_since_restore": 0, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 50.06216216216216, "ram_util_percent": 62.54054054054054}}
{"episode_reward_max": -3.2, "episode_reward_min": -77.59999999999998, "episode_reward_mean": -10.854000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.799999999999999, -3.2, -3.3, -19.9, -17.5, -20.099999999999998, -10.299999999999997, -7.3, -16.699999999999996, -3.4, -4.300000000000001, -4.4, -8.2, -31.30000000000003, -11.999999999999996, -5.9, -3.3, -16.2, -4.3, -15.499999999999998, -16.0, -3.2, -11.899999999999997, -10.899999999999999, -3.3, -12.199999999999998, -9.9, -3.3, -16.199999999999996, -52.50000000000004, -4.800000000000001, -3.2, -17.3, -3.2, -17.600000000000005, -14.999999999999998, -3.3, -8.6, -12.299999999999999, -4.2, -11.799999999999999, -3.3, -13.1, -4.000000000000001, -18.300000000000022, -14.29999999999998, -10.0, -7.800000000000001, -6.3, -8.999999999999998, -77.59999999999998, -6.499999999999999, -14.600000000000001, -3.2, -10.2, -4.3, -7.3, -32.60000000000001, -4.4, -3.4000000000000004, -19.199999999999996, -8.2, -4.300000000000001, -10.799999999999999, -4.3, -15.899999999999999, -3.3, -3.3, -7.4, -30.700000000000003, -10.699999999999998, -14.199999999999998, -3.3, -4.300000000000001, -4.4, -8.2, -3.3, -13.5, -3.3, -12.599999999999996, -3.3, -3.2, -13.299999999999997, -3.2, -4.2, -14.8, -11.899999999999999, -3.2, -16.7, -14.1, -3.4, -28.2, -3.3, -8.3, -20.599999999999998, -3.2, -8.2, -22.70000000000001, -3.4, -4.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3189258390295882, "mean_inference_ms": 1.7004060597980588, "mean_action_processing_ms": 0.09516599734403684, "mean_env_wait_ms": 7.798105385837451, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 832000, "timesteps_this_iter": 0, "agent_timesteps_total": 832000, "timers": {"sample_time_ms": 23233.367, "sample_throughput": 172.166, "load_time_ms": 0.499, "load_throughput": 8017785.424, "learn_time_ms": 11809.425, "learn_throughput": 338.713, "update_time_ms": 2.145}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.1259295212934845, "policy_loss": -0.018876879790457345, "vf_loss": 14.42416282565363, "vf_explained_var": 0.14204112349017975, "kl": 0.023799684262488015, "entropy": 0.1697816649271596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 832000, "num_agent_steps_sampled": 832000, "num_steps_trained": 832000, "num_agent_steps_trained": 832000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8404, "training_iteration": 208, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-25-30", "timestamp": 1643649930, "time_this_iter_s": 23.967563152313232, "time_total_s": 4604.096135377884, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4604.096135377884, "timesteps_since_restore": 0, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 41.688235294117646, "ram_util_percent": 62.5}}
{"episode_reward_max": -3.2, "episode_reward_min": -77.59999999999998, "episode_reward_mean": -10.846000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.799999999999999, -3.3, -13.1, -4.000000000000001, -18.300000000000022, -14.29999999999998, -10.0, -7.800000000000001, -6.3, -8.999999999999998, -77.59999999999998, -6.499999999999999, -14.600000000000001, -3.2, -10.2, -4.3, -7.3, -32.60000000000001, -4.4, -3.4000000000000004, -19.199999999999996, -8.2, -4.300000000000001, -10.799999999999999, -4.3, -15.899999999999999, -3.3, -3.3, -7.4, -30.700000000000003, -10.699999999999998, -14.199999999999998, -3.3, -4.300000000000001, -4.4, -8.2, -3.3, -13.5, -3.3, -12.599999999999996, -3.3, -3.2, -13.299999999999997, -3.2, -4.2, -14.8, -11.899999999999999, -3.2, -16.7, -14.1, -3.4, -28.2, -3.3, -8.3, -20.599999999999998, -3.2, -8.2, -22.70000000000001, -3.4, -4.2, -26.800000000000004, -4.2, -66.80000000000007, -4.2, -9.3, -10.2, -4.2, -19.099999999999998, -3.3, -24.90000000000001, -3.2, -7.299999999999999, -3.3, -9.899999999999999, -3.4, -14.799999999999999, -12.7, -6.9, -9.2, -4.2, -13.2, -12.6, -7.199999999999999, -11.9, -3.6000000000000005, -26.2, -11.499999999999996, -3.3, -4.300000000000001, -4.300000000000001, -18.799999999999997, -7.3, -5.699999999999999, -22.200000000000006, -3.2, -9.3, -6.800000000000001, -3.3, -18.0, -3.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3194900118196458, "mean_inference_ms": 1.7010892265972932, "mean_action_processing_ms": 0.09520532147905834, "mean_env_wait_ms": 7.801585807371022, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 836000, "timesteps_this_iter": 0, "agent_timesteps_total": 836000, "timers": {"sample_time_ms": 23558.666, "sample_throughput": 169.789, "load_time_ms": 0.484, "load_throughput": 8259349.185, "learn_time_ms": 11968.765, "learn_throughput": 334.203, "update_time_ms": 2.241}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 0.25637746026879676, "policy_loss": -0.016038424952546516, "vf_loss": 27.191059389518152, "vf_explained_var": 0.15639052660234512, "kl": 0.014195459292711331, "entropy": 0.18712834155247096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 836000, "num_agent_steps_sampled": 836000, "num_steps_trained": 836000, "num_agent_steps_trained": 836000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8444, "training_iteration": 209, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-25-55", "timestamp": 1643649955, "time_this_iter_s": 24.234607934951782, "time_total_s": 4628.330743312836, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4628.330743312836, "timesteps_since_restore": 0, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 44.811764705882354, "ram_util_percent": 62.49117647058823}}
{"episode_reward_max": -3.2, "episode_reward_min": -66.80000000000007, "episode_reward_mean": -12.251000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -3.2, -13.299999999999997, -3.2, -4.2, -14.8, -11.899999999999999, -3.2, -16.7, -14.1, -3.4, -28.2, -3.3, -8.3, -20.599999999999998, -3.2, -8.2, -22.70000000000001, -3.4, -4.2, -26.800000000000004, -4.2, -66.80000000000007, -4.2, -9.3, -10.2, -4.2, -19.099999999999998, -3.3, -24.90000000000001, -3.2, -7.299999999999999, -3.3, -9.899999999999999, -3.4, -14.799999999999999, -12.7, -6.9, -9.2, -4.2, -13.2, -12.6, -7.199999999999999, -11.9, -3.6000000000000005, -26.2, -11.499999999999996, -3.3, -4.300000000000001, -4.300000000000001, -18.799999999999997, -7.3, -5.699999999999999, -22.200000000000006, -3.2, -9.3, -6.800000000000001, -3.3, -18.0, -3.4, -21.3, -25.599999999999994, -13.200000000000001, -12.4, -3.3, -20.799999999999997, -9.099999999999998, -3.4, -5.300000000000001, -38.4, -16.099999999999998, -8.3, -4.5, -33.09999999999999, -17.5, -6.699999999999999, -20.2, -13.2, -15.799999999999999, -15.799999999999999, -4.300000000000001, -19.5, -30.3, -4.300000000000001, -4.300000000000001, -14.39999999999998, -16.5, -4.6, -8.3, -9.3, -20.20000000000001, -13.799999999999997, -3.2, -14.7, -9.2, -15.099999999999998, -41.4, -24.30000000000001, -6.2, -19.800000000000004], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3196296666416574, "mean_inference_ms": 1.7014709731154776, "mean_action_processing_ms": 0.09517294549491381, "mean_env_wait_ms": 7.803448570658436, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 840000, "timesteps_this_iter": 0, "agent_timesteps_total": 840000, "timers": {"sample_time_ms": 23931.701, "sample_throughput": 167.142, "load_time_ms": 0.487, "load_throughput": 8208834.524, "learn_time_ms": 12062.678, "learn_throughput": 331.601, "update_time_ms": 2.322}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 0.1927096960435231, "policy_loss": -0.012523651269755217, "vf_loss": 20.4700032861002, "vf_explained_var": 0.14681823112631356, "kl": 0.01498263662171575, "entropy": 0.208656347082347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 840000, "num_agent_steps_sampled": 840000, "num_steps_trained": 840000, "num_agent_steps_trained": 840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8484, "training_iteration": 210, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-26-18", "timestamp": 1643649978, "time_this_iter_s": 23.200870037078857, "time_total_s": 4651.531613349915, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4651.531613349915, "timesteps_since_restore": 0, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 45.93333333333334, "ram_util_percent": 62.5}}
{"episode_reward_max": -2.7, "episode_reward_min": -41.4, "episode_reward_mean": -12.147, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.2, -12.6, -7.199999999999999, -11.9, -3.6000000000000005, -26.2, -11.499999999999996, -3.3, -4.300000000000001, -4.300000000000001, -18.799999999999997, -7.3, -5.699999999999999, -22.200000000000006, -3.2, -9.3, -6.800000000000001, -3.3, -18.0, -3.4, -21.3, -25.599999999999994, -13.200000000000001, -12.4, -3.3, -20.799999999999997, -9.099999999999998, -3.4, -5.300000000000001, -38.4, -16.099999999999998, -8.3, -4.5, -33.09999999999999, -17.5, -6.699999999999999, -20.2, -13.2, -15.799999999999999, -15.799999999999999, -4.300000000000001, -19.5, -30.3, -4.300000000000001, -4.300000000000001, -14.39999999999998, -16.5, -4.6, -8.3, -9.3, -20.20000000000001, -13.799999999999997, -3.2, -14.7, -9.2, -15.099999999999998, -41.4, -24.30000000000001, -6.2, -19.800000000000004, -3.3, -6.300000000000001, -13.7, -15.2, -4.3, -11.099999999999998, -9.0, -19.0, -20.7, -14.899999999999997, -11.299999999999997, -3.4, -17.099999999999998, -12.899999999999999, -3.4, -4.300000000000001, -25.7, -5.1, -15.1, -16.199999999999996, -18.800000000000004, -10.3, -9.299999999999997, -10.6, -12.600000000000001, -21.20000000000002, -13.7, -4.2, -10.1, -3.3, -16.799999999999997, -2.7, -3.3, -4.300000000000001, -8.299999999999997, -8.3, -8.899999999999999, -11.5, -15.399999999999999, -5.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3196355504004225, "mean_inference_ms": 1.7020823860144876, "mean_action_processing_ms": 0.0952055733038237, "mean_env_wait_ms": 7.805862065509853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 844000, "timesteps_this_iter": 0, "agent_timesteps_total": 844000, "timers": {"sample_time_ms": 24100.384, "sample_throughput": 165.972, "load_time_ms": 0.452, "load_throughput": 8853879.36, "learn_time_ms": 11659.877, "learn_throughput": 343.057, "update_time_ms": 2.293}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 0.06433779946578447, "policy_loss": -0.008771809088366648, "vf_loss": 7.280386897184515, "vf_explained_var": 0.23980520540668118, "kl": 0.008589283762422377, "entropy": 0.19421711907752098, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 844000, "num_agent_steps_sampled": 844000, "num_steps_trained": 844000, "num_agent_steps_trained": 844000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8524, "training_iteration": 211, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-26-42", "timestamp": 1643650002, "time_this_iter_s": 23.847898960113525, "time_total_s": 4675.379512310028, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4675.379512310028, "timesteps_since_restore": 0, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 46.92941176470588, "ram_util_percent": 62.46764705882353}}
{"episode_reward_max": -2.7, "episode_reward_min": -42.3, "episode_reward_mean": -11.394, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -19.5, -30.3, -4.300000000000001, -4.300000000000001, -14.39999999999998, -16.5, -4.6, -8.3, -9.3, -20.20000000000001, -13.799999999999997, -3.2, -14.7, -9.2, -15.099999999999998, -41.4, -24.30000000000001, -6.2, -19.800000000000004, -3.3, -6.300000000000001, -13.7, -15.2, -4.3, -11.099999999999998, -9.0, -19.0, -20.7, -14.899999999999997, -11.299999999999997, -3.4, -17.099999999999998, -12.899999999999999, -3.4, -4.300000000000001, -25.7, -5.1, -15.1, -16.199999999999996, -18.800000000000004, -10.3, -9.299999999999997, -10.6, -12.600000000000001, -21.20000000000002, -13.7, -4.2, -10.1, -3.3, -16.799999999999997, -2.7, -3.3, -4.300000000000001, -8.299999999999997, -8.3, -8.899999999999999, -11.5, -15.399999999999999, -5.3, -8.399999999999999, -4.3, -10.2, -3.4, -10.999999999999998, -42.3, -7.399999999999999, -14.599999999999998, -7.5, -18.700000000000003, -12.0, -13.4, -3.2, -17.5, -9.0, -5.300000000000001, -6.4, -3.3, -21.70000000000003, -8.4, -5.300000000000001, -8.600000000000001, -15.7, -5.4, -11.5, -4.9, -9.799999999999995, -14.799999999999999, -3.3, -4.300000000000001, -8.2, -19.300000000000004, -11.299999999999997, -21.400000000000002, -11.999999999999998, -7.800000000000001, -4.800000000000001, -8.9, -4.800000000000001, -14.699999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3196087301052322, "mean_inference_ms": 1.7026165041935934, "mean_action_processing_ms": 0.0952376161617063, "mean_env_wait_ms": 7.808508035037559, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 848000, "timesteps_this_iter": 0, "agent_timesteps_total": 848000, "timers": {"sample_time_ms": 23627.556, "sample_throughput": 169.294, "load_time_ms": 0.446, "load_throughput": 8971293.514, "learn_time_ms": 11766.109, "learn_throughput": 339.959, "update_time_ms": 2.292}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 0.16885743850506643, "policy_loss": -0.015660240888215042, "vf_loss": 18.41858848391041, "vf_explained_var": 0.17213050152665826, "kl": 0.009321238307693165, "entropy": 0.18712001765767733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 848000, "num_agent_steps_sampled": 848000, "num_steps_trained": 848000, "num_agent_steps_trained": 848000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8564, "training_iteration": 212, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-27-07", "timestamp": 1643650027, "time_this_iter_s": 25.026554107666016, "time_total_s": 4700.406066417694, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4700.406066417694, "timesteps_since_restore": 0, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 49.583333333333336, "ram_util_percent": 62.463888888888896}}
{"episode_reward_max": -2.7, "episode_reward_min": -42.3, "episode_reward_mean": -10.303000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.800000000000004, -10.3, -9.299999999999997, -10.6, -12.600000000000001, -21.20000000000002, -13.7, -4.2, -10.1, -3.3, -16.799999999999997, -2.7, -3.3, -4.300000000000001, -8.299999999999997, -8.3, -8.899999999999999, -11.5, -15.399999999999999, -5.3, -8.399999999999999, -4.3, -10.2, -3.4, -10.999999999999998, -42.3, -7.399999999999999, -14.599999999999998, -7.5, -18.700000000000003, -12.0, -13.4, -3.2, -17.5, -9.0, -5.300000000000001, -6.4, -3.3, -21.70000000000003, -8.4, -5.300000000000001, -8.600000000000001, -15.7, -5.4, -11.5, -4.9, -9.799999999999995, -14.799999999999999, -3.3, -4.300000000000001, -8.2, -19.300000000000004, -11.299999999999997, -21.400000000000002, -11.999999999999998, -7.800000000000001, -4.800000000000001, -8.9, -4.800000000000001, -14.699999999999998, -3.4, -4.2, -6.799999999999999, -11.0, -10.2, -4.2, -4.2, -5.300000000000001, -4.4, -10.600000000000001, -10.099999999999994, -13.600000000000001, -8.3, -4.2, -15.8, -13.899999999999999, -10.2, -12.2, -3.2, -18.9, -25.3, -7.300000000000001, -13.2, -4.2, -15.299999999999995, -6.300000000000001, -12.0, -3.4, -15.3, -4.3, -33.3, -3.6000000000000005, -3.2, -17.4, -12.2, -17.2, -3.6, -12.899999999999999, -9.2, -12.7], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.319676634424333, "mean_inference_ms": 1.703336763222428, "mean_action_processing_ms": 0.09527993986333602, "mean_env_wait_ms": 7.81215096577949, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 852000, "timesteps_this_iter": 0, "agent_timesteps_total": 852000, "timers": {"sample_time_ms": 23881.197, "sample_throughput": 167.496, "load_time_ms": 0.471, "load_throughput": 8489205.08, "learn_time_ms": 12044.138, "learn_throughput": 332.112, "update_time_ms": 2.3}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 0.036219936369928304, "policy_loss": -0.03274572289909326, "vf_loss": 6.874671442758652, "vf_explained_var": 0.3477854378761784, "kl": 0.006150929247891823, "entropy": 0.1714644045679159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 852000, "num_agent_steps_sampled": 852000, "num_steps_trained": 852000, "num_agent_steps_trained": 852000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8604, "training_iteration": 213, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-27-33", "timestamp": 1643650053, "time_this_iter_s": 26.124083280563354, "time_total_s": 4726.530149698257, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4726.530149698257, "timesteps_since_restore": 0, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 52.40270270270271, "ram_util_percent": 62.5}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.3, "episode_reward_mean": -10.493, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -8.600000000000001, -15.7, -5.4, -11.5, -4.9, -9.799999999999995, -14.799999999999999, -3.3, -4.300000000000001, -8.2, -19.300000000000004, -11.299999999999997, -21.400000000000002, -11.999999999999998, -7.800000000000001, -4.800000000000001, -8.9, -4.800000000000001, -14.699999999999998, -3.4, -4.2, -6.799999999999999, -11.0, -10.2, -4.2, -4.2, -5.300000000000001, -4.4, -10.600000000000001, -10.099999999999994, -13.600000000000001, -8.3, -4.2, -15.8, -13.899999999999999, -10.2, -12.2, -3.2, -18.9, -25.3, -7.300000000000001, -13.2, -4.2, -15.299999999999995, -6.300000000000001, -12.0, -3.4, -15.3, -4.3, -33.3, -3.6000000000000005, -3.2, -17.4, -12.2, -17.2, -3.6, -12.899999999999999, -9.2, -12.7, -12.899999999999999, -3.2, -12.8, -3.4, -4.2, -14.999999999999988, -9.7, -11.1, -3.3, -17.7, -4.300000000000001, -19.2, -4.300000000000001, -4.4, -4.700000000000001, -7.3, -11.600000000000001, -10.899999999999999, -15.59999999999999, -9.399999999999997, -11.699999999999998, -33.10000000000001, -20.699999999999996, -15.499999999999995, -18.600000000000005, -8.3, -8.5, -3.3, -13.399999999999999, -10.0, -10.3, -5.300000000000001, -10.700000000000001, -14.6, -10.5, -13.999999999999996, -16.4, -7.300000000000001, -10.699999999999998, -17.999999999999993], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.32041531196244, "mean_inference_ms": 1.7045463312806755, "mean_action_processing_ms": 0.09534692878262717, "mean_env_wait_ms": 7.818083997285259, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 856000, "timesteps_this_iter": 0, "agent_timesteps_total": 856000, "timers": {"sample_time_ms": 24474.583, "sample_throughput": 163.435, "load_time_ms": 0.453, "load_throughput": 8830578.451, "learn_time_ms": 12180.409, "learn_throughput": 328.396, "update_time_ms": 2.376}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 0.08637136983264598, "policy_loss": -0.009392077831791775, "vf_loss": 9.542829652082535, "vf_explained_var": 0.324633478349255, "kl": 0.009415514394152608, "entropy": 0.1784070129556361, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 856000, "num_agent_steps_sampled": 856000, "num_steps_trained": 856000, "num_agent_steps_trained": 856000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8644, "training_iteration": 214, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-28-00", "timestamp": 1643650080, "time_this_iter_s": 26.566190719604492, "time_total_s": 4753.096340417862, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4753.096340417862, "timesteps_since_restore": 0, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 52.88157894736842, "ram_util_percent": 62.502631578947366}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.3, "episode_reward_mean": -10.901, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.3, -7.300000000000001, -13.2, -4.2, -15.299999999999995, -6.300000000000001, -12.0, -3.4, -15.3, -4.3, -33.3, -3.6000000000000005, -3.2, -17.4, -12.2, -17.2, -3.6, -12.899999999999999, -9.2, -12.7, -12.899999999999999, -3.2, -12.8, -3.4, -4.2, -14.999999999999988, -9.7, -11.1, -3.3, -17.7, -4.300000000000001, -19.2, -4.300000000000001, -4.4, -4.700000000000001, -7.3, -11.600000000000001, -10.899999999999999, -15.59999999999999, -9.399999999999997, -11.699999999999998, -33.10000000000001, -20.699999999999996, -15.499999999999995, -18.600000000000005, -8.3, -8.5, -3.3, -13.399999999999999, -10.0, -10.3, -5.300000000000001, -10.700000000000001, -14.6, -10.5, -13.999999999999996, -16.4, -7.300000000000001, -10.699999999999998, -17.999999999999993, -3.3, -12.799999999999999, -11.9, -5.3, -9.3, -15.299999999999986, -9.099999999999998, -10.2, -8.4, -16.099999999999998, -18.100000000000023, -19.3, -19.2, -12.099999999999996, -3.3, -19.5, -19.799999999999997, -3.5, -4.4, -10.200000000000001, -4.4, -14.799999999999999, -3.3, -4.2, -3.3, -11.0, -14.0, -3.4, -19.1, -13.7, -3.4, -5.300000000000001, -9.4, -8.799999999999999, -14.5, -15.999999999999998, -4.4, -7.299999999999997, -17.6, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3215834486848945, "mean_inference_ms": 1.7062555605174126, "mean_action_processing_ms": 0.09543895944246625, "mean_env_wait_ms": 7.826653166427811, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 860000, "timesteps_this_iter": 0, "agent_timesteps_total": 860000, "timers": {"sample_time_ms": 24873.613, "sample_throughput": 160.813, "load_time_ms": 0.455, "load_throughput": 8785722.664, "learn_time_ms": 12415.458, "learn_throughput": 322.179, "update_time_ms": 2.393}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 0.07465694900401817, "policy_loss": -0.007763451946678982, "vf_loss": 8.211887825592871, "vf_explained_var": 0.36076837476863655, "kl": 0.008470789236173296, "entropy": 0.18444972559809686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 860000, "num_agent_steps_sampled": 860000, "num_steps_trained": 860000, "num_agent_steps_trained": 860000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8684, "training_iteration": 215, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-28-27", "timestamp": 1643650107, "time_this_iter_s": 27.661664962768555, "time_total_s": 4780.7580053806305, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4780.7580053806305, "timesteps_since_restore": 0, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 44.17, "ram_util_percent": 62.5875}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.10000000000001, "episode_reward_mean": -10.505, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.699999999999998, -33.10000000000001, -20.699999999999996, -15.499999999999995, -18.600000000000005, -8.3, -8.5, -3.3, -13.399999999999999, -10.0, -10.3, -5.300000000000001, -10.700000000000001, -14.6, -10.5, -13.999999999999996, -16.4, -7.300000000000001, -10.699999999999998, -17.999999999999993, -3.3, -12.799999999999999, -11.9, -5.3, -9.3, -15.299999999999986, -9.099999999999998, -10.2, -8.4, -16.099999999999998, -18.100000000000023, -19.3, -19.2, -12.099999999999996, -3.3, -19.5, -19.799999999999997, -3.5, -4.4, -10.200000000000001, -4.4, -14.799999999999999, -3.3, -4.2, -3.3, -11.0, -14.0, -3.4, -19.1, -13.7, -3.4, -5.300000000000001, -9.4, -8.799999999999999, -14.5, -15.999999999999998, -4.4, -7.299999999999997, -17.6, -3.3, -3.3, -7.5, -4.2, -7.599999999999998, -4.300000000000001, -13.8, -8.5, -3.2, -4.2, -14.7, -10.8, -9.699999999999998, -14.7, -3.3, -20.499999999999996, -16.699999999999996, -20.8, -7.7, -3.2, -5.2, -21.199999999999996, -5.499999999999998, -16.199999999999996, -11.7, -4.3, -9.199999999999998, -4.4, -4.5, -16.5, -11.5, -13.2, -8.899999999999999, -8.4, -8.8, -4.2, -4.300000000000001, -24.3, -4.4, -4.4, -7.499999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3234756390641766, "mean_inference_ms": 1.708691415538766, "mean_action_processing_ms": 0.09556815487921738, "mean_env_wait_ms": 7.838880789689129, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 864000, "timesteps_this_iter": 0, "agent_timesteps_total": 864000, "timers": {"sample_time_ms": 25562.888, "sample_throughput": 156.477, "load_time_ms": 0.461, "load_throughput": 8670843.971, "learn_time_ms": 12492.472, "learn_throughput": 320.193, "update_time_ms": 2.482}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 0.05966354328538141, "policy_loss": -0.013942136847844688, "vf_loss": 7.340354367962448, "vf_explained_var": 0.3444096727396852, "kl": 0.005678659413214485, "entropy": 0.1834110747942681, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 864000, "num_agent_steps_sampled": 864000, "num_steps_trained": 864000, "num_agent_steps_trained": 864000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8724, "training_iteration": 216, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-28-57", "timestamp": 1643650137, "time_this_iter_s": 29.686696767807007, "time_total_s": 4810.4447021484375, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4810.4447021484375, "timesteps_since_restore": 0, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 48.490476190476194, "ram_util_percent": 62.59047619047618}}
{"episode_reward_max": -3.2, "episode_reward_min": -30.499999999999947, "episode_reward_mean": -9.867, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -14.799999999999999, -3.3, -4.2, -3.3, -11.0, -14.0, -3.4, -19.1, -13.7, -3.4, -5.300000000000001, -9.4, -8.799999999999999, -14.5, -15.999999999999998, -4.4, -7.299999999999997, -17.6, -3.3, -3.3, -7.5, -4.2, -7.599999999999998, -4.300000000000001, -13.8, -8.5, -3.2, -4.2, -14.7, -10.8, -9.699999999999998, -14.7, -3.3, -20.499999999999996, -16.699999999999996, -20.8, -7.7, -3.2, -5.2, -21.199999999999996, -5.499999999999998, -16.199999999999996, -11.7, -4.3, -9.199999999999998, -4.4, -4.5, -16.5, -11.5, -13.2, -8.899999999999999, -8.4, -8.8, -4.2, -4.300000000000001, -24.3, -4.4, -4.4, -7.499999999999998, -7.0, -7.2, -8.999999999999998, -3.3, -7.4, -12.499999999999996, -12.5, -3.3, -17.2, -10.999999999999998, -9.600000000000001, -9.599999999999998, -19.699999999999996, -30.499999999999947, -5.799999999999999, -4.4, -17.7, -13.2, -10.2, -8.5, -21.699999999999996, -16.799999999999997, -7.899999999999997, -16.9, -8.1, -7.3, -11.2, -9.099999999999998, -4.2, -19.9, -15.6, -4.300000000000001, -8.399999999999999, -4.3, -7.8999999999999995, -3.3, -23.80000000000003, -8.2, -5.300000000000001, -4.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3254776766154561, "mean_inference_ms": 1.7113187640584724, "mean_action_processing_ms": 0.0957094796217201, "mean_env_wait_ms": 7.851967907459814, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 868000, "timesteps_this_iter": 0, "agent_timesteps_total": 868000, "timers": {"sample_time_ms": 25805.365, "sample_throughput": 155.007, "load_time_ms": 0.473, "load_throughput": 8454127.488, "learn_time_ms": 12457.599, "learn_throughput": 321.089, "update_time_ms": 2.427}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 0.06760732903275439, "policy_loss": -0.013477468049974852, "vf_loss": 8.077169410483812, "vf_explained_var": 0.3451658437328954, "kl": 0.008796180710529334, "entropy": 0.17789879131621572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 868000, "num_agent_steps_sampled": 868000, "num_steps_trained": 868000, "num_agent_steps_trained": 868000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8764, "training_iteration": 217, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-29-24", "timestamp": 1643650164, "time_this_iter_s": 26.842134952545166, "time_total_s": 4837.286837100983, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4837.286837100983, "timesteps_since_restore": 0, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 48.152631578947364, "ram_util_percent": 62.6236842105263}}
{"episode_reward_max": -3.2, "episode_reward_min": -83.2, "episode_reward_mean": -10.793000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -9.199999999999998, -4.4, -4.5, -16.5, -11.5, -13.2, -8.899999999999999, -8.4, -8.8, -4.2, -4.300000000000001, -24.3, -4.4, -4.4, -7.499999999999998, -7.0, -7.2, -8.999999999999998, -3.3, -7.4, -12.499999999999996, -12.5, -3.3, -17.2, -10.999999999999998, -9.600000000000001, -9.599999999999998, -19.699999999999996, -30.499999999999947, -5.799999999999999, -4.4, -17.7, -13.2, -10.2, -8.5, -21.699999999999996, -16.799999999999997, -7.899999999999997, -16.9, -8.1, -7.3, -11.2, -9.099999999999998, -4.2, -19.9, -15.6, -4.300000000000001, -8.399999999999999, -4.3, -7.8999999999999995, -3.3, -23.80000000000003, -8.2, -5.300000000000001, -4.4, -4.4, -9.7, -10.3, -11.2, -7.699999999999996, -22.0, -3.4, -18.799999999999997, -10.1, -3.2, -18.299999999999997, -8.3, -17.6, -11.5, -15.2, -18.599999999999994, -21.6, -3.3, -5.4, -4.300000000000001, -83.2, -11.999999999999998, -8.799999999999997, -3.4, -13.3, -3.3, -6.199999999999999, -6.3, -10.100000000000001, -19.000000000000032, -4.300000000000001, -12.499999999999998, -12.2, -7.299999999999999, -3.6000000000000005, -3.2, -9.3, -15.5, -5.300000000000001, -4.300000000000001, -20.4, -4.2, -5.300000000000001, -14.399999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3272499776133602, "mean_inference_ms": 1.7132752051610942, "mean_action_processing_ms": 0.0958778918560836, "mean_env_wait_ms": 7.862438356931371, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 872000, "timesteps_this_iter": 0, "agent_timesteps_total": 872000, "timers": {"sample_time_ms": 25785.404, "sample_throughput": 155.127, "load_time_ms": 0.493, "load_throughput": 8108068.819, "learn_time_ms": 12481.346, "learn_throughput": 320.478, "update_time_ms": 2.496}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 0.2788688103618321, "policy_loss": -0.005027137390307842, "vf_loss": 28.36204225376088, "vf_explained_var": 0.2226797051968113, "kl": 0.007740563031700091, "entropy": 0.17199545624836157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 872000, "num_agent_steps_sampled": 872000, "num_steps_trained": 872000, "num_agent_steps_trained": 872000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8808, "training_iteration": 218, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-29-48", "timestamp": 1643650188, "time_this_iter_s": 24.36335802078247, "time_total_s": 4861.650195121765, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4861.650195121765, "timesteps_since_restore": 0, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 47.26571428571429, "ram_util_percent": 62.45714285714287}}
{"episode_reward_max": -1.3, "episode_reward_min": -137.5, "episode_reward_mean": -11.59, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.1, -7.3, -11.2, -9.099999999999998, -4.2, -19.9, -15.6, -4.300000000000001, -8.399999999999999, -4.3, -7.8999999999999995, -3.3, -23.80000000000003, -8.2, -5.300000000000001, -4.4, -4.4, -9.7, -10.3, -11.2, -7.699999999999996, -22.0, -3.4, -18.799999999999997, -10.1, -3.2, -18.299999999999997, -8.3, -17.6, -11.5, -15.2, -18.599999999999994, -21.6, -3.3, -5.4, -4.300000000000001, -83.2, -11.999999999999998, -8.799999999999997, -3.4, -13.3, -3.3, -6.199999999999999, -6.3, -10.100000000000001, -19.000000000000032, -4.300000000000001, -12.499999999999998, -12.2, -7.299999999999999, -3.6000000000000005, -3.2, -9.3, -15.5, -5.300000000000001, -4.300000000000001, -20.4, -4.2, -5.300000000000001, -14.399999999999999, -15.999999999999998, -18.9, -3.8000000000000007, -20.50000000000003, -8.0, -11.7, -4.4, -12.8, -1.3, -10.999999999999998, -8.599999999999998, -5.300000000000001, -20.8, -3.3, -9.3, -13.499999999999998, -18.6, -11.099999999999998, -3.2, -9.299999999999999, -9.799999999999999, -14.199999999999996, -6.2, -4.300000000000001, -11.2, -4.300000000000001, -137.5, -21.999999999999996, -3.3, -4.2, -4.300000000000001, -4.2, -4.300000000000001, -5.300000000000001, -5.4, -16.7, -4.5, -14.3, -5.2, -8.799999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3282211403944806, "mean_inference_ms": 1.7147792882068507, "mean_action_processing_ms": 0.09596296390020903, "mean_env_wait_ms": 7.869792052163205, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 876000, "timesteps_this_iter": 0, "agent_timesteps_total": 876000, "timers": {"sample_time_ms": 26081.022, "sample_throughput": 153.368, "load_time_ms": 0.495, "load_throughput": 8088523.768, "learn_time_ms": 12542.763, "learn_throughput": 318.909, "update_time_ms": 2.44}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 0.8129637193755918, "policy_loss": -0.013460561639619291, "vf_loss": 82.60596476053038, "vf_explained_var": 0.14513707160949707, "kl": 0.010244153960619944, "entropy": 0.1811857705074613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 876000, "num_agent_steps_sampled": 876000, "num_steps_trained": 876000, "num_agent_steps_trained": 876000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8848, "training_iteration": 219, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-30-16", "timestamp": 1643650216, "time_this_iter_s": 27.55153203010559, "time_total_s": 4889.201727151871, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4889.201727151871, "timesteps_since_restore": 0, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 49.13076923076923, "ram_util_percent": 62.29743589743593}}
{"episode_reward_max": -1.3, "episode_reward_min": -137.5, "episode_reward_mean": -11.233999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.3, -3.3, -6.199999999999999, -6.3, -10.100000000000001, -19.000000000000032, -4.300000000000001, -12.499999999999998, -12.2, -7.299999999999999, -3.6000000000000005, -3.2, -9.3, -15.5, -5.300000000000001, -4.300000000000001, -20.4, -4.2, -5.300000000000001, -14.399999999999999, -15.999999999999998, -18.9, -3.8000000000000007, -20.50000000000003, -8.0, -11.7, -4.4, -12.8, -1.3, -10.999999999999998, -8.599999999999998, -5.300000000000001, -20.8, -3.3, -9.3, -13.499999999999998, -18.6, -11.099999999999998, -3.2, -9.299999999999999, -9.799999999999999, -14.199999999999996, -6.2, -4.300000000000001, -11.2, -4.300000000000001, -137.5, -21.999999999999996, -3.3, -4.2, -4.300000000000001, -4.2, -4.300000000000001, -5.300000000000001, -5.4, -16.7, -4.5, -14.3, -5.2, -8.799999999999999, -4.4, -7.299999999999999, -6.1, -5.3, -4.2, -13.299999999999997, -51.29999999999999, -3.4, -21.2, -14.099999999999996, -18.0, -12.8, -10.799999999999999, -3.7, -3.3, -7.099999999999998, -10.3, -9.099999999999998, -22.800000000000008, -7.300000000000001, -7.6000000000000005, -3.4, -11.099999999999998, -4.4, -3.4, -12.799999999999999, -4.300000000000001, -4.2, -18.2, -5.300000000000001, -16.099999999999998, -27.2, -8.799999999999999, -4.4, -5.2, -19.7, -24.799999999999997, -8.4, -12.600000000000001, -4.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3288555798870345, "mean_inference_ms": 1.7158649601608855, "mean_action_processing_ms": 0.09596585017362676, "mean_env_wait_ms": 7.87486207886187, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 880000, "timesteps_this_iter": 0, "agent_timesteps_total": 880000, "timers": {"sample_time_ms": 26173.003, "sample_throughput": 152.829, "load_time_ms": 0.498, "load_throughput": 8029681.248, "learn_time_ms": 12569.419, "learn_throughput": 318.233, "update_time_ms": 2.434}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 0.12466649500432835, "policy_loss": -0.009934316154929899, "vf_loss": 13.440999252405218, "vf_explained_var": 0.21133928247677383, "kl": 0.0053607436790156044, "entropy": 0.19225268570646162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 880000, "num_agent_steps_sampled": 880000, "num_steps_trained": 880000, "num_agent_steps_trained": 880000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8888, "training_iteration": 220, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-30-40", "timestamp": 1643650240, "time_this_iter_s": 23.799787998199463, "time_total_s": 4913.00151515007, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4913.00151515007, "timesteps_since_restore": 0, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 44.90882352941176, "ram_util_percent": 62.27647058823531}}
{"episode_reward_max": -3.2, "episode_reward_min": -137.5, "episode_reward_mean": -11.986999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.799999999999999, -14.199999999999996, -6.2, -4.300000000000001, -11.2, -4.300000000000001, -137.5, -21.999999999999996, -3.3, -4.2, -4.300000000000001, -4.2, -4.300000000000001, -5.300000000000001, -5.4, -16.7, -4.5, -14.3, -5.2, -8.799999999999999, -4.4, -7.299999999999999, -6.1, -5.3, -4.2, -13.299999999999997, -51.29999999999999, -3.4, -21.2, -14.099999999999996, -18.0, -12.8, -10.799999999999999, -3.7, -3.3, -7.099999999999998, -10.3, -9.099999999999998, -22.800000000000008, -7.300000000000001, -7.6000000000000005, -3.4, -11.099999999999998, -4.4, -3.4, -12.799999999999999, -4.300000000000001, -4.2, -18.2, -5.300000000000001, -16.099999999999998, -27.2, -8.799999999999999, -4.4, -5.2, -19.7, -24.799999999999997, -8.4, -12.600000000000001, -4.3, -3.900000000000001, -14.499999999999996, -3.3, -10.200000000000001, -22.1, -19.60000000000004, -11.2, -3.2, -14.099999999999996, -16.799999999999997, -20.8, -4.300000000000001, -23.2, -5.3, -21.099999999999998, -3.3, -15.1, -21.9, -3.4, -4.5, -9.8, -5.4, -10.3, -8.2, -17.3, -25.2, -10.599999999999998, -3.3, -12.0, -15.2, -14.399999999999999, -9.3, -11.3, -8.3, -14.999999999999998, -8.8, -8.3, -9.3, -11.499999999999998, -11.399999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3290976041964218, "mean_inference_ms": 1.7163663479238824, "mean_action_processing_ms": 0.0959910434221597, "mean_env_wait_ms": 7.876657801433964, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 884000, "timesteps_this_iter": 0, "agent_timesteps_total": 884000, "timers": {"sample_time_ms": 26027.318, "sample_throughput": 153.685, "load_time_ms": 0.501, "load_throughput": 7987629.023, "learn_time_ms": 12533.879, "learn_throughput": 319.135, "update_time_ms": 2.429}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 0.0763086925776455, "policy_loss": -0.021940937667324016, "vf_loss": 9.785715116736709, "vf_explained_var": 0.22942291331547562, "kl": 0.01102614081605203, "entropy": 0.21347434374914376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 884000, "num_agent_steps_sampled": 884000, "num_steps_trained": 884000, "num_agent_steps_trained": 884000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8928, "training_iteration": 221, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-31-02", "timestamp": 1643650262, "time_this_iter_s": 21.7882661819458, "time_total_s": 4934.789781332016, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4934.789781332016, "timesteps_since_restore": 0, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 37.3516129032258, "ram_util_percent": 62.29999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -83.3, "episode_reward_mean": -11.943999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.6000000000000005, -3.4, -11.099999999999998, -4.4, -3.4, -12.799999999999999, -4.300000000000001, -4.2, -18.2, -5.300000000000001, -16.099999999999998, -27.2, -8.799999999999999, -4.4, -5.2, -19.7, -24.799999999999997, -8.4, -12.600000000000001, -4.3, -3.900000000000001, -14.499999999999996, -3.3, -10.200000000000001, -22.1, -19.60000000000004, -11.2, -3.2, -14.099999999999996, -16.799999999999997, -20.8, -4.300000000000001, -23.2, -5.3, -21.099999999999998, -3.3, -15.1, -21.9, -3.4, -4.5, -9.8, -5.4, -10.3, -8.2, -17.3, -25.2, -10.599999999999998, -3.3, -12.0, -15.2, -14.399999999999999, -9.3, -11.3, -8.3, -14.999999999999998, -8.8, -8.3, -9.3, -11.499999999999998, -11.399999999999997, -5.300000000000001, -16.699999999999996, -12.899999999999999, -4.4, -13.4, -19.0, -83.3, -5.2, -5.2, -6.300000000000001, -17.499999999999996, -4.2, -5.6, -11.600000000000001, -10.1, -8.5, -6.6000000000000005, -13.299999999999985, -7.0, -11.2, -20.3, -12.2, -10.2, -11.7, -4.4, -14.7, -6.499999999999999, -12.200000000000001, -19.20000000000001, -20.299999999999994, -14.999999999999975, -4.300000000000001, -24.999999999999996, -15.2, -3.4, -23.300000000000004, -5.300000000000001, -4.2, -10.699999999999998, -16.099999999999994], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.328898553014335, "mean_inference_ms": 1.7160211502254037, "mean_action_processing_ms": 0.0959738788910127, "mean_env_wait_ms": 7.874831435830503, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 888000, "timesteps_this_iter": 0, "agent_timesteps_total": 888000, "timers": {"sample_time_ms": 25827.729, "sample_throughput": 154.872, "load_time_ms": 0.501, "load_throughput": 7987629.023, "learn_time_ms": 12285.828, "learn_throughput": 325.578, "update_time_ms": 2.492}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 0.20394459824648595, "policy_loss": -0.006926541643277291, "vf_loss": 21.065605440575588, "vf_explained_var": 0.26527557539683516, "kl": 0.006042613840826906, "entropy": 0.17677243440462057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 888000, "num_agent_steps_sampled": 888000, "num_steps_trained": 888000, "num_agent_steps_trained": 888000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8968, "training_iteration": 222, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-31-23", "timestamp": 1643650283, "time_this_iter_s": 20.89958620071411, "time_total_s": 4955.68936753273, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4955.68936753273, "timesteps_since_restore": 0, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 35.04333333333333, "ram_util_percent": 62.37000000000001}}
{"episode_reward_max": -3.2, "episode_reward_min": -100.40000000000015, "episode_reward_mean": -12.693000000000005, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.8, -5.4, -10.3, -8.2, -17.3, -25.2, -10.599999999999998, -3.3, -12.0, -15.2, -14.399999999999999, -9.3, -11.3, -8.3, -14.999999999999998, -8.8, -8.3, -9.3, -11.499999999999998, -11.399999999999997, -5.300000000000001, -16.699999999999996, -12.899999999999999, -4.4, -13.4, -19.0, -83.3, -5.2, -5.2, -6.300000000000001, -17.499999999999996, -4.2, -5.6, -11.600000000000001, -10.1, -8.5, -6.6000000000000005, -13.299999999999985, -7.0, -11.2, -20.3, -12.2, -10.2, -11.7, -4.4, -14.7, -6.499999999999999, -12.200000000000001, -19.20000000000001, -20.299999999999994, -14.999999999999975, -4.300000000000001, -24.999999999999996, -15.2, -3.4, -23.300000000000004, -5.300000000000001, -4.2, -10.699999999999998, -16.099999999999994, -5.300000000000001, -17.2, -3.2, -3.4, -7.300000000000001, -7.8, -16.299999999999997, -6.6000000000000005, -3.2, -11.7, -11.999999999999998, -17.500000000000004, -6.4, -5.2, -23.099999999999994, -13.600000000000001, -9.799999999999999, -11.2, -14.199999999999998, -14.6, -8.5, -15.899999999999999, -5.300000000000001, -100.40000000000015, -8.3, -11.999999999999998, -7.4, -25.7, -32.60000000000001, -4.3, -16.5, -4.2, -18.0, -4.2, -5.000000000000001, -12.099999999999998, -4.4, -6.4, -13.699999999999989, -8.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3283172098780827, "mean_inference_ms": 1.7153126840787494, "mean_action_processing_ms": 0.09593587124992521, "mean_env_wait_ms": 7.871172792615993, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 892000, "timesteps_this_iter": 0, "agent_timesteps_total": 892000, "timers": {"sample_time_ms": 25307.141, "sample_throughput": 158.058, "load_time_ms": 0.475, "load_throughput": 8414693.55, "learn_time_ms": 12025.334, "learn_throughput": 332.631, "update_time_ms": 2.602}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 0.35310655634084176, "policy_loss": -0.018002961209965168, "vf_loss": 37.06689173957353, "vf_explained_var": 0.20918081607869876, "kl": 0.01237824586917717, "entropy": 0.17713180923413846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 892000, "num_agent_steps_sampled": 892000, "num_steps_trained": 892000, "num_agent_steps_trained": 892000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9008, "training_iteration": 223, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-31-44", "timestamp": 1643650304, "time_this_iter_s": 20.79116702079773, "time_total_s": 4976.480534553528, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4976.480534553528, "timesteps_since_restore": 0, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 36.273333333333326, "ram_util_percent": 62.43000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -100.40000000000015, "episode_reward_mean": -11.641000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.3, -12.2, -10.2, -11.7, -4.4, -14.7, -6.499999999999999, -12.200000000000001, -19.20000000000001, -20.299999999999994, -14.999999999999975, -4.300000000000001, -24.999999999999996, -15.2, -3.4, -23.300000000000004, -5.300000000000001, -4.2, -10.699999999999998, -16.099999999999994, -5.300000000000001, -17.2, -3.2, -3.4, -7.300000000000001, -7.8, -16.299999999999997, -6.6000000000000005, -3.2, -11.7, -11.999999999999998, -17.500000000000004, -6.4, -5.2, -23.099999999999994, -13.600000000000001, -9.799999999999999, -11.2, -14.199999999999998, -14.6, -8.5, -15.899999999999999, -5.300000000000001, -100.40000000000015, -8.3, -11.999999999999998, -7.4, -25.7, -32.60000000000001, -4.3, -16.5, -4.2, -18.0, -4.2, -5.000000000000001, -12.099999999999998, -4.4, -6.4, -13.699999999999989, -8.4, -14.5, -3.3, -7.2, -7.800000000000001, -7.2, -3.2, -15.3, -5.2, -4.2, -16.700000000000003, -6.5, -4.300000000000001, -26.3, -4.300000000000001, -7.499999999999999, -3.2, -14.299999999999999, -7.2, -15.599999999999975, -3.2, -6.2, -12.2, -14.3, -17.700000000000003, -8.2, -3.4, -18.899999999999995, -10.9, -18.5, -10.399999999999999, -12.899999999999972, -20.799999999999997, -8.700000000000001, -3.3, -12.399999999999999, -3.4, -4.300000000000001, -5.2, -13.0, -5.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.327618047484338, "mean_inference_ms": 1.7145453267198314, "mean_action_processing_ms": 0.09589495353984429, "mean_env_wait_ms": 7.867565463997823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 896000, "timesteps_this_iter": 0, "agent_timesteps_total": 896000, "timers": {"sample_time_ms": 24691.068, "sample_throughput": 162.002, "load_time_ms": 0.472, "load_throughput": 8466072.564, "learn_time_ms": 11815.879, "learn_throughput": 338.528, "update_time_ms": 2.559}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 0.03439890545422351, "policy_loss": -0.029520838124857795, "vf_loss": 6.328874323957709, "vf_explained_var": 0.4053896809777906, "kl": 0.017726968894555405, "entropy": 0.18504085805146925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 896000, "num_agent_steps_sampled": 896000, "num_steps_trained": 896000, "num_agent_steps_trained": 896000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9048, "training_iteration": 224, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-32-05", "timestamp": 1643650325, "time_this_iter_s": 20.933866024017334, "time_total_s": 4997.414400577545, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4997.414400577545, "timesteps_since_restore": 0, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 39.80999999999999, "ram_util_percent": 62.45000000000002}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -177.3, "episode_reward_mean": -13.675999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.5, -15.899999999999999, -5.300000000000001, -100.40000000000015, -8.3, -11.999999999999998, -7.4, -25.7, -32.60000000000001, -4.3, -16.5, -4.2, -18.0, -4.2, -5.000000000000001, -12.099999999999998, -4.4, -6.4, -13.699999999999989, -8.4, -14.5, -3.3, -7.2, -7.800000000000001, -7.2, -3.2, -15.3, -5.2, -4.2, -16.700000000000003, -6.5, -4.300000000000001, -26.3, -4.300000000000001, -7.499999999999999, -3.2, -14.299999999999999, -7.2, -15.599999999999975, -3.2, -6.2, -12.2, -14.3, -17.700000000000003, -8.2, -3.4, -18.899999999999995, -10.9, -18.5, -10.399999999999999, -12.899999999999972, -20.799999999999997, -8.700000000000001, -3.3, -12.399999999999999, -3.4, -4.300000000000001, -5.2, -13.0, -5.300000000000001, -12.1, -8.700000000000001, -9.1, -23.799999999999997, -3.3, -10.199999999999994, -3.3, -8.3, -14.199999999999998, -3.3, -7.300000000000001, -21.3, -20.100000000000005, -3.2, -8.2, -11.8, -5.0, -22.4, -5.6, -177.3, -2.4000000000000004, -7.2, -4.2, -9.600000000000001, -10.6, -9.3, -6.1, -23.5, -93.09999999999991, -5.300000000000001, -21.9, -3.3, -12.6, -19.000000000000004, -5.300000000000001, -5.300000000000001, -8.3, -12.899999999999999, -15.1, -13.799999999999995], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.326893541746542, "mean_inference_ms": 1.7137616518444987, "mean_action_processing_ms": 0.09585274161995544, "mean_env_wait_ms": 7.864069167409404, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 900000, "timesteps_this_iter": 0, "agent_timesteps_total": 900000, "timers": {"sample_time_ms": 24078.235, "sample_throughput": 166.125, "load_time_ms": 0.473, "load_throughput": 8463083.132, "learn_time_ms": 11533.165, "learn_throughput": 346.826, "update_time_ms": 2.563}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03559570312499999, "cur_lr": 0.00010000000000000003, "total_loss": 1.2676825599396921, "policy_loss": -0.025181611621331784, "vf_loss": 129.20888050768966, "vf_explained_var": 0.02080286741256714, "kl": 0.021783743895000315, "entropy": 0.19772731795586565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 900000, "num_agent_steps_sampled": 900000, "num_steps_trained": 900000, "num_agent_steps_trained": 900000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9088, "training_iteration": 225, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-32-25", "timestamp": 1643650345, "time_this_iter_s": 20.812408208847046, "time_total_s": 5018.226808786392, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5018.226808786392, "timesteps_since_restore": 0, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 35.46896551724139, "ram_util_percent": 62.489655172413805}}
{"episode_reward_max": -1.3, "episode_reward_min": -177.3, "episode_reward_mean": -12.479000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -12.2, -14.3, -17.700000000000003, -8.2, -3.4, -18.899999999999995, -10.9, -18.5, -10.399999999999999, -12.899999999999972, -20.799999999999997, -8.700000000000001, -3.3, -12.399999999999999, -3.4, -4.300000000000001, -5.2, -13.0, -5.300000000000001, -12.1, -8.700000000000001, -9.1, -23.799999999999997, -3.3, -10.199999999999994, -3.3, -8.3, -14.199999999999998, -3.3, -7.300000000000001, -21.3, -20.100000000000005, -3.2, -8.2, -11.8, -5.0, -22.4, -5.6, -177.3, -2.4000000000000004, -7.2, -4.2, -9.600000000000001, -10.6, -9.3, -6.1, -23.5, -93.09999999999991, -5.300000000000001, -21.9, -3.3, -12.6, -19.000000000000004, -5.300000000000001, -5.300000000000001, -8.3, -12.899999999999999, -15.1, -13.799999999999995, -15.7, -11.9, -3.2, -13.899999999999999, -3.3, -19.800000000000004, -3.7000000000000006, -5.2, -1.3, -4.300000000000001, -24.00000000000002, -4.2, -4.300000000000001, -20.5, -7.600000000000001, -3.3, -7.699999999999999, -14.899999999999997, -4.4, -13.1, -14.699999999999998, -20.4, -3.2, -4.2, -10.899999999999993, -6.799999999999999, -12.0, -3.3, -4.300000000000001, -7.399999999999999, -21.1, -3.4, -5.1000000000000005, -4.300000000000001, -11.799999999999999, -5.300000000000001, -15.2, -10.5, -5.4, -15.0], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3261481886114808, "mean_inference_ms": 1.712922108323341, "mean_action_processing_ms": 0.09580753078335155, "mean_env_wait_ms": 7.860256880426116, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 904000, "timesteps_this_iter": 0, "agent_timesteps_total": 904000, "timers": {"sample_time_ms": 23186.08, "sample_throughput": 172.517, "load_time_ms": 0.485, "load_throughput": 8243522.013, "learn_time_ms": 11352.452, "learn_throughput": 352.347, "update_time_ms": 2.41}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 0.06633449731574904, "policy_loss": -0.015731357593309656, "vf_loss": 8.16131492978142, "vf_explained_var": 0.15473382767810617, "kl": 0.008478708410255727, "entropy": 0.19986273490132825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 904000, "num_agent_steps_sampled": 904000, "num_steps_trained": 904000, "num_agent_steps_trained": 904000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9128, "training_iteration": 226, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-32-47", "timestamp": 1643650367, "time_this_iter_s": 21.780805110931396, "time_total_s": 5040.007613897324, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5040.007613897324, "timesteps_since_restore": 0, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 45.47096774193548, "ram_util_percent": 62.5}}
{"episode_reward_max": -1.3, "episode_reward_min": -93.09999999999991, "episode_reward_mean": -10.776, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000004, -7.2, -4.2, -9.600000000000001, -10.6, -9.3, -6.1, -23.5, -93.09999999999991, -5.300000000000001, -21.9, -3.3, -12.6, -19.000000000000004, -5.300000000000001, -5.300000000000001, -8.3, -12.899999999999999, -15.1, -13.799999999999995, -15.7, -11.9, -3.2, -13.899999999999999, -3.3, -19.800000000000004, -3.7000000000000006, -5.2, -1.3, -4.300000000000001, -24.00000000000002, -4.2, -4.300000000000001, -20.5, -7.600000000000001, -3.3, -7.699999999999999, -14.899999999999997, -4.4, -13.1, -14.699999999999998, -20.4, -3.2, -4.2, -10.899999999999993, -6.799999999999999, -12.0, -3.3, -4.300000000000001, -7.399999999999999, -21.1, -3.4, -5.1000000000000005, -4.300000000000001, -11.799999999999999, -5.300000000000001, -15.2, -10.5, -5.4, -15.0, -10.0, -9.8, -9.299999999999999, -19.299999999999997, -7.2, -6.300000000000001, -4.2, -7.399999999999999, -28.2, -24.1, -10.5, -6.299999999999999, -3.2, -18.199999999999992, -12.799999999999999, -24.20000000000001, -3.6000000000000005, -3.4, -4.300000000000001, -4.2, -6.299999999999999, -8.299999999999997, -4.300000000000001, -7.300000000000001, -26.800000000000004, -4.300000000000001, -5.799999999999999, -5.8999999999999995, -13.899999999999999, -14.600000000000001, -4.2, -27.4, -12.099999999999998, -5.300000000000001, -3.3, -9.499999999999998, -5.8999999999999995, -3.2, -26.5, -6.799999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.325380006865113, "mean_inference_ms": 1.7121906168392842, "mean_action_processing_ms": 0.09576748426170865, "mean_env_wait_ms": 7.856859046690722, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 908000, "timesteps_this_iter": 0, "agent_timesteps_total": 908000, "timers": {"sample_time_ms": 22552.609, "sample_throughput": 177.363, "load_time_ms": 0.485, "load_throughput": 8250819.317, "learn_time_ms": 11282.556, "learn_throughput": 354.53, "update_time_ms": 2.428}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 0.1391708324833583, "policy_loss": -0.012399628367875852, "vf_loss": 15.087149566668336, "vf_explained_var": 0.1036053506917851, "kl": 0.013090924206224711, "entropy": 0.22375578003064278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 908000, "num_agent_steps_sampled": 908000, "num_steps_trained": 908000, "num_agent_steps_trained": 908000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9168, "training_iteration": 227, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-33-09", "timestamp": 1643650389, "time_this_iter_s": 21.659588098526, "time_total_s": 5061.66720199585, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5061.66720199585, "timesteps_since_restore": 0, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 34.08709677419355, "ram_util_percent": 62.47741935483873}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.09999999999996, "episode_reward_mean": -10.962, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.899999999999993, -6.799999999999999, -12.0, -3.3, -4.300000000000001, -7.399999999999999, -21.1, -3.4, -5.1000000000000005, -4.300000000000001, -11.799999999999999, -5.300000000000001, -15.2, -10.5, -5.4, -15.0, -10.0, -9.8, -9.299999999999999, -19.299999999999997, -7.2, -6.300000000000001, -4.2, -7.399999999999999, -28.2, -24.1, -10.5, -6.299999999999999, -3.2, -18.199999999999992, -12.799999999999999, -24.20000000000001, -3.6000000000000005, -3.4, -4.300000000000001, -4.2, -6.299999999999999, -8.299999999999997, -4.300000000000001, -7.300000000000001, -26.800000000000004, -4.300000000000001, -5.799999999999999, -5.8999999999999995, -13.899999999999999, -14.600000000000001, -4.2, -27.4, -12.099999999999998, -5.300000000000001, -3.3, -9.499999999999998, -5.8999999999999995, -3.2, -26.5, -6.799999999999999, -8.999999999999998, -8.599999999999998, -4.2, -4.2, -10.3, -16.6, -6.5, -33.09999999999996, -15.299999999999999, -4.4, -13.09999999999999, -29.3, -24.5, -3.3, -3.4000000000000004, -29.100000000000048, -3.3, -14.2, -9.7, -19.900000000000002, -19.4, -3.3, -18.1, -14.299999999999997, -3.4, -24.7, -3.4, -4.300000000000001, -19.3, -3.4, -4.4, -19.800000000000004, -3.3, -15.499999999999996, -11.3, -5.000000000000001, -19.5, -12.299999999999999, -17.800000000000004, -3.3, -4.2, -32.2, -3.2, -8.799999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.325602223383322, "mean_inference_ms": 1.711845107894647, "mean_action_processing_ms": 0.09582513529318437, "mean_env_wait_ms": 7.856182803337781, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 912000, "timesteps_this_iter": 0, "agent_timesteps_total": 912000, "timers": {"sample_time_ms": 22428.992, "sample_throughput": 178.341, "load_time_ms": 0.465, "load_throughput": 8607673.285, "learn_time_ms": 11190.787, "learn_throughput": 357.437, "update_time_ms": 2.437}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 0.1559861376681315, "policy_loss": -0.008599610318259527, "vf_loss": 16.407580039193554, "vf_explained_var": 0.28777811027342276, "kl": 0.009550825359985275, "entropy": 0.213762402558519, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 912000, "num_agent_steps_sampled": 912000, "num_steps_trained": 912000, "num_agent_steps_trained": 912000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9212, "training_iteration": 228, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-33-32", "timestamp": 1643650412, "time_this_iter_s": 22.898411989212036, "time_total_s": 5084.565613985062, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5084.565613985062, "timesteps_since_restore": 0, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 34.657575757575756, "ram_util_percent": 62.39999999999999}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -51.299999999999976, "episode_reward_mean": -11.469, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.800000000000004, -4.300000000000001, -5.799999999999999, -5.8999999999999995, -13.899999999999999, -14.600000000000001, -4.2, -27.4, -12.099999999999998, -5.300000000000001, -3.3, -9.499999999999998, -5.8999999999999995, -3.2, -26.5, -6.799999999999999, -8.999999999999998, -8.599999999999998, -4.2, -4.2, -10.3, -16.6, -6.5, -33.09999999999996, -15.299999999999999, -4.4, -13.09999999999999, -29.3, -24.5, -3.3, -3.4000000000000004, -29.100000000000048, -3.3, -14.2, -9.7, -19.900000000000002, -19.4, -3.3, -18.1, -14.299999999999997, -3.4, -24.7, -3.4, -4.300000000000001, -19.3, -3.4, -4.4, -19.800000000000004, -3.3, -15.499999999999996, -11.3, -5.000000000000001, -19.5, -12.299999999999999, -17.800000000000004, -3.3, -4.2, -32.2, -3.2, -8.799999999999999, -7.6000000000000005, -3.4, -18.4, -11.2, -6.199999999999999, -17.2, -18.5, -3.2, -8.4, -2.6000000000000005, -5.2, -10.799999999999999, -6.699999999999999, -2.900000000000001, -12.2, -23.9, -16.099999999999998, -3.2, -5.1, -17.000000000000004, -7.3999999999999995, -5.3, -9.0, -14.099999999999998, -22.5, -15.799999999999997, -17.10000000000002, -3.2, -51.299999999999976, -10.3, -4.2, -16.3, -12.699999999999998, -6.2, -4.300000000000001, -9.399999999999999, -10.3, -5.300000000000001, -7.2, -3.5000000000000004], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.325663142591095, "mean_inference_ms": 1.7116696408237935, "mean_action_processing_ms": 0.09583011148952444, "mean_env_wait_ms": 7.855439735161327, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 916000, "timesteps_this_iter": 0, "agent_timesteps_total": 916000, "timers": {"sample_time_ms": 21924.451, "sample_throughput": 182.445, "load_time_ms": 0.467, "load_throughput": 8558057.539, "learn_time_ms": 11027.46, "learn_throughput": 362.731, "update_time_ms": 2.489}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 0.16705756641133257, "policy_loss": -0.012761951572391935, "vf_loss": 17.91063012429463, "vf_explained_var": 0.12779935931646697, "kl": 0.0133577823378443, "entropy": 0.2152530842691019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 916000, "num_agent_steps_sampled": 916000, "num_steps_trained": 916000, "num_agent_steps_trained": 916000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9252, "training_iteration": 229, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-33-54", "timestamp": 1643650434, "time_this_iter_s": 21.810810089111328, "time_total_s": 5106.376424074173, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5106.376424074173, "timesteps_since_restore": 0, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 38.24516129032258, "ram_util_percent": 62.40000000000002}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -51.299999999999976, "episode_reward_mean": -10.146999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -24.7, -3.4, -4.300000000000001, -19.3, -3.4, -4.4, -19.800000000000004, -3.3, -15.499999999999996, -11.3, -5.000000000000001, -19.5, -12.299999999999999, -17.800000000000004, -3.3, -4.2, -32.2, -3.2, -8.799999999999999, -7.6000000000000005, -3.4, -18.4, -11.2, -6.199999999999999, -17.2, -18.5, -3.2, -8.4, -2.6000000000000005, -5.2, -10.799999999999999, -6.699999999999999, -2.900000000000001, -12.2, -23.9, -16.099999999999998, -3.2, -5.1, -17.000000000000004, -7.3999999999999995, -5.3, -9.0, -14.099999999999998, -22.5, -15.799999999999997, -17.10000000000002, -3.2, -51.299999999999976, -10.3, -4.2, -16.3, -12.699999999999998, -6.2, -4.300000000000001, -9.399999999999999, -10.3, -5.300000000000001, -7.2, -3.5000000000000004, -11.3, -4.300000000000001, -18.0, -8.799999999999999, -3.3, -6.300000000000001, -14.399999999999999, -3.3, -6.2, -14.8, -4.4, -9.9, -11.2, -16.9, -12.9, -7.1, -16.4, -6.300000000000001, -15.499999999999998, -3.3, -8.8, -8.9, -3.4, -4.4, -14.7, -5.799999999999999, -6.300000000000001, -6.300000000000001, -15.3, -3.3, -3.4, -6.999999999999999, -3.3, -18.3, -3.4, -4.300000000000001, -19.90000000000001, -3.3, -22.500000000000007, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3255118815582225, "mean_inference_ms": 1.7114027140666415, "mean_action_processing_ms": 0.09575758977515958, "mean_env_wait_ms": 7.85391760861551, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 920000, "timesteps_this_iter": 0, "agent_timesteps_total": 920000, "timers": {"sample_time_ms": 21658.904, "sample_throughput": 184.682, "load_time_ms": 0.482, "load_throughput": 8303908.137, "learn_time_ms": 11345.711, "learn_throughput": 352.556, "update_time_ms": 2.512}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 0.04383618106680011, "policy_loss": -0.008934107197759052, "vf_loss": 5.244343560229066, "vf_explained_var": 0.3428655482107593, "kl": 0.006121585619589491, "entropy": 0.18178281237681707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 920000, "num_agent_steps_sampled": 920000, "num_steps_trained": 920000, "num_agent_steps_trained": 920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9292, "training_iteration": 230, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-34-20", "timestamp": 1643650460, "time_this_iter_s": 25.965266942977905, "time_total_s": 5132.341691017151, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5132.341691017151, "timesteps_since_restore": 0, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 41.713513513513504, "ram_util_percent": 62.52162162162161}}
{"episode_reward_max": -3.2, "episode_reward_min": -51.299999999999976, "episode_reward_mean": -9.922, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.3999999999999995, -5.3, -9.0, -14.099999999999998, -22.5, -15.799999999999997, -17.10000000000002, -3.2, -51.299999999999976, -10.3, -4.2, -16.3, -12.699999999999998, -6.2, -4.300000000000001, -9.399999999999999, -10.3, -5.300000000000001, -7.2, -3.5000000000000004, -11.3, -4.300000000000001, -18.0, -8.799999999999999, -3.3, -6.300000000000001, -14.399999999999999, -3.3, -6.2, -14.8, -4.4, -9.9, -11.2, -16.9, -12.9, -7.1, -16.4, -6.300000000000001, -15.499999999999998, -3.3, -8.8, -8.9, -3.4, -4.4, -14.7, -5.799999999999999, -6.300000000000001, -6.300000000000001, -15.3, -3.3, -3.4, -6.999999999999999, -3.3, -18.3, -3.4, -4.300000000000001, -19.90000000000001, -3.3, -22.500000000000007, -3.2, -10.299999999999994, -6.1, -7.800000000000001, -4.4, -31.2, -3.4, -4.4, -6.300000000000001, -4.800000000000001, -3.3, -5.4, -12.3, -5.2, -4.2, -21.200000000000003, -24.6, -14.999999999999996, -16.9, -6.2, -15.100000000000001, -4.2, -4.2, -19.3, -24.10000000000001, -6.4, -10.799999999999999, -10.3, -5.300000000000001, -10.8, -3.2, -15.999999999999998, -4.300000000000001, -5.300000000000001, -5.4, -10.199999999999998, -19.7, -10.999999999999996, -8.4, -6.2, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.325913938257752, "mean_inference_ms": 1.7125169766904564, "mean_action_processing_ms": 0.09581307728785415, "mean_env_wait_ms": 7.858864323872765, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 924000, "timesteps_this_iter": 0, "agent_timesteps_total": 924000, "timers": {"sample_time_ms": 22510.49, "sample_throughput": 177.695, "load_time_ms": 0.499, "load_throughput": 8011659.424, "learn_time_ms": 11685.755, "learn_throughput": 342.297, "update_time_ms": 2.627}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 0.07174399828147744, "policy_loss": -0.00786630912453577, "vf_loss": 7.9126438170030555, "vf_explained_var": 0.30266292255411864, "kl": 0.009062373048653167, "entropy": 0.18411597050726414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 924000, "num_agent_steps_sampled": 924000, "num_steps_trained": 924000, "num_agent_steps_trained": 924000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9332, "training_iteration": 231, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-34-50", "timestamp": 1643650490, "time_this_iter_s": 30.504010915756226, "time_total_s": 5162.845701932907, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5162.845701932907, "timesteps_since_restore": 0, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 47.188372093023254, "ram_util_percent": 62.41395348837211}}
{"episode_reward_max": -2.7000000000000006, "episode_reward_min": -31.2, "episode_reward_mean": -9.988000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.8, -8.9, -3.4, -4.4, -14.7, -5.799999999999999, -6.300000000000001, -6.300000000000001, -15.3, -3.3, -3.4, -6.999999999999999, -3.3, -18.3, -3.4, -4.300000000000001, -19.90000000000001, -3.3, -22.500000000000007, -3.2, -10.299999999999994, -6.1, -7.800000000000001, -4.4, -31.2, -3.4, -4.4, -6.300000000000001, -4.800000000000001, -3.3, -5.4, -12.3, -5.2, -4.2, -21.200000000000003, -24.6, -14.999999999999996, -16.9, -6.2, -15.100000000000001, -4.2, -4.2, -19.3, -24.10000000000001, -6.4, -10.799999999999999, -10.3, -5.300000000000001, -10.8, -3.2, -15.999999999999998, -4.300000000000001, -5.300000000000001, -5.4, -10.199999999999998, -19.7, -10.999999999999996, -8.4, -6.2, -3.2, -10.3, -4.9, -11.3, -9.399999999999999, -13.3, -7.4, -2.7000000000000006, -9.799999999999999, -21.3, -6.9, -13.6, -11.6, -17.700000000000003, -17.500000000000004, -17.700000000000003, -6.0, -12.399999999999999, -10.899999999999999, -6.2, -11.599999999999998, -16.5, -21.90000000000001, -14.799999999999997, -19.19999999999999, -17.2, -10.299999999999999, -3.4, -27.20000000000001, -5.2, -11.5, -12.799999999999999, -5.3, -6.4, -3.6000000000000005, -10.8, -4.4, -9.899999999999999, -3.2, -4.300000000000001, -6.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3269812106817909, "mean_inference_ms": 1.7142299137237114, "mean_action_processing_ms": 0.09590536547577123, "mean_env_wait_ms": 7.867239308444542, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 928000, "timesteps_this_iter": 0, "agent_timesteps_total": 928000, "timers": {"sample_time_ms": 23161.978, "sample_throughput": 172.697, "load_time_ms": 0.547, "load_throughput": 7315752.845, "learn_time_ms": 11832.67, "learn_throughput": 338.047, "update_time_ms": 2.579}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 0.07364335979575351, "policy_loss": -0.012499562612864919, "vf_loss": 8.575076857689888, "vf_explained_var": 0.22309270411409357, "kl": 0.0073446595564185925, "entropy": 0.22743355264106105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 928000, "num_agent_steps_sampled": 928000, "num_steps_trained": 928000, "num_agent_steps_trained": 928000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9372, "training_iteration": 232, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-35-16", "timestamp": 1643650516, "time_this_iter_s": 25.48461604118347, "time_total_s": 5188.330317974091, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5188.330317974091, "timesteps_since_restore": 0, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 46.61388888888889, "ram_util_percent": 62.21666666666668}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -27.20000000000001, "episode_reward_mean": -10.358999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -4.2, -19.3, -24.10000000000001, -6.4, -10.799999999999999, -10.3, -5.300000000000001, -10.8, -3.2, -15.999999999999998, -4.300000000000001, -5.300000000000001, -5.4, -10.199999999999998, -19.7, -10.999999999999996, -8.4, -6.2, -3.2, -10.3, -4.9, -11.3, -9.399999999999999, -13.3, -7.4, -2.7000000000000006, -9.799999999999999, -21.3, -6.9, -13.6, -11.6, -17.700000000000003, -17.500000000000004, -17.700000000000003, -6.0, -12.399999999999999, -10.899999999999999, -6.2, -11.599999999999998, -16.5, -21.90000000000001, -14.799999999999997, -19.19999999999999, -17.2, -10.299999999999999, -3.4, -27.20000000000001, -5.2, -11.5, -12.799999999999999, -5.3, -6.4, -3.6000000000000005, -10.8, -4.4, -9.899999999999999, -3.2, -4.300000000000001, -6.2, -11.799999999999997, -8.5, -6.0, -15.599999999999973, -13.099999999999996, -4.3, -12.799999999999999, -7.800000000000001, -17.1, -20.5, -18.6, -7.9, -22.999999999999996, -12.6, -3.9000000000000004, -6.4, -6.300000000000001, -5.4999999999999964, -18.7, -14.099999999999996, -11.700000000000001, -14.899999999999997, -5.4, -4.2, -4.2, -4.300000000000001, -20.9, -15.999999999999998, -10.0, -16.3, -5.9, -4.2, -4.2, -6.4, -5.4, -10.3, -10.799999999999999, -2.6000000000000005, -14.0, -4.800000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3281073532888135, "mean_inference_ms": 1.7160060116493177, "mean_action_processing_ms": 0.09600795138931398, "mean_env_wait_ms": 7.875726337634519, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 932000, "timesteps_this_iter": 0, "agent_timesteps_total": 932000, "timers": {"sample_time_ms": 23675.977, "sample_throughput": 168.948, "load_time_ms": 0.58, "load_throughput": 6899093.675, "learn_time_ms": 12222.805, "learn_throughput": 327.257, "update_time_ms": 2.565}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 0.07954249077386433, "policy_loss": -0.012861337195280738, "vf_loss": 9.161142089738641, "vf_explained_var": 0.2594026439933367, "kl": 0.014840917718483648, "entropy": 0.19743092772300525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 932000, "num_agent_steps_sampled": 932000, "num_steps_trained": 932000, "num_agent_steps_trained": 932000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9412, "training_iteration": 233, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-35-44", "timestamp": 1643650544, "time_this_iter_s": 28.36865735054016, "time_total_s": 5216.698975324631, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5216.698975324631, "timesteps_since_restore": 0, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 50.699999999999996, "ram_util_percent": 62.26341463414634}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -62.2, "episode_reward_mean": -11.620000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.5, -21.90000000000001, -14.799999999999997, -19.19999999999999, -17.2, -10.299999999999999, -3.4, -27.20000000000001, -5.2, -11.5, -12.799999999999999, -5.3, -6.4, -3.6000000000000005, -10.8, -4.4, -9.899999999999999, -3.2, -4.300000000000001, -6.2, -11.799999999999997, -8.5, -6.0, -15.599999999999973, -13.099999999999996, -4.3, -12.799999999999999, -7.800000000000001, -17.1, -20.5, -18.6, -7.9, -22.999999999999996, -12.6, -3.9000000000000004, -6.4, -6.300000000000001, -5.4999999999999964, -18.7, -14.099999999999996, -11.700000000000001, -14.899999999999997, -5.4, -4.2, -4.2, -4.300000000000001, -20.9, -15.999999999999998, -10.0, -16.3, -5.9, -4.2, -4.2, -6.4, -5.4, -10.3, -10.799999999999999, -2.6000000000000005, -14.0, -4.800000000000001, -7.699999999999999, -4.700000000000001, -7.4, -23.4, -15.6, -5.2, -13.499999999999996, -12.5, -12.899999999999999, -30.500000000000004, -10.199999999999998, -20.4, -10.799999999999999, -6.899999999999999, -7.199999999999999, -19.3, -6.299999999999999, -11.099999999999977, -9.599999999999982, -5.4, -23.3, -15.3, -12.3, -3.2, -7.599999999999992, -49.4, -9.4, -4.4, -6.4, -6.0, -4.2, -28.9, -16.9, -62.2, -5.4, -19.6, -6.299999999999999, -3.4, -4.2, -7.8999999999999995], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.329348027384469, "mean_inference_ms": 1.7175679645067956, "mean_action_processing_ms": 0.0960985861980897, "mean_env_wait_ms": 7.882822931453469, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 936000, "timesteps_this_iter": 0, "agent_timesteps_total": 936000, "timers": {"sample_time_ms": 24423.55, "sample_throughput": 163.776, "load_time_ms": 0.583, "load_throughput": 6861285.784, "learn_time_ms": 12460.641, "learn_throughput": 321.011, "update_time_ms": 2.611}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 0.2754800707985577, "policy_loss": -0.014974730994592431, "vf_loss": 28.9788522284518, "vf_explained_var": -0.024537860001287153, "kl": 0.012478715406332504, "entropy": 0.23606353942905703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 936000, "num_agent_steps_sampled": 936000, "num_steps_trained": 936000, "num_agent_steps_trained": 936000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9452, "training_iteration": 234, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-36-11", "timestamp": 1643650571, "time_this_iter_s": 26.879193782806396, "time_total_s": 5243.578169107437, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5243.578169107437, "timesteps_since_restore": 0, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 49.271052631578954, "ram_util_percent": 62.300000000000026}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -196.5, "episode_reward_mean": -13.297999999999996, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.700000000000001, -14.899999999999997, -5.4, -4.2, -4.2, -4.300000000000001, -20.9, -15.999999999999998, -10.0, -16.3, -5.9, -4.2, -4.2, -6.4, -5.4, -10.3, -10.799999999999999, -2.6000000000000005, -14.0, -4.800000000000001, -7.699999999999999, -4.700000000000001, -7.4, -23.4, -15.6, -5.2, -13.499999999999996, -12.5, -12.899999999999999, -30.500000000000004, -10.199999999999998, -20.4, -10.799999999999999, -6.899999999999999, -7.199999999999999, -19.3, -6.299999999999999, -11.099999999999977, -9.599999999999982, -5.4, -23.3, -15.3, -12.3, -3.2, -7.599999999999992, -49.4, -9.4, -4.4, -6.4, -6.0, -4.2, -28.9, -16.9, -62.2, -5.4, -19.6, -6.299999999999999, -3.4, -4.2, -7.8999999999999995, -5.4, -196.5, -16.4, -9.099999999999998, -12.399999999999997, -5.6, -15.5, -14.8, -11.2, -7.3, -19.300000000000015, -7.5, -14.499999999999998, -15.199999999999998, -4.2, -6.2, -10.6, -19.400000000000002, -16.699999999999996, -3.8000000000000003, -3.3, -20.3, -10.1, -15.700000000000001, -4.300000000000001, -5.2, -17.900000000000006, -4.2, -23.1, -16.9, -3.2, -11.699999999999998, -12.299999999999994, -9.499999999999988, -5.300000000000001, -14.3, -11.4, -6.5, -3.3, -6.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3306551033496559, "mean_inference_ms": 1.7190868451651946, "mean_action_processing_ms": 0.09618360262307274, "mean_env_wait_ms": 7.88961241239351, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 940000, "timesteps_this_iter": 0, "agent_timesteps_total": 940000, "timers": {"sample_time_ms": 24982.12, "sample_throughput": 160.115, "load_time_ms": 0.579, "load_throughput": 6908184.139, "learn_time_ms": 12730.913, "learn_throughput": 314.196, "update_time_ms": 2.683}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 1.9792434474418281, "policy_loss": -0.006538466187894985, "vf_loss": 198.54961238855958, "vf_explained_var": -0.04446630112586483, "kl": 0.005354308718323569, "entropy": 0.20867337363381538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 940000, "num_agent_steps_sampled": 940000, "num_steps_trained": 940000, "num_agent_steps_trained": 940000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9492, "training_iteration": 235, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-36-38", "timestamp": 1643650598, "time_this_iter_s": 26.720378875732422, "time_total_s": 5270.29854798317, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5270.29854798317, "timesteps_since_restore": 0, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 43.550000000000004, "ram_util_percent": 62.2473684210526}}
{"episode_reward_max": -3.2, "episode_reward_min": -196.5, "episode_reward_mean": -14.120999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.3, -15.3, -12.3, -3.2, -7.599999999999992, -49.4, -9.4, -4.4, -6.4, -6.0, -4.2, -28.9, -16.9, -62.2, -5.4, -19.6, -6.299999999999999, -3.4, -4.2, -7.8999999999999995, -5.4, -196.5, -16.4, -9.099999999999998, -12.399999999999997, -5.6, -15.5, -14.8, -11.2, -7.3, -19.300000000000015, -7.5, -14.499999999999998, -15.199999999999998, -4.2, -6.2, -10.6, -19.400000000000002, -16.699999999999996, -3.8000000000000003, -3.3, -20.3, -10.1, -15.700000000000001, -4.300000000000001, -5.2, -17.900000000000006, -4.2, -23.1, -16.9, -3.2, -11.699999999999998, -12.299999999999994, -9.499999999999988, -5.300000000000001, -14.3, -11.4, -6.5, -3.3, -6.300000000000001, -12.3, -3.3, -6.999999999999998, -3.4, -5.2, -5.2, -4.300000000000001, -22.799999999999983, -19.2, -52.5, -9.3, -6.699999999999999, -9.599999999999996, -18.200000000000003, -13.2, -3.4, -15.299999999999997, -14.2, -3.3, -22.199999999999996, -4.300000000000001, -54.2, -9.600000000000001, -3.9000000000000004, -10.399999999999999, -11.3, -7.6, -12.799999999999999, -9.699999999999998, -11.9, -19.000000000000007, -11.7, -16.199999999999996, -20.100000000000023, -5.4, -4.2, -4.5, -3.8000000000000003, -19.700000000000003, -8.499999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3321975935254933, "mean_inference_ms": 1.7209154940360276, "mean_action_processing_ms": 0.09628091675073687, "mean_env_wait_ms": 7.898145852399252, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 944000, "timesteps_this_iter": 0, "agent_timesteps_total": 944000, "timers": {"sample_time_ms": 25786.74, "sample_throughput": 155.118, "load_time_ms": 0.562, "load_throughput": 7113209.531, "learn_time_ms": 13012.095, "learn_throughput": 307.406, "update_time_ms": 2.697}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 0.32565608188179473, "policy_loss": -0.014506404344192756, "vf_loss": 33.96408132378773, "vf_explained_var": -0.17303599651141832, "kl": 0.009770478197642382, "entropy": 0.20072337384185485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 944000, "num_agent_steps_sampled": 944000, "num_steps_trained": 944000, "num_agent_steps_trained": 944000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9532, "training_iteration": 236, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-37-08", "timestamp": 1643650628, "time_this_iter_s": 29.94349503517151, "time_total_s": 5300.242043018341, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5300.242043018341, "timesteps_since_restore": 0, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 50.33488372093022, "ram_util_percent": 62.365116279069774}}
{"episode_reward_max": -3.2, "episode_reward_min": -83.3, "episode_reward_mean": -13.731, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -20.3, -10.1, -15.700000000000001, -4.300000000000001, -5.2, -17.900000000000006, -4.2, -23.1, -16.9, -3.2, -11.699999999999998, -12.299999999999994, -9.499999999999988, -5.300000000000001, -14.3, -11.4, -6.5, -3.3, -6.300000000000001, -12.3, -3.3, -6.999999999999998, -3.4, -5.2, -5.2, -4.300000000000001, -22.799999999999983, -19.2, -52.5, -9.3, -6.699999999999999, -9.599999999999996, -18.200000000000003, -13.2, -3.4, -15.299999999999997, -14.2, -3.3, -22.199999999999996, -4.300000000000001, -54.2, -9.600000000000001, -3.9000000000000004, -10.399999999999999, -11.3, -7.6, -12.799999999999999, -9.699999999999998, -11.9, -19.000000000000007, -11.7, -16.199999999999996, -20.100000000000023, -5.4, -4.2, -4.5, -3.8000000000000003, -19.700000000000003, -8.499999999999998, -13.299999999999997, -9.5, -12.2, -22.500000000000032, -3.3, -4.2, -54.2, -16.099999999999998, -4.800000000000001, -3.5, -16.6, -8.2, -9.499999999999998, -17.199999999999996, -11.2, -49.2, -9.7, -3.2, -25.6, -10.999999999999998, -20.5, -9.799999999999999, -9.2, -3.3, -83.3, -51.3, -10.600000000000001, -7.800000000000001, -13.3, -23.200000000000035, -10.8, -19.5, -12.699999999999998, -6.300000000000001, -15.3, -4.4, -15.999999999999998, -15.799999999999999, -23.3, -7.499999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3335105396539115, "mean_inference_ms": 1.7229022920381356, "mean_action_processing_ms": 0.09638708521705462, "mean_env_wait_ms": 7.907561369368107, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 948000, "timesteps_this_iter": 0, "agent_timesteps_total": 948000, "timers": {"sample_time_ms": 26440.371, "sample_throughput": 151.284, "load_time_ms": 0.565, "load_throughput": 7082879.216, "learn_time_ms": 13567.202, "learn_throughput": 294.829, "update_time_ms": 2.784}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 0.5500299266309187, "policy_loss": -0.009034739068198589, "vf_loss": 55.85952602560802, "vf_explained_var": 0.0742889904847709, "kl": 0.008791598159731476, "entropy": 0.20410748021176425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 948000, "num_agent_steps_sampled": 948000, "num_steps_trained": 948000, "num_agent_steps_trained": 948000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9572, "training_iteration": 237, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-37-39", "timestamp": 1643650659, "time_this_iter_s": 30.928022861480713, "time_total_s": 5331.170065879822, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5331.170065879822, "timesteps_since_restore": 0, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 60.96590909090909, "ram_util_percent": 62.37727272727273}}
{"episode_reward_max": -2.3, "episode_reward_min": -120.2, "episode_reward_mean": -14.431999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.399999999999999, -11.3, -7.6, -12.799999999999999, -9.699999999999998, -11.9, -19.000000000000007, -11.7, -16.199999999999996, -20.100000000000023, -5.4, -4.2, -4.5, -3.8000000000000003, -19.700000000000003, -8.499999999999998, -13.299999999999997, -9.5, -12.2, -22.500000000000032, -3.3, -4.2, -54.2, -16.099999999999998, -4.800000000000001, -3.5, -16.6, -8.2, -9.499999999999998, -17.199999999999996, -11.2, -49.2, -9.7, -3.2, -25.6, -10.999999999999998, -20.5, -9.799999999999999, -9.2, -3.3, -83.3, -51.3, -10.600000000000001, -7.800000000000001, -13.3, -23.200000000000035, -10.8, -19.5, -12.699999999999998, -6.300000000000001, -15.3, -4.4, -15.999999999999998, -15.799999999999999, -23.3, -7.499999999999999, -4.300000000000001, -5.300000000000001, -21.60000000000003, -9.299999999999999, -46.00000000000002, -10.899999999999999, -3.2, -11.599999999999998, -19.2, -7.3, -19.900000000000006, -16.799999999999997, -3.3, -16.199999999999996, -3.2, -9.299999999999999, -4.6000000000000005, -3.3, -120.2, -65.49999999999994, -4.3, -6.999999999999999, -13.799999999999999, -3.2, -9.2, -2.3, -4.5, -9.3, -4.2, -7.999999999999998, -16.6, -9.0, -3.2, -6.199999999999998, -5.2, -9.599999999999998, -14.7, -4.0, -12.899999999999999, -14.2, -4.2, -11.1, -7.799999999999998, -11.999999999999996], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3356618811192627, "mean_inference_ms": 1.7254840186981752, "mean_action_processing_ms": 0.09659083210997213, "mean_env_wait_ms": 7.920395113188904, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 952000, "timesteps_this_iter": 0, "agent_timesteps_total": 952000, "timers": {"sample_time_ms": 27442.117, "sample_throughput": 145.761, "load_time_ms": 0.58, "load_throughput": 6901931.874, "learn_time_ms": 13890.386, "learn_throughput": 287.969, "update_time_ms": 2.806}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 1.0204279268015257, "policy_loss": -0.013675574988367096, "vf_loss": 103.32380804656654, "vf_explained_var": 0.01711169801732545, "kl": 0.01620890927240897, "entropy": 0.2072300200180341, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 952000, "num_agent_steps_sampled": 952000, "num_steps_trained": 952000, "num_agent_steps_trained": 952000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9616, "training_iteration": 238, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-38-10", "timestamp": 1643650690, "time_this_iter_s": 30.56259512901306, "time_total_s": 5361.732661008835, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5361.732661008835, "timesteps_since_restore": 0, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 55.409090909090885, "ram_util_percent": 62.17272727272726}}
{"episode_reward_max": -2.3, "episode_reward_min": -137.5, "episode_reward_mean": -17.261999999999997, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-83.3, -51.3, -10.600000000000001, -7.800000000000001, -13.3, -23.200000000000035, -10.8, -19.5, -12.699999999999998, -6.300000000000001, -15.3, -4.4, -15.999999999999998, -15.799999999999999, -23.3, -7.499999999999999, -4.300000000000001, -5.300000000000001, -21.60000000000003, -9.299999999999999, -46.00000000000002, -10.899999999999999, -3.2, -11.599999999999998, -19.2, -7.3, -19.900000000000006, -16.799999999999997, -3.3, -16.199999999999996, -3.2, -9.299999999999999, -4.6000000000000005, -3.3, -120.2, -65.49999999999994, -4.3, -6.999999999999999, -13.799999999999999, -3.2, -9.2, -2.3, -4.5, -9.3, -4.2, -7.999999999999998, -16.6, -9.0, -3.2, -6.199999999999998, -5.2, -9.599999999999998, -14.7, -4.0, -12.899999999999999, -14.2, -4.2, -11.1, -7.799999999999998, -11.999999999999996, -34.800000000000004, -26.800000000000004, -3.7, -93.19999999999989, -8.499999999999998, -6.300000000000001, -23.799999999999997, -11.399999999999997, -137.5, -8.799999999999999, -3.3, -21.6, -16.699999999999996, -3.4, -4.300000000000001, -5.300000000000001, -17.5, -16.6, -15.0, -18.0, -6.2, -74.89999999999995, -3.2, -44.4, -10.2, -14.399999999999999, -16.2, -8.3, -10.899999999999999, -7.899999999999998, -3.4, -4.300000000000001, -6.199999999999999, -12.599999999999994, -46.6, -22.3, -13.6, -3.3, -9.3, -12.89999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.337401656450797, "mean_inference_ms": 1.7276810118178856, "mean_action_processing_ms": 0.09671204332614475, "mean_env_wait_ms": 7.9304524188037995, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 956000, "timesteps_this_iter": 0, "agent_timesteps_total": 956000, "timers": {"sample_time_ms": 28119.017, "sample_throughput": 142.252, "load_time_ms": 0.597, "load_throughput": 6694818.835, "learn_time_ms": 14007.868, "learn_throughput": 285.554, "update_time_ms": 2.835}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 1.1479706813175712, "policy_loss": -0.011233237271086985, "vf_loss": 115.85779491880889, "vf_explained_var": -0.01003948200133539, "kl": 0.011724274656937636, "entropy": 0.18539342233730902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 956000, "num_agent_steps_sampled": 956000, "num_steps_trained": 956000, "num_agent_steps_trained": 956000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9656, "training_iteration": 239, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-38-36", "timestamp": 1643650716, "time_this_iter_s": 26.497653007507324, "time_total_s": 5388.230314016342, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5388.230314016342, "timesteps_since_restore": 0, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 49.818918918918925, "ram_util_percent": 62.19189189189186}}
{"episode_reward_max": -2.3, "episode_reward_min": -137.5, "episode_reward_mean": -14.449999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.2, -2.3, -4.5, -9.3, -4.2, -7.999999999999998, -16.6, -9.0, -3.2, -6.199999999999998, -5.2, -9.599999999999998, -14.7, -4.0, -12.899999999999999, -14.2, -4.2, -11.1, -7.799999999999998, -11.999999999999996, -34.800000000000004, -26.800000000000004, -3.7, -93.19999999999989, -8.499999999999998, -6.300000000000001, -23.799999999999997, -11.399999999999997, -137.5, -8.799999999999999, -3.3, -21.6, -16.699999999999996, -3.4, -4.300000000000001, -5.300000000000001, -17.5, -16.6, -15.0, -18.0, -6.2, -74.89999999999995, -3.2, -44.4, -10.2, -14.399999999999999, -16.2, -8.3, -10.899999999999999, -7.899999999999998, -3.4, -4.300000000000001, -6.199999999999999, -12.599999999999994, -46.6, -22.3, -13.6, -3.3, -9.3, -12.89999999999998, -26.90000000000001, -8.799999999999999, -4.9, -3.4000000000000004, -24.299999999999997, -19.5, -7.699999999999998, -7.2, -4.300000000000001, -9.799999999999999, -4.3, -10.2, -11.599999999999994, -9.899999999999999, -15.899999999999999, -8.9, -16.099999999999998, -12.299999999999997, -11.0, -16.699999999999996, -17.0, -6.299999999999999, -11.8, -16.9, -11.0, -15.899999999999999, -7.399999999999999, -3.3, -4.300000000000001, -21.199999999999996, -3.3, -49.2, -13.3, -11.2, -3.4000000000000004, -3.3, -4.2, -12.9, -5.799999999999999, -13.8], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3384752035237681, "mean_inference_ms": 1.7293111965185815, "mean_action_processing_ms": 0.09674220701035738, "mean_env_wait_ms": 7.937841785339283, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 960000, "timesteps_this_iter": 0, "agent_timesteps_total": 960000, "timers": {"sample_time_ms": 28463.077, "sample_throughput": 140.533, "load_time_ms": 0.583, "load_throughput": 6862689.083, "learn_time_ms": 13872.817, "learn_throughput": 288.334, "update_time_ms": 2.759}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 0.19846563013871352, "policy_loss": -0.013002329461416731, "vf_loss": 21.03640729688829, "vf_explained_var": 0.08964561505984235, "kl": 0.020674604692180343, "entropy": 0.24782808407019544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 960000, "num_agent_steps_sampled": 960000, "num_steps_trained": 960000, "num_agent_steps_trained": 960000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9696, "training_iteration": 240, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-39-03", "timestamp": 1643650743, "time_this_iter_s": 26.85909128189087, "time_total_s": 5415.089405298233, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5415.089405298233, "timesteps_since_restore": 0, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 48.15128205128205, "ram_util_percent": 62.335897435897444}}
{"episode_reward_max": -3.2, "episode_reward_min": -74.89999999999995, "episode_reward_mean": -13.075999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -74.89999999999995, -3.2, -44.4, -10.2, -14.399999999999999, -16.2, -8.3, -10.899999999999999, -7.899999999999998, -3.4, -4.300000000000001, -6.199999999999999, -12.599999999999994, -46.6, -22.3, -13.6, -3.3, -9.3, -12.89999999999998, -26.90000000000001, -8.799999999999999, -4.9, -3.4000000000000004, -24.299999999999997, -19.5, -7.699999999999998, -7.2, -4.300000000000001, -9.799999999999999, -4.3, -10.2, -11.599999999999994, -9.899999999999999, -15.899999999999999, -8.9, -16.099999999999998, -12.299999999999997, -11.0, -16.699999999999996, -17.0, -6.299999999999999, -11.8, -16.9, -11.0, -15.899999999999999, -7.399999999999999, -3.3, -4.300000000000001, -21.199999999999996, -3.3, -49.2, -13.3, -11.2, -3.4000000000000004, -3.3, -4.2, -12.9, -5.799999999999999, -13.8, -14.599999999999998, -7.4, -9.1, -12.599999999999998, -8.799999999999999, -7.300000000000001, -8.2, -7.3, -8.3, -11.899999999999999, -6.1000000000000005, -13.2, -4.4, -18.9, -5.3, -7.300000000000001, -11.700000000000001, -6.3, -7.1, -19.8, -24.3, -10.2, -12.899999999999999, -9.2, -22.2, -6.300000000000001, -8.3, -23.5, -9.3, -12.7, -13.600000000000001, -22.400000000000002, -60.3, -8.299999999999997, -7.099999999999999, -7.399999999999999, -12.299999999999997, -7.300000000000001, -19.800000000000004, -14.299999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3405825858030573, "mean_inference_ms": 1.7322929134182763, "mean_action_processing_ms": 0.09690561552195959, "mean_env_wait_ms": 7.952341331110424, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 964000, "timesteps_this_iter": 0, "agent_timesteps_total": 964000, "timers": {"sample_time_ms": 28774.7, "sample_throughput": 139.011, "load_time_ms": 0.609, "load_throughput": 6569253.299, "learn_time_ms": 14271.832, "learn_throughput": 280.272, "update_time_ms": 2.837}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.15318633642958937, "policy_loss": -0.009405245958897536, "vf_loss": 16.183308976696384, "vf_explained_var": 0.21644215115936855, "kl": 0.009470497486362844, "entropy": 0.22311349024054825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 964000, "num_agent_steps_sampled": 964000, "num_steps_trained": 964000, "num_agent_steps_trained": 964000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9736, "training_iteration": 241, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-39-42", "timestamp": 1643650782, "time_this_iter_s": 38.98414707183838, "time_total_s": 5454.073552370071, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5454.073552370071, "timesteps_since_restore": 0, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 53.136363636363626, "ram_util_percent": 62.27818181818182}}
{"episode_reward_max": -3.2, "episode_reward_min": -60.3, "episode_reward_mean": -12.758, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.0, -6.299999999999999, -11.8, -16.9, -11.0, -15.899999999999999, -7.399999999999999, -3.3, -4.300000000000001, -21.199999999999996, -3.3, -49.2, -13.3, -11.2, -3.4000000000000004, -3.3, -4.2, -12.9, -5.799999999999999, -13.8, -14.599999999999998, -7.4, -9.1, -12.599999999999998, -8.799999999999999, -7.300000000000001, -8.2, -7.3, -8.3, -11.899999999999999, -6.1000000000000005, -13.2, -4.4, -18.9, -5.3, -7.300000000000001, -11.700000000000001, -6.3, -7.1, -19.8, -24.3, -10.2, -12.899999999999999, -9.2, -22.2, -6.300000000000001, -8.3, -23.5, -9.3, -12.7, -13.600000000000001, -22.400000000000002, -60.3, -8.299999999999997, -7.099999999999999, -7.399999999999999, -12.299999999999997, -7.300000000000001, -19.800000000000004, -14.299999999999999, -13.099999999999996, -5.3, -12.2, -14.1, -18.699999999999996, -4.2, -16.299999999999997, -20.0, -6.999999999999998, -42.90000000000001, -11.4, -5.3, -3.2, -4.300000000000001, -8.9, -4.2, -6.2, -13.1, -20.2, -4.3, -46.2, -28.200000000000014, -12.799999999999997, -11.700000000000001, -4.3, -8.799999999999999, -15.8, -6.2, -6.300000000000001, -13.7, -17.3, -7.599999999999999, -12.899999999999999, -5.3, -12.7, -25.10000000000003, -31.000000000000018, -7.3, -11.899999999999984, -13.0], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3435046807195028, "mean_inference_ms": 1.7361255260085608, "mean_action_processing_ms": 0.09712030233112913, "mean_env_wait_ms": 7.971703577492729, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 968000, "timesteps_this_iter": 0, "agent_timesteps_total": 968000, "timers": {"sample_time_ms": 29624.799, "sample_throughput": 135.022, "load_time_ms": 0.624, "load_throughput": 6407185.793, "learn_time_ms": 14547.685, "learn_throughput": 274.958, "update_time_ms": 2.912}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.1654103173794205, "policy_loss": -0.012807427864441627, "vf_loss": 17.732085194126253, "vf_explained_var": 0.22708144034108807, "kl": 0.011198570298991663, "entropy": 0.2138822090882127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 968000, "num_agent_steps_sampled": 968000, "num_steps_trained": 968000, "num_agent_steps_trained": 968000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9776, "training_iteration": 242, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-40-15", "timestamp": 1643650815, "time_this_iter_s": 32.6814751625061, "time_total_s": 5486.7550275325775, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5486.7550275325775, "timesteps_since_restore": 0, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 52.36382978723405, "ram_util_percent": 61.882978723404285}}
{"episode_reward_max": -1.3, "episode_reward_min": -60.3, "episode_reward_mean": -13.120999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.3, -10.2, -12.899999999999999, -9.2, -22.2, -6.300000000000001, -8.3, -23.5, -9.3, -12.7, -13.600000000000001, -22.400000000000002, -60.3, -8.299999999999997, -7.099999999999999, -7.399999999999999, -12.299999999999997, -7.300000000000001, -19.800000000000004, -14.299999999999999, -13.099999999999996, -5.3, -12.2, -14.1, -18.699999999999996, -4.2, -16.299999999999997, -20.0, -6.999999999999998, -42.90000000000001, -11.4, -5.3, -3.2, -4.300000000000001, -8.9, -4.2, -6.2, -13.1, -20.2, -4.3, -46.2, -28.200000000000014, -12.799999999999997, -11.700000000000001, -4.3, -8.799999999999999, -15.8, -6.2, -6.300000000000001, -13.7, -17.3, -7.599999999999999, -12.899999999999999, -5.3, -12.7, -25.10000000000003, -31.000000000000018, -7.3, -11.899999999999984, -13.0, -5.300000000000001, -5.2, -6.2, -57.0, -9.399999999999997, -5.300000000000001, -22.3, -16.4, -18.2, -12.799999999999999, -7.300000000000001, -5.3, -8.8, -14.599999999999993, -12.0, -6.4, -2.2, -14.4, -15.099999999999998, -13.199999999999998, -27.5, -12.899999999999977, -23.6, -11.8, -13.399999999999999, -1.3, -4.3, -11.5, -9.499999999999998, -5.4, -4.3, -7.099999999999998, -17.2, -5.3, -9.100000000000001, -8.7, -8.6, -6.5, -8.599999999999998, -13.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3464656182502708, "mean_inference_ms": 1.7398331269072378, "mean_action_processing_ms": 0.09732696423532108, "mean_env_wait_ms": 7.98954636343384, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 972000, "timesteps_this_iter": 0, "agent_timesteps_total": 972000, "timers": {"sample_time_ms": 30140.452, "sample_throughput": 132.712, "load_time_ms": 0.602, "load_throughput": 6647864.643, "learn_time_ms": 14625.158, "learn_throughput": 273.501, "update_time_ms": 2.828}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.38211027133473824, "policy_loss": -0.006555955178825365, "vf_loss": 38.80020045823948, "vf_explained_var": 0.15477393557948452, "kl": 0.008293514745873759, "entropy": 0.21999036549560486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 972000, "num_agent_steps_sampled": 972000, "num_steps_trained": 972000, "num_agent_steps_trained": 972000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9816, "training_iteration": 243, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-40-46", "timestamp": 1643650846, "time_this_iter_s": 31.53618597984314, "time_total_s": 5518.291213512421, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5518.291213512421, "timesteps_since_restore": 0, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 56.76444444444444, "ram_util_percent": 61.8088888888889}}
{"episode_reward_max": -1.3, "episode_reward_min": -113.2, "episode_reward_mean": -12.885000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.2, -28.200000000000014, -12.799999999999997, -11.700000000000001, -4.3, -8.799999999999999, -15.8, -6.2, -6.300000000000001, -13.7, -17.3, -7.599999999999999, -12.899999999999999, -5.3, -12.7, -25.10000000000003, -31.000000000000018, -7.3, -11.899999999999984, -13.0, -5.300000000000001, -5.2, -6.2, -57.0, -9.399999999999997, -5.300000000000001, -22.3, -16.4, -18.2, -12.799999999999999, -7.300000000000001, -5.3, -8.8, -14.599999999999993, -12.0, -6.4, -2.2, -14.4, -15.099999999999998, -13.199999999999998, -27.5, -12.899999999999977, -23.6, -11.8, -13.399999999999999, -1.3, -4.3, -11.5, -9.499999999999998, -5.4, -4.3, -7.099999999999998, -17.2, -5.3, -9.100000000000001, -8.7, -8.6, -6.5, -8.599999999999998, -13.4, -6.300000000000001, -5.3, -4.2, -9.799999999999999, -10.9, -16.4, -3.2, -14.299999999999997, -4.3, -8.4, -5.3, -5.300000000000001, -22.6, -2.4000000000000004, -11.200000000000001, -3.4, -12.899999999999999, -25.200000000000028, -9.6, -10.9, -113.2, -5.4, -26.00000000000001, -8.5, -18.2, -9.000000000000002, -4.6000000000000005, -5.4, -2.6000000000000005, -21.199999999999996, -7.999999999999998, -11.699999999999996, -20.6, -41.3, -4.3, -11.999999999999998, -4.3, -5.4, -5.2, -4.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3484136540145346, "mean_inference_ms": 1.7422454813753205, "mean_action_processing_ms": 0.09745789291753663, "mean_env_wait_ms": 8.000788832699765, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 976000, "timesteps_this_iter": 0, "agent_timesteps_total": 976000, "timers": {"sample_time_ms": 30202.864, "sample_throughput": 132.438, "load_time_ms": 0.603, "load_throughput": 6637869.832, "learn_time_ms": 14456.982, "learn_throughput": 276.683, "update_time_ms": 2.831}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.18662544904497042, "policy_loss": -0.01698351800842311, "vf_loss": 20.272033698071716, "vf_explained_var": 0.22159960327609893, "kl": 0.011095362812902946, "entropy": 0.21135051145508726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 976000, "num_agent_steps_sampled": 976000, "num_steps_trained": 976000, "num_agent_steps_trained": 976000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9856, "training_iteration": 244, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-41-11", "timestamp": 1643650871, "time_this_iter_s": 25.045706033706665, "time_total_s": 5543.336919546127, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5543.336919546127, "timesteps_since_restore": 0, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 50.722857142857144, "ram_util_percent": 61.991428571428564}}
{"episode_reward_max": -1.3, "episode_reward_min": -113.2, "episode_reward_mean": -12.02, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.5, -12.899999999999977, -23.6, -11.8, -13.399999999999999, -1.3, -4.3, -11.5, -9.499999999999998, -5.4, -4.3, -7.099999999999998, -17.2, -5.3, -9.100000000000001, -8.7, -8.6, -6.5, -8.599999999999998, -13.4, -6.300000000000001, -5.3, -4.2, -9.799999999999999, -10.9, -16.4, -3.2, -14.299999999999997, -4.3, -8.4, -5.3, -5.300000000000001, -22.6, -2.4000000000000004, -11.200000000000001, -3.4, -12.899999999999999, -25.200000000000028, -9.6, -10.9, -113.2, -5.4, -26.00000000000001, -8.5, -18.2, -9.000000000000002, -4.6000000000000005, -5.4, -2.6000000000000005, -21.199999999999996, -7.999999999999998, -11.699999999999996, -20.6, -41.3, -4.3, -11.999999999999998, -4.3, -5.4, -5.2, -4.2, -9.8, -15.6, -4.2, -16.600000000000005, -10.4, -9.1, -15.2, -7.3, -11.1, -8.7, -10.2, -4.6000000000000005, -32.3, -5.2, -18.4, -4.700000000000001, -4.2, -7.300000000000001, -3.2, -13.3, -5.4, -5.6000000000000005, -4.4, -6.300000000000001, -7.1, -10.7, -19.5, -4.3, -15.3, -19.5, -9.7, -12.499999999999998, -22.3, -19.6, -13.1, -9.7, -8.5, -3.5, -18.2, -42.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3491890615744564, "mean_inference_ms": 1.7432662321745926, "mean_action_processing_ms": 0.0975137990573134, "mean_env_wait_ms": 8.005379970034147, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 980000, "timesteps_this_iter": 0, "agent_timesteps_total": 980000, "timers": {"sample_time_ms": 29828.037, "sample_throughput": 134.102, "load_time_ms": 0.637, "load_throughput": 6279603.249, "learn_time_ms": 14524.581, "learn_throughput": 275.395, "update_time_ms": 2.772}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.131344593986268, "policy_loss": -0.014753771445123099, "vf_loss": 14.526482262278115, "vf_explained_var": 0.17018554383708584, "kl": 0.010407563291751815, "entropy": 0.21965841439462477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 980000, "num_agent_steps_sampled": 980000, "num_steps_trained": 980000, "num_agent_steps_trained": 980000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9896, "training_iteration": 245, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-41-37", "timestamp": 1643650897, "time_this_iter_s": 25.324501991271973, "time_total_s": 5568.661421537399, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5568.661421537399, "timesteps_since_restore": 0, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 46.1945945945946, "ram_util_percent": 62.129729729729725}}
{"episode_reward_max": -2.4, "episode_reward_min": -113.2, "episode_reward_mean": -11.744000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113.2, -5.4, -26.00000000000001, -8.5, -18.2, -9.000000000000002, -4.6000000000000005, -5.4, -2.6000000000000005, -21.199999999999996, -7.999999999999998, -11.699999999999996, -20.6, -41.3, -4.3, -11.999999999999998, -4.3, -5.4, -5.2, -4.2, -9.8, -15.6, -4.2, -16.600000000000005, -10.4, -9.1, -15.2, -7.3, -11.1, -8.7, -10.2, -4.6000000000000005, -32.3, -5.2, -18.4, -4.700000000000001, -4.2, -7.300000000000001, -3.2, -13.3, -5.4, -5.6000000000000005, -4.4, -6.300000000000001, -7.1, -10.7, -19.5, -4.3, -15.3, -19.5, -9.7, -12.499999999999998, -22.3, -19.6, -13.1, -9.7, -8.5, -3.5, -18.2, -42.4, -12.5, -10.499999999999998, -18.2, -9.999999999999998, -12.5, -21.900000000000023, -32.800000000000004, -5.7, -2.6000000000000005, -3.6000000000000005, -5.8999999999999995, -10.7, -3.1, -3.3, -4.300000000000001, -11.599999999999998, -5.4, -10.7, -5.4, -11.2, -13.7, -5.5, -6.1, -21.3, -17.999999999999996, -4.300000000000001, -4.2, -6.2, -9.3, -5.4, -2.4000000000000004, -5.8999999999999995, -11.899999999999997, -17.2, -9.1, -12.899999999999986, -7.700000000000001, -3.8000000000000003, -5.1, -2.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3493289028683007, "mean_inference_ms": 1.743433587295793, "mean_action_processing_ms": 0.09752482009804521, "mean_env_wait_ms": 8.006167677013924, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 984000, "timesteps_this_iter": 0, "agent_timesteps_total": 984000, "timers": {"sample_time_ms": 29527.557, "sample_throughput": 135.467, "load_time_ms": 0.636, "load_throughput": 6293501.388, "learn_time_ms": 14192.949, "learn_throughput": 281.83, "update_time_ms": 2.725}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.1028358030884016, "policy_loss": -0.014193358867158813, "vf_loss": 11.621130875490046, "vf_explained_var": 0.18681362405900032, "kl": 0.01021166685602784, "entropy": 0.21440108478549988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 984000, "num_agent_steps_sampled": 984000, "num_steps_trained": 984000, "num_agent_steps_trained": 984000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9936, "training_iteration": 246, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-42-00", "timestamp": 1643650920, "time_this_iter_s": 22.92107391357422, "time_total_s": 5591.5824954509735, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5591.5824954509735, "timesteps_since_restore": 0, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 42.41875, "ram_util_percent": 62.21875}}
{"episode_reward_max": -2.4, "episode_reward_min": -91.0, "episode_reward_mean": -11.249999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -5.6000000000000005, -4.4, -6.300000000000001, -7.1, -10.7, -19.5, -4.3, -15.3, -19.5, -9.7, -12.499999999999998, -22.3, -19.6, -13.1, -9.7, -8.5, -3.5, -18.2, -42.4, -12.5, -10.499999999999998, -18.2, -9.999999999999998, -12.5, -21.900000000000023, -32.800000000000004, -5.7, -2.6000000000000005, -3.6000000000000005, -5.8999999999999995, -10.7, -3.1, -3.3, -4.300000000000001, -11.599999999999998, -5.4, -10.7, -5.4, -11.2, -13.7, -5.5, -6.1, -21.3, -17.999999999999996, -4.300000000000001, -4.2, -6.2, -9.3, -5.4, -2.4000000000000004, -5.8999999999999995, -11.899999999999997, -17.2, -9.1, -12.899999999999986, -7.700000000000001, -3.8000000000000003, -5.1, -2.4, -16.3, -15.999999999999998, -3.2, -4.300000000000001, -13.899999999999999, -3.3, -19.9, -3.2, -4.300000000000001, -10.2, -3.2, -5.4, -4.300000000000001, -16.900000000000002, -13.799999999999999, -7.699999999999999, -13.899999999999999, -14.3, -7.799999999999999, -10.2, -12.999999999999996, -8.5, -15.799999999999999, -12.799999999999997, -11.9, -10.5, -91.0, -13.299999999999999, -4.300000000000001, -9.4, -6.499999999999999, -10.099999999999998, -20.0, -3.3, -4.4, -26.700000000000003, -4.3, -9.6, -4.300000000000001, -21.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3495128965765368, "mean_inference_ms": 1.7438165718524812, "mean_action_processing_ms": 0.09754706628601671, "mean_env_wait_ms": 8.007959750151288, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 988000, "timesteps_this_iter": 0, "agent_timesteps_total": 988000, "timers": {"sample_time_ms": 29113.153, "sample_throughput": 137.395, "load_time_ms": 0.65, "load_throughput": 6155195.363, "learn_time_ms": 13820.812, "learn_throughput": 289.419, "update_time_ms": 2.672}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.2869983728374204, "policy_loss": -0.02023970537358314, "vf_loss": 30.648789172595546, "vf_explained_var": 0.08051089996932655, "kl": 0.009366859992458421, "entropy": 0.16803246625969487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 988000, "num_agent_steps_sampled": 988000, "num_steps_trained": 988000, "num_agent_steps_trained": 988000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9976, "training_iteration": 247, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-42-26", "timestamp": 1643650946, "time_this_iter_s": 26.407040119171143, "time_total_s": 5617.989535570145, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5617.989535570145, "timesteps_since_restore": 0, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 50.58947368421053, "ram_util_percent": 62.26578947368419}}
{"episode_reward_max": -1.3, "episode_reward_min": -91.0, "episode_reward_mean": -12.508999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.999999999999996, -4.300000000000001, -4.2, -6.2, -9.3, -5.4, -2.4000000000000004, -5.8999999999999995, -11.899999999999997, -17.2, -9.1, -12.899999999999986, -7.700000000000001, -3.8000000000000003, -5.1, -2.4, -16.3, -15.999999999999998, -3.2, -4.300000000000001, -13.899999999999999, -3.3, -19.9, -3.2, -4.300000000000001, -10.2, -3.2, -5.4, -4.300000000000001, -16.900000000000002, -13.799999999999999, -7.699999999999999, -13.899999999999999, -14.3, -7.799999999999999, -10.2, -12.999999999999996, -8.5, -15.799999999999999, -12.799999999999997, -11.9, -10.5, -91.0, -13.299999999999999, -4.300000000000001, -9.4, -6.499999999999999, -10.099999999999998, -20.0, -3.3, -4.4, -26.700000000000003, -4.3, -9.6, -4.300000000000001, -21.3, -28.800000000000004, -4.2, -16.2, -10.5, -7.3, -3.3, -16.6, -7.799999999999999, -15.2, -29.3, -44.900000000000006, -13.899999999999997, -3.2, -69.7, -5.2, -10.2, -9.2, -23.500000000000025, -3.2, -4.4, -16.4, -16.7, -4.2, -18.5, -5.300000000000001, -14.399999999999999, -13.999999999999996, -3.2, -11.9, -13.799999999999999, -18.900000000000006, -3.3, -18.5, -14.2, -57.2, -4.2, -13.6, -10.4, -9.100000000000001, -1.3, -8.3, -9.6, -3.2, -15.199999999999983], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3505969687958626, "mean_inference_ms": 1.7448108484554945, "mean_action_processing_ms": 0.09766495892654657, "mean_env_wait_ms": 8.013246280893497, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 992000, "timesteps_this_iter": 0, "agent_timesteps_total": 992000, "timers": {"sample_time_ms": 28475.139, "sample_throughput": 140.473, "load_time_ms": 0.636, "load_throughput": 6293737.48, "learn_time_ms": 13595.609, "learn_throughput": 294.213, "update_time_ms": 2.591}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.49084657640071205, "policy_loss": -0.012109613402556348, "vf_loss": 50.17278169649904, "vf_explained_var": 0.19641644031770766, "kl": 0.015337582000198762, "entropy": 0.18904870495360385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 992000, "num_agent_steps_sampled": 992000, "num_steps_trained": 992000, "num_agent_steps_trained": 992000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10020, "training_iteration": 248, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-42-52", "timestamp": 1643650972, "time_this_iter_s": 25.665244102478027, "time_total_s": 5643.654779672623, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5643.654779672623, "timesteps_since_restore": 0, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 47.08055555555555, "ram_util_percent": 62.186111111111096}}
{"episode_reward_max": -1.3, "episode_reward_min": -91.0, "episode_reward_mean": -12.857999999999997, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.9, -10.5, -91.0, -13.299999999999999, -4.300000000000001, -9.4, -6.499999999999999, -10.099999999999998, -20.0, -3.3, -4.4, -26.700000000000003, -4.3, -9.6, -4.300000000000001, -21.3, -28.800000000000004, -4.2, -16.2, -10.5, -7.3, -3.3, -16.6, -7.799999999999999, -15.2, -29.3, -44.900000000000006, -13.899999999999997, -3.2, -69.7, -5.2, -10.2, -9.2, -23.500000000000025, -3.2, -4.4, -16.4, -16.7, -4.2, -18.5, -5.300000000000001, -14.399999999999999, -13.999999999999996, -3.2, -11.9, -13.799999999999999, -18.900000000000006, -3.3, -18.5, -14.2, -57.2, -4.2, -13.6, -10.4, -9.100000000000001, -1.3, -8.3, -9.6, -3.2, -15.199999999999983, -26.3, -13.899999999999997, -10.699999999999998, -3.4, -17.8, -23.3, -6.2, -3.4, -10.8, -9.799999999999997, -13.699999999999998, -12.4, -3.2, -4.300000000000001, -7.399999999999999, -3.3, -18.4, -11.899999999999999, -7.599999999999999, -18.7, -3.8000000000000007, -4.2, -19.2, -6.3, -16.3, -3.2, -17.5, -15.3, -5.300000000000001, -4.300000000000001, -12.200000000000001, -7.2, -6.2, -8.299999999999997, -3.3, -6.2, -16.099999999999994, -7.8999999999999995, -3.3, -10.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3514277166508457, "mean_inference_ms": 1.7456399486194838, "mean_action_processing_ms": 0.09771046452764494, "mean_env_wait_ms": 8.01672572472501, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 996000, "timesteps_this_iter": 0, "agent_timesteps_total": 996000, "timers": {"sample_time_ms": 28066.456, "sample_throughput": 142.519, "load_time_ms": 0.63, "load_throughput": 6353802.689, "learn_time_ms": 13726.793, "learn_throughput": 291.401, "update_time_ms": 2.776}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.0808387700388188, "policy_loss": -0.013801644772531525, "vf_loss": 9.373727581834281, "vf_explained_var": 0.2746703834943874, "kl": 0.011276533754717986, "entropy": 0.17473849008480707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 996000, "num_agent_steps_sampled": 996000, "num_steps_trained": 996000, "num_agent_steps_trained": 996000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10060, "training_iteration": 249, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-43-18", "timestamp": 1643650998, "time_this_iter_s": 26.001256942749023, "time_total_s": 5669.656036615372, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5669.656036615372, "timesteps_since_restore": 0, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 52.397368421052626, "ram_util_percent": 62.20526315789474}}
{"episode_reward_max": -1.3, "episode_reward_min": -114.2, "episode_reward_mean": -12.316, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -14.399999999999999, -13.999999999999996, -3.2, -11.9, -13.799999999999999, -18.900000000000006, -3.3, -18.5, -14.2, -57.2, -4.2, -13.6, -10.4, -9.100000000000001, -1.3, -8.3, -9.6, -3.2, -15.199999999999983, -26.3, -13.899999999999997, -10.699999999999998, -3.4, -17.8, -23.3, -6.2, -3.4, -10.8, -9.799999999999997, -13.699999999999998, -12.4, -3.2, -4.300000000000001, -7.399999999999999, -3.3, -18.4, -11.899999999999999, -7.599999999999999, -18.7, -3.8000000000000007, -4.2, -19.2, -6.3, -16.3, -3.2, -17.5, -15.3, -5.300000000000001, -4.300000000000001, -12.200000000000001, -7.2, -6.2, -8.299999999999997, -3.3, -6.2, -16.099999999999994, -7.8999999999999995, -3.3, -10.3, -5.0, -114.2, -14.1, -15.3, -11.5, -3.2, -5.4, -6.6, -13.799999999999995, -13.399999999999999, -4.4, -14.3, -14.5, -14.299999999999997, -14.999999999999998, -13.0, -3.2, -11.899999999999999, -5.3, -7.299999999999999, -4.4, -12.7, -3.2, -9.2, -13.899999999999997, -16.5, -17.799999999999986, -18.3, -6.899999999999999, -4.3, -12.699999999999998, -3.7, -55.50000000000017, -19.60000000000003, -14.2, -16.199999999999996, -3.2, -16.5, -21.3, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3524247219641041, "mean_inference_ms": 1.7468095934703631, "mean_action_processing_ms": 0.09771946935588996, "mean_env_wait_ms": 8.02184286357247, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1000000, "timesteps_this_iter": 0, "agent_timesteps_total": 1000000, "timers": {"sample_time_ms": 28414.903, "sample_throughput": 140.771, "load_time_ms": 0.643, "load_throughput": 6219081.44, "learn_time_ms": 13716.326, "learn_throughput": 291.623, "update_time_ms": 2.879}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.7226590074867921, "policy_loss": -0.00820884594608659, "vf_loss": 73.02674317077924, "vf_explained_var": 0.0955692232296031, "kl": 0.007497206988442158, "entropy": 0.2019847407216026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1000000, "num_agent_steps_sampled": 1000000, "num_steps_trained": 1000000, "num_agent_steps_trained": 1000000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10100, "training_iteration": 250, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-43-47", "timestamp": 1643651027, "time_this_iter_s": 28.91920781135559, "time_total_s": 5698.575244426727, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5698.575244426727, "timesteps_since_restore": 0, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 57.8439024390244, "ram_util_percent": 62.08780487804878}}
{"episode_reward_max": -3.2, "episode_reward_min": -114.2, "episode_reward_mean": -12.333000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -4.2, -19.2, -6.3, -16.3, -3.2, -17.5, -15.3, -5.300000000000001, -4.300000000000001, -12.200000000000001, -7.2, -6.2, -8.299999999999997, -3.3, -6.2, -16.099999999999994, -7.8999999999999995, -3.3, -10.3, -5.0, -114.2, -14.1, -15.3, -11.5, -3.2, -5.4, -6.6, -13.799999999999995, -13.399999999999999, -4.4, -14.3, -14.5, -14.299999999999997, -14.999999999999998, -13.0, -3.2, -11.899999999999999, -5.3, -7.299999999999999, -4.4, -12.7, -3.2, -9.2, -13.899999999999997, -16.5, -17.799999999999986, -18.3, -6.899999999999999, -4.3, -12.699999999999998, -3.7, -55.50000000000017, -19.60000000000003, -14.2, -16.199999999999996, -3.2, -16.5, -21.3, -3.3, -3.7, -7.2, -11.799999999999997, -12.2, -15.599999999999998, -4.2, -4.2, -9.200000000000001, -12.099999999999998, -19.000000000000004, -22.600000000000005, -12.1, -13.5, -12.999999999999996, -5.3, -5.3, -18.6, -6.3, -9.7, -9.3, -7.300000000000001, -16.3, -13.8, -5.4, -6.400000000000001, -15.3, -3.2, -16.7, -5.799999999999999, -34.00000000000001, -15.999999999999998, -40.40000000000001, -4.9, -4.4, -3.3000000000000003, -15.59999999999998, -3.4, -22.3, -11.899999999999999, -16.499999999999996], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3536103767095753, "mean_inference_ms": 1.7483809201324307, "mean_action_processing_ms": 0.09781393351406889, "mean_env_wait_ms": 8.028410274094318, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1004000, "timesteps_this_iter": 0, "agent_timesteps_total": 1004000, "timers": {"sample_time_ms": 27740.211, "sample_throughput": 144.195, "load_time_ms": 0.601, "load_throughput": 6652873.344, "learn_time_ms": 13186.488, "learn_throughput": 303.341, "update_time_ms": 2.674}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.13230726967230239, "policy_loss": -0.01870279608254311, "vf_loss": 15.04109476920097, "vf_explained_var": 0.1375879942088999, "kl": 0.0074805705741102764, "entropy": 0.20942747003288678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1004000, "num_agent_steps_sampled": 1004000, "num_steps_trained": 1004000, "num_agent_steps_trained": 1004000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10140, "training_iteration": 251, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-44-14", "timestamp": 1643651054, "time_this_iter_s": 27.016119956970215, "time_total_s": 5725.5913643836975, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5725.5913643836975, "timesteps_since_restore": 0, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 54.034210526315796, "ram_util_percent": 61.97105263157895}}
{"episode_reward_max": -3.2, "episode_reward_min": -59.200000000000074, "episode_reward_mean": -12.532000000000005, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -12.7, -3.2, -9.2, -13.899999999999997, -16.5, -17.799999999999986, -18.3, -6.899999999999999, -4.3, -12.699999999999998, -3.7, -55.50000000000017, -19.60000000000003, -14.2, -16.199999999999996, -3.2, -16.5, -21.3, -3.3, -3.7, -7.2, -11.799999999999997, -12.2, -15.599999999999998, -4.2, -4.2, -9.200000000000001, -12.099999999999998, -19.000000000000004, -22.600000000000005, -12.1, -13.5, -12.999999999999996, -5.3, -5.3, -18.6, -6.3, -9.7, -9.3, -7.300000000000001, -16.3, -13.8, -5.4, -6.400000000000001, -15.3, -3.2, -16.7, -5.799999999999999, -34.00000000000001, -15.999999999999998, -40.40000000000001, -4.9, -4.4, -3.3000000000000003, -15.59999999999998, -3.4, -22.3, -11.899999999999999, -16.499999999999996, -29.2, -42.699999999999946, -18.2, -3.3, -6.300000000000001, -17.9, -3.3, -19.10000000000001, -10.3, -4.300000000000001, -13.4, -9.9, -12.7, -3.3, -12.600000000000001, -7.3, -18.500000000000004, -3.3, -18.3, -19.80000000000002, -12.299999999999995, -9.799999999999997, -4.5, -22.3, -9.799999999999997, -8.9, -5.3, -15.3, -8.8, -12.799999999999999, -12.299999999999999, -5.300000000000001, -3.2, -5.300000000000001, -7.5, -6.3, -4.4, -59.200000000000074, -9.8, -5.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3545590717738296, "mean_inference_ms": 1.7496648443765395, "mean_action_processing_ms": 0.09789709035472902, "mean_env_wait_ms": 8.03406291021514, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1008000, "timesteps_this_iter": 0, "agent_timesteps_total": 1008000, "timers": {"sample_time_ms": 26698.793, "sample_throughput": 149.82, "load_time_ms": 0.567, "load_throughput": 7055475.84, "learn_time_ms": 12964.31, "learn_throughput": 308.539, "update_time_ms": 2.587}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.14270736623595479, "policy_loss": -0.015422742384215517, "vf_loss": 15.69994421953796, "vf_explained_var": 0.1251733531234085, "kl": 0.014117453896094059, "entropy": 0.20776249737909405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1008000, "num_agent_steps_sampled": 1008000, "num_steps_trained": 1008000, "num_agent_steps_trained": 1008000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10180, "training_iteration": 252, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-44-40", "timestamp": 1643651080, "time_this_iter_s": 25.416933059692383, "time_total_s": 5751.00829744339, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5751.00829744339, "timesteps_since_restore": 0, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 49.54444444444445, "ram_util_percent": 61.92777777777778}}
{"episode_reward_max": -3.2, "episode_reward_min": -59.200000000000074, "episode_reward_mean": -11.592, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.300000000000001, -16.3, -13.8, -5.4, -6.400000000000001, -15.3, -3.2, -16.7, -5.799999999999999, -34.00000000000001, -15.999999999999998, -40.40000000000001, -4.9, -4.4, -3.3000000000000003, -15.59999999999998, -3.4, -22.3, -11.899999999999999, -16.499999999999996, -29.2, -42.699999999999946, -18.2, -3.3, -6.300000000000001, -17.9, -3.3, -19.10000000000001, -10.3, -4.300000000000001, -13.4, -9.9, -12.7, -3.3, -12.600000000000001, -7.3, -18.500000000000004, -3.3, -18.3, -19.80000000000002, -12.299999999999995, -9.799999999999997, -4.5, -22.3, -9.799999999999997, -8.9, -5.3, -15.3, -8.8, -12.799999999999999, -12.299999999999999, -5.300000000000001, -3.2, -5.300000000000001, -7.5, -6.3, -4.4, -59.200000000000074, -9.8, -5.2, -7.999999999999998, -10.0, -5.300000000000001, -17.4, -8.299999999999997, -17.599999999999998, -15.399999999999995, -6.4, -9.399999999999999, -7.4, -5.2, -11.999999999999996, -8.9, -3.3, -9.4, -4.300000000000001, -18.10000000000001, -8.2, -11.400000000000002, -20.9, -4.2, -12.699999999999998, -3.7, -17.1, -5.2, -7.2, -11.7, -3.3, -27.70000000000002, -11.599999999999998, -12.3, -11.5, -11.099999999999998, -11.2, -5.2, -5.2, -4.300000000000001, -4.4, -6.300000000000001, -11.499999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3554607581013152, "mean_inference_ms": 1.7508055629475059, "mean_action_processing_ms": 0.09796079151807469, "mean_env_wait_ms": 8.039103273078661, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1012000, "timesteps_this_iter": 0, "agent_timesteps_total": 1012000, "timers": {"sample_time_ms": 26272.324, "sample_throughput": 152.251, "load_time_ms": 0.563, "load_throughput": 7110797.66, "learn_time_ms": 12691.779, "learn_throughput": 315.165, "update_time_ms": 2.621}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.059758207918975945, "policy_loss": -0.012491361702722246, "vf_loss": 7.167085691325126, "vf_explained_var": 0.1798176094408958, "kl": 0.007225761149782578, "entropy": 0.17132112140697175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1012000, "num_agent_steps_sampled": 1012000, "num_steps_trained": 1012000, "num_agent_steps_trained": 1012000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10220, "training_iteration": 253, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-45-06", "timestamp": 1643651106, "time_this_iter_s": 26.764787912368774, "time_total_s": 5777.773085355759, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5777.773085355759, "timesteps_since_restore": 0, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 53.22105263157896, "ram_util_percent": 61.952631578947376}}
{"episode_reward_max": -3.2, "episode_reward_min": -59.200000000000074, "episode_reward_mean": -9.96, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.299999999999995, -9.799999999999997, -4.5, -22.3, -9.799999999999997, -8.9, -5.3, -15.3, -8.8, -12.799999999999999, -12.299999999999999, -5.300000000000001, -3.2, -5.300000000000001, -7.5, -6.3, -4.4, -59.200000000000074, -9.8, -5.2, -7.999999999999998, -10.0, -5.300000000000001, -17.4, -8.299999999999997, -17.599999999999998, -15.399999999999995, -6.4, -9.399999999999999, -7.4, -5.2, -11.999999999999996, -8.9, -3.3, -9.4, -4.300000000000001, -18.10000000000001, -8.2, -11.400000000000002, -20.9, -4.2, -12.699999999999998, -3.7, -17.1, -5.2, -7.2, -11.7, -3.3, -27.70000000000002, -11.599999999999998, -12.3, -11.5, -11.099999999999998, -11.2, -5.2, -5.2, -4.300000000000001, -4.4, -6.300000000000001, -11.499999999999998, -9.899999999999999, -32.500000000000014, -8.899999999999993, -3.2, -6.300000000000001, -3.3, -13.599999999999996, -3.2, -23.400000000000006, -3.3, -10.39999999999999, -3.3, -5.300000000000001, -12.3, -11.199999999999998, -6.1, -14.299999999999997, -3.3, -4.2, -12.5, -5.3, -3.3, -25.199999999999996, -5.3, -4.2, -10.7, -15.9, -5.5, -8.3, -11.999999999999998, -4.2, -5.300000000000001, -4.2, -15.5, -4.300000000000001, -15.899999999999999, -8.999999999999998, -15.199999999999998, -10.399999999999997, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3563625652503175, "mean_inference_ms": 1.7519540209774578, "mean_action_processing_ms": 0.09802426200073726, "mean_env_wait_ms": 8.044390426548304, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1016000, "timesteps_this_iter": 0, "agent_timesteps_total": 1016000, "timers": {"sample_time_ms": 25975.236, "sample_throughput": 153.993, "load_time_ms": 0.561, "load_throughput": 7124688.296, "learn_time_ms": 12958.219, "learn_throughput": 308.684, "update_time_ms": 2.615}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.054235247857067535, "policy_loss": -0.008388321647440553, "vf_loss": 6.150365709970075, "vf_explained_var": 0.4704515130930049, "kl": 0.013983125373780396, "entropy": 0.17614321006081438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1016000, "num_agent_steps_sampled": 1016000, "num_steps_trained": 1016000, "num_agent_steps_trained": 1016000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10260, "training_iteration": 254, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-45-34", "timestamp": 1643651134, "time_this_iter_s": 27.475918769836426, "time_total_s": 5805.249004125595, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5805.249004125595, "timesteps_since_restore": 0, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 55.352500000000006, "ram_util_percent": 62.017500000000005}}
{"episode_reward_max": -2.5, "episode_reward_min": -32.500000000000014, "episode_reward_mean": -10.072999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -12.699999999999998, -3.7, -17.1, -5.2, -7.2, -11.7, -3.3, -27.70000000000002, -11.599999999999998, -12.3, -11.5, -11.099999999999998, -11.2, -5.2, -5.2, -4.300000000000001, -4.4, -6.300000000000001, -11.499999999999998, -9.899999999999999, -32.500000000000014, -8.899999999999993, -3.2, -6.300000000000001, -3.3, -13.599999999999996, -3.2, -23.400000000000006, -3.3, -10.39999999999999, -3.3, -5.300000000000001, -12.3, -11.199999999999998, -6.1, -14.299999999999997, -3.3, -4.2, -12.5, -5.3, -3.3, -25.199999999999996, -5.3, -4.2, -10.7, -15.9, -5.5, -8.3, -11.999999999999998, -4.2, -5.300000000000001, -4.2, -15.5, -4.300000000000001, -15.899999999999999, -8.999999999999998, -15.199999999999998, -10.399999999999997, -3.2, -4.5, -3.2, -8.099999999999998, -3.3, -19.9, -19.8, -19.5, -8.3, -3.3, -6.2, -2.5, -6.800000000000001, -18.00000000000002, -15.799999999999999, -7.499999999999998, -13.7, -10.2, -3.3, -4.2, -3.3, -7.2, -29.40000000000002, -4.3, -4.300000000000001, -14.599999999999998, -14.299999999999999, -22.700000000000003, -4.4, -24.00000000000003, -4.9, -7.099999999999998, -16.3, -14.699999999999998, -23.3, -10.5, -13.899999999999999, -13.899999999999997, -4.300000000000001, -12.499999999999998, -18.499999999999996], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3577714252670838, "mean_inference_ms": 1.7537060898325136, "mean_action_processing_ms": 0.09812053304683105, "mean_env_wait_ms": 8.052718073666764, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1020000, "timesteps_this_iter": 0, "agent_timesteps_total": 1020000, "timers": {"sample_time_ms": 26732.025, "sample_throughput": 149.633, "load_time_ms": 0.574, "load_throughput": 6970756.191, "learn_time_ms": 13030.96, "learn_throughput": 306.961, "update_time_ms": 2.749}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.10404774871609744, "policy_loss": -0.015006337048465847, "vf_loss": 11.807849514868952, "vf_explained_var": 0.2349496252434228, "kl": 0.01218116379582279, "entropy": 0.2270582823102833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1020000, "num_agent_steps_sampled": 1020000, "num_steps_trained": 1020000, "num_agent_steps_trained": 1020000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10300, "training_iteration": 255, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-46-05", "timestamp": 1643651165, "time_this_iter_s": 30.951393127441406, "time_total_s": 5836.2003972530365, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5836.2003972530365, "timesteps_since_restore": 0, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 55.28181818181818, "ram_util_percent": 62.099999999999994}}
{"episode_reward_max": -2.5, "episode_reward_min": -65.70000000000003, "episode_reward_mean": -11.659, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3, -3.3, -25.199999999999996, -5.3, -4.2, -10.7, -15.9, -5.5, -8.3, -11.999999999999998, -4.2, -5.300000000000001, -4.2, -15.5, -4.300000000000001, -15.899999999999999, -8.999999999999998, -15.199999999999998, -10.399999999999997, -3.2, -4.5, -3.2, -8.099999999999998, -3.3, -19.9, -19.8, -19.5, -8.3, -3.3, -6.2, -2.5, -6.800000000000001, -18.00000000000002, -15.799999999999999, -7.499999999999998, -13.7, -10.2, -3.3, -4.2, -3.3, -7.2, -29.40000000000002, -4.3, -4.300000000000001, -14.599999999999998, -14.299999999999999, -22.700000000000003, -4.4, -24.00000000000003, -4.9, -7.099999999999998, -16.3, -14.699999999999998, -23.3, -10.5, -13.899999999999999, -13.899999999999997, -4.300000000000001, -12.499999999999998, -18.499999999999996, -11.1, -8.799999999999997, -14.199999999999998, -3.4, -4.2, -8.5, -3.3, -20.5, -22.2, -3.4, -26.1, -15.2, -3.2, -5.3, -45.2, -15.3, -4.3, -13.0, -65.70000000000003, -11.400000000000002, -18.799999999999997, -11.399999999999995, -20.099999999999998, -4.3, -8.9, -15.399999999999999, -10.5, -17.500000000000004, -4.3, -9.7, -15.1, -6.2, -16.2, -3.2, -13.9, -3.4, -23.2, -3.4, -23.400000000000006, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3594221117897798, "mean_inference_ms": 1.7561005736976523, "mean_action_processing_ms": 0.0982485499181767, "mean_env_wait_ms": 8.06399537070444, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1024000, "timesteps_this_iter": 0, "agent_timesteps_total": 1024000, "timers": {"sample_time_ms": 27280.91, "sample_throughput": 146.623, "load_time_ms": 0.586, "load_throughput": 6825555.736, "learn_time_ms": 13299.688, "learn_throughput": 300.759, "update_time_ms": 2.753}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.37281867414606507, "policy_loss": -0.004519769236425398, "vf_loss": 37.67356379326954, "vf_explained_var": 0.10637979475400781, "kl": 0.007526670264163098, "entropy": 0.2146713619671201, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1024000, "num_agent_steps_sampled": 1024000, "num_steps_trained": 1024000, "num_agent_steps_trained": 1024000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10340, "training_iteration": 256, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-46-35", "timestamp": 1643651195, "time_this_iter_s": 30.39976215362549, "time_total_s": 5866.600159406662, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5866.600159406662, "timesteps_since_restore": 0, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 54.84883720930232, "ram_util_percent": 62.12093023255812}}
{"episode_reward_max": -3.2, "episode_reward_min": -65.70000000000003, "episode_reward_mean": -13.825999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.2, -29.40000000000002, -4.3, -4.300000000000001, -14.599999999999998, -14.299999999999999, -22.700000000000003, -4.4, -24.00000000000003, -4.9, -7.099999999999998, -16.3, -14.699999999999998, -23.3, -10.5, -13.899999999999999, -13.899999999999997, -4.300000000000001, -12.499999999999998, -18.499999999999996, -11.1, -8.799999999999997, -14.199999999999998, -3.4, -4.2, -8.5, -3.3, -20.5, -22.2, -3.4, -26.1, -15.2, -3.2, -5.3, -45.2, -15.3, -4.3, -13.0, -65.70000000000003, -11.400000000000002, -18.799999999999997, -11.399999999999995, -20.099999999999998, -4.3, -8.9, -15.399999999999999, -10.5, -17.500000000000004, -4.3, -9.7, -15.1, -6.2, -16.2, -3.2, -13.9, -3.4, -23.2, -3.4, -23.400000000000006, -3.3, -20.9, -8.9, -3.3, -11.999999999999998, -16.299999999999997, -7.4, -12.600000000000001, -19.800000000000004, -6.5, -4.3, -14.3, -29.2, -12.399999999999999, -15.9, -55.3, -3.3, -9.799999999999999, -18.800000000000022, -6.6, -17.5, -4.300000000000001, -15.799999999999997, -13.1, -33.3, -16.4, -9.7, -20.2, -9.799999999999999, -3.3, -4.2, -11.1, -16.500000000000004, -4.300000000000001, -15.099999999999998, -8.299999999999997, -14.099999999999998, -13.299999999999972, -11.899999999999999, -4.1, -57.10000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3606236062255743, "mean_inference_ms": 1.7577526508380077, "mean_action_processing_ms": 0.09833561376962971, "mean_env_wait_ms": 8.07150770649246, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1028000, "timesteps_this_iter": 0, "agent_timesteps_total": 1028000, "timers": {"sample_time_ms": 27365.759, "sample_throughput": 146.168, "load_time_ms": 0.559, "load_throughput": 7158736.986, "learn_time_ms": 13215.995, "learn_throughput": 302.664, "update_time_ms": 2.768}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.2746793153725805, "policy_loss": -0.01151581557607779, "vf_loss": 28.554800312493438, "vf_explained_var": -0.014170122210697461, "kl": 0.008080060526938552, "entropy": 0.23104609446499938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1028000, "num_agent_steps_sampled": 1028000, "num_steps_trained": 1028000, "num_agent_steps_trained": 1028000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10380, "training_iteration": 257, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-46-59", "timestamp": 1643651219, "time_this_iter_s": 23.72088599205017, "time_total_s": 5890.321045398712, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5890.321045398712, "timesteps_since_restore": 0, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 42.311764705882354, "ram_util_percent": 62.10294117647059}}
{"episode_reward_max": -2.2, "episode_reward_min": -57.10000000000001, "episode_reward_mean": -12.570000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.9, -15.399999999999999, -10.5, -17.500000000000004, -4.3, -9.7, -15.1, -6.2, -16.2, -3.2, -13.9, -3.4, -23.2, -3.4, -23.400000000000006, -3.3, -20.9, -8.9, -3.3, -11.999999999999998, -16.299999999999997, -7.4, -12.600000000000001, -19.800000000000004, -6.5, -4.3, -14.3, -29.2, -12.399999999999999, -15.9, -55.3, -3.3, -9.799999999999999, -18.800000000000022, -6.6, -17.5, -4.300000000000001, -15.799999999999997, -13.1, -33.3, -16.4, -9.7, -20.2, -9.799999999999999, -3.3, -4.2, -11.1, -16.500000000000004, -4.300000000000001, -15.099999999999998, -8.299999999999997, -14.099999999999998, -13.299999999999972, -11.899999999999999, -4.1, -57.10000000000001, -12.3, -18.4, -3.4, -9.299999999999999, -7.9, -13.2, -13.5, -3.3, -51.50000000000001, -14.999999999999995, -10.9, -2.2, -13.799999999999997, -4.4, -6.300000000000001, -6.800000000000001, -12.2, -11.8, -5.800000000000001, -3.6000000000000005, -4.700000000000001, -4.300000000000001, -18.3, -8.7, -3.3, -5.300000000000001, -16.299999999999997, -10.2, -3.5, -3.5, -27.600000000000016, -3.3, -16.699999999999996, -7.1, -4.4, -15.3, -14.899999999999997, -8.2, -32.2, -12.7, -3.2, -23.900000000000006, -10.8, -14.399999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3613801050241825, "mean_inference_ms": 1.7583248503574709, "mean_action_processing_ms": 0.0984301276618972, "mean_env_wait_ms": 8.074873179525438, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1032000, "timesteps_this_iter": 0, "agent_timesteps_total": 1032000, "timers": {"sample_time_ms": 27101.258, "sample_throughput": 147.595, "load_time_ms": 0.592, "load_throughput": 6752753.472, "learn_time_ms": 13212.514, "learn_throughput": 302.743, "update_time_ms": 2.809}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.1725035163854319, "policy_loss": -0.0076354537720000875, "vf_loss": 17.951874216013056, "vf_explained_var": 0.03542129326892156, "kl": 0.007744149363645966, "entropy": 0.23759802580680897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1032000, "num_agent_steps_sampled": 1032000, "num_steps_trained": 1032000, "num_agent_steps_trained": 1032000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10424, "training_iteration": 258, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-47-23", "timestamp": 1643651243, "time_this_iter_s": 23.818578243255615, "time_total_s": 5914.139623641968, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5914.139623641968, "timesteps_since_restore": 0, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 39.06764705882353, "ram_util_percent": 62.11470588235293}}
{"episode_reward_max": -2.2, "episode_reward_min": -57.10000000000001, "episode_reward_mean": -11.132, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.4, -9.7, -20.2, -9.799999999999999, -3.3, -4.2, -11.1, -16.500000000000004, -4.300000000000001, -15.099999999999998, -8.299999999999997, -14.099999999999998, -13.299999999999972, -11.899999999999999, -4.1, -57.10000000000001, -12.3, -18.4, -3.4, -9.299999999999999, -7.9, -13.2, -13.5, -3.3, -51.50000000000001, -14.999999999999995, -10.9, -2.2, -13.799999999999997, -4.4, -6.300000000000001, -6.800000000000001, -12.2, -11.8, -5.800000000000001, -3.6000000000000005, -4.700000000000001, -4.300000000000001, -18.3, -8.7, -3.3, -5.300000000000001, -16.299999999999997, -10.2, -3.5, -3.5, -27.600000000000016, -3.3, -16.699999999999996, -7.1, -4.4, -15.3, -14.899999999999997, -8.2, -32.2, -12.7, -3.2, -23.900000000000006, -10.8, -14.399999999999999, -15.7, -7.0, -12.7, -16.9, -14.099999999999998, -4.3, -5.300000000000001, -5.300000000000001, -4.2, -4.300000000000001, -16.199999999999996, -3.4, -14.399999999999999, -26.6, -3.8000000000000003, -5.3, -11.499999999999998, -5.300000000000001, -14.6, -3.3, -7.699999999999998, -17.099999999999998, -4.4, -16.099999999999998, -11.899999999999999, -11.199999999999998, -3.3, -6.2, -12.299999999999994, -4.2, -6.899999999999999, -3.3, -4.4, -13.699999999999998, -3.3, -12.59999999999999, -4.2, -29.2, -11.2, -18.0], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3617858121957296, "mean_inference_ms": 1.758380502584377, "mean_action_processing_ms": 0.09843528946040586, "mean_env_wait_ms": 8.075018093552028, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1036000, "timesteps_this_iter": 0, "agent_timesteps_total": 1036000, "timers": {"sample_time_ms": 27062.591, "sample_throughput": 147.806, "load_time_ms": 0.577, "load_throughput": 6935599.835, "learn_time_ms": 12962.782, "learn_throughput": 308.576, "update_time_ms": 2.526}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.0824980090262108, "policy_loss": -0.006566887602250102, "vf_loss": 8.827207611837695, "vf_explained_var": 0.21433722626778387, "kl": 0.00989912486876589, "entropy": 0.20209059737702853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1036000, "num_agent_steps_sampled": 1036000, "num_steps_trained": 1036000, "num_agent_steps_trained": 1036000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10464, "training_iteration": 259, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-47-46", "timestamp": 1643651266, "time_this_iter_s": 23.146354913711548, "time_total_s": 5937.285978555679, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5937.285978555679, "timesteps_since_restore": 0, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 42.70606060606061, "ram_util_percent": 62.169696969696965}}
{"episode_reward_max": -1.3, "episode_reward_min": -33.000000000000014, "episode_reward_mean": -10.921000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -5.300000000000001, -16.299999999999997, -10.2, -3.5, -3.5, -27.600000000000016, -3.3, -16.699999999999996, -7.1, -4.4, -15.3, -14.899999999999997, -8.2, -32.2, -12.7, -3.2, -23.900000000000006, -10.8, -14.399999999999999, -15.7, -7.0, -12.7, -16.9, -14.099999999999998, -4.3, -5.300000000000001, -5.300000000000001, -4.2, -4.300000000000001, -16.199999999999996, -3.4, -14.399999999999999, -26.6, -3.8000000000000003, -5.3, -11.499999999999998, -5.300000000000001, -14.6, -3.3, -7.699999999999998, -17.099999999999998, -4.4, -16.099999999999998, -11.899999999999999, -11.199999999999998, -3.3, -6.2, -12.299999999999994, -4.2, -6.899999999999999, -3.3, -4.4, -13.699999999999998, -3.3, -12.59999999999999, -4.2, -29.2, -11.2, -18.0, -24.0, -30.3, -10.0, -7.1, -21.7, -5.1000000000000005, -4.3, -4.2, -10.499999999999998, -5.300000000000001, -7.399999999999999, -15.299999999999997, -4.9, -16.3, -12.899999999999999, -11.6, -6.8000000000000025, -10.9, -3.4, -13.899999999999999, -6.300000000000001, -4.4, -4.2, -21.2, -7.599999999999999, -4.2, -17.5, -7.300000000000001, -12.3, -3.4, -1.3, -18.799999999999994, -11.399999999999999, -8.600000000000001, -33.000000000000014, -24.69999999999999, -18.0, -6.199999999999999, -9.9, -13.699999999999996], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3618587907151687, "mean_inference_ms": 1.7581893519485905, "mean_action_processing_ms": 0.09836807041771388, "mean_env_wait_ms": 8.073908266096419, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1040000, "timesteps_this_iter": 0, "agent_timesteps_total": 1040000, "timers": {"sample_time_ms": 26351.452, "sample_throughput": 151.794, "load_time_ms": 0.57, "load_throughput": 7016232.854, "learn_time_ms": 12691.561, "learn_throughput": 315.17, "update_time_ms": 2.382}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.10340198564032714, "policy_loss": -0.007591743971551618, "vf_loss": 11.049061279463512, "vf_explained_var": 0.15434258381525676, "kl": 0.006281897246201116, "entropy": 0.21646734106764998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1040000, "num_agent_steps_sampled": 1040000, "num_steps_trained": 1040000, "num_agent_steps_trained": 1040000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10504, "training_iteration": 260, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-48-08", "timestamp": 1643651288, "time_this_iter_s": 21.616519927978516, "time_total_s": 5958.902498483658, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5958.902498483658, "timesteps_since_restore": 0, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 36.812903225806444, "ram_util_percent": 62.12258064516127}}
{"episode_reward_max": -1.3, "episode_reward_min": -67.4, "episode_reward_mean": -11.511, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.699999999999998, -17.099999999999998, -4.4, -16.099999999999998, -11.899999999999999, -11.199999999999998, -3.3, -6.2, -12.299999999999994, -4.2, -6.899999999999999, -3.3, -4.4, -13.699999999999998, -3.3, -12.59999999999999, -4.2, -29.2, -11.2, -18.0, -24.0, -30.3, -10.0, -7.1, -21.7, -5.1000000000000005, -4.3, -4.2, -10.499999999999998, -5.300000000000001, -7.399999999999999, -15.299999999999997, -4.9, -16.3, -12.899999999999999, -11.6, -6.8000000000000025, -10.9, -3.4, -13.899999999999999, -6.300000000000001, -4.4, -4.2, -21.2, -7.599999999999999, -4.2, -17.5, -7.300000000000001, -12.3, -3.4, -1.3, -18.799999999999994, -11.399999999999999, -8.600000000000001, -33.000000000000014, -24.69999999999999, -18.0, -6.199999999999999, -9.9, -13.699999999999996, -6.300000000000001, -3.7000000000000006, -3.2, -8.3, -5.0, -16.899999999999995, -10.699999999999998, -6.1, -14.3, -23.3, -3.4, -4.300000000000001, -13.899999999999999, -3.3, -4.300000000000001, -29.9, -15.399999999999999, -4.4, -3.3, -17.2, -10.999999999999998, -67.4, -19.0, -14.799999999999997, -6.199999999999999, -10.1, -10.599999999999984, -6.199999999999999, -4.300000000000001, -12.099999999999998, -34.49999999999998, -5.000000000000001, -15.199999999999998, -4.2, -14.2, -18.2, -4.300000000000001, -13.299999999999999, -16.9, -5.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3619662728573456, "mean_inference_ms": 1.7585635934151815, "mean_action_processing_ms": 0.0983765949946495, "mean_env_wait_ms": 8.074480289207346, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1044000, "timesteps_this_iter": 0, "agent_timesteps_total": 1044000, "timers": {"sample_time_ms": 25998.185, "sample_throughput": 153.857, "load_time_ms": 0.595, "load_throughput": 6725952.534, "learn_time_ms": 12593.247, "learn_throughput": 317.631, "update_time_ms": 2.448}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.35063213478418326, "policy_loss": -0.006024931370210583, "vf_loss": 35.6061334476676, "vf_explained_var": 0.14465556336987404, "kl": 0.007438346912014339, "entropy": 0.19933521346219124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1044000, "num_agent_steps_sampled": 1044000, "num_steps_trained": 1044000, "num_agent_steps_trained": 1044000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10544, "training_iteration": 261, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-48-33", "timestamp": 1643651313, "time_this_iter_s": 25.240517139434814, "time_total_s": 5984.143015623093, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5984.143015623093, "timesteps_since_restore": 0, "iterations_since_restore": 261, "perf": {"cpu_util_percent": 51.582857142857144, "ram_util_percent": 62.17714285714284}}
{"episode_reward_max": -1.3, "episode_reward_min": -104.6000000000001, "episode_reward_mean": -13.178000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.300000000000001, -4.4, -4.2, -21.2, -7.599999999999999, -4.2, -17.5, -7.300000000000001, -12.3, -3.4, -1.3, -18.799999999999994, -11.399999999999999, -8.600000000000001, -33.000000000000014, -24.69999999999999, -18.0, -6.199999999999999, -9.9, -13.699999999999996, -6.300000000000001, -3.7000000000000006, -3.2, -8.3, -5.0, -16.899999999999995, -10.699999999999998, -6.1, -14.3, -23.3, -3.4, -4.300000000000001, -13.899999999999999, -3.3, -4.300000000000001, -29.9, -15.399999999999999, -4.4, -3.3, -17.2, -10.999999999999998, -67.4, -19.0, -14.799999999999997, -6.199999999999999, -10.1, -10.599999999999984, -6.199999999999999, -4.300000000000001, -12.099999999999998, -34.49999999999998, -5.000000000000001, -15.199999999999998, -4.2, -14.2, -18.2, -4.300000000000001, -13.299999999999999, -16.9, -5.300000000000001, -4.3, -21.5, -13.6, -7.4, -12.599999999999998, -12.8, -25.3, -7.099999999999998, -4.4, -17.3, -9.799999999999999, -5.300000000000001, -16.2, -7.199999999999999, -8.2, -14.600000000000001, -13.999999999999998, -18.2, -14.799999999999999, -3.2, -21.599999999999998, -3.2, -12.2, -13.1, -15.999999999999998, -6.2, -44.3, -4.3, -17.3, -10.1, -16.699999999999996, -7.3, -7.300000000000001, -104.6000000000001, -10.1, -11.7, -6.9, -11.499999999999998, -6.199999999999999, -25.400000000000087], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3628902833681076, "mean_inference_ms": 1.7596336473694478, "mean_action_processing_ms": 0.09842470875861899, "mean_env_wait_ms": 8.07876447947791, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1048000, "timesteps_this_iter": 0, "agent_timesteps_total": 1048000, "timers": {"sample_time_ms": 26080.318, "sample_throughput": 153.372, "load_time_ms": 0.573, "load_throughput": 6980327.023, "learn_time_ms": 12592.762, "learn_throughput": 317.643, "update_time_ms": 2.432}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.5437364870212942, "policy_loss": -0.012293541514044328, "vf_loss": 55.50361262598345, "vf_explained_var": 0.16341132130674135, "kl": 0.012409988978323436, "entropy": 0.22814019107690423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1048000, "num_agent_steps_sampled": 1048000, "num_steps_trained": 1048000, "num_agent_steps_trained": 1048000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10584, "training_iteration": 262, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-49-00", "timestamp": 1643651340, "time_this_iter_s": 27.204617977142334, "time_total_s": 6011.347633600235, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6011.347633600235, "timesteps_since_restore": 0, "iterations_since_restore": 262, "perf": {"cpu_util_percent": 52.92307692307692, "ram_util_percent": 62.261538461538436}}
{"episode_reward_max": -3.2, "episode_reward_min": -127.49999999999991, "episode_reward_mean": -14.977, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.999999999999998, -67.4, -19.0, -14.799999999999997, -6.199999999999999, -10.1, -10.599999999999984, -6.199999999999999, -4.300000000000001, -12.099999999999998, -34.49999999999998, -5.000000000000001, -15.199999999999998, -4.2, -14.2, -18.2, -4.300000000000001, -13.299999999999999, -16.9, -5.300000000000001, -4.3, -21.5, -13.6, -7.4, -12.599999999999998, -12.8, -25.3, -7.099999999999998, -4.4, -17.3, -9.799999999999999, -5.300000000000001, -16.2, -7.199999999999999, -8.2, -14.600000000000001, -13.999999999999998, -18.2, -14.799999999999999, -3.2, -21.599999999999998, -3.2, -12.2, -13.1, -15.999999999999998, -6.2, -44.3, -4.3, -17.3, -10.1, -16.699999999999996, -7.3, -7.300000000000001, -104.6000000000001, -10.1, -11.7, -6.9, -11.499999999999998, -6.199999999999999, -25.400000000000087, -3.2, -11.3, -5.2, -8.7, -27.700000000000045, -7.000000000000001, -10.0, -3.3, -35.5, -3.3, -20.6, -8.700000000000001, -4.3, -4.300000000000001, -21.099999999999998, -11.099999999999998, -6.4, -8.9, -15.999999999999998, -14.099999999999998, -4.4, -8.500000000000002, -5.3, -15.599999999999998, -5.300000000000001, -9.4, -11.999999999999998, -8.5, -25.900000000000016, -12.9, -4.4, -127.49999999999991, -4.4, -71.60000000000002, -12.2, -6.799999999999999, -3.3, -23.500000000000036, -13.099999999999998, -5.800000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3639953319555702, "mean_inference_ms": 1.7608947373895956, "mean_action_processing_ms": 0.0984846379355397, "mean_env_wait_ms": 8.083835488337447, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1052000, "timesteps_this_iter": 0, "agent_timesteps_total": 1052000, "timers": {"sample_time_ms": 25954.059, "sample_throughput": 154.118, "load_time_ms": 0.627, "load_throughput": 6383295.666, "learn_time_ms": 12585.753, "learn_throughput": 317.82, "update_time_ms": 2.51}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.8887767490785649, "policy_loss": -0.013229848178584249, "vf_loss": 90.11832840442658, "vf_explained_var": -0.05316125635177858, "kl": 0.010279963214835099, "entropy": 0.21730190910479075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1052000, "num_agent_steps_sampled": 1052000, "num_steps_trained": 1052000, "num_agent_steps_trained": 1052000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10624, "training_iteration": 263, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-49-26", "timestamp": 1643651366, "time_this_iter_s": 25.452315092086792, "time_total_s": 6036.799948692322, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6036.799948692322, "timesteps_since_restore": 0, "iterations_since_restore": 263, "perf": {"cpu_util_percent": 52.5945945945946, "ram_util_percent": 62.25405405405408}}
{"episode_reward_max": -3.2, "episode_reward_min": -127.49999999999991, "episode_reward_mean": -13.961000000000004, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.599999999999998, -3.2, -12.2, -13.1, -15.999999999999998, -6.2, -44.3, -4.3, -17.3, -10.1, -16.699999999999996, -7.3, -7.300000000000001, -104.6000000000001, -10.1, -11.7, -6.9, -11.499999999999998, -6.199999999999999, -25.400000000000087, -3.2, -11.3, -5.2, -8.7, -27.700000000000045, -7.000000000000001, -10.0, -3.3, -35.5, -3.3, -20.6, -8.700000000000001, -4.3, -4.300000000000001, -21.099999999999998, -11.099999999999998, -6.4, -8.9, -15.999999999999998, -14.099999999999998, -4.4, -8.500000000000002, -5.3, -15.599999999999998, -5.300000000000001, -9.4, -11.999999999999998, -8.5, -25.900000000000016, -12.9, -4.4, -127.49999999999991, -4.4, -71.60000000000002, -12.2, -6.799999999999999, -3.3, -23.500000000000036, -13.099999999999998, -5.800000000000001, -6.300000000000001, -22.3, -10.2, -4.300000000000001, -15.3, -11.999999999999996, -4.300000000000001, -4.2, -12.399999999999999, -5.4, -4.5, -9.0, -4.300000000000001, -13.399999999999999, -5.3, -9.999999999999998, -14.2, -7.8, -13.499999999999998, -4.300000000000001, -18.2, -11.3, -24.3, -12.7, -5.300000000000001, -4.6000000000000005, -7.4, -14.599999999999978, -10.8, -16.5, -11.3, -5.2, -5.4, -13.799999999999997, -21.0, -4.2, -10.799999999999999, -14.7, -15.499999999999998, -18.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.364851377345809, "mean_inference_ms": 1.7620543867337808, "mean_action_processing_ms": 0.09855100507139863, "mean_env_wait_ms": 8.088832804857676, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1056000, "timesteps_this_iter": 0, "agent_timesteps_total": 1056000, "timers": {"sample_time_ms": 25970.282, "sample_throughput": 154.022, "load_time_ms": 0.644, "load_throughput": 6209184.308, "learn_time_ms": 12465.234, "learn_throughput": 320.892, "update_time_ms": 2.457}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.06874534175130388, "policy_loss": -0.015788856336987147, "vf_loss": 8.34783875929412, "vf_explained_var": 0.3254956824164237, "kl": 0.013182784591536233, "entropy": 0.20436000393763665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1056000, "num_agent_steps_sampled": 1056000, "num_steps_trained": 1056000, "num_agent_steps_trained": 1056000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10664, "training_iteration": 264, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-49-52", "timestamp": 1643651392, "time_this_iter_s": 26.480074167251587, "time_total_s": 6063.280022859573, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6063.280022859573, "timesteps_since_restore": 0, "iterations_since_restore": 264, "perf": {"cpu_util_percent": 50.740540540540536, "ram_util_percent": 62.302702702702724}}
{"episode_reward_max": -3.2, "episode_reward_min": -127.49999999999991, "episode_reward_mean": -12.649, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -8.500000000000002, -5.3, -15.599999999999998, -5.300000000000001, -9.4, -11.999999999999998, -8.5, -25.900000000000016, -12.9, -4.4, -127.49999999999991, -4.4, -71.60000000000002, -12.2, -6.799999999999999, -3.3, -23.500000000000036, -13.099999999999998, -5.800000000000001, -6.300000000000001, -22.3, -10.2, -4.300000000000001, -15.3, -11.999999999999996, -4.300000000000001, -4.2, -12.399999999999999, -5.4, -4.5, -9.0, -4.300000000000001, -13.399999999999999, -5.3, -9.999999999999998, -14.2, -7.8, -13.499999999999998, -4.300000000000001, -18.2, -11.3, -24.3, -12.7, -5.300000000000001, -4.6000000000000005, -7.4, -14.599999999999978, -10.8, -16.5, -11.3, -5.2, -5.4, -13.799999999999997, -21.0, -4.2, -10.799999999999999, -14.7, -15.499999999999998, -18.4, -19.7, -20.500000000000004, -3.3000000000000003, -4.2, -15.999999999999998, -11.799999999999999, -3.3, -10.999999999999998, -9.0, -9.600000000000001, -6.1, -3.3, -14.899999999999999, -3.7, -16.9, -3.4, -12.199999999999998, -25.3, -15.899999999999999, -6.300000000000001, -28.799999999999986, -3.4, -5.2, -9.3, -4.9, -19.3, -7.7, -3.2, -5.300000000000001, -12.700000000000001, -3.3, -8.700000000000001, -6.1, -5.300000000000001, -6.300000000000001, -15.499999999999998, -13.399999999999999, -51.2, -16.599999999999998, -12.899999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3653369713109487, "mean_inference_ms": 1.762913387401984, "mean_action_processing_ms": 0.0986002851345512, "mean_env_wait_ms": 8.092518397907085, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1060000, "timesteps_this_iter": 0, "agent_timesteps_total": 1060000, "timers": {"sample_time_ms": 25497.278, "sample_throughput": 156.879, "load_time_ms": 0.599, "load_throughput": 6683350.994, "learn_time_ms": 12285.566, "learn_throughput": 325.585, "update_time_ms": 2.421}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.15022113852162836, "policy_loss": -0.012252024232700307, "vf_loss": 16.184362014006542, "vf_explained_var": 0.22695728950603034, "kl": 0.007860447904092294, "entropy": 0.2160322056983107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1060000, "num_agent_steps_sampled": 1060000, "num_steps_trained": 1060000, "num_agent_steps_trained": 1060000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10704, "training_iteration": 265, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-50-18", "timestamp": 1643651418, "time_this_iter_s": 25.636932849884033, "time_total_s": 6088.916955709457, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6088.916955709457, "timesteps_since_restore": 0, "iterations_since_restore": 265, "perf": {"cpu_util_percent": 50.8027027027027, "ram_util_percent": 62.300000000000026}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -51.2, "episode_reward_mean": -11.239, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.2, -11.3, -24.3, -12.7, -5.300000000000001, -4.6000000000000005, -7.4, -14.599999999999978, -10.8, -16.5, -11.3, -5.2, -5.4, -13.799999999999997, -21.0, -4.2, -10.799999999999999, -14.7, -15.499999999999998, -18.4, -19.7, -20.500000000000004, -3.3000000000000003, -4.2, -15.999999999999998, -11.799999999999999, -3.3, -10.999999999999998, -9.0, -9.600000000000001, -6.1, -3.3, -14.899999999999999, -3.7, -16.9, -3.4, -12.199999999999998, -25.3, -15.899999999999999, -6.300000000000001, -28.799999999999986, -3.4, -5.2, -9.3, -4.9, -19.3, -7.7, -3.2, -5.300000000000001, -12.700000000000001, -3.3, -8.700000000000001, -6.1, -5.300000000000001, -6.300000000000001, -15.499999999999998, -13.399999999999999, -51.2, -16.599999999999998, -12.899999999999999, -13.2, -2.6000000000000005, -26.6, -4.4, -16.79999999999999, -5.2, -11.7, -10.100000000000001, -10.1, -19.09999999999999, -17.099999999999998, -15.8, -10.3, -6.300000000000001, -29.200000000000035, -11.8, -3.2, -13.8, -9.2, -4.4, -4.300000000000001, -24.700000000000006, -9.8, -10.2, -3.4, -14.899999999999999, -9.3, -9.7, -13.3, -6.3, -9.69999999999999, -4.4, -5.4, -3.5000000000000004, -7.3, -4.1, -5.300000000000001, -9.3, -13.3, -13.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3660410349917687, "mean_inference_ms": 1.763993057115033, "mean_action_processing_ms": 0.09865880628896537, "mean_env_wait_ms": 8.097445572438605, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1064000, "timesteps_this_iter": 0, "agent_timesteps_total": 1064000, "timers": {"sample_time_ms": 25118.988, "sample_throughput": 159.242, "load_time_ms": 0.592, "load_throughput": 6761189.651, "learn_time_ms": 12427.38, "learn_throughput": 321.87, "update_time_ms": 2.463}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.11367114911416686, "policy_loss": -0.009067951922895768, "vf_loss": 12.195717581305452, "vf_explained_var": 0.17732683272771937, "kl": 0.00976307948412373, "entropy": 0.20189796671752006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1064000, "num_agent_steps_sampled": 1064000, "num_steps_trained": 1064000, "num_agent_steps_trained": 1064000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10744, "training_iteration": 266, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-50-48", "timestamp": 1643651448, "time_this_iter_s": 29.816778898239136, "time_total_s": 6118.7337346076965, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6118.7337346076965, "timesteps_since_restore": 0, "iterations_since_restore": 266, "perf": {"cpu_util_percent": 57.19047619047619, "ram_util_percent": 62.30952380952381}}
{"episode_reward_max": -2.2, "episode_reward_min": -71.3, "episode_reward_mean": -12.229000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.799999999999986, -3.4, -5.2, -9.3, -4.9, -19.3, -7.7, -3.2, -5.300000000000001, -12.700000000000001, -3.3, -8.700000000000001, -6.1, -5.300000000000001, -6.300000000000001, -15.499999999999998, -13.399999999999999, -51.2, -16.599999999999998, -12.899999999999999, -13.2, -2.6000000000000005, -26.6, -4.4, -16.79999999999999, -5.2, -11.7, -10.100000000000001, -10.1, -19.09999999999999, -17.099999999999998, -15.8, -10.3, -6.300000000000001, -29.200000000000035, -11.8, -3.2, -13.8, -9.2, -4.4, -4.300000000000001, -24.700000000000006, -9.8, -10.2, -3.4, -14.899999999999999, -9.3, -9.7, -13.3, -6.3, -9.69999999999999, -4.4, -5.4, -3.5000000000000004, -7.3, -4.1, -5.300000000000001, -9.3, -13.3, -13.3, -21.1, -22.3, -7.9, -13.599999999999998, -17.900000000000006, -3.4, -28.1, -23.3, -23.900000000000006, -16.599999999999994, -6.300000000000001, -5.300000000000001, -10.699999999999998, -5.4, -4.4, -4.300000000000001, -71.3, -18.3, -9.7, -4.3, -14.0, -11.699999999999998, -11.599999999999998, -5.3, -16.5, -6.8999999999999995, -6.300000000000001, -12.3, -26.3, -13.7, -9.8, -3.3, -25.500000000000036, -5.0, -25.400000000000027, -9.3, -15.899999999999999, -14.499999999999998, -2.2, -7.8], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.366983394315068, "mean_inference_ms": 1.765325672140104, "mean_action_processing_ms": 0.0987292147902051, "mean_env_wait_ms": 8.103744389899902, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1068000, "timesteps_this_iter": 0, "agent_timesteps_total": 1068000, "timers": {"sample_time_ms": 25549.068, "sample_throughput": 156.561, "load_time_ms": 0.604, "load_throughput": 6624764.462, "learn_time_ms": 12329.304, "learn_throughput": 324.43, "update_time_ms": 2.39}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.3326965008391648, "policy_loss": -0.010980604802789066, "vf_loss": 34.30977456428671, "vf_explained_var": 0.08045993415258264, "kl": 0.007233957713880924, "entropy": 0.23125701695680617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1068000, "num_agent_steps_sampled": 1068000, "num_steps_trained": 1068000, "num_agent_steps_trained": 1068000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10784, "training_iteration": 267, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-51-14", "timestamp": 1643651474, "time_this_iter_s": 25.611202001571655, "time_total_s": 6144.344936609268, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6144.344936609268, "timesteps_since_restore": 0, "iterations_since_restore": 267, "perf": {"cpu_util_percent": 42.13243243243244, "ram_util_percent": 62.35945945945948}}
{"episode_reward_max": -2.2, "episode_reward_min": -72.5, "episode_reward_mean": -13.286999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -14.899999999999999, -9.3, -9.7, -13.3, -6.3, -9.69999999999999, -4.4, -5.4, -3.5000000000000004, -7.3, -4.1, -5.300000000000001, -9.3, -13.3, -13.3, -21.1, -22.3, -7.9, -13.599999999999998, -17.900000000000006, -3.4, -28.1, -23.3, -23.900000000000006, -16.599999999999994, -6.300000000000001, -5.300000000000001, -10.699999999999998, -5.4, -4.4, -4.300000000000001, -71.3, -18.3, -9.7, -4.3, -14.0, -11.699999999999998, -11.599999999999998, -5.3, -16.5, -6.8999999999999995, -6.300000000000001, -12.3, -26.3, -13.7, -9.8, -3.3, -25.500000000000036, -5.0, -25.400000000000027, -9.3, -15.899999999999999, -14.499999999999998, -2.2, -7.8, -8.9, -15.8, -8.599999999999998, -22.2, -11.2, -10.2, -5.5, -18.799999999999997, -18.7, -25.3, -24.5, -17.0, -6.2, -20.4, -8.2, -19.500000000000004, -17.7, -5.1, -6.2, -13.399999999999997, -4.7, -5.300000000000001, -22.9, -3.8000000000000003, -72.5, -19.10000000000001, -7.599999999999999, -7.699999999999998, -4.2, -10.899999999999999, -4.300000000000001, -4.300000000000001, -25.300000000000008, -12.2, -8.3, -19.2, -16.9, -16.8, -13.199999999999998, -32.3, -12.5, -12.8, -5.300000000000001, -9.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.368034342728391, "mean_inference_ms": 1.766233303381768, "mean_action_processing_ms": 0.0988412362392382, "mean_env_wait_ms": 8.108817358380088, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1072000, "timesteps_this_iter": 0, "agent_timesteps_total": 1072000, "timers": {"sample_time_ms": 25424.592, "sample_throughput": 157.328, "load_time_ms": 0.567, "load_throughput": 7053399.479, "learn_time_ms": 12164.389, "learn_throughput": 328.829, "update_time_ms": 2.332}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.4102083442782763, "policy_loss": -0.0050985458306968216, "vf_loss": 41.47571700452477, "vf_explained_var": 0.007018010013846941, "kl": 0.006863790749772575, "entropy": 0.23038336785249813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1072000, "num_agent_steps_sampled": 1072000, "num_steps_trained": 1072000, "num_agent_steps_trained": 1072000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10828, "training_iteration": 268, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-51-36", "timestamp": 1643651496, "time_this_iter_s": 21.89603900909424, "time_total_s": 6166.240975618362, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6166.240975618362, "timesteps_since_restore": 0, "iterations_since_restore": 268, "perf": {"cpu_util_percent": 36.81935483870968, "ram_util_percent": 62.241935483870975}}
{"episode_reward_max": -2.2, "episode_reward_min": -113.19999999999992, "episode_reward_mean": -13.87, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.5, -6.8999999999999995, -6.300000000000001, -12.3, -26.3, -13.7, -9.8, -3.3, -25.500000000000036, -5.0, -25.400000000000027, -9.3, -15.899999999999999, -14.499999999999998, -2.2, -7.8, -8.9, -15.8, -8.599999999999998, -22.2, -11.2, -10.2, -5.5, -18.799999999999997, -18.7, -25.3, -24.5, -17.0, -6.2, -20.4, -8.2, -19.500000000000004, -17.7, -5.1, -6.2, -13.399999999999997, -4.7, -5.300000000000001, -22.9, -3.8000000000000003, -72.5, -19.10000000000001, -7.599999999999999, -7.699999999999998, -4.2, -10.899999999999999, -4.300000000000001, -4.300000000000001, -25.300000000000008, -12.2, -8.3, -19.2, -16.9, -16.8, -13.199999999999998, -32.3, -12.5, -12.8, -5.300000000000001, -9.3, -4.9, -18.1, -4.2, -8.4, -5.2, -4.800000000000001, -36.3, -9.4, -17.3, -11.3, -7.300000000000001, -12.799999999999997, -7.4, -12.6, -7.999999999999998, -9.699999999999998, -11.999999999999998, -9.5, -10.600000000000001, -13.3, -9.099999999999998, -4.2, -4.2, -13.199999999999992, -6.0, -20.600000000000016, -4.300000000000001, -16.799999999999997, -6.3, -7.2, -16.9, -12.9, -10.6, -15.3, -5.3, -9.399999999999999, -113.19999999999992, -3.3, -16.4, -33.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3679729430453818, "mean_inference_ms": 1.766030267419047, "mean_action_processing_ms": 0.09882952526002121, "mean_env_wait_ms": 8.107420526832549, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1076000, "timesteps_this_iter": 0, "agent_timesteps_total": 1076000, "timers": {"sample_time_ms": 25036.695, "sample_throughput": 159.765, "load_time_ms": 0.565, "load_throughput": 7083178.249, "learn_time_ms": 12122.258, "learn_throughput": 329.972, "update_time_ms": 2.339}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.5138171100776182, "policy_loss": -0.017563009070813335, "vf_loss": 53.04394313212364, "vf_explained_var": 0.1886007018627659, "kl": 0.011745497133241092, "entropy": 0.240214957609292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1076000, "num_agent_steps_sampled": 1076000, "num_steps_trained": 1076000, "num_agent_steps_trained": 1076000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10868, "training_iteration": 269, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-51-56", "timestamp": 1643651516, "time_this_iter_s": 20.49734902381897, "time_total_s": 6186.738324642181, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6186.738324642181, "timesteps_since_restore": 0, "iterations_since_restore": 269, "perf": {"cpu_util_percent": 36.717241379310344, "ram_util_percent": 62.20000000000002}}
{"episode_reward_max": -3.3, "episode_reward_min": -113.19999999999992, "episode_reward_mean": -14.147, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72.5, -19.10000000000001, -7.599999999999999, -7.699999999999998, -4.2, -10.899999999999999, -4.300000000000001, -4.300000000000001, -25.300000000000008, -12.2, -8.3, -19.2, -16.9, -16.8, -13.199999999999998, -32.3, -12.5, -12.8, -5.300000000000001, -9.3, -4.9, -18.1, -4.2, -8.4, -5.2, -4.800000000000001, -36.3, -9.4, -17.3, -11.3, -7.300000000000001, -12.799999999999997, -7.4, -12.6, -7.999999999999998, -9.699999999999998, -11.999999999999998, -9.5, -10.600000000000001, -13.3, -9.099999999999998, -4.2, -4.2, -13.199999999999992, -6.0, -20.600000000000016, -4.300000000000001, -16.799999999999997, -6.3, -7.2, -16.9, -12.9, -10.6, -15.3, -5.3, -9.399999999999999, -113.19999999999992, -3.3, -16.4, -33.2, -10.5, -6.300000000000001, -20.3, -12.2, -46.5, -24.799999999999997, -8.1, -15.499999999999993, -19.3, -16.299999999999997, -11.5, -10.5, -14.6, -9.5, -12.0, -9.599999999999996, -7.599999999999998, -12.399999999999997, -17.099999999999984, -16.2, -26.2, -19.5, -5.3, -14.700000000000001, -10.399999999999999, -12.399999999999997, -13.5, -11.1, -11.799999999999997, -6.299999999999999, -11.6, -14.2, -13.399999999999999, -11.599999999999998, -4.300000000000001, -9.1, -4.999999999999999, -4.800000000000001, -15.3, -27.200000000000045], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.367442327972236, "mean_inference_ms": 1.765167472064113, "mean_action_processing_ms": 0.09872205365483593, "mean_env_wait_ms": 8.102529883910938, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1080000, "timesteps_this_iter": 0, "agent_timesteps_total": 1080000, "timers": {"sample_time_ms": 24898.79, "sample_throughput": 160.65, "load_time_ms": 0.553, "load_throughput": 7227508.724, "learn_time_ms": 12140.19, "learn_throughput": 329.484, "update_time_ms": 2.429}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.12593465825562836, "policy_loss": -0.01400326140104763, "vf_loss": 13.874066994523488, "vf_explained_var": 0.2362604978264019, "kl": 0.014948762217527103, "entropy": 0.26912933309232034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1080000, "num_agent_steps_sampled": 1080000, "num_steps_trained": 1080000, "num_agent_steps_trained": 1080000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10908, "training_iteration": 270, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-52-17", "timestamp": 1643651537, "time_this_iter_s": 20.792402029037476, "time_total_s": 6207.530726671219, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6207.530726671219, "timesteps_since_restore": 0, "iterations_since_restore": 270, "perf": {"cpu_util_percent": 37.97666666666667, "ram_util_percent": 62.22333333333334}}
{"episode_reward_max": -2.2, "episode_reward_min": -113.19999999999992, "episode_reward_mean": -13.685, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.099999999999998, -4.2, -4.2, -13.199999999999992, -6.0, -20.600000000000016, -4.300000000000001, -16.799999999999997, -6.3, -7.2, -16.9, -12.9, -10.6, -15.3, -5.3, -9.399999999999999, -113.19999999999992, -3.3, -16.4, -33.2, -10.5, -6.300000000000001, -20.3, -12.2, -46.5, -24.799999999999997, -8.1, -15.499999999999993, -19.3, -16.299999999999997, -11.5, -10.5, -14.6, -9.5, -12.0, -9.599999999999996, -7.599999999999998, -12.399999999999997, -17.099999999999984, -16.2, -26.2, -19.5, -5.3, -14.700000000000001, -10.399999999999999, -12.399999999999997, -13.5, -11.1, -11.799999999999997, -6.299999999999999, -11.6, -14.2, -13.399999999999999, -11.599999999999998, -4.300000000000001, -9.1, -4.999999999999999, -4.800000000000001, -15.3, -27.200000000000045, -11.899999999999999, -12.3, -2.2, -9.1, -4.3, -12.3, -29.100000000000026, -6.300000000000001, -5.800000000000001, -5.300000000000001, -8.299999999999997, -11.2, -22.2, -9.7, -3.3, -12.2, -11.699999999999998, -7.300000000000001, -18.799999999999997, -4.300000000000001, -22.1, -38.2, -15.999999999999998, -5.300000000000001, -5.2, -6.2, -11.399999999999997, -9.2, -20.400000000000013, -8.599999999999998, -9.5, -6.300000000000001, -7.199999999999999, -2.4000000000000004, -18.6, -5.3, -7.199999999999999, -6.4, -69.3, -9.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3669348625458235, "mean_inference_ms": 1.7645861657672717, "mean_action_processing_ms": 0.09869148353546317, "mean_env_wait_ms": 8.09878605170535, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1084000, "timesteps_this_iter": 0, "agent_timesteps_total": 1084000, "timers": {"sample_time_ms": 24752.541, "sample_throughput": 161.6, "load_time_ms": 0.525, "load_throughput": 7625660.652, "learn_time_ms": 12038.2, "learn_throughput": 332.276, "update_time_ms": 2.39}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.1915856632406533, "policy_loss": -0.02231141485509172, "vf_loss": 21.288673942832535, "vf_explained_var": 0.06151600108351759, "kl": 0.012615074895208328, "entropy": 0.22247460501328592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1084000, "num_agent_steps_sampled": 1084000, "num_steps_trained": 1084000, "num_agent_steps_trained": 1084000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10948, "training_iteration": 271, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-52-40", "timestamp": 1643651560, "time_this_iter_s": 22.572782039642334, "time_total_s": 6230.103508710861, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6230.103508710861, "timesteps_since_restore": 0, "iterations_since_restore": 271, "perf": {"cpu_util_percent": 40.81875, "ram_util_percent": 62.318749999999994}}
{"episode_reward_max": -2.2, "episode_reward_min": -86.2, "episode_reward_mean": -14.408000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.2, -19.5, -5.3, -14.700000000000001, -10.399999999999999, -12.399999999999997, -13.5, -11.1, -11.799999999999997, -6.299999999999999, -11.6, -14.2, -13.399999999999999, -11.599999999999998, -4.300000000000001, -9.1, -4.999999999999999, -4.800000000000001, -15.3, -27.200000000000045, -11.899999999999999, -12.3, -2.2, -9.1, -4.3, -12.3, -29.100000000000026, -6.300000000000001, -5.800000000000001, -5.300000000000001, -8.299999999999997, -11.2, -22.2, -9.7, -3.3, -12.2, -11.699999999999998, -7.300000000000001, -18.799999999999997, -4.300000000000001, -22.1, -38.2, -15.999999999999998, -5.300000000000001, -5.2, -6.2, -11.399999999999997, -9.2, -20.400000000000013, -8.599999999999998, -9.5, -6.300000000000001, -7.199999999999999, -2.4000000000000004, -18.6, -5.3, -7.199999999999999, -6.4, -69.3, -9.2, -6.2, -15.3, -19.3, -5.300000000000001, -4.9, -4.3, -6.2, -23.3, -17.599999999999998, -3.3, -86.2, -6.6, -17.600000000000005, -19.300000000000004, -6.2, -20.400000000000002, -9.4, -10.6, -9.2, -21.3, -12.899999999999995, -18.0, -7.399999999999999, -65.3, -8.399999999999999, -63.60000000000001, -12.99999999999999, -37.5, -10.2, -39.2, -11.2, -16.2, -2.2, -16.5, -4.300000000000001, -20.500000000000004, -8.700000000000001, -5.4, -10.2, -18.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3665873407400702, "mean_inference_ms": 1.7642564401065197, "mean_action_processing_ms": 0.09867884462641269, "mean_env_wait_ms": 8.096933180821864, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1088000, "timesteps_this_iter": 0, "agent_timesteps_total": 1088000, "timers": {"sample_time_ms": 24306.709, "sample_throughput": 164.564, "load_time_ms": 0.52, "load_throughput": 7693147.469, "learn_time_ms": 11943.12, "learn_throughput": 334.921, "update_time_ms": 2.387}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.6364942335215727, "policy_loss": -0.010514755106420927, "vf_loss": 64.61577409211026, "vf_explained_var": 0.12033930170920587, "kl": 0.010628779803402823, "entropy": 0.260154921465343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1088000, "num_agent_steps_sampled": 1088000, "num_steps_trained": 1088000, "num_agent_steps_trained": 1088000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10988, "training_iteration": 272, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-53-03", "timestamp": 1643651583, "time_this_iter_s": 22.821819067001343, "time_total_s": 6252.925327777863, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6252.925327777863, "timesteps_since_restore": 0, "iterations_since_restore": 272, "perf": {"cpu_util_percent": 44.02727272727273, "ram_util_percent": 62.300000000000004}}
{"episode_reward_max": -2.2, "episode_reward_min": -86.2, "episode_reward_mean": -14.022, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.1, -38.2, -15.999999999999998, -5.300000000000001, -5.2, -6.2, -11.399999999999997, -9.2, -20.400000000000013, -8.599999999999998, -9.5, -6.300000000000001, -7.199999999999999, -2.4000000000000004, -18.6, -5.3, -7.199999999999999, -6.4, -69.3, -9.2, -6.2, -15.3, -19.3, -5.300000000000001, -4.9, -4.3, -6.2, -23.3, -17.599999999999998, -3.3, -86.2, -6.6, -17.600000000000005, -19.300000000000004, -6.2, -20.400000000000002, -9.4, -10.6, -9.2, -21.3, -12.899999999999995, -18.0, -7.399999999999999, -65.3, -8.399999999999999, -63.60000000000001, -12.99999999999999, -37.5, -10.2, -39.2, -11.2, -16.2, -2.2, -16.5, -4.300000000000001, -20.500000000000004, -8.700000000000001, -5.4, -10.2, -18.3, -6.2, -4.2, -24.900000000000006, -10.2, -4.300000000000001, -16.899999999999995, -4.300000000000001, -4.300000000000001, -27.300000000000026, -9.2, -9.3, -17.4, -6.0, -7.8, -5.4, -36.3, -18.0, -4.300000000000001, -10.0, -4.300000000000001, -5.300000000000001, -12.8, -13.499999999999998, -13.999999999999998, -4.3, -9.4, -6.300000000000001, -12.7, -6.2, -8.999999999999995, -4.6, -14.3, -15.5, -17.900000000000006, -8.2, -3.5, -10.5, -4.3, -2.2, -11.6], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3664516004459422, "mean_inference_ms": 1.7641822812426051, "mean_action_processing_ms": 0.09867957201339056, "mean_env_wait_ms": 8.096684036471084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1092000, "timesteps_this_iter": 0, "agent_timesteps_total": 1092000, "timers": {"sample_time_ms": 24128.236, "sample_throughput": 165.781, "load_time_ms": 0.474, "load_throughput": 8436697.174, "learn_time_ms": 11756.937, "learn_throughput": 340.225, "update_time_ms": 2.255}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 0.00010000000000000003, "total_loss": 0.0910376293339356, "policy_loss": -0.03572780477754291, "vf_loss": 12.450902091944089, "vf_explained_var": 0.18312123738309388, "kl": 0.028173384110481623, "entropy": 0.25248075771315764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1092000, "num_agent_steps_sampled": 1092000, "num_steps_trained": 1092000, "num_agent_steps_trained": 1092000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11028, "training_iteration": 273, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-53-25", "timestamp": 1643651605, "time_this_iter_s": 22.745935201644897, "time_total_s": 6275.671262979507, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6275.671262979507, "timesteps_since_restore": 0, "iterations_since_restore": 273, "perf": {"cpu_util_percent": 45.7125, "ram_util_percent": 62.3}}
{"episode_reward_max": -2.2, "episode_reward_min": -65.3, "episode_reward_mean": -13.729000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.899999999999995, -18.0, -7.399999999999999, -65.3, -8.399999999999999, -63.60000000000001, -12.99999999999999, -37.5, -10.2, -39.2, -11.2, -16.2, -2.2, -16.5, -4.300000000000001, -20.500000000000004, -8.700000000000001, -5.4, -10.2, -18.3, -6.2, -4.2, -24.900000000000006, -10.2, -4.300000000000001, -16.899999999999995, -4.300000000000001, -4.300000000000001, -27.300000000000026, -9.2, -9.3, -17.4, -6.0, -7.8, -5.4, -36.3, -18.0, -4.300000000000001, -10.0, -4.300000000000001, -5.300000000000001, -12.8, -13.499999999999998, -13.999999999999998, -4.3, -9.4, -6.300000000000001, -12.7, -6.2, -8.999999999999995, -4.6, -14.3, -15.5, -17.900000000000006, -8.2, -3.5, -10.5, -4.3, -2.2, -11.6, -7.300000000000001, -11.7, -22.8, -18.700000000000003, -44.2, -14.999999999999998, -6.1, -6.499999999999999, -20.2, -44.3, -11.2, -14.4, -21.9, -7.300000000000001, -17.0, -16.3, -6.799999999999999, -16.4, -15.5, -7.799999999999999, -15.2, -4.300000000000001, -16.30000000000002, -12.199999999999998, -24.3, -7.699999999999998, -8.4, -6.2, -13.3, -23.699999999999996, -18.1, -11.600000000000001, -14.599999999999998, -10.599999999999998, -9.0, -5.000000000000001, -6.2, -9.2, -9.999999999999998, -9.9], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3664124049328006, "mean_inference_ms": 1.7640148454284361, "mean_action_processing_ms": 0.09867202860416235, "mean_env_wait_ms": 8.095865832887712, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1096000, "timesteps_this_iter": 0, "agent_timesteps_total": 1096000, "timers": {"sample_time_ms": 23638.595, "sample_throughput": 169.215, "load_time_ms": 0.452, "load_throughput": 8846876.186, "learn_time_ms": 11707.345, "learn_throughput": 341.666, "update_time_ms": 2.23}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.17690569050034247, "policy_loss": -0.01514892390859063, "vf_loss": 19.087457151182235, "vf_explained_var": 0.1103809957222272, "kl": 0.009822622963932904, "entropy": 0.29265268762265484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1096000, "num_agent_steps_sampled": 1096000, "num_steps_trained": 1096000, "num_agent_steps_trained": 1096000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11068, "training_iteration": 274, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-53-48", "timestamp": 1643651628, "time_this_iter_s": 22.9755380153656, "time_total_s": 6298.646800994873, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6298.646800994873, "timesteps_since_restore": 0, "iterations_since_restore": 274, "perf": {"cpu_util_percent": 42.478787878787884, "ram_util_percent": 62.24242424242423}}
{"episode_reward_max": -2.2, "episode_reward_min": -44.3, "episode_reward_mean": -12.609999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -12.8, -13.499999999999998, -13.999999999999998, -4.3, -9.4, -6.300000000000001, -12.7, -6.2, -8.999999999999995, -4.6, -14.3, -15.5, -17.900000000000006, -8.2, -3.5, -10.5, -4.3, -2.2, -11.6, -7.300000000000001, -11.7, -22.8, -18.700000000000003, -44.2, -14.999999999999998, -6.1, -6.499999999999999, -20.2, -44.3, -11.2, -14.4, -21.9, -7.300000000000001, -17.0, -16.3, -6.799999999999999, -16.4, -15.5, -7.799999999999999, -15.2, -4.300000000000001, -16.30000000000002, -12.199999999999998, -24.3, -7.699999999999998, -8.4, -6.2, -13.3, -23.699999999999996, -18.1, -11.600000000000001, -14.599999999999998, -10.599999999999998, -9.0, -5.000000000000001, -6.2, -9.2, -9.999999999999998, -9.9, -9.599999999999998, -4.000000000000001, -12.3, -17.6, -15.399999999999999, -6.5, -7.9, -10.2, -24.9, -8.299999999999997, -8.3, -10.2, -22.3, -16.4, -11.299999999999999, -18.799999999999997, -8.2, -8.9, -13.2, -11.3, -13.6, -14.2, -16.4, -12.1, -19.600000000000005, -7.2, -7.2, -6.3, -11.3, -9.2, -7.299999999999999, -12.4, -21.299999999999997, -9.999999999999998, -11.7, -8.3, -20.6, -18.3, -15.3, -19.800000000000004], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3664802579379574, "mean_inference_ms": 1.7640895520918418, "mean_action_processing_ms": 0.09867659051894137, "mean_env_wait_ms": 8.096106843580284, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1100000, "timesteps_this_iter": 0, "agent_timesteps_total": 1100000, "timers": {"sample_time_ms": 23574.699, "sample_throughput": 169.673, "load_time_ms": 0.449, "load_throughput": 8899435.604, "learn_time_ms": 11562.839, "learn_throughput": 345.936, "update_time_ms": 2.117}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.4017670813312013, "policy_loss": -0.02293994257211565, "vf_loss": 42.34353432245152, "vf_explained_var": 0.12077636026567029, "kl": 0.01058544298127265, "entropy": 0.2973103700466053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1100000, "num_agent_steps_sampled": 1100000, "num_steps_trained": 1100000, "num_agent_steps_trained": 1100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11108, "training_iteration": 275, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-54-12", "timestamp": 1643651652, "time_this_iter_s": 24.039720058441162, "time_total_s": 6322.686521053314, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6322.686521053314, "timesteps_since_restore": 0, "iterations_since_restore": 275, "perf": {"cpu_util_percent": 41.51764705882353, "ram_util_percent": 62.36470588235294}}
{"episode_reward_max": -4.000000000000001, "episode_reward_min": -114.40000000000006, "episode_reward_mean": -14.687999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.2, -4.300000000000001, -16.30000000000002, -12.199999999999998, -24.3, -7.699999999999998, -8.4, -6.2, -13.3, -23.699999999999996, -18.1, -11.600000000000001, -14.599999999999998, -10.599999999999998, -9.0, -5.000000000000001, -6.2, -9.2, -9.999999999999998, -9.9, -9.599999999999998, -4.000000000000001, -12.3, -17.6, -15.399999999999999, -6.5, -7.9, -10.2, -24.9, -8.299999999999997, -8.3, -10.2, -22.3, -16.4, -11.299999999999999, -18.799999999999997, -8.2, -8.9, -13.2, -11.3, -13.6, -14.2, -16.4, -12.1, -19.600000000000005, -7.2, -7.2, -6.3, -11.3, -9.2, -7.299999999999999, -12.4, -21.299999999999997, -9.999999999999998, -11.7, -8.3, -20.6, -18.3, -15.3, -19.800000000000004, -14.2, -11.3, -9.500000000000002, -9.799999999999999, -9.799999999999994, -10.200000000000001, -18.800000000000008, -40.99999999999992, -14.099999999999998, -9.8, -18.2, -22.6, -65.89999999999993, -9.3, -16.3, -18.4, -13.2, -25.600000000000005, -9.4, -12.399999999999999, -114.40000000000006, -22.2, -11.9, -13.2, -10.2, -11.0, -8.2, -12.2, -12.2, -21.599999999999998, -21.3, -5.699999999999999, -7.399999999999999, -16.2, -18.800000000000004, -15.699999999999978, -9.0, -9.7, -10.299999999999997, -14.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3664651206506966, "mean_inference_ms": 1.7642484581406097, "mean_action_processing_ms": 0.09868640834001507, "mean_env_wait_ms": 8.096665273617244, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1104000, "timesteps_this_iter": 0, "agent_timesteps_total": 1104000, "timers": {"sample_time_ms": 23173.849, "sample_throughput": 172.608, "load_time_ms": 0.491, "load_throughput": 8154175.456, "learn_time_ms": 11258.553, "learn_throughput": 355.285, "update_time_ms": 2.112}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.2630139651037352, "policy_loss": -0.018405113977089684, "vf_loss": 28.024842698086974, "vf_explained_var": 0.18141203452182073, "kl": 0.009744490927393549, "entropy": 0.2893082583944003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1104000, "num_agent_steps_sampled": 1104000, "num_steps_trained": 1104000, "num_agent_steps_trained": 1104000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11148, "training_iteration": 276, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-54-37", "timestamp": 1643651677, "time_this_iter_s": 24.218679904937744, "time_total_s": 6346.905200958252, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6346.905200958252, "timesteps_since_restore": 0, "iterations_since_restore": 276, "perf": {"cpu_util_percent": 30.571428571428573, "ram_util_percent": 62.35714285714287}}
{"episode_reward_max": -4.3, "episode_reward_min": -114.40000000000006, "episode_reward_mean": -15.007999999999997, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.6, -14.2, -16.4, -12.1, -19.600000000000005, -7.2, -7.2, -6.3, -11.3, -9.2, -7.299999999999999, -12.4, -21.299999999999997, -9.999999999999998, -11.7, -8.3, -20.6, -18.3, -15.3, -19.800000000000004, -14.2, -11.3, -9.500000000000002, -9.799999999999999, -9.799999999999994, -10.200000000000001, -18.800000000000008, -40.99999999999992, -14.099999999999998, -9.8, -18.2, -22.6, -65.89999999999993, -9.3, -16.3, -18.4, -13.2, -25.600000000000005, -9.4, -12.399999999999999, -114.40000000000006, -22.2, -11.9, -13.2, -10.2, -11.0, -8.2, -12.2, -12.2, -21.599999999999998, -21.3, -5.699999999999999, -7.399999999999999, -16.2, -18.800000000000004, -15.699999999999978, -9.0, -9.7, -10.299999999999997, -14.3, -19.400000000000006, -9.4, -14.5, -10.199999999999998, -20.2, -14.3, -10.600000000000001, -15.399999999999999, -4.4, -9.2, -32.8, -12.5, -4.3, -9.2, -11.700000000000001, -11.8, -6.199999999999998, -12.3, -9.3, -4.800000000000001, -24.100000000000044, -15.4, -4.800000000000001, -12.9, -5.3, -5.800000000000001, -21.600000000000005, -14.8, -15.9, -16.2, -15.2, -4.300000000000001, -8.799999999999997, -6.2, -25.3, -7.299999999999999, -41.3, -10.099999999999998, -7.3, -8.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3671186567633993, "mean_inference_ms": 1.765098326787188, "mean_action_processing_ms": 0.09873407910006866, "mean_env_wait_ms": 8.100585997139564, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1108000, "timesteps_this_iter": 0, "agent_timesteps_total": 1108000, "timers": {"sample_time_ms": 22947.749, "sample_throughput": 174.309, "load_time_ms": 0.548, "load_throughput": 7298567.016, "learn_time_ms": 11608.013, "learn_throughput": 344.59, "update_time_ms": 2.292}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.13602559643770037, "policy_loss": -0.021654224317641028, "vf_loss": 15.655617986699585, "vf_explained_var": 0.008606562883623185, "kl": 0.009353122152951025, "entropy": 0.28029614209487874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1108000, "num_agent_steps_sampled": 1108000, "num_steps_trained": 1108000, "num_agent_steps_trained": 1108000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11188, "training_iteration": 277, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-55-07", "timestamp": 1643651707, "time_this_iter_s": 29.885120153427124, "time_total_s": 6376.790321111679, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6376.790321111679, "timesteps_since_restore": 0, "iterations_since_restore": 277, "perf": {"cpu_util_percent": 36.326190476190476, "ram_util_percent": 62.47380952380953}}
{"episode_reward_max": -2.2, "episode_reward_min": -42.3, "episode_reward_mean": -13.858000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.2, -11.0, -8.2, -12.2, -12.2, -21.599999999999998, -21.3, -5.699999999999999, -7.399999999999999, -16.2, -18.800000000000004, -15.699999999999978, -9.0, -9.7, -10.299999999999997, -14.3, -19.400000000000006, -9.4, -14.5, -10.199999999999998, -20.2, -14.3, -10.600000000000001, -15.399999999999999, -4.4, -9.2, -32.8, -12.5, -4.3, -9.2, -11.700000000000001, -11.8, -6.199999999999998, -12.3, -9.3, -4.800000000000001, -24.100000000000044, -15.4, -4.800000000000001, -12.9, -5.3, -5.800000000000001, -21.600000000000005, -14.8, -15.9, -16.2, -15.2, -4.300000000000001, -8.799999999999997, -6.2, -25.3, -7.299999999999999, -41.3, -10.099999999999998, -7.3, -8.3, -13.3, -11.3, -13.3, -42.3, -2.2, -13.600000000000001, -10.600000000000001, -12.7, -17.8, -13.6, -28.2, -7.599999999999999, -10.899999999999997, -18.799999999999983, -21.4, -12.4, -21.3, -4.800000000000001, -40.3, -11.3, -5.300000000000001, -7.999999999999998, -24.500000000000092, -25.40000000000004, -8.3, -16.3, -17.3, -9.2, -11.999999999999996, -10.9, -20.6, -17.1, -13.299999999999997, -16.6, -12.099999999999998, -22.499999999999996, -13.2, -4.2, -7.199999999999999, -12.099999999999998, -20.199999999999996, -21.100000000000033, -17.3, -6.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3682061611414627, "mean_inference_ms": 1.766058538225675, "mean_action_processing_ms": 0.0988508846226619, "mean_env_wait_ms": 8.105944794629579, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1112000, "timesteps_this_iter": 0, "agent_timesteps_total": 1112000, "timers": {"sample_time_ms": 23390.813, "sample_throughput": 171.007, "load_time_ms": 0.547, "load_throughput": 7314477.046, "learn_time_ms": 11497.242, "learn_throughput": 347.91, "update_time_ms": 2.273}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.17512475161122218, "policy_loss": -0.01734997045288804, "vf_loss": 19.046090826039674, "vf_explained_var": 0.18858252763748168, "kl": 0.016762913828292262, "entropy": 0.25423012580922855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1112000, "num_agent_steps_sampled": 1112000, "num_steps_trained": 1112000, "num_agent_steps_trained": 1112000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11232, "training_iteration": 278, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-55-28", "timestamp": 1643651728, "time_this_iter_s": 21.724135875701904, "time_total_s": 6398.514456987381, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6398.514456987381, "timesteps_since_restore": 0, "iterations_since_restore": 278, "perf": {"cpu_util_percent": 36.96451612903226, "ram_util_percent": 62.33548387096773}}
{"episode_reward_max": -1.2, "episode_reward_min": -48.60000000000007, "episode_reward_mean": -13.999000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3, -5.800000000000001, -21.600000000000005, -14.8, -15.9, -16.2, -15.2, -4.300000000000001, -8.799999999999997, -6.2, -25.3, -7.299999999999999, -41.3, -10.099999999999998, -7.3, -8.3, -13.3, -11.3, -13.3, -42.3, -2.2, -13.600000000000001, -10.600000000000001, -12.7, -17.8, -13.6, -28.2, -7.599999999999999, -10.899999999999997, -18.799999999999983, -21.4, -12.4, -21.3, -4.800000000000001, -40.3, -11.3, -5.300000000000001, -7.999999999999998, -24.500000000000092, -25.40000000000004, -8.3, -16.3, -17.3, -9.2, -11.999999999999996, -10.9, -20.6, -17.1, -13.299999999999997, -16.6, -12.099999999999998, -22.499999999999996, -13.2, -4.2, -7.199999999999999, -12.099999999999998, -20.199999999999996, -21.100000000000033, -17.3, -6.2, -6.300000000000001, -10.5, -9.799999999999999, -10.5, -13.3, -12.2, -9.2, -17.09999999999999, -7.799999999999999, -1.3, -27.300000000000033, -1.2, -18.199999999999996, -4.7, -14.299999999999999, -31.700000000000006, -8.3, -9.4, -10.3, -13.3, -7.5, -11.7, -14.3, -12.3, -11.6, -5.2, -8.299999999999999, -48.60000000000007, -10.2, -44.3, -13.3, -6.300000000000001, -7.2, -11.8, -9.499999999999991, -9.5, -10.4, -14.799999999999999, -13.099999999999998, -11.0], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.368257212946965, "mean_inference_ms": 1.7660488092702422, "mean_action_processing_ms": 0.09884943692142023, "mean_env_wait_ms": 8.105850838500032, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1116000, "timesteps_this_iter": 0, "agent_timesteps_total": 1116000, "timers": {"sample_time_ms": 23262.202, "sample_throughput": 171.953, "load_time_ms": 0.541, "load_throughput": 7398666.431, "learn_time_ms": 11270.108, "learn_throughput": 354.921, "update_time_ms": 2.247}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.2012516425101347, "policy_loss": -0.012848881986593046, "vf_loss": 21.293436946151076, "vf_explained_var": 0.20846455565062902, "kl": 0.009707019309316282, "entropy": 0.26290648449813164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1116000, "num_agent_steps_sampled": 1116000, "num_steps_trained": 1116000, "num_agent_steps_trained": 1116000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11272, "training_iteration": 279, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-55-47", "timestamp": 1643651747, "time_this_iter_s": 18.054527282714844, "time_total_s": 6416.568984270096, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6416.568984270096, "timesteps_since_restore": 0, "iterations_since_restore": 279, "perf": {"cpu_util_percent": 34.65384615384615, "ram_util_percent": 62.330769230769235}}
{"episode_reward_max": -1.2, "episode_reward_min": -48.60000000000007, "episode_reward_mean": -12.545000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.3, -16.3, -17.3, -9.2, -11.999999999999996, -10.9, -20.6, -17.1, -13.299999999999997, -16.6, -12.099999999999998, -22.499999999999996, -13.2, -4.2, -7.199999999999999, -12.099999999999998, -20.199999999999996, -21.100000000000033, -17.3, -6.2, -6.300000000000001, -10.5, -9.799999999999999, -10.5, -13.3, -12.2, -9.2, -17.09999999999999, -7.799999999999999, -1.3, -27.300000000000033, -1.2, -18.199999999999996, -4.7, -14.299999999999999, -31.700000000000006, -8.3, -9.4, -10.3, -13.3, -7.5, -11.7, -14.3, -12.3, -11.6, -5.2, -8.299999999999999, -48.60000000000007, -10.2, -44.3, -13.3, -6.300000000000001, -7.2, -11.8, -9.499999999999991, -9.5, -10.4, -14.799999999999999, -13.099999999999998, -11.0, -26.900000000000006, -10.299999999999999, -10.699999999999996, -13.899999999999997, -15.3, -10.3, -12.499999999999998, -7.6000000000000005, -14.2, -32.3, -8.3, -10.9, -5.3, -11.999999999999998, -10.5, -16.6, -5.3, -3.2, -10.0, -16.7, -11.2, -8.3, -5.3, -31.2, -2.4000000000000004, -5.3, -12.100000000000001, -8.8, -12.999999999999998, -9.3, -14.3, -13.1, -19.699999999999996, -6.300000000000001, -5.2, -4.800000000000001, -7.4, -5.3, -7.199999999999999, -16.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3671160634049528, "mean_inference_ms": 1.7646639694202904, "mean_action_processing_ms": 0.09871106733418854, "mean_env_wait_ms": 8.099044660319915, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1120000, "timesteps_this_iter": 0, "agent_timesteps_total": 1120000, "timers": {"sample_time_ms": 22778.192, "sample_throughput": 175.607, "load_time_ms": 0.534, "load_throughput": 7496186.944, "learn_time_ms": 10965.129, "learn_throughput": 364.793, "update_time_ms": 2.137}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.1053552798145721, "policy_loss": -0.009943945421486772, "vf_loss": 11.429336427104088, "vf_explained_var": 0.3167394118924295, "kl": 0.00837273799498367, "entropy": 0.25403360551403414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1120000, "num_agent_steps_sampled": 1120000, "num_steps_trained": 1120000, "num_agent_steps_trained": 1120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11312, "training_iteration": 280, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-56-02", "timestamp": 1643651762, "time_this_iter_s": 15.217610120773315, "time_total_s": 6431.786594390869, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6431.786594390869, "timesteps_since_restore": 0, "iterations_since_restore": 280, "perf": {"cpu_util_percent": 29.627272727272725, "ram_util_percent": 62.40000000000002}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -63.0, "episode_reward_mean": -12.601, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.5, -11.7, -14.3, -12.3, -11.6, -5.2, -8.299999999999999, -48.60000000000007, -10.2, -44.3, -13.3, -6.300000000000001, -7.2, -11.8, -9.499999999999991, -9.5, -10.4, -14.799999999999999, -13.099999999999998, -11.0, -26.900000000000006, -10.299999999999999, -10.699999999999996, -13.899999999999997, -15.3, -10.3, -12.499999999999998, -7.6000000000000005, -14.2, -32.3, -8.3, -10.9, -5.3, -11.999999999999998, -10.5, -16.6, -5.3, -3.2, -10.0, -16.7, -11.2, -8.3, -5.3, -31.2, -2.4000000000000004, -5.3, -12.100000000000001, -8.8, -12.999999999999998, -9.3, -14.3, -13.1, -19.699999999999996, -6.300000000000001, -5.2, -4.800000000000001, -7.4, -5.3, -7.199999999999999, -16.2, -10.3, -11.4, -13.3, -15.3, -5.4, -11.1, -6.1, -14.799999999999994, -7.999999999999999, -18.6, -6.4, -3.3000000000000003, -10.2, -17.5, -12.2, -18.800000000000004, -5.2, -4.2, -31.4, -7.2, -9.2, -9.199999999999998, -11.3, -63.0, -4.300000000000001, -13.999999999999995, -7.4, -8.000000000000002, -10.1, -10.3, -15.2, -14.799999999999999, -7.199999999999999, -10.799999999999995, -14.600000000000001, -14.600000000000001, -20.099999999999994, -33.29999999999999, -3.5000000000000004, -8.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3655757081160018, "mean_inference_ms": 1.76276935435611, "mean_action_processing_ms": 0.09860094596913382, "mean_env_wait_ms": 8.089357987549239, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1124000, "timesteps_this_iter": 0, "agent_timesteps_total": 1124000, "timers": {"sample_time_ms": 22123.617, "sample_throughput": 180.802, "load_time_ms": 0.517, "load_throughput": 7741067.688, "learn_time_ms": 10775.459, "learn_throughput": 371.214, "update_time_ms": 2.158}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.19584423306207824, "policy_loss": -0.029487955281310665, "vf_loss": 22.34644140094839, "vf_explained_var": 0.18798362087177975, "kl": 0.015547263065019957, "entropy": 0.2219546436462351, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1124000, "num_agent_steps_sampled": 1124000, "num_steps_trained": 1124000, "num_agent_steps_trained": 1124000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11352, "training_iteration": 281, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-56-19", "timestamp": 1643651779, "time_this_iter_s": 17.188521146774292, "time_total_s": 6448.975115537643, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6448.975115537643, "timesteps_since_restore": 0, "iterations_since_restore": 281, "perf": {"cpu_util_percent": 36.24583333333333, "ram_util_percent": 62.4375}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -63.0, "episode_reward_mean": -12.380999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.2, -8.3, -5.3, -31.2, -2.4000000000000004, -5.3, -12.100000000000001, -8.8, -12.999999999999998, -9.3, -14.3, -13.1, -19.699999999999996, -6.300000000000001, -5.2, -4.800000000000001, -7.4, -5.3, -7.199999999999999, -16.2, -10.3, -11.4, -13.3, -15.3, -5.4, -11.1, -6.1, -14.799999999999994, -7.999999999999999, -18.6, -6.4, -3.3000000000000003, -10.2, -17.5, -12.2, -18.800000000000004, -5.2, -4.2, -31.4, -7.2, -9.2, -9.199999999999998, -11.3, -63.0, -4.300000000000001, -13.999999999999995, -7.4, -8.000000000000002, -10.1, -10.3, -15.2, -14.799999999999999, -7.199999999999999, -10.799999999999995, -14.600000000000001, -14.600000000000001, -20.099999999999994, -33.29999999999999, -3.5000000000000004, -8.4, -7.6000000000000005, -18.7, -11.1, -5.300000000000001, -6.3, -8.2, -11.2, -17.1, -12.3, -13.2, -4.700000000000001, -16.199999999999996, -25.800000000000043, -7.300000000000001, -5.899999999999999, -16.4, -8.799999999999999, -6.2, -7.2, -11.499999999999998, -51.200000000000045, -38.89999999999996, -7.2, -15.6, -7.499999999999998, -15.3, -19.500000000000004, -4.300000000000001, -9.1, -8.2, -11.199999999999998, -9.2, -13.499999999999996, -14.7, -4.9, -16.7, -6.2, -16.5, -7.4, -13.599999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3645697661828344, "mean_inference_ms": 1.7613922369574158, "mean_action_processing_ms": 0.09852228176384446, "mean_env_wait_ms": 8.082500453141789, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1128000, "timesteps_this_iter": 0, "agent_timesteps_total": 1128000, "timers": {"sample_time_ms": 21910.395, "sample_throughput": 182.562, "load_time_ms": 0.508, "load_throughput": 7872192.192, "learn_time_ms": 10467.419, "learn_throughput": 382.138, "update_time_ms": 2.095}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.1126941351770794, "policy_loss": -0.017139220149606785, "vf_loss": 12.876722295694453, "vf_explained_var": 0.29797870074549027, "kl": 0.00887441735148069, "entropy": 0.23093163255722293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1128000, "num_agent_steps_sampled": 1128000, "num_steps_trained": 1128000, "num_agent_steps_trained": 1128000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11392, "training_iteration": 282, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-56-39", "timestamp": 1643651799, "time_this_iter_s": 19.51599097251892, "time_total_s": 6468.491106510162, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6468.491106510162, "timesteps_since_restore": 0, "iterations_since_restore": 282, "perf": {"cpu_util_percent": 44.528571428571425, "ram_util_percent": 62.45714285714286}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -63.0, "episode_reward_mean": -13.835, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.2, -9.199999999999998, -11.3, -63.0, -4.300000000000001, -13.999999999999995, -7.4, -8.000000000000002, -10.1, -10.3, -15.2, -14.799999999999999, -7.199999999999999, -10.799999999999995, -14.600000000000001, -14.600000000000001, -20.099999999999994, -33.29999999999999, -3.5000000000000004, -8.4, -7.6000000000000005, -18.7, -11.1, -5.300000000000001, -6.3, -8.2, -11.2, -17.1, -12.3, -13.2, -4.700000000000001, -16.199999999999996, -25.800000000000043, -7.300000000000001, -5.899999999999999, -16.4, -8.799999999999999, -6.2, -7.2, -11.499999999999998, -51.200000000000045, -38.89999999999996, -7.2, -15.6, -7.499999999999998, -15.3, -19.500000000000004, -4.300000000000001, -9.1, -8.2, -11.199999999999998, -9.2, -13.499999999999996, -14.7, -4.9, -16.7, -6.2, -16.5, -7.4, -13.599999999999998, -12.899999999999999, -16.5, -29.39999999999999, -3.2, -8.8, -20.3, -38.20000000000008, -2.4000000000000004, -18.999999999999996, -12.2, -15.7, -26.20000000000004, -24.099999999999994, -4.9, -26.500000000000018, -6.2, -14.3, -9.2, -13.599999999999996, -10.799999999999999, -12.999999999999998, -17.5, -5.300000000000001, -14.600000000000001, -14.6, -17.8, -8.399999999999999, -7.300000000000001, -15.699999999999996, -14.6, -7.3, -8.3, -13.3, -9.9, -23.2, -10.600000000000001, -21.3, -15.8, -22.3, -7.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3635768155857715, "mean_inference_ms": 1.7601049508658837, "mean_action_processing_ms": 0.09844897678579141, "mean_env_wait_ms": 8.076069495425854, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1132000, "timesteps_this_iter": 0, "agent_timesteps_total": 1132000, "timers": {"sample_time_ms": 21191.526, "sample_throughput": 188.755, "load_time_ms": 0.486, "load_throughput": 8228158.901, "learn_time_ms": 10176.232, "learn_throughput": 393.073, "update_time_ms": 2.033}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.15735317605137022, "policy_loss": -0.017193830760836762, "vf_loss": 17.345332252658825, "vf_explained_var": 0.22976505974287628, "kl": 0.009103790994457869, "entropy": 0.23173566955712535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1132000, "num_agent_steps_sampled": 1132000, "num_steps_trained": 1132000, "num_agent_steps_trained": 1132000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11432, "training_iteration": 283, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-56-54", "timestamp": 1643651814, "time_this_iter_s": 15.741432666778564, "time_total_s": 6484.232539176941, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6484.232539176941, "timesteps_since_restore": 0, "iterations_since_restore": 283, "perf": {"cpu_util_percent": 30.430434782608696, "ram_util_percent": 62.5}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -51.200000000000045, "episode_reward_mean": -14.344000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.200000000000045, -38.89999999999996, -7.2, -15.6, -7.499999999999998, -15.3, -19.500000000000004, -4.300000000000001, -9.1, -8.2, -11.199999999999998, -9.2, -13.499999999999996, -14.7, -4.9, -16.7, -6.2, -16.5, -7.4, -13.599999999999998, -12.899999999999999, -16.5, -29.39999999999999, -3.2, -8.8, -20.3, -38.20000000000008, -2.4000000000000004, -18.999999999999996, -12.2, -15.7, -26.20000000000004, -24.099999999999994, -4.9, -26.500000000000018, -6.2, -14.3, -9.2, -13.599999999999996, -10.799999999999999, -12.999999999999998, -17.5, -5.300000000000001, -14.600000000000001, -14.6, -17.8, -8.399999999999999, -7.300000000000001, -15.699999999999996, -14.6, -7.3, -8.3, -13.3, -9.9, -23.2, -10.600000000000001, -21.3, -15.8, -22.3, -7.3, -8.5, -3.3, -6.2, -34.2, -7.2, -39.49999999999999, -5.300000000000001, -5.4, -4.800000000000001, -6.2, -22.900000000000002, -22.000000000000025, -13.499999999999998, -7.2, -16.099999999999998, -8.2, -7.2, -14.8, -27.5, -17.5, -19.4, -5.4, -6.9, -12.2, -29.000000000000032, -8.9, -4.2, -7.1, -5.2, -11.299999999999999, -9.2, -9.499999999999998, -15.200000000000001, -15.300000000000017, -13.099999999999998, -9.3, -41.49999999999998, -9.499999999999998, -13.3, -38.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3622995265718645, "mean_inference_ms": 1.7585190524770709, "mean_action_processing_ms": 0.09836018504970323, "mean_env_wait_ms": 8.068388151229705, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1136000, "timesteps_this_iter": 0, "agent_timesteps_total": 1136000, "timers": {"sample_time_ms": 20635.077, "sample_throughput": 193.845, "load_time_ms": 0.479, "load_throughput": 8349781.516, "learn_time_ms": 9780.647, "learn_throughput": 408.971, "update_time_ms": 1.99}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.15526164992942765, "policy_loss": -0.016525250663279846, "vf_loss": 17.042409047772807, "vf_explained_var": 0.18991218830949516, "kl": 0.011343994381585466, "entropy": 0.22473269363725057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1136000, "num_agent_steps_sampled": 1136000, "num_steps_trained": 1136000, "num_agent_steps_trained": 1136000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11472, "training_iteration": 284, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-57-11", "timestamp": 1643651831, "time_this_iter_s": 16.37400794029236, "time_total_s": 6500.606547117233, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6500.606547117233, "timesteps_since_restore": 0, "iterations_since_restore": 284, "perf": {"cpu_util_percent": 34.013043478260876, "ram_util_percent": 62.3086956521739}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -75.1, "episode_reward_mean": -13.873000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.999999999999998, -17.5, -5.300000000000001, -14.600000000000001, -14.6, -17.8, -8.399999999999999, -7.300000000000001, -15.699999999999996, -14.6, -7.3, -8.3, -13.3, -9.9, -23.2, -10.600000000000001, -21.3, -15.8, -22.3, -7.3, -8.5, -3.3, -6.2, -34.2, -7.2, -39.49999999999999, -5.300000000000001, -5.4, -4.800000000000001, -6.2, -22.900000000000002, -22.000000000000025, -13.499999999999998, -7.2, -16.099999999999998, -8.2, -7.2, -14.8, -27.5, -17.5, -19.4, -5.4, -6.9, -12.2, -29.000000000000032, -8.9, -4.2, -7.1, -5.2, -11.299999999999999, -9.2, -9.499999999999998, -15.200000000000001, -15.300000000000017, -13.099999999999998, -9.3, -41.49999999999998, -9.499999999999998, -13.3, -38.2, -2.6000000000000005, -7.8, -16.5, -6.8999999999999995, -24.600000000000005, -3.6000000000000005, -19.6, -27.599999999999998, -9.5, -19.5, -10.1, -9.3, -19.800000000000004, -6.2, -11.3, -8.599999999999998, -36.3, -4.5, -6.999999999999999, -11.8, -17.0, -17.4, -21.800000000000004, -6.1, -4.800000000000001, -37.2, -5.1, -21.800000000000004, -4.3, -4.700000000000001, -7.2, -7.300000000000001, -19.7, -5.3, -3.2, -75.1, -10.2, -6.2, -12.3, -8.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3609352328394098, "mean_inference_ms": 1.7567227755941652, "mean_action_processing_ms": 0.09826012707624403, "mean_env_wait_ms": 8.05979521091952, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1140000, "timesteps_this_iter": 0, "agent_timesteps_total": 1140000, "timers": {"sample_time_ms": 19836.029, "sample_throughput": 201.653, "load_time_ms": 0.473, "load_throughput": 8458389.715, "learn_time_ms": 9476.088, "learn_throughput": 422.115, "update_time_ms": 1.941}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.5614317715338241, "policy_loss": -0.012696097570882048, "vf_loss": 57.31829619971655, "vf_explained_var": -0.13420279077304306, "kl": 0.007865408878262625, "entropy": 0.22066294913009932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1140000, "num_agent_steps_sampled": 1140000, "num_steps_trained": 1140000, "num_agent_steps_trained": 1140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11512, "training_iteration": 285, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-57-28", "timestamp": 1643651848, "time_this_iter_s": 16.981589794158936, "time_total_s": 6517.588136911392, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6517.588136911392, "timesteps_since_restore": 0, "iterations_since_restore": 285, "perf": {"cpu_util_percent": 34.416666666666664, "ram_util_percent": 62.34166666666667}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -89.3, "episode_reward_mean": -15.272000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.4, -5.4, -6.9, -12.2, -29.000000000000032, -8.9, -4.2, -7.1, -5.2, -11.299999999999999, -9.2, -9.499999999999998, -15.200000000000001, -15.300000000000017, -13.099999999999998, -9.3, -41.49999999999998, -9.499999999999998, -13.3, -38.2, -2.6000000000000005, -7.8, -16.5, -6.8999999999999995, -24.600000000000005, -3.6000000000000005, -19.6, -27.599999999999998, -9.5, -19.5, -10.1, -9.3, -19.800000000000004, -6.2, -11.3, -8.599999999999998, -36.3, -4.5, -6.999999999999999, -11.8, -17.0, -17.4, -21.800000000000004, -6.1, -4.800000000000001, -37.2, -5.1, -21.800000000000004, -4.3, -4.700000000000001, -7.2, -7.300000000000001, -19.7, -5.3, -3.2, -75.1, -10.2, -6.2, -12.3, -8.2, -13.0, -4.2, -8.299999999999999, -7.299999999999999, -4.2, -18.899999999999967, -8.2, -17.0, -21.6, -4.2, -8.700000000000001, -32.50000000000001, -8.2, -3.2, -20.89999999999999, -21.100000000000005, -13.2, -11.000000000000002, -14.8, -6.4, -89.3, -40.3, -13.199999999999998, -6.300000000000001, -10.3, -25.699999999999996, -55.3, -11.8, -11.1, -6.300000000000001, -4.300000000000001, -12.899999999999999, -56.80000000000001, -7.299999999999999, -3.1, -6.2, -6.3999999999999995, -11.4, -5.300000000000001, -55.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3597995264241138, "mean_inference_ms": 1.7552477428255167, "mean_action_processing_ms": 0.09817705284503539, "mean_env_wait_ms": 8.05269870511688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1144000, "timesteps_this_iter": 0, "agent_timesteps_total": 1144000, "timers": {"sample_time_ms": 19287.522, "sample_throughput": 207.388, "load_time_ms": 0.418, "load_throughput": 9571665.906, "learn_time_ms": 9064.444, "learn_throughput": 441.285, "update_time_ms": 1.847}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.3281641551413603, "policy_loss": -0.021989506856733634, "vf_loss": 34.85259676287251, "vf_explained_var": 0.17131109647853401, "kl": 0.013548878213221746, "entropy": 0.23526032269001007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1144000, "num_agent_steps_sampled": 1144000, "num_steps_trained": 1144000, "num_agent_steps_trained": 1144000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11552, "training_iteration": 286, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-57-45", "timestamp": 1643651865, "time_this_iter_s": 17.679755210876465, "time_total_s": 6535.267892122269, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6535.267892122269, "timesteps_since_restore": 0, "iterations_since_restore": 286, "perf": {"cpu_util_percent": 38.832, "ram_util_percent": 62.38}}
{"episode_reward_max": -3.1, "episode_reward_min": -89.3, "episode_reward_mean": -14.5, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.0, -17.4, -21.800000000000004, -6.1, -4.800000000000001, -37.2, -5.1, -21.800000000000004, -4.3, -4.700000000000001, -7.2, -7.300000000000001, -19.7, -5.3, -3.2, -75.1, -10.2, -6.2, -12.3, -8.2, -13.0, -4.2, -8.299999999999999, -7.299999999999999, -4.2, -18.899999999999967, -8.2, -17.0, -21.6, -4.2, -8.700000000000001, -32.50000000000001, -8.2, -3.2, -20.89999999999999, -21.100000000000005, -13.2, -11.000000000000002, -14.8, -6.4, -89.3, -40.3, -13.199999999999998, -6.300000000000001, -10.3, -25.699999999999996, -55.3, -11.8, -11.1, -6.300000000000001, -4.300000000000001, -12.899999999999999, -56.80000000000001, -7.299999999999999, -3.1, -6.2, -6.3999999999999995, -11.4, -5.300000000000001, -55.3, -9.1, -15.799999999999999, -16.6, -5.9, -3.2, -5.300000000000001, -34.000000000000036, -11.2, -6.1, -21.899999999999995, -5.999999999999999, -16.89999999999999, -14.8, -10.899999999999999, -3.2, -6.2, -10.899999999999999, -3.2, -13.3, -3.5000000000000004, -17.3, -19.9, -7.300000000000001, -3.3, -5.300000000000001, -4.800000000000001, -9.3, -15.399999999999999, -3.2, -16.5, -17.9, -13.9, -16.700000000000003, -14.299999999999981, -38.2, -13.599999999999998, -3.2, -17.7, -7.5, -6.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.358639341284224, "mean_inference_ms": 1.7537484677233817, "mean_action_processing_ms": 0.09809210269236392, "mean_env_wait_ms": 8.045554555359274, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1148000, "timesteps_this_iter": 0, "agent_timesteps_total": 1148000, "timers": {"sample_time_ms": 18177.134, "sample_throughput": 220.057, "load_time_ms": 0.335, "load_throughput": 11940229.165, "learn_time_ms": 8445.022, "learn_throughput": 473.652, "update_time_ms": 1.645}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.15697560571910193, "policy_loss": -0.012806786380968587, "vf_loss": 16.882605929528513, "vf_explained_var": 0.12135098730364154, "kl": 0.007960495493628823, "entropy": 0.20602006512463733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1148000, "num_agent_steps_sampled": 1148000, "num_steps_trained": 1148000, "num_agent_steps_trained": 1148000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11592, "training_iteration": 287, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-58-02", "timestamp": 1643651882, "time_this_iter_s": 16.721266984939575, "time_total_s": 6551.989159107208, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6551.989159107208, "timesteps_since_restore": 0, "iterations_since_restore": 287, "perf": {"cpu_util_percent": 30.733333333333334, "ram_util_percent": 62.40833333333333}}
{"episode_reward_max": -3.1, "episode_reward_min": -56.80000000000001, "episode_reward_mean": -12.294, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.3, -25.699999999999996, -55.3, -11.8, -11.1, -6.300000000000001, -4.300000000000001, -12.899999999999999, -56.80000000000001, -7.299999999999999, -3.1, -6.2, -6.3999999999999995, -11.4, -5.300000000000001, -55.3, -9.1, -15.799999999999999, -16.6, -5.9, -3.2, -5.300000000000001, -34.000000000000036, -11.2, -6.1, -21.899999999999995, -5.999999999999999, -16.89999999999999, -14.8, -10.899999999999999, -3.2, -6.2, -10.899999999999999, -3.2, -13.3, -3.5000000000000004, -17.3, -19.9, -7.300000000000001, -3.3, -5.300000000000001, -4.800000000000001, -9.3, -15.399999999999999, -3.2, -16.5, -17.9, -13.9, -16.700000000000003, -14.299999999999981, -38.2, -13.599999999999998, -3.2, -17.7, -7.5, -6.300000000000001, -11.4, -5.1, -19.7, -18.300000000000004, -25.400000000000006, -12.299999999999999, -3.3, -10.999999999999998, -13.4, -17.6, -19.099999999999998, -4.300000000000001, -15.7, -13.499999999999993, -9.7, -9.600000000000001, -5.5, -20.300000000000004, -5.2, -12.299999999999988, -10.799999999999997, -12.899999999999999, -11.7, -17.09999999999999, -4.2, -4.2, -7.999999999999998, -5.300000000000001, -10.7, -6.699999999999999, -7.2, -4.300000000000001, -13.3, -12.699999999999998, -11.2, -6.300000000000001, -5.300000000000001, -13.2, -22.39999999999999, -5.1000000000000005, -5.300000000000001, -5.2, -10.7, -3.8000000000000007], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.357681143387798, "mean_inference_ms": 1.7519096756699588, "mean_action_processing_ms": 0.09805374391277155, "mean_env_wait_ms": 8.037855319864978, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1152000, "timesteps_this_iter": 0, "agent_timesteps_total": 1152000, "timers": {"sample_time_ms": 17137.371, "sample_throughput": 233.408, "load_time_ms": 0.33, "load_throughput": 12103026.98, "learn_time_ms": 8312.0, "learn_throughput": 481.232, "update_time_ms": 1.618}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.08224174540705217, "policy_loss": -0.010087512020942985, "vf_loss": 9.138917075049493, "vf_explained_var": 0.26464820452915727, "kl": 0.007825231081984855, "entropy": 0.19357654800017673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1152000, "num_agent_steps_sampled": 1152000, "num_steps_trained": 1152000, "num_agent_steps_trained": 1152000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11636, "training_iteration": 288, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-58-18", "timestamp": 1643651898, "time_this_iter_s": 16.236726999282837, "time_total_s": 6568.225886106491, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6568.225886106491, "timesteps_since_restore": 0, "iterations_since_restore": 288, "perf": {"cpu_util_percent": 33.06521739130435, "ram_util_percent": 62.43043478260872}}
{"episode_reward_max": -2.2, "episode_reward_min": -87.59999999999988, "episode_reward_mean": -11.679999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -4.800000000000001, -9.3, -15.399999999999999, -3.2, -16.5, -17.9, -13.9, -16.700000000000003, -14.299999999999981, -38.2, -13.599999999999998, -3.2, -17.7, -7.5, -6.300000000000001, -11.4, -5.1, -19.7, -18.300000000000004, -25.400000000000006, -12.299999999999999, -3.3, -10.999999999999998, -13.4, -17.6, -19.099999999999998, -4.300000000000001, -15.7, -13.499999999999993, -9.7, -9.600000000000001, -5.5, -20.300000000000004, -5.2, -12.299999999999988, -10.799999999999997, -12.899999999999999, -11.7, -17.09999999999999, -4.2, -4.2, -7.999999999999998, -5.300000000000001, -10.7, -6.699999999999999, -7.2, -4.300000000000001, -13.3, -12.699999999999998, -11.2, -6.300000000000001, -5.300000000000001, -13.2, -22.39999999999999, -5.1000000000000005, -5.300000000000001, -5.2, -10.7, -3.8000000000000007, -13.600000000000001, -8.899999999999999, -17.6, -8.399999999999999, -4.3, -20.2, -11.2, -13.49999999999999, -5.899999999999999, -9.6, -9.099999999999998, -9.3, -14.199999999999994, -4.300000000000001, -13.8, -5.2, -7.099999999999998, -9.2, -3.5000000000000004, -18.099999999999994, -3.3, -17.4, -4.2, -8.2, -5.9, -87.59999999999988, -4.2, -15.1, -13.099999999999996, -2.2, -9.799999999999999, -15.600000000000001, -22.2, -23.2, -4.3, -4.2, -19.0, -11.099999999999998, -4.300000000000001, -11.999999999999996], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3563832479657498, "mean_inference_ms": 1.750129961393101, "mean_action_processing_ms": 0.09795480009574398, "mean_env_wait_ms": 8.029573614378277, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1156000, "timesteps_this_iter": 0, "agent_timesteps_total": 1156000, "timers": {"sample_time_ms": 16817.973, "sample_throughput": 237.841, "load_time_ms": 0.332, "load_throughput": 12055195.804, "learn_time_ms": 8350.253, "learn_throughput": 479.027, "update_time_ms": 1.627}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.33647541983481194, "policy_loss": -0.016504214392594432, "vf_loss": 35.13592236926479, "vf_explained_var": 0.22703545381945947, "kl": 0.013488223238256701, "entropy": 0.22208789001389218, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1156000, "num_agent_steps_sampled": 1156000, "num_steps_trained": 1156000, "num_agent_steps_trained": 1156000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11676, "training_iteration": 289, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-58-35", "timestamp": 1643651915, "time_this_iter_s": 16.57280993461609, "time_total_s": 6584.798696041107, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6584.798696041107, "timesteps_since_restore": 0, "iterations_since_restore": 289, "perf": {"cpu_util_percent": 32.791666666666664, "ram_util_percent": 62.4}}
{"episode_reward_max": -2.2, "episode_reward_min": -87.59999999999988, "episode_reward_mean": -13.567, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -4.2, -7.999999999999998, -5.300000000000001, -10.7, -6.699999999999999, -7.2, -4.300000000000001, -13.3, -12.699999999999998, -11.2, -6.300000000000001, -5.300000000000001, -13.2, -22.39999999999999, -5.1000000000000005, -5.300000000000001, -5.2, -10.7, -3.8000000000000007, -13.600000000000001, -8.899999999999999, -17.6, -8.399999999999999, -4.3, -20.2, -11.2, -13.49999999999999, -5.899999999999999, -9.6, -9.099999999999998, -9.3, -14.199999999999994, -4.300000000000001, -13.8, -5.2, -7.099999999999998, -9.2, -3.5000000000000004, -18.099999999999994, -3.3, -17.4, -4.2, -8.2, -5.9, -87.59999999999988, -4.2, -15.1, -13.099999999999996, -2.2, -9.799999999999999, -15.600000000000001, -22.2, -23.2, -4.3, -4.2, -19.0, -11.099999999999998, -4.300000000000001, -11.999999999999996, -6.300000000000001, -5.3, -5.300000000000001, -34.60000000000001, -4.2, -21.800000000000004, -14.5, -6.2, -12.5, -5.2, -6.2, -8.1, -6.299999999999998, -4.2, -24.2, -16.9, -5.4, -39.2, -27.3, -9.2, -12.999999999999998, -39.800000000000004, -23.5, -13.2, -8.999999999999998, -14.799999999999997, -10.499999999999998, -14.699999999999998, -25.3, -66.2, -21.5, -9.1, -13.6, -23.5, -4.2, -11.6, -79.4, -12.2, -12.799999999999997, -16.9], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3548349260900199, "mean_inference_ms": 1.7483374564808412, "mean_action_processing_ms": 0.09779482401693393, "mean_env_wait_ms": 8.020970479337967, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1160000, "timesteps_this_iter": 0, "agent_timesteps_total": 1160000, "timers": {"sample_time_ms": 16938.52, "sample_throughput": 236.148, "load_time_ms": 0.336, "load_throughput": 11914790.143, "learn_time_ms": 8372.709, "learn_throughput": 477.743, "update_time_ms": 1.614}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.501657405864918, "policy_loss": -0.009966183467818204, "vf_loss": 51.039611801601225, "vf_explained_var": 0.05220845450637161, "kl": 0.010217470611671074, "entropy": 0.21322020601521255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1160000, "num_agent_steps_sampled": 1160000, "num_steps_trained": 1160000, "num_agent_steps_trained": 1160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11716, "training_iteration": 290, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-58-51", "timestamp": 1643651931, "time_this_iter_s": 16.27373170852661, "time_total_s": 6601.072427749634, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6601.072427749634, "timesteps_since_restore": 0, "iterations_since_restore": 290, "perf": {"cpu_util_percent": 34.00434782608695, "ram_util_percent": 62.40000000000002}}
{"episode_reward_max": -2.2, "episode_reward_min": -87.59999999999988, "episode_reward_mean": -14.719, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -17.4, -4.2, -8.2, -5.9, -87.59999999999988, -4.2, -15.1, -13.099999999999996, -2.2, -9.799999999999999, -15.600000000000001, -22.2, -23.2, -4.3, -4.2, -19.0, -11.099999999999998, -4.300000000000001, -11.999999999999996, -6.300000000000001, -5.3, -5.300000000000001, -34.60000000000001, -4.2, -21.800000000000004, -14.5, -6.2, -12.5, -5.2, -6.2, -8.1, -6.299999999999998, -4.2, -24.2, -16.9, -5.4, -39.2, -27.3, -9.2, -12.999999999999998, -39.800000000000004, -23.5, -13.2, -8.999999999999998, -14.799999999999997, -10.499999999999998, -14.699999999999998, -25.3, -66.2, -21.5, -9.1, -13.6, -23.5, -4.2, -11.6, -79.4, -12.2, -12.799999999999997, -16.9, -5.4, -6.300000000000001, -13.1, -12.399999999999997, -11.799999999999994, -4.300000000000001, -11.399999999999999, -4.2, -4.700000000000001, -5.499999999999999, -40.00000000000005, -3.7, -26.299999999999994, -4.300000000000001, -4.300000000000001, -5.2, -17.8, -21.500000000000007, -9.000000000000002, -8.8, -13.199999999999998, -10.099999999999998, -18.4, -68.39999999999999, -6.3, -17.6, -10.1, -8.899999999999999, -20.299999999999997, -12.999999999999998, -15.199999999999996, -3.3, -4.300000000000001, -8.2, -3.3, -5.300000000000001, -8.700000000000001, -13.1, -9.3, -10.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3532721586747496, "mean_inference_ms": 1.7464841663796935, "mean_action_processing_ms": 0.09768738214261184, "mean_env_wait_ms": 8.011623090352233, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1164000, "timesteps_this_iter": 0, "agent_timesteps_total": 1164000, "timers": {"sample_time_ms": 16924.897, "sample_throughput": 236.338, "load_time_ms": 0.345, "load_throughput": 11597688.373, "learn_time_ms": 8217.231, "learn_throughput": 486.782, "update_time_ms": 1.555}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.2875550397796937, "policy_loss": -0.013356300516514688, "vf_loss": 30.00014817458327, "vf_explained_var": 0.06128157024742455, "kl": 0.007573676638939761, "entropy": 0.2042250631557357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1164000, "num_agent_steps_sampled": 1164000, "num_steps_trained": 1164000, "num_agent_steps_trained": 1164000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11756, "training_iteration": 291, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-59-07", "timestamp": 1643651947, "time_this_iter_s": 15.265351295471191, "time_total_s": 6616.337779045105, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6616.337779045105, "timesteps_since_restore": 0, "iterations_since_restore": 291, "perf": {"cpu_util_percent": 26.79090909090909, "ram_util_percent": 62.40909090909092}}
{"episode_reward_max": -3.3, "episode_reward_min": -79.4, "episode_reward_mean": -14.026, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.999999999999998, -39.800000000000004, -23.5, -13.2, -8.999999999999998, -14.799999999999997, -10.499999999999998, -14.699999999999998, -25.3, -66.2, -21.5, -9.1, -13.6, -23.5, -4.2, -11.6, -79.4, -12.2, -12.799999999999997, -16.9, -5.4, -6.300000000000001, -13.1, -12.399999999999997, -11.799999999999994, -4.300000000000001, -11.399999999999999, -4.2, -4.700000000000001, -5.499999999999999, -40.00000000000005, -3.7, -26.299999999999994, -4.300000000000001, -4.300000000000001, -5.2, -17.8, -21.500000000000007, -9.000000000000002, -8.8, -13.199999999999998, -10.099999999999998, -18.4, -68.39999999999999, -6.3, -17.6, -10.1, -8.899999999999999, -20.299999999999997, -12.999999999999998, -15.199999999999996, -3.3, -4.300000000000001, -8.2, -3.3, -5.300000000000001, -8.700000000000001, -13.1, -9.3, -10.3, -18.699999999999996, -19.300000000000004, -12.899999999999999, -8.2, -11.499999999999998, -5.3, -5.2, -5.5, -18.0, -10.3, -13.0, -6.4, -25.6, -31.400000000000006, -4.300000000000001, -31.600000000000048, -12.7, -6.2, -16.199999999999996, -8.2, -14.8, -13.399999999999999, -10.0, -12.899999999999999, -6.0, -13.199999999999998, -20.400000000000006, -12.599999999999998, -7.299999999999999, -9.599999999999998, -4.2, -9.3, -14.399999999999999, -7.9, -11.2, -4.300000000000001, -15.7, -14.2, -4.300000000000001, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3518946565535304, "mean_inference_ms": 1.744802736398305, "mean_action_processing_ms": 0.09759310492000216, "mean_env_wait_ms": 8.003669164640268, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1168000, "timesteps_this_iter": 0, "agent_timesteps_total": 1168000, "timers": {"sample_time_ms": 16568.623, "sample_throughput": 241.42, "load_time_ms": 0.342, "load_throughput": 11684925.477, "learn_time_ms": 8282.473, "learn_throughput": 482.948, "update_time_ms": 1.684}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.0978642325848341, "policy_loss": -0.019567803518786547, "vf_loss": 11.67796947943267, "vf_explained_var": 0.1677444270862046, "kl": 0.005430076203051783, "entropy": 0.22731763227011567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1168000, "num_agent_steps_sampled": 1168000, "num_steps_trained": 1168000, "num_agent_steps_trained": 1168000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11796, "training_iteration": 292, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-59-25", "timestamp": 1643651965, "time_this_iter_s": 18.170618772506714, "time_total_s": 6634.508397817612, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6634.508397817612, "timesteps_since_restore": 0, "iterations_since_restore": 292, "perf": {"cpu_util_percent": 37.51538461538462, "ram_util_percent": 62.51153846153845}}
{"episode_reward_max": -1.2, "episode_reward_min": -68.39999999999999, "episode_reward_mean": -11.915, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.199999999999998, -10.099999999999998, -18.4, -68.39999999999999, -6.3, -17.6, -10.1, -8.899999999999999, -20.299999999999997, -12.999999999999998, -15.199999999999996, -3.3, -4.300000000000001, -8.2, -3.3, -5.300000000000001, -8.700000000000001, -13.1, -9.3, -10.3, -18.699999999999996, -19.300000000000004, -12.899999999999999, -8.2, -11.499999999999998, -5.3, -5.2, -5.5, -18.0, -10.3, -13.0, -6.4, -25.6, -31.400000000000006, -4.300000000000001, -31.600000000000048, -12.7, -6.2, -16.199999999999996, -8.2, -14.8, -13.399999999999999, -10.0, -12.899999999999999, -6.0, -13.199999999999998, -20.400000000000006, -12.599999999999998, -7.299999999999999, -9.599999999999998, -4.2, -9.3, -14.399999999999999, -7.9, -11.2, -4.300000000000001, -15.7, -14.2, -4.300000000000001, -4.300000000000001, -10.2, -10.2, -6.699999999999999, -11.599999999999987, -1.2, -8.8, -68.3, -5.2, -5.6, -3.3, -4.1, -12.7, -16.4, -15.399999999999979, -16.799999999999997, -11.7, -8.7, -3.2, -6.2, -6.300000000000001, -13.9, -14.9, -10.999999999999998, -9.8, -10.3, -6.199999999999999, -5.300000000000001, -8.399999999999999, -16.199999999999996, -8.499999999999998, -13.099999999999998, -9.899999999999999, -5.2, -6.3, -8.499999999999998, -8.299999999999999, -20.699999999999996, -14.599999999999996, -16.799999999999997, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3507256764045974, "mean_inference_ms": 1.7435298038328637, "mean_action_processing_ms": 0.09752188511154568, "mean_env_wait_ms": 7.997689621011777, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1172000, "timesteps_this_iter": 0, "agent_timesteps_total": 1172000, "timers": {"sample_time_ms": 16814.675, "sample_throughput": 237.887, "load_time_ms": 0.343, "load_throughput": 11647608.998, "learn_time_ms": 8626.063, "learn_throughput": 463.711, "update_time_ms": 1.696}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.1262520442228584, "policy_loss": -0.010731431079768044, "vf_loss": 13.63400305647363, "vf_explained_var": 0.2681882200702544, "kl": 0.005356030904790394, "entropy": 0.19692612954525537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1172000, "num_agent_steps_sampled": 1172000, "num_steps_trained": 1172000, "num_agent_steps_trained": 1172000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11836, "training_iteration": 293, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_17-59-54", "timestamp": 1643651994, "time_this_iter_s": 29.14198589324951, "time_total_s": 6663.650383710861, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6663.650383710861, "timesteps_since_restore": 0, "iterations_since_restore": 293, "perf": {"cpu_util_percent": 36.307317073170736, "ram_util_percent": 62.75853658536585}}
{"episode_reward_max": -1.2, "episode_reward_min": -68.3, "episode_reward_mean": -11.482000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.8, -13.399999999999999, -10.0, -12.899999999999999, -6.0, -13.199999999999998, -20.400000000000006, -12.599999999999998, -7.299999999999999, -9.599999999999998, -4.2, -9.3, -14.399999999999999, -7.9, -11.2, -4.300000000000001, -15.7, -14.2, -4.300000000000001, -4.300000000000001, -10.2, -10.2, -6.699999999999999, -11.599999999999987, -1.2, -8.8, -68.3, -5.2, -5.6, -3.3, -4.1, -12.7, -16.4, -15.399999999999979, -16.799999999999997, -11.7, -8.7, -3.2, -6.2, -6.300000000000001, -13.9, -14.9, -10.999999999999998, -9.8, -10.3, -6.199999999999999, -5.300000000000001, -8.399999999999999, -16.199999999999996, -8.499999999999998, -13.099999999999998, -9.899999999999999, -5.2, -6.3, -8.499999999999998, -8.299999999999999, -20.699999999999996, -14.599999999999996, -16.799999999999997, -3.2, -23.2, -10.500000000000002, -24.2, -21.1, -12.5, -5.699999999999999, -6.2, -10.0, -15.3, -5.1, -13.1, -12.2, -19.300000000000004, -3.4, -8.7, -25.600000000000005, -5.9, -45.2, -23.2, -4.5, -11.699999999999998, -3.900000000000001, -4.2, -15.899999999999999, -7.0, -7.999999999999999, -15.199999999999978, -8.4, -19.199999999999996, -15.4, -3.3, -12.099999999999998, -16.799999999999997, -14.2, -10.599999999999998, -10.1, -3.3, -5.2, -4.2, -10.899999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3501864861067825, "mean_inference_ms": 1.7435791462321923, "mean_action_processing_ms": 0.09748656164831436, "mean_env_wait_ms": 7.995786884879026, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1176000, "timesteps_this_iter": 0, "agent_timesteps_total": 1176000, "timers": {"sample_time_ms": 19726.385, "sample_throughput": 202.774, "load_time_ms": 0.348, "load_throughput": 11491243.836, "learn_time_ms": 8617.823, "learn_throughput": 464.154, "update_time_ms": 1.688}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.14211974106328462, "policy_loss": -0.0065625962911434075, "vf_loss": 14.794420909240682, "vf_explained_var": 0.0066504169535893266, "kl": 0.006144167850269676, "entropy": 0.21610532053696213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1176000, "num_agent_steps_sampled": 1176000, "num_steps_trained": 1176000, "num_agent_steps_trained": 1176000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11876, "training_iteration": 294, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-00-28", "timestamp": 1643652028, "time_this_iter_s": 20.799553871154785, "time_total_s": 6684.449937582016, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6684.449937582016, "timesteps_since_restore": 0, "iterations_since_restore": 294, "perf": {"cpu_util_percent": 35.699999999999996, "ram_util_percent": 64.00416666666666}}
{"episode_reward_max": -3.2, "episode_reward_min": -74.3, "episode_reward_mean": -11.972000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.9, -14.9, -10.999999999999998, -9.8, -10.3, -6.199999999999999, -5.300000000000001, -8.399999999999999, -16.199999999999996, -8.499999999999998, -13.099999999999998, -9.899999999999999, -5.2, -6.3, -8.499999999999998, -8.299999999999999, -20.699999999999996, -14.599999999999996, -16.799999999999997, -3.2, -23.2, -10.500000000000002, -24.2, -21.1, -12.5, -5.699999999999999, -6.2, -10.0, -15.3, -5.1, -13.1, -12.2, -19.300000000000004, -3.4, -8.7, -25.600000000000005, -5.9, -45.2, -23.2, -4.5, -11.699999999999998, -3.900000000000001, -4.2, -15.899999999999999, -7.0, -7.999999999999999, -15.199999999999978, -8.4, -19.199999999999996, -15.4, -3.3, -12.099999999999998, -16.799999999999997, -14.2, -10.599999999999998, -10.1, -3.3, -5.2, -4.2, -10.899999999999999, -13.299999999999999, -10.299999999999999, -5.2, -10.6, -17.6, -8.9, -19.6, -3.8000000000000007, -11.7, -4.3, -16.9, -3.3, -4.800000000000001, -74.3, -4.2, -14.099999999999998, -6.1, -8.299999999999999, -17.200000000000003, -3.6, -12.3, -6.2, -8.0, -10.099999999999998, -19.7, -16.7, -17.3, -17.1, -5.300000000000001, -5.799999999999999, -5.499999999999998, -6.300000000000001, -12.2, -5.300000000000001, -9.2, -16.8, -14.8, -4.3, -24.7, -15.899999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.349460852563849, "mean_inference_ms": 1.7432214970414086, "mean_action_processing_ms": 0.09742835073362731, "mean_env_wait_ms": 7.991914331554872, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1180000, "timesteps_this_iter": 0, "agent_timesteps_total": 1180000, "timers": {"sample_time_ms": 19611.669, "sample_throughput": 203.96, "load_time_ms": 0.345, "load_throughput": 11580876.648, "learn_time_ms": 8522.046, "learn_throughput": 469.371, "update_time_ms": 1.694}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 0.00010000000000000003, "total_loss": 0.32891851356253027, "policy_loss": -0.007887111230683263, "vf_loss": 33.62760884729765, "vf_explained_var": 0.15055651248142282, "kl": 0.004407897939976534, "entropy": 0.19059319268631678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1180000, "num_agent_steps_sampled": 1180000, "num_steps_trained": 1180000, "num_agent_steps_trained": 1180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11916, "training_iteration": 295, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-00-43", "timestamp": 1643652043, "time_this_iter_s": 14.955252170562744, "time_total_s": 6699.405189752579, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6699.405189752579, "timesteps_since_restore": 0, "iterations_since_restore": 295, "perf": {"cpu_util_percent": 29.571428571428566, "ram_util_percent": 64.09047619047617}}
{"episode_reward_max": -2.5000000000000004, "episode_reward_min": -98.3, "episode_reward_mean": -12.543, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.699999999999998, -3.900000000000001, -4.2, -15.899999999999999, -7.0, -7.999999999999999, -15.199999999999978, -8.4, -19.199999999999996, -15.4, -3.3, -12.099999999999998, -16.799999999999997, -14.2, -10.599999999999998, -10.1, -3.3, -5.2, -4.2, -10.899999999999999, -13.299999999999999, -10.299999999999999, -5.2, -10.6, -17.6, -8.9, -19.6, -3.8000000000000007, -11.7, -4.3, -16.9, -3.3, -4.800000000000001, -74.3, -4.2, -14.099999999999998, -6.1, -8.299999999999999, -17.200000000000003, -3.6, -12.3, -6.2, -8.0, -10.099999999999998, -19.7, -16.7, -17.3, -17.1, -5.300000000000001, -5.799999999999999, -5.499999999999998, -6.300000000000001, -12.2, -5.300000000000001, -9.2, -16.8, -14.8, -4.3, -24.7, -15.899999999999999, -21.900000000000006, -4.9, -12.199999999999998, -16.999999999999996, -9.2, -7.89999999999999, -98.3, -15.899999999999999, -9.199999999999998, -12.099999999999971, -5.2, -11.6, -18.7, -5.300000000000001, -11.9, -7.299999999999998, -5.800000000000001, -4.3, -3.3000000000000003, -4.3, -10.2, -10.0, -62.30000000000011, -13.7, -2.5000000000000004, -28.1, -3.3, -7.899999999999998, -3.3, -8.899999999999999, -4.2, -21.100000000000012, -11.899999999999997, -14.799999999999999, -11.2, -13.2, -22.4, -3.2, -6.300000000000001, -18.299999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3483633661008037, "mean_inference_ms": 1.742044951455494, "mean_action_processing_ms": 0.0973394370853512, "mean_env_wait_ms": 7.984929381126277, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1184000, "timesteps_this_iter": 0, "agent_timesteps_total": 1184000, "timers": {"sample_time_ms": 19378.69, "sample_throughput": 206.412, "load_time_ms": 0.35, "load_throughput": 11428621.253, "learn_time_ms": 8471.141, "learn_throughput": 472.191, "update_time_ms": 1.719}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.4923694743878729, "policy_loss": -0.01741073771419945, "vf_loss": 50.909804725262426, "vf_explained_var": -0.15074516887305886, "kl": 0.011356892521632153, "entropy": 0.19609335051669227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1184000, "num_agent_steps_sampled": 1184000, "num_steps_trained": 1184000, "num_agent_steps_trained": 1184000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11956, "training_iteration": 296, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-00-59", "timestamp": 1643652059, "time_this_iter_s": 15.797748804092407, "time_total_s": 6715.202938556671, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6715.202938556671, "timesteps_since_restore": 0, "iterations_since_restore": 296, "perf": {"cpu_util_percent": 27.169565217391302, "ram_util_percent": 62.926086956521736}}
{"episode_reward_max": -2.5000000000000004, "episode_reward_min": -98.3, "episode_reward_mean": -12.586000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.7, -16.7, -17.3, -17.1, -5.300000000000001, -5.799999999999999, -5.499999999999998, -6.300000000000001, -12.2, -5.300000000000001, -9.2, -16.8, -14.8, -4.3, -24.7, -15.899999999999999, -21.900000000000006, -4.9, -12.199999999999998, -16.999999999999996, -9.2, -7.89999999999999, -98.3, -15.899999999999999, -9.199999999999998, -12.099999999999971, -5.2, -11.6, -18.7, -5.300000000000001, -11.9, -7.299999999999998, -5.800000000000001, -4.3, -3.3000000000000003, -4.3, -10.2, -10.0, -62.30000000000011, -13.7, -2.5000000000000004, -28.1, -3.3, -7.899999999999998, -3.3, -8.899999999999999, -4.2, -21.100000000000012, -11.899999999999997, -14.799999999999999, -11.2, -13.2, -22.4, -3.2, -6.300000000000001, -18.299999999999997, -8.2, -9.799999999999997, -10.3, -7.399999999999999, -11.2, -3.3, -18.2, -27.4, -3.3, -8.2, -6.5, -7.6, -6.599999999999999, -3.3, -9.2, -5.5, -20.7, -11.4, -3.3, -15.1, -4.2, -5.8999999999999995, -8.499999999999998, -11.799999999999999, -18.800000000000004, -22.200000000000042, -14.799999999999995, -9.3, -4.300000000000001, -17.600000000000005, -17.900000000000002, -4.3, -4.2, -8.600000000000001, -12.199999999999998, -46.3, -12.899999999999999, -25.100000000000012, -11.3, -16.299999999999997, -5.300000000000001, -7.4, -3.4, -9.5], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3473794548614597, "mean_inference_ms": 1.7399836913229731, "mean_action_processing_ms": 0.09728923793438497, "mean_env_wait_ms": 7.976339286932937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1188000, "timesteps_this_iter": 0, "agent_timesteps_total": 1188000, "timers": {"sample_time_ms": 19305.792, "sample_throughput": 207.192, "load_time_ms": 0.355, "load_throughput": 11271223.379, "learn_time_ms": 8390.872, "learn_throughput": 476.709, "update_time_ms": 1.726}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.19711040749054362, "policy_loss": -0.013552769391937683, "vf_loss": 20.949500098023364, "vf_explained_var": -0.04145041569586723, "kl": 0.019447693508058573, "entropy": 0.1959794223028165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1188000, "num_agent_steps_sampled": 1188000, "num_steps_trained": 1188000, "num_agent_steps_trained": 1188000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12000, "training_iteration": 297, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-01-14", "timestamp": 1643652074, "time_this_iter_s": 15.697428941726685, "time_total_s": 6730.900367498398, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6730.900367498398, "timesteps_since_restore": 0, "iterations_since_restore": 297, "perf": {"cpu_util_percent": 30.29090909090909, "ram_util_percent": 61.886363636363654}}
{"episode_reward_max": -2.5000000000000004, "episode_reward_min": -64.20000000000002, "episode_reward_mean": -11.806, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.5000000000000004, -28.1, -3.3, -7.899999999999998, -3.3, -8.899999999999999, -4.2, -21.100000000000012, -11.899999999999997, -14.799999999999999, -11.2, -13.2, -22.4, -3.2, -6.300000000000001, -18.299999999999997, -8.2, -9.799999999999997, -10.3, -7.399999999999999, -11.2, -3.3, -18.2, -27.4, -3.3, -8.2, -6.5, -7.6, -6.599999999999999, -3.3, -9.2, -5.5, -20.7, -11.4, -3.3, -15.1, -4.2, -5.8999999999999995, -8.499999999999998, -11.799999999999999, -18.800000000000004, -22.200000000000042, -14.799999999999995, -9.3, -4.300000000000001, -17.600000000000005, -17.900000000000002, -4.3, -4.2, -8.600000000000001, -12.199999999999998, -46.3, -12.899999999999999, -25.100000000000012, -11.3, -16.299999999999997, -5.300000000000001, -7.4, -3.4, -9.5, -9.2, -18.6, -10.799999999999997, -8.4, -14.4, -18.4, -19.3, -24.300000000000004, -15.799999999999999, -4.3, -3.3, -12.099999999999998, -3.3, -6.999999999999998, -20.400000000000002, -27.2, -12.0, -3.3, -64.20000000000002, -12.099999999999971, -4.2, -14.399999999999999, -7.1, -3.3, -14.2, -12.5, -5.4, -5.499999999999999, -15.999999999999998, -17.299999999999997, -21.000000000000007, -13.5, -7.0, -9.299999999999997, -3.2, -13.2, -7.8, -3.2, -7.6000000000000005, -7.299999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.346281046003321, "mean_inference_ms": 1.7382278866876688, "mean_action_processing_ms": 0.09719018811114825, "mean_env_wait_ms": 7.968040137614932, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1192000, "timesteps_this_iter": 0, "agent_timesteps_total": 1192000, "timers": {"sample_time_ms": 19195.968, "sample_throughput": 208.377, "load_time_ms": 0.353, "load_throughput": 11345155.532, "learn_time_ms": 8286.355, "learn_throughput": 482.721, "update_time_ms": 1.709}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.22332165779305563, "policy_loss": -0.0059983234767431535, "vf_loss": 22.865265530540096, "vf_explained_var": 0.12565335996689336, "kl": 0.011109595211006755, "entropy": 0.20934018787517342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1192000, "num_agent_steps_sampled": 1192000, "num_steps_trained": 1192000, "num_agent_steps_trained": 1192000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12040, "training_iteration": 298, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-01-29", "timestamp": 1643652089, "time_this_iter_s": 14.889997005462646, "time_total_s": 6745.7903645038605, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6745.7903645038605, "timesteps_since_restore": 0, "iterations_since_restore": 298, "perf": {"cpu_util_percent": 28.09047619047619, "ram_util_percent": 62.01904761904765}}
{"episode_reward_max": -3.2, "episode_reward_min": -64.20000000000002, "episode_reward_mean": -12.114999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.800000000000004, -22.200000000000042, -14.799999999999995, -9.3, -4.300000000000001, -17.600000000000005, -17.900000000000002, -4.3, -4.2, -8.600000000000001, -12.199999999999998, -46.3, -12.899999999999999, -25.100000000000012, -11.3, -16.299999999999997, -5.300000000000001, -7.4, -3.4, -9.5, -9.2, -18.6, -10.799999999999997, -8.4, -14.4, -18.4, -19.3, -24.300000000000004, -15.799999999999999, -4.3, -3.3, -12.099999999999998, -3.3, -6.999999999999998, -20.400000000000002, -27.2, -12.0, -3.3, -64.20000000000002, -12.099999999999971, -4.2, -14.399999999999999, -7.1, -3.3, -14.2, -12.5, -5.4, -5.499999999999999, -15.999999999999998, -17.299999999999997, -21.000000000000007, -13.5, -7.0, -9.299999999999997, -3.2, -13.2, -7.8, -3.2, -7.6000000000000005, -7.299999999999999, -4.2, -4.4, -11.3, -6.999999999999999, -9.299999999999999, -42.3, -9.000000000000002, -9.799999999999997, -20.2, -6.3, -18.900000000000006, -15.599999999999998, -16.4, -8.799999999999997, -12.499999999999996, -9.3, -16.999999999999996, -3.2, -9.3, -16.2, -11.6, -9.3, -4.2, -12.8, -4.6000000000000005, -9.899999999999997, -3.2, -26.700000000000003, -5.3, -4.2, -3.3, -11.2, -10.799999999999999, -18.4, -12.399999999999999, -9.2, -6.799999999999999, -11.899999999999997, -5.300000000000001, -6.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3449350781299751, "mean_inference_ms": 1.7364408064772612, "mean_action_processing_ms": 0.09702871016197516, "mean_env_wait_ms": 7.959165159680638, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1196000, "timesteps_this_iter": 0, "agent_timesteps_total": 1196000, "timers": {"sample_time_ms": 19097.267, "sample_throughput": 209.454, "load_time_ms": 0.352, "load_throughput": 11376697.633, "learn_time_ms": 8183.656, "learn_throughput": 488.779, "update_time_ms": 1.674}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.10035002169735048, "policy_loss": -0.009627711480503441, "vf_loss": 10.942364135192287, "vf_explained_var": 0.33589343665748517, "kl": 0.009224507030519575, "entropy": 0.20138547410888055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1196000, "num_agent_steps_sampled": 1196000, "num_steps_trained": 1196000, "num_agent_steps_trained": 1196000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12080, "training_iteration": 299, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-01-45", "timestamp": 1643652105, "time_this_iter_s": 15.604954719543457, "time_total_s": 6761.395319223404, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6761.395319223404, "timesteps_since_restore": 0, "iterations_since_restore": 299, "perf": {"cpu_util_percent": 22.290909090909093, "ram_util_percent": 62.06363636363635}}
{"episode_reward_max": -3.2, "episode_reward_min": -42.3, "episode_reward_mean": -10.360999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -14.399999999999999, -7.1, -3.3, -14.2, -12.5, -5.4, -5.499999999999999, -15.999999999999998, -17.299999999999997, -21.000000000000007, -13.5, -7.0, -9.299999999999997, -3.2, -13.2, -7.8, -3.2, -7.6000000000000005, -7.299999999999999, -4.2, -4.4, -11.3, -6.999999999999999, -9.299999999999999, -42.3, -9.000000000000002, -9.799999999999997, -20.2, -6.3, -18.900000000000006, -15.599999999999998, -16.4, -8.799999999999997, -12.499999999999996, -9.3, -16.999999999999996, -3.2, -9.3, -16.2, -11.6, -9.3, -4.2, -12.8, -4.6000000000000005, -9.899999999999997, -3.2, -26.700000000000003, -5.3, -4.2, -3.3, -11.2, -10.799999999999999, -18.4, -12.399999999999999, -9.2, -6.799999999999999, -11.899999999999997, -5.300000000000001, -6.300000000000001, -20.799999999999997, -10.6, -18.3, -3.3, -20.999999999999996, -3.2, -10.199999999999998, -9.3, -3.3, -13.7, -5.2, -8.5, -3.3, -13.5, -3.2, -10.2, -19.7, -3.3, -4.800000000000001, -12.299999999999997, -6.2, -4.2, -5.300000000000001, -7.999999999999998, -8.5, -13.5, -4.3, -8.7, -8.7, -29.300000000000026, -4.3, -24.60000000000001, -3.3, -8.600000000000001, -4.300000000000001, -17.9, -8.7, -8.3, -10.0, -20.300000000000008], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3435989858299069, "mean_inference_ms": 1.734719637448215, "mean_action_processing_ms": 0.09692786296529528, "mean_env_wait_ms": 7.9503435918130485, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1200000, "timesteps_this_iter": 0, "agent_timesteps_total": 1200000, "timers": {"sample_time_ms": 18992.07, "sample_throughput": 210.614, "load_time_ms": 0.345, "load_throughput": 11583275.338, "learn_time_ms": 8103.072, "learn_throughput": 493.64, "update_time_ms": 1.677}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.07382772960599952, "policy_loss": -0.013544828530340907, "vf_loss": 8.680877603446284, "vf_explained_var": 0.42228857483915105, "kl": 0.0093858208989184, "entropy": 0.19421739412211284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1200000, "num_agent_steps_sampled": 1200000, "num_steps_trained": 1200000, "num_agent_steps_trained": 1200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12120, "training_iteration": 300, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-02-00", "timestamp": 1643652120, "time_this_iter_s": 15.44052791595459, "time_total_s": 6776.8358471393585, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6776.8358471393585, "timesteps_since_restore": 0, "iterations_since_restore": 300, "perf": {"cpu_util_percent": 21.400000000000002, "ram_util_percent": 62.122727272727275}}
{"episode_reward_max": -2.7000000000000006, "episode_reward_min": -29.300000000000026, "episode_reward_mean": -9.702, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.6, -9.3, -4.2, -12.8, -4.6000000000000005, -9.899999999999997, -3.2, -26.700000000000003, -5.3, -4.2, -3.3, -11.2, -10.799999999999999, -18.4, -12.399999999999999, -9.2, -6.799999999999999, -11.899999999999997, -5.300000000000001, -6.300000000000001, -20.799999999999997, -10.6, -18.3, -3.3, -20.999999999999996, -3.2, -10.199999999999998, -9.3, -3.3, -13.7, -5.2, -8.5, -3.3, -13.5, -3.2, -10.2, -19.7, -3.3, -4.800000000000001, -12.299999999999997, -6.2, -4.2, -5.300000000000001, -7.999999999999998, -8.5, -13.5, -4.3, -8.7, -8.7, -29.300000000000026, -4.3, -24.60000000000001, -3.3, -8.600000000000001, -4.300000000000001, -17.9, -8.7, -8.3, -10.0, -20.300000000000008, -7.2, -5.2, -6.600000000000001, -23.3, -13.799999999999999, -18.7, -6.299999999999999, -2.7000000000000006, -12.099999999999996, -15.399999999999997, -3.2, -8.199999999999998, -3.3, -6.2, -7.799999999999998, -6.6000000000000005, -11.2, -10.7, -3.3, -8.399999999999999, -6.0, -4.4, -5.300000000000001, -8.499999999999998, -15.8, -16.5, -6.8, -18.300000000000004, -14.799999999999997, -3.4, -22.8, -5.4, -4.2, -7.8999999999999995, -5.9, -18.4, -11.399999999999999, -11.899999999999999, -3.2, -7.0], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3422222407591264, "mean_inference_ms": 1.7328491534356523, "mean_action_processing_ms": 0.09682345428309201, "mean_env_wait_ms": 7.941661922792246, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1204000, "timesteps_this_iter": 0, "agent_timesteps_total": 1204000, "timers": {"sample_time_ms": 18899.474, "sample_throughput": 211.646, "load_time_ms": 0.345, "load_throughput": 11596085.153, "learn_time_ms": 8086.036, "learn_throughput": 494.68, "update_time_ms": 1.67}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.055385625990788626, "policy_loss": -0.016627962790149192, "vf_loss": 7.097403988322263, "vf_explained_var": 0.3734981361896761, "kl": 0.017306296063138625, "entropy": 0.22339293378335173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1204000, "num_agent_steps_sampled": 1204000, "num_steps_trained": 1204000, "num_agent_steps_trained": 1204000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12160, "training_iteration": 301, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-02-16", "timestamp": 1643652136, "time_this_iter_s": 14.9758620262146, "time_total_s": 6791.811709165573, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6791.811709165573, "timesteps_since_restore": 0, "iterations_since_restore": 301, "perf": {"cpu_util_percent": 22.972727272727273, "ram_util_percent": 62.149999999999984}}
{"episode_reward_max": -2.3, "episode_reward_min": -65.3, "episode_reward_mean": -10.963, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -4.2, -5.300000000000001, -7.999999999999998, -8.5, -13.5, -4.3, -8.7, -8.7, -29.300000000000026, -4.3, -24.60000000000001, -3.3, -8.600000000000001, -4.300000000000001, -17.9, -8.7, -8.3, -10.0, -20.300000000000008, -7.2, -5.2, -6.600000000000001, -23.3, -13.799999999999999, -18.7, -6.299999999999999, -2.7000000000000006, -12.099999999999996, -15.399999999999997, -3.2, -8.199999999999998, -3.3, -6.2, -7.799999999999998, -6.6000000000000005, -11.2, -10.7, -3.3, -8.399999999999999, -6.0, -4.4, -5.300000000000001, -8.499999999999998, -15.8, -16.5, -6.8, -18.300000000000004, -14.799999999999997, -3.4, -22.8, -5.4, -4.2, -7.8999999999999995, -5.9, -18.4, -11.399999999999999, -11.899999999999999, -3.2, -7.0, -18.2, -17.799999999999997, -3.7, -6.299999999999994, -25.600000000000005, -22.00000000000001, -20.7, -11.799999999999999, -20.10000000000001, -3.3, -6.0, -7.9, -8.2, -4.300000000000001, -11.799999999999999, -11.3, -10.8, -35.80000000000001, -3.3, -10.299999999999995, -10.999999999999998, -21.999999999999986, -3.2, -5.699999999999999, -65.3, -5.2, -18.2, -2.5, -11.199999999999996, -10.799999999999999, -4.9, -5.300000000000001, -23.6, -4.300000000000001, -7.2, -2.4000000000000004, -20.300000000000008, -2.3, -4.3, -22.299999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.34063062697695, "mean_inference_ms": 1.7308921225678437, "mean_action_processing_ms": 0.09671463503695939, "mean_env_wait_ms": 7.932609793690667, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1208000, "timesteps_this_iter": 0, "agent_timesteps_total": 1208000, "timers": {"sample_time_ms": 18727.334, "sample_throughput": 213.592, "load_time_ms": 0.352, "load_throughput": 11351296.346, "learn_time_ms": 7845.811, "learn_throughput": 509.826, "update_time_ms": 1.544}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.17925612071018304, "policy_loss": -0.013838102980967491, "vf_loss": 19.254219030116193, "vf_explained_var": 0.12880378705199047, "kl": 0.009190236052761801, "entropy": 0.21972572409337568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1208000, "num_agent_steps_sampled": 1208000, "num_steps_trained": 1208000, "num_agent_steps_trained": 1208000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12200, "training_iteration": 302, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-02-30", "timestamp": 1643652150, "time_this_iter_s": 14.210853815078735, "time_total_s": 6806.022562980652, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6806.022562980652, "timesteps_since_restore": 0, "iterations_since_restore": 302, "perf": {"cpu_util_percent": 26.47, "ram_util_percent": 62.210000000000015}}
{"episode_reward_max": -2.3, "episode_reward_min": -80.4, "episode_reward_mean": -12.818999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, -4.4, -5.300000000000001, -8.499999999999998, -15.8, -16.5, -6.8, -18.300000000000004, -14.799999999999997, -3.4, -22.8, -5.4, -4.2, -7.8999999999999995, -5.9, -18.4, -11.399999999999999, -11.899999999999999, -3.2, -7.0, -18.2, -17.799999999999997, -3.7, -6.299999999999994, -25.600000000000005, -22.00000000000001, -20.7, -11.799999999999999, -20.10000000000001, -3.3, -6.0, -7.9, -8.2, -4.300000000000001, -11.799999999999999, -11.3, -10.8, -35.80000000000001, -3.3, -10.299999999999995, -10.999999999999998, -21.999999999999986, -3.2, -5.699999999999999, -65.3, -5.2, -18.2, -2.5, -11.199999999999996, -10.799999999999999, -4.9, -5.300000000000001, -23.6, -4.300000000000001, -7.2, -2.4000000000000004, -20.300000000000008, -2.3, -4.3, -22.299999999999997, -13.2, -18.1, -3.3, -12.0, -3.3, -34.9, -24.0, -9.3, -80.4, -17.699999999999996, -10.499999999999998, -5.1000000000000005, -10.5, -13.399999999999999, -8.3, -7.300000000000001, -20.7, -11.2, -19.5, -40.80000000000005, -12.499999999999996, -20.6, -4.2, -4.300000000000001, -11.199999999999989, -4.2, -8.9, -5.3, -6.3999999999999995, -15.099999999999996, -9.3, -16.2, -11.000000000000002, -15.699999999999998, -6.3, -11.799999999999999, -10.299999999999999, -16.4, -13.3, -6.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3390346231959755, "mean_inference_ms": 1.7288902280720486, "mean_action_processing_ms": 0.09660288075340173, "mean_env_wait_ms": 7.92330280966095, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1212000, "timesteps_this_iter": 0, "agent_timesteps_total": 1212000, "timers": {"sample_time_ms": 18257.688, "sample_throughput": 219.086, "load_time_ms": 0.353, "load_throughput": 11318367.402, "learn_time_ms": 7403.419, "learn_throughput": 540.291, "update_time_ms": 1.522}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.24196361400367272, "policy_loss": -0.008335332804790107, "vf_loss": 24.980111595251227, "vf_explained_var": 0.209192253569121, "kl": 0.008287977787436559, "entropy": 0.2112612239135209, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1212000, "num_agent_steps_sampled": 1212000, "num_steps_trained": 1212000, "num_agent_steps_trained": 1212000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12240, "training_iteration": 303, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-02-44", "timestamp": 1643652164, "time_this_iter_s": 14.26907205581665, "time_total_s": 6820.2916350364685, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6820.2916350364685, "timesteps_since_restore": 0, "iterations_since_restore": 303, "perf": {"cpu_util_percent": 27.725, "ram_util_percent": 62.09500000000001}}
{"episode_reward_max": -2.3, "episode_reward_min": -80.4, "episode_reward_mean": -13.445, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.999999999999998, -21.999999999999986, -3.2, -5.699999999999999, -65.3, -5.2, -18.2, -2.5, -11.199999999999996, -10.799999999999999, -4.9, -5.300000000000001, -23.6, -4.300000000000001, -7.2, -2.4000000000000004, -20.300000000000008, -2.3, -4.3, -22.299999999999997, -13.2, -18.1, -3.3, -12.0, -3.3, -34.9, -24.0, -9.3, -80.4, -17.699999999999996, -10.499999999999998, -5.1000000000000005, -10.5, -13.399999999999999, -8.3, -7.300000000000001, -20.7, -11.2, -19.5, -40.80000000000005, -12.499999999999996, -20.6, -4.2, -4.300000000000001, -11.199999999999989, -4.2, -8.9, -5.3, -6.3999999999999995, -15.099999999999996, -9.3, -16.2, -11.000000000000002, -15.699999999999998, -6.3, -11.799999999999999, -10.299999999999999, -16.4, -13.3, -6.300000000000001, -4.2, -4.4, -7.1, -5.300000000000001, -22.5, -20.4, -3.3, -3.2, -4.4, -13.599999999999998, -29.3, -3.4000000000000004, -10.2, -8.799999999999999, -4.2, -6.2, -30.9, -4.300000000000001, -33.19999999999998, -7.2, -18.200000000000003, -32.6, -4.3, -4.2, -5.300000000000001, -6.300000000000001, -5.4, -5.2, -13.0, -6.599999999999998, -5.2, -26.900000000000006, -13.299999999999999, -2.5, -32.50000000000001, -16.4, -14.099999999999998, -40.3, -29.700000000000003, -11.600000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.337496251239922, "mean_inference_ms": 1.7269177404236098, "mean_action_processing_ms": 0.09649277818747347, "mean_env_wait_ms": 7.91403534964498, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1216000, "timesteps_this_iter": 0, "agent_timesteps_total": 1216000, "timers": {"sample_time_ms": 15187.357, "sample_throughput": 263.377, "load_time_ms": 0.349, "load_throughput": 11454370.178, "learn_time_ms": 7294.064, "learn_throughput": 548.391, "update_time_ms": 1.509}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.19946276134791313, "policy_loss": -0.01798984125476851, "vf_loss": 21.70028810898463, "vf_explained_var": 0.17655444292611974, "kl": 0.007487046041142278, "entropy": 0.2094513787377265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1216000, "num_agent_steps_sampled": 1216000, "num_steps_trained": 1216000, "num_agent_steps_trained": 1216000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12280, "training_iteration": 304, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-02-59", "timestamp": 1643652179, "time_this_iter_s": 14.597697019577026, "time_total_s": 6834.8893320560455, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6834.8893320560455, "timesteps_since_restore": 0, "iterations_since_restore": 304, "perf": {"cpu_util_percent": 22.023809523809526, "ram_util_percent": 62.0047619047619}}
{"episode_reward_max": -2.5, "episode_reward_min": -142.2, "episode_reward_mean": -13.291999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.499999999999996, -20.6, -4.2, -4.300000000000001, -11.199999999999989, -4.2, -8.9, -5.3, -6.3999999999999995, -15.099999999999996, -9.3, -16.2, -11.000000000000002, -15.699999999999998, -6.3, -11.799999999999999, -10.299999999999999, -16.4, -13.3, -6.300000000000001, -4.2, -4.4, -7.1, -5.300000000000001, -22.5, -20.4, -3.3, -3.2, -4.4, -13.599999999999998, -29.3, -3.4000000000000004, -10.2, -8.799999999999999, -4.2, -6.2, -30.9, -4.300000000000001, -33.19999999999998, -7.2, -18.200000000000003, -32.6, -4.3, -4.2, -5.300000000000001, -6.300000000000001, -5.4, -5.2, -13.0, -6.599999999999998, -5.2, -26.900000000000006, -13.299999999999999, -2.5, -32.50000000000001, -16.4, -14.099999999999998, -40.3, -29.700000000000003, -11.600000000000001, -5.7, -3.3, -18.7, -18.5, -21.299999999999997, -3.7, -12.899999999999997, -7.499999999999998, -23.2, -4.3, -19.4, -26.800000000000008, -20.9, -142.2, -16.799999999999983, -14.799999999999995, -13.5, -13.899999999999999, -12.5, -13.899999999999999, -9.3, -8.5, -8.3, -9.899999999999999, -6.2, -8.3, -11.3, -7.799999999999999, -13.700000000000001, -4.9, -14.899999999999999, -4.3, -5.300000000000001, -20.7, -8.2, -12.2, -4.3, -12.3, -11.3, -4.699999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.335964144276611, "mean_inference_ms": 1.7249470627953172, "mean_action_processing_ms": 0.09638282535499855, "mean_env_wait_ms": 7.904706688241801, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1220000, "timesteps_this_iter": 0, "agent_timesteps_total": 1220000, "timers": {"sample_time_ms": 15067.682, "sample_throughput": 265.469, "load_time_ms": 0.35, "load_throughput": 11417732.408, "learn_time_ms": 7249.711, "learn_throughput": 551.746, "update_time_ms": 1.495}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 1.0764360038255671, "policy_loss": -0.008652916622738684, "vf_loss": 108.46236533365582, "vf_explained_var": -0.00585476775323191, "kl": 0.007745951448119408, "entropy": 0.2323364439590644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1220000, "num_agent_steps_sampled": 1220000, "num_steps_trained": 1220000, "num_agent_steps_trained": 1220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12320, "training_iteration": 305, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-03-13", "timestamp": 1643652193, "time_this_iter_s": 14.409271955490112, "time_total_s": 6849.298604011536, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6849.298604011536, "timesteps_since_restore": 0, "iterations_since_restore": 305, "perf": {"cpu_util_percent": 22.457142857142863, "ram_util_percent": 62.090476190476174}}
{"episode_reward_max": -2.5, "episode_reward_min": -142.2, "episode_reward_mean": -13.199000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.200000000000003, -32.6, -4.3, -4.2, -5.300000000000001, -6.300000000000001, -5.4, -5.2, -13.0, -6.599999999999998, -5.2, -26.900000000000006, -13.299999999999999, -2.5, -32.50000000000001, -16.4, -14.099999999999998, -40.3, -29.700000000000003, -11.600000000000001, -5.7, -3.3, -18.7, -18.5, -21.299999999999997, -3.7, -12.899999999999997, -7.499999999999998, -23.2, -4.3, -19.4, -26.800000000000008, -20.9, -142.2, -16.799999999999983, -14.799999999999995, -13.5, -13.899999999999999, -12.5, -13.899999999999999, -9.3, -8.5, -8.3, -9.899999999999999, -6.2, -8.3, -11.3, -7.799999999999999, -13.700000000000001, -4.9, -14.899999999999999, -4.3, -5.300000000000001, -20.7, -8.2, -12.2, -4.3, -12.3, -11.3, -4.699999999999999, -6.300000000000001, -5.300000000000001, -10.199999999999996, -22.900000000000006, -14.09999999999997, -13.2, -18.900000000000006, -3.4, -10.1, -7.999999999999998, -8.299999999999997, -9.2, -5.300000000000001, -4.300000000000001, -12.2, -4.3, -8.099999999999998, -25.699999999999992, -16.0, -10.2, -3.3, -11.5, -3.3, -26.799999999999997, -11.999999999999996, -3.2, -4.300000000000001, -7.300000000000001, -4.300000000000001, -15.399999999999999, -17.799999999999997, -3.2, -9.9, -8.3, -19.900000000000002, -27.90000000000001, -5.9, -9.1, -13.499999999999998, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3344890202949935, "mean_inference_ms": 1.722993088792635, "mean_action_processing_ms": 0.0962741805166085, "mean_env_wait_ms": 7.895463664420764, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1224000, "timesteps_this_iter": 0, "agent_timesteps_total": 1224000, "timers": {"sample_time_ms": 14966.646, "sample_throughput": 267.261, "load_time_ms": 0.344, "load_throughput": 11622595.081, "learn_time_ms": 7215.724, "learn_throughput": 554.345, "update_time_ms": 1.475}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.12344284383479946, "policy_loss": -0.016564677372795118, "vf_loss": 13.945584024536995, "vf_explained_var": 0.3252372013625278, "kl": 0.00918435747481248, "entropy": 0.20103269889149614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1224000, "num_agent_steps_sampled": 1224000, "num_steps_trained": 1224000, "num_agent_steps_trained": 1224000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12360, "training_iteration": 306, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-03-28", "timestamp": 1643652208, "time_this_iter_s": 14.893275737762451, "time_total_s": 6864.191879749298, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6864.191879749298, "timesteps_since_restore": 0, "iterations_since_restore": 306, "perf": {"cpu_util_percent": 24.133333333333333, "ram_util_percent": 62.07142857142855}}
{"episode_reward_max": -3.2, "episode_reward_min": -35.5, "episode_reward_mean": -10.94, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -8.3, -11.3, -7.799999999999999, -13.700000000000001, -4.9, -14.899999999999999, -4.3, -5.300000000000001, -20.7, -8.2, -12.2, -4.3, -12.3, -11.3, -4.699999999999999, -6.300000000000001, -5.300000000000001, -10.199999999999996, -22.900000000000006, -14.09999999999997, -13.2, -18.900000000000006, -3.4, -10.1, -7.999999999999998, -8.299999999999997, -9.2, -5.300000000000001, -4.300000000000001, -12.2, -4.3, -8.099999999999998, -25.699999999999992, -16.0, -10.2, -3.3, -11.5, -3.3, -26.799999999999997, -11.999999999999996, -3.2, -4.300000000000001, -7.300000000000001, -4.300000000000001, -15.399999999999999, -17.799999999999997, -3.2, -9.9, -8.3, -19.900000000000002, -27.90000000000001, -5.9, -9.1, -13.499999999999998, -3.2, -18.900000000000006, -6.300000000000001, -10.7, -13.6, -5.8999999999999995, -4.300000000000001, -13.199999999999998, -23.4, -4.4, -9.1, -11.399999999999999, -29.799999999999997, -5.3, -11.700000000000001, -3.3, -18.800000000000004, -5.300000000000001, -12.799999999999999, -3.3, -11.1, -16.6, -26.7, -21.699999999999996, -10.2, -3.3, -11.799999999999999, -3.3, -4.4, -14.099999999999996, -35.5, -3.3, -5.6000000000000005, -15.7, -15.099999999999998, -4.2, -11.799999999999999, -8.100000000000001, -19.300000000000004, -10.199999999999998, -11.6, -17.199999999999996, -7.199999999999999, -13.7, -4.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3335339136169444, "mean_inference_ms": 1.7208507255963457, "mean_action_processing_ms": 0.09622065338284543, "mean_env_wait_ms": 7.886562656908327, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1228000, "timesteps_this_iter": 0, "agent_timesteps_total": 1228000, "timers": {"sample_time_ms": 14892.534, "sample_throughput": 268.591, "load_time_ms": 0.341, "load_throughput": 11742172.452, "learn_time_ms": 7191.143, "learn_throughput": 556.24, "update_time_ms": 1.545}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.11145726798242458, "policy_loss": -0.011839538299909202, "vf_loss": 12.282714463049366, "vf_explained_var": 0.211084795254533, "kl": 0.007818901683043882, "entropy": 0.20976974263947498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1228000, "num_agent_steps_sampled": 1228000, "num_steps_trained": 1228000, "num_agent_steps_trained": 1228000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12404, "training_iteration": 307, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-03-43", "timestamp": 1643652223, "time_this_iter_s": 15.053202152252197, "time_total_s": 6879.24508190155, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6879.24508190155, "timesteps_since_restore": 0, "iterations_since_restore": 307, "perf": {"cpu_util_percent": 24.219047619047622, "ram_util_percent": 62.08095238095238}}
{"episode_reward_max": -3.2, "episode_reward_min": -35.5, "episode_reward_mean": -10.912, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.999999999999996, -3.2, -4.300000000000001, -7.300000000000001, -4.300000000000001, -15.399999999999999, -17.799999999999997, -3.2, -9.9, -8.3, -19.900000000000002, -27.90000000000001, -5.9, -9.1, -13.499999999999998, -3.2, -18.900000000000006, -6.300000000000001, -10.7, -13.6, -5.8999999999999995, -4.300000000000001, -13.199999999999998, -23.4, -4.4, -9.1, -11.399999999999999, -29.799999999999997, -5.3, -11.700000000000001, -3.3, -18.800000000000004, -5.300000000000001, -12.799999999999999, -3.3, -11.1, -16.6, -26.7, -21.699999999999996, -10.2, -3.3, -11.799999999999999, -3.3, -4.4, -14.099999999999996, -35.5, -3.3, -5.6000000000000005, -15.7, -15.099999999999998, -4.2, -11.799999999999999, -8.100000000000001, -19.300000000000004, -10.199999999999998, -11.6, -17.199999999999996, -7.199999999999999, -13.7, -4.3, -22.3, -13.5, -33.6, -3.3, -9.2, -4.300000000000001, -4.300000000000001, -9.299999999999999, -3.3, -23.5, -28.0, -3.4, -5.300000000000001, -22.700000000000003, -13.2, -5.2, -3.3, -18.49999999999999, -6.1, -3.3, -9.0, -9.000000000000002, -3.900000000000001, -5.300000000000001, -14.8, -8.2, -4.300000000000001, -14.399999999999999, -4.300000000000001, -9.199999999999998, -14.6, -3.4000000000000004, -3.3, -5.2, -8.0, -8.4, -17.4, -15.699999999999998, -3.2, -11.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3326743539955967, "mean_inference_ms": 1.7191499709243203, "mean_action_processing_ms": 0.09612969986969279, "mean_env_wait_ms": 7.878734390678349, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1232000, "timesteps_this_iter": 0, "agent_timesteps_total": 1232000, "timers": {"sample_time_ms": 14960.774, "sample_throughput": 267.366, "load_time_ms": 0.343, "load_throughput": 11670294.936, "learn_time_ms": 7247.962, "learn_throughput": 551.879, "update_time_ms": 1.548}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.08455489218255044, "policy_loss": -0.013347727843430093, "vf_loss": 9.707603443966757, "vf_explained_var": 0.2524261284259058, "kl": 0.01376091403933708, "entropy": 0.1974123512064257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1232000, "num_agent_steps_sampled": 1232000, "num_steps_trained": 1232000, "num_agent_steps_trained": 1232000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12444, "training_iteration": 308, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-03-59", "timestamp": 1643652239, "time_this_iter_s": 16.23856520652771, "time_total_s": 6895.483647108078, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6895.483647108078, "timesteps_since_restore": 0, "iterations_since_restore": 308, "perf": {"cpu_util_percent": 33.19583333333333, "ram_util_percent": 62.487500000000004}}
{"episode_reward_max": -1.0, "episode_reward_min": -78.8000000000001, "episode_reward_mean": -12.493, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -11.799999999999999, -3.3, -4.4, -14.099999999999996, -35.5, -3.3, -5.6000000000000005, -15.7, -15.099999999999998, -4.2, -11.799999999999999, -8.100000000000001, -19.300000000000004, -10.199999999999998, -11.6, -17.199999999999996, -7.199999999999999, -13.7, -4.3, -22.3, -13.5, -33.6, -3.3, -9.2, -4.300000000000001, -4.300000000000001, -9.299999999999999, -3.3, -23.5, -28.0, -3.4, -5.300000000000001, -22.700000000000003, -13.2, -5.2, -3.3, -18.49999999999999, -6.1, -3.3, -9.0, -9.000000000000002, -3.900000000000001, -5.300000000000001, -14.8, -8.2, -4.300000000000001, -14.399999999999999, -4.300000000000001, -9.199999999999998, -14.6, -3.4000000000000004, -3.3, -5.2, -8.0, -8.4, -17.4, -15.699999999999998, -3.2, -11.3, -7.300000000000001, -6.300000000000001, -9.6, -1.0, -25.1, -6.4, -5.300000000000001, -10.799999999999986, -8.499999999999998, -7.3, -10.2, -7.9, -4.700000000000001, -18.699999999999996, -18.700000000000028, -5.3, -62.50000000000006, -13.799999999999999, -3.3, -5.699999999999999, -11.799999999999999, -20.0, -11.5, -14.599999999999998, -10.000000000000002, -4.800000000000001, -11.799999999999994, -14.999999999999998, -5.300000000000001, -15.199999999999998, -3.8000000000000003, -17.3, -16.0, -78.8000000000001, -6.300000000000001, -60.40000000000001, -6.6000000000000005, -11.7, -13.5, -48.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3316148330520523, "mean_inference_ms": 1.717568994985419, "mean_action_processing_ms": 0.09598322383863979, "mean_env_wait_ms": 7.870857166085009, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1236000, "timesteps_this_iter": 0, "agent_timesteps_total": 1236000, "timers": {"sample_time_ms": 15031.032, "sample_throughput": 266.116, "load_time_ms": 0.344, "load_throughput": 11623400.305, "learn_time_ms": 7218.052, "learn_throughput": 554.166, "update_time_ms": 1.602}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.5330987525666984, "policy_loss": -0.012118227584838307, "vf_loss": 54.457159030309285, "vf_explained_var": 0.03597900540597977, "kl": 0.010744621025123835, "entropy": 0.2210244023751828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1236000, "num_agent_steps_sampled": 1236000, "num_steps_trained": 1236000, "num_agent_steps_trained": 1236000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12484, "training_iteration": 309, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-04-15", "timestamp": 1643652255, "time_this_iter_s": 15.440107107162476, "time_total_s": 6910.9237542152405, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6910.9237542152405, "timesteps_since_restore": 0, "iterations_since_restore": 309, "perf": {"cpu_util_percent": 26.963636363636365, "ram_util_percent": 62.37272727272727}}
{"episode_reward_max": -1.0, "episode_reward_min": -78.8000000000001, "episode_reward_mean": -12.161000000000007, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, -9.000000000000002, -3.900000000000001, -5.300000000000001, -14.8, -8.2, -4.300000000000001, -14.399999999999999, -4.300000000000001, -9.199999999999998, -14.6, -3.4000000000000004, -3.3, -5.2, -8.0, -8.4, -17.4, -15.699999999999998, -3.2, -11.3, -7.300000000000001, -6.300000000000001, -9.6, -1.0, -25.1, -6.4, -5.300000000000001, -10.799999999999986, -8.499999999999998, -7.3, -10.2, -7.9, -4.700000000000001, -18.699999999999996, -18.700000000000028, -5.3, -62.50000000000006, -13.799999999999999, -3.3, -5.699999999999999, -11.799999999999999, -20.0, -11.5, -14.599999999999998, -10.000000000000002, -4.800000000000001, -11.799999999999994, -14.999999999999998, -5.300000000000001, -15.199999999999998, -3.8000000000000003, -17.3, -16.0, -78.8000000000001, -6.300000000000001, -60.40000000000001, -6.6000000000000005, -11.7, -13.5, -48.3, -9.5, -6.3, -9.0, -6.2, -5.3, -7.199999999999998, -6.2, -12.0, -8.4, -5.2, -7.599999999999999, -5.4, -21.3, -2.5, -7.4, -12.1, -19.699999999999996, -13.299999999999999, -18.4, -17.9, -11.899999999999999, -5.5, -11.199999999999998, -5.8999999999999995, -17.6, -13.399999999999997, -24.5, -6.399999999999999, -40.30000000000003, -9.2, -6.3, -16.4, -7.300000000000001, -5.4, -9.3, -3.5000000000000004, -3.2, -7.599999999999998, -11.899999999999999, -4.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3302538473013124, "mean_inference_ms": 1.716027930906791, "mean_action_processing_ms": 0.09589063133597157, "mean_env_wait_ms": 7.862610504921647, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1240000, "timesteps_this_iter": 0, "agent_timesteps_total": 1240000, "timers": {"sample_time_ms": 14946.419, "sample_throughput": 267.623, "load_time_ms": 0.341, "load_throughput": 11725759.016, "learn_time_ms": 7235.021, "learn_throughput": 552.866, "update_time_ms": 1.599}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.09788480260239173, "policy_loss": -0.01304526197754087, "vf_loss": 11.014141539283978, "vf_explained_var": 0.15430767587436142, "kl": 0.013129317674062805, "entropy": 0.2418634689222741, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1240000, "num_agent_steps_sampled": 1240000, "num_steps_trained": 1240000, "num_agent_steps_trained": 1240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12524, "training_iteration": 310, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-04-30", "timestamp": 1643652270, "time_this_iter_s": 15.055122375488281, "time_total_s": 6925.978876590729, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6925.978876590729, "timesteps_since_restore": 0, "iterations_since_restore": 310, "perf": {"cpu_util_percent": 31.0, "ram_util_percent": 62.31904761904761}}
{"episode_reward_max": -2.5, "episode_reward_min": -78.8000000000001, "episode_reward_mean": -13.383000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.799999999999999, -20.0, -11.5, -14.599999999999998, -10.000000000000002, -4.800000000000001, -11.799999999999994, -14.999999999999998, -5.300000000000001, -15.199999999999998, -3.8000000000000003, -17.3, -16.0, -78.8000000000001, -6.300000000000001, -60.40000000000001, -6.6000000000000005, -11.7, -13.5, -48.3, -9.5, -6.3, -9.0, -6.2, -5.3, -7.199999999999998, -6.2, -12.0, -8.4, -5.2, -7.599999999999999, -5.4, -21.3, -2.5, -7.4, -12.1, -19.699999999999996, -13.299999999999999, -18.4, -17.9, -11.899999999999999, -5.5, -11.199999999999998, -5.8999999999999995, -17.6, -13.399999999999997, -24.5, -6.399999999999999, -40.30000000000003, -9.2, -6.3, -16.4, -7.300000000000001, -5.4, -9.3, -3.5000000000000004, -3.2, -7.599999999999998, -11.899999999999999, -4.4, -7.2, -5.3, -8.2, -7.300000000000001, -20.9, -21.600000000000005, -22.10000000000001, -22.4, -6.3, -7.4, -5.2, -15.5, -5.3, -23.299999999999997, -23.6, -14.299999999999999, -10.799999999999997, -9.2, -11.0, -5.6, -15.399999999999975, -7.300000000000001, -56.2, -22.2, -17.400000000000002, -13.0, -11.399999999999999, -4.3, -10.299999999999999, -11.499999999999998, -6.300000000000001, -8.9, -12.799999999999999, -7.300000000000001, -13.799999999999999, -5.2, -11.4, -7.099999999999999, -30.900000000000002, -8.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3288382552918083, "mean_inference_ms": 1.7143136309106513, "mean_action_processing_ms": 0.09579292323006972, "mean_env_wait_ms": 7.8543301138344805, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1244000, "timesteps_this_iter": 0, "agent_timesteps_total": 1244000, "timers": {"sample_time_ms": 14996.88, "sample_throughput": 266.722, "load_time_ms": 0.339, "load_throughput": 11788375.492, "learn_time_ms": 7307.133, "learn_throughput": 547.41, "update_time_ms": 1.586}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.10853282043119512, "policy_loss": -0.018572423733290166, "vf_loss": 12.64837755317329, "vf_explained_var": 0.3084135473415416, "kl": 0.010346204177712074, "entropy": 0.21771604015782314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1244000, "num_agent_steps_sampled": 1244000, "num_steps_trained": 1244000, "num_agent_steps_trained": 1244000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12564, "training_iteration": 311, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-04-46", "timestamp": 1643652286, "time_this_iter_s": 16.03255605697632, "time_total_s": 6942.011432647705, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6942.011432647705, "timesteps_since_restore": 0, "iterations_since_restore": 311, "perf": {"cpu_util_percent": 39.34782608695652, "ram_util_percent": 62.65217391304347}}
{"episode_reward_max": -3.2, "episode_reward_min": -67.89999999999999, "episode_reward_mean": -12.683, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.899999999999999, -5.5, -11.199999999999998, -5.8999999999999995, -17.6, -13.399999999999997, -24.5, -6.399999999999999, -40.30000000000003, -9.2, -6.3, -16.4, -7.300000000000001, -5.4, -9.3, -3.5000000000000004, -3.2, -7.599999999999998, -11.899999999999999, -4.4, -7.2, -5.3, -8.2, -7.300000000000001, -20.9, -21.600000000000005, -22.10000000000001, -22.4, -6.3, -7.4, -5.2, -15.5, -5.3, -23.299999999999997, -23.6, -14.299999999999999, -10.799999999999997, -9.2, -11.0, -5.6, -15.399999999999975, -7.300000000000001, -56.2, -22.2, -17.400000000000002, -13.0, -11.399999999999999, -4.3, -10.299999999999999, -11.499999999999998, -6.300000000000001, -8.9, -12.799999999999999, -7.300000000000001, -13.799999999999999, -5.2, -11.4, -7.099999999999999, -30.900000000000002, -8.3, -5.1000000000000005, -5.3, -7.6, -10.700000000000001, -5.4, -11.0, -7.300000000000001, -41.3, -4.2, -14.5, -13.7, -8.5, -30.3, -5.2, -5.300000000000001, -15.1, -7.6000000000000005, -67.89999999999999, -4.3, -9.3, -16.6, -8.700000000000001, -10.3, -15.3, -9.8, -7.099999999999999, -7.799999999999998, -14.6, -6.4, -5.800000000000001, -46.2, -7.300000000000001, -10.0, -20.5, -11.7, -10.7, -3.3, -6.300000000000001, -6.300000000000001, -9.299999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3274443518881662, "mean_inference_ms": 1.712481442876325, "mean_action_processing_ms": 0.09569083634912857, "mean_env_wait_ms": 7.845625139253148, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1248000, "timesteps_this_iter": 0, "agent_timesteps_total": 1248000, "timers": {"sample_time_ms": 15061.267, "sample_throughput": 265.582, "load_time_ms": 0.324, "load_throughput": 12344357.295, "learn_time_ms": 7228.836, "learn_throughput": 553.339, "update_time_ms": 1.575}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.21363049115464894, "policy_loss": -0.017698439828530754, "vf_loss": 23.06271391222554, "vf_explained_var": 0.331978016707205, "kl": 0.011683409369394947, "entropy": 0.22268489095312294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1248000, "num_agent_steps_sampled": 1248000, "num_steps_trained": 1248000, "num_agent_steps_trained": 1248000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12604, "training_iteration": 312, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-04-59", "timestamp": 1643652299, "time_this_iter_s": 13.367272138595581, "time_total_s": 6955.378704786301, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6955.378704786301, "timesteps_since_restore": 0, "iterations_since_restore": 312, "perf": {"cpu_util_percent": 29.29473684210526, "ram_util_percent": 62.984210526315806}}
{"episode_reward_max": -3.2, "episode_reward_min": -67.89999999999999, "episode_reward_mean": -13.635, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.399999999999975, -7.300000000000001, -56.2, -22.2, -17.400000000000002, -13.0, -11.399999999999999, -4.3, -10.299999999999999, -11.499999999999998, -6.300000000000001, -8.9, -12.799999999999999, -7.300000000000001, -13.799999999999999, -5.2, -11.4, -7.099999999999999, -30.900000000000002, -8.3, -5.1000000000000005, -5.3, -7.6, -10.700000000000001, -5.4, -11.0, -7.300000000000001, -41.3, -4.2, -14.5, -13.7, -8.5, -30.3, -5.2, -5.300000000000001, -15.1, -7.6000000000000005, -67.89999999999999, -4.3, -9.3, -16.6, -8.700000000000001, -10.3, -15.3, -9.8, -7.099999999999999, -7.799999999999998, -14.6, -6.4, -5.800000000000001, -46.2, -7.300000000000001, -10.0, -20.5, -11.7, -10.7, -3.3, -6.300000000000001, -6.300000000000001, -9.299999999999997, -25.900000000000006, -12.6, -4.4, -7.9, -13.2, -17.3, -9.7, -25.9, -6.4, -13.399999999999997, -18.399999999999995, -5.9, -6.3999999999999995, -4.6, -7.9, -7.199999999999999, -17.499999999999996, -9.0, -15.599999999999996, -15.099999999999998, -14.799999999999997, -3.2, -14.899999999999999, -41.4, -36.4, -23.000000000000007, -15.999999999999996, -18.4, -6.2, -47.2, -9.3, -18.699999999999964, -4.1, -14.5, -16.9, -13.399999999999997, -5.1, -5.4, -8.4, -7.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3260757371689078, "mean_inference_ms": 1.710570880937753, "mean_action_processing_ms": 0.09558537252723565, "mean_env_wait_ms": 7.836523431934322, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1252000, "timesteps_this_iter": 0, "agent_timesteps_total": 1252000, "timers": {"sample_time_ms": 14966.082, "sample_throughput": 267.271, "load_time_ms": 0.331, "load_throughput": 12079498.884, "learn_time_ms": 11244.564, "learn_throughput": 355.727, "update_time_ms": 2.254}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.1761440428950253, "policy_loss": -0.016472492213310895, "vf_loss": 19.178677222997912, "vf_explained_var": 0.13951984919527524, "kl": 0.013813887173662418, "entropy": 0.25017393311505676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1252000, "num_agent_steps_sampled": 1252000, "num_steps_trained": 1252000, "num_agent_steps_trained": 1252000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12644, "training_iteration": 313, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_18-05-54", "timestamp": 1643652354, "time_this_iter_s": 54.25016689300537, "time_total_s": 7009.628871679306, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7009.628871679306, "timesteps_since_restore": 0, "iterations_since_restore": 313, "perf": {"cpu_util_percent": 27.927272727272733, "ram_util_percent": 62.74999999999999}}
{"episode_reward_max": -3.2, "episode_reward_min": -47.2, "episode_reward_mean": -11.874999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.6, -8.700000000000001, -10.3, -15.3, -9.8, -7.099999999999999, -7.799999999999998, -14.6, -6.4, -5.800000000000001, -46.2, -7.300000000000001, -10.0, -20.5, -11.7, -10.7, -3.3, -6.300000000000001, -6.300000000000001, -9.299999999999997, -25.900000000000006, -12.6, -4.4, -7.9, -13.2, -17.3, -9.7, -25.9, -6.4, -13.399999999999997, -18.399999999999995, -5.9, -6.3999999999999995, -4.6, -7.9, -7.199999999999999, -17.499999999999996, -9.0, -15.599999999999996, -15.099999999999998, -14.799999999999997, -3.2, -14.899999999999999, -41.4, -36.4, -23.000000000000007, -15.999999999999996, -18.4, -6.2, -47.2, -9.3, -18.699999999999964, -4.1, -14.5, -16.9, -13.399999999999997, -5.1, -5.4, -8.4, -7.300000000000001, -4.2, -5.300000000000001, -10.6, -6.0, -5.3, -7.4, -9.3, -33.3, -16.2, -8.2, -7.300000000000001, -5.300000000000001, -16.3, -11.6, -3.2, -16.3, -6.300000000000001, -17.0, -10.499999999999998, -5.2, -12.0, -5.300000000000001, -12.199999999999998, -5.199999999999999, -4.300000000000001, -13.099999999999996, -7.1, -4.300000000000001, -5.300000000000001, -7.2, -14.3, -5.2, -7.300000000000001, -12.599999999999998, -10.899999999999999, -11.799999999999999, -16.3, -4.6000000000000005, -13.699999999999998, -7.099999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5723619103550304, "mean_inference_ms": 2.9307977256858195, "mean_action_processing_ms": 0.09576350898137298, "mean_env_wait_ms": 10.314837982905688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1256000, "timesteps_this_iter": 0, "agent_timesteps_total": 1256000, "timers": {"sample_time_ms": 18399.552, "sample_throughput": 217.397, "load_time_ms": 0.332, "load_throughput": 12035305.595, "learn_time_ms": 11672.193, "learn_throughput": 342.695, "update_time_ms": 2.273}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.06573418326555722, "policy_loss": -0.02770931976697137, "vf_loss": 9.28610040135281, "vf_explained_var": 0.22941181102106648, "kl": 0.009697408227607451, "entropy": 0.22665416585501805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1256000, "num_agent_steps_sampled": 1256000, "num_steps_trained": 1256000, "num_agent_steps_trained": 1256000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12684, "training_iteration": 314, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-11-05", "timestamp": 1643656265, "time_this_iter_s": 3910.847507953644, "time_total_s": 10920.47637963295, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10920.47637963295, "timesteps_since_restore": 0, "iterations_since_restore": 314, "perf": {"cpu_util_percent": 73.44202898550724, "ram_util_percent": 63.617391304347834}}
{"episode_reward_max": -3.2, "episode_reward_min": -47.2, "episode_reward_mean": -11.496999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.799999999999997, -3.2, -14.899999999999999, -41.4, -36.4, -23.000000000000007, -15.999999999999996, -18.4, -6.2, -47.2, -9.3, -18.699999999999964, -4.1, -14.5, -16.9, -13.399999999999997, -5.1, -5.4, -8.4, -7.300000000000001, -4.2, -5.300000000000001, -10.6, -6.0, -5.3, -7.4, -9.3, -33.3, -16.2, -8.2, -7.300000000000001, -5.300000000000001, -16.3, -11.6, -3.2, -16.3, -6.300000000000001, -17.0, -10.499999999999998, -5.2, -12.0, -5.300000000000001, -12.199999999999998, -5.199999999999999, -4.300000000000001, -13.099999999999996, -7.1, -4.300000000000001, -5.300000000000001, -7.2, -14.3, -5.2, -7.300000000000001, -12.599999999999998, -10.899999999999999, -11.799999999999999, -16.3, -4.6000000000000005, -13.699999999999998, -7.099999999999998, -3.3, -13.7, -11.9, -3.4, -13.3, -21.6, -13.0, -3.3, -6.499999999999999, -6.300000000000001, -5.2, -9.5, -7.3, -9.1, -9.999999999999998, -4.3, -12.099999999999996, -10.600000000000001, -4.3, -8.2, -13.2, -11.5, -14.999999999999998, -11.0, -14.2, -10.3, -31.199999999999996, -5.4, -4.300000000000001, -8.299999999999999, -20.2, -15.8, -11.2, -24.3, -20.8, -11.79999999999999, -6.2, -7.299999999999996, -4.3, -17.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8155733080293026, "mean_inference_ms": 4.149147617774542, "mean_action_processing_ms": 0.09600262457630848, "mean_env_wait_ms": 12.79327774123069, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1260000, "timesteps_this_iter": 0, "agent_timesteps_total": 1260000, "timers": {"sample_time_ms": 19729.878, "sample_throughput": 202.738, "load_time_ms": 0.333, "load_throughput": 11995721.436, "learn_time_ms": 11880.378, "learn_throughput": 336.69, "update_time_ms": 2.31}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.0618783422916006, "policy_loss": -0.012648712088083549, "vf_loss": 7.380685288611279, "vf_explained_var": 0.32913864479270033, "kl": 0.011989908495486113, "entropy": 0.23167241311842396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1260000, "num_agent_steps_sampled": 1260000, "num_steps_trained": 1260000, "num_agent_steps_trained": 1260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12724, "training_iteration": 315, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-11-30", "timestamp": 1643656290, "time_this_iter_s": 25.514291048049927, "time_total_s": 10945.990670681, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10945.990670681, "timesteps_since_restore": 0, "iterations_since_restore": 315, "perf": {"cpu_util_percent": 56.836111111111116, "ram_util_percent": 65.50277777777778}}
{"episode_reward_max": -3.2, "episode_reward_min": -89.3, "episode_reward_mean": -12.115, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -5.300000000000001, -12.199999999999998, -5.199999999999999, -4.300000000000001, -13.099999999999996, -7.1, -4.300000000000001, -5.300000000000001, -7.2, -14.3, -5.2, -7.300000000000001, -12.599999999999998, -10.899999999999999, -11.799999999999999, -16.3, -4.6000000000000005, -13.699999999999998, -7.099999999999998, -3.3, -13.7, -11.9, -3.4, -13.3, -21.6, -13.0, -3.3, -6.499999999999999, -6.300000000000001, -5.2, -9.5, -7.3, -9.1, -9.999999999999998, -4.3, -12.099999999999996, -10.600000000000001, -4.3, -8.2, -13.2, -11.5, -14.999999999999998, -11.0, -14.2, -10.3, -31.199999999999996, -5.4, -4.300000000000001, -8.299999999999999, -20.2, -15.8, -11.2, -24.3, -20.8, -11.79999999999999, -6.2, -7.299999999999996, -4.3, -17.3, -10.7, -4.3, -5.2, -12.700000000000001, -11.099999999999998, -16.599999999999987, -17.3, -8.5, -13.3, -4.4, -9.3, -23.800000000000008, -14.999999999999973, -13.899999999999999, -20.099999999999994, -6.0, -8.8, -3.7000000000000006, -62.4, -7.4, -3.2, -11.3, -89.3, -15.1, -19.0, -6.4, -8.399999999999999, -15.699999999999996, -7.300000000000001, -16.9, -5.2, -22.700000000000003, -11.2, -20.3, -13.7, -14.099999999999998, -15.799999999999999, -3.2, -10.9, -6.999999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.822984726538463, "mean_inference_ms": 5.361076568209336, "mean_action_processing_ms": 0.09608787177625545, "mean_env_wait_ms": 14.020962312710662, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1264000, "timesteps_this_iter": 0, "agent_timesteps_total": 1264000, "timers": {"sample_time_ms": 20007.813, "sample_throughput": 199.922, "load_time_ms": 0.335, "load_throughput": 11946180.575, "learn_time_ms": 11955.684, "learn_throughput": 334.569, "update_time_ms": 2.409}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.3812072912093392, "policy_loss": -0.017034945755155496, "vf_loss": 39.742426677032185, "vf_explained_var": 0.16507362979714588, "kl": 0.013617644726820692, "entropy": 0.21592271555495518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1264000, "num_agent_steps_sampled": 1264000, "num_steps_trained": 1264000, "num_agent_steps_trained": 1264000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12764, "training_iteration": 316, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-11-47", "timestamp": 1643656307, "time_this_iter_s": 16.351003885269165, "time_total_s": 10962.341674566269, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10962.341674566269, "timesteps_since_restore": 0, "iterations_since_restore": 316, "perf": {"cpu_util_percent": 38.78695652173913, "ram_util_percent": 63.03478260869564}}
{"episode_reward_max": -2.2, "episode_reward_min": -91.89999999999988, "episode_reward_mean": -13.815999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.2, -10.3, -31.199999999999996, -5.4, -4.300000000000001, -8.299999999999999, -20.2, -15.8, -11.2, -24.3, -20.8, -11.79999999999999, -6.2, -7.299999999999996, -4.3, -17.3, -10.7, -4.3, -5.2, -12.700000000000001, -11.099999999999998, -16.599999999999987, -17.3, -8.5, -13.3, -4.4, -9.3, -23.800000000000008, -14.999999999999973, -13.899999999999999, -20.099999999999994, -6.0, -8.8, -3.7000000000000006, -62.4, -7.4, -3.2, -11.3, -89.3, -15.1, -19.0, -6.4, -8.399999999999999, -15.699999999999996, -7.300000000000001, -16.9, -5.2, -22.700000000000003, -11.2, -20.3, -13.7, -14.099999999999998, -15.799999999999999, -3.2, -10.9, -6.999999999999999, -8.4, -18.099999999999998, -4.300000000000001, -7.300000000000001, -5.300000000000001, -8.2, -2.2, -3.3, -5.300000000000001, -17.400000000000002, -13.999999999999996, -15.2, -10.5, -11.5, -5.4, -18.1, -10.4, -20.4, -16.5, -4.2, -8.2, -5.4, -16.2, -17.5, -7.2, -14.3, -10.000000000000002, -17.09999999999999, -5.300000000000001, -5.2, -10.5, -30.9, -10.4, -19.3, -91.89999999999988, -12.899999999999997, -5.3, -23.799999999999997, -10.3, -17.3, -4.2, -4.300000000000001, -20.6, -3.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.938355031867819, "mean_inference_ms": 5.46996020280255, "mean_action_processing_ms": 0.09610752802084983, "mean_env_wait_ms": 13.752908580418541, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1268000, "timesteps_this_iter": 0, "agent_timesteps_total": 1268000, "timers": {"sample_time_ms": 20307.268, "sample_throughput": 196.974, "load_time_ms": 0.337, "load_throughput": 11881881.02, "learn_time_ms": 12000.512, "learn_throughput": 333.319, "update_time_ms": 2.375}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.375407627352228, "policy_loss": -0.014219058196871512, "vf_loss": 38.85362295719885, "vf_explained_var": 0.014482044340461813, "kl": 0.018153965935348716, "entropy": 0.20215767926426345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1268000, "num_agent_steps_sampled": 1268000, "num_steps_trained": 1268000, "num_agent_steps_trained": 1268000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12808, "training_iteration": 317, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-12-04", "timestamp": 1643656324, "time_this_iter_s": 17.734626054763794, "time_total_s": 10980.076300621033, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10980.076300621033, "timesteps_since_restore": 0, "iterations_since_restore": 317, "perf": {"cpu_util_percent": 43.469230769230776, "ram_util_percent": 62.95769230769231}}
{"episode_reward_max": -2.2, "episode_reward_min": -91.89999999999988, "episode_reward_mean": -12.589, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0, -6.4, -8.399999999999999, -15.699999999999996, -7.300000000000001, -16.9, -5.2, -22.700000000000003, -11.2, -20.3, -13.7, -14.099999999999998, -15.799999999999999, -3.2, -10.9, -6.999999999999999, -8.4, -18.099999999999998, -4.300000000000001, -7.300000000000001, -5.300000000000001, -8.2, -2.2, -3.3, -5.300000000000001, -17.400000000000002, -13.999999999999996, -15.2, -10.5, -11.5, -5.4, -18.1, -10.4, -20.4, -16.5, -4.2, -8.2, -5.4, -16.2, -17.5, -7.2, -14.3, -10.000000000000002, -17.09999999999999, -5.300000000000001, -5.2, -10.5, -30.9, -10.4, -19.3, -91.89999999999988, -12.899999999999997, -5.3, -23.799999999999997, -10.3, -17.3, -4.2, -4.300000000000001, -20.6, -3.4, -24.800000000000004, -5.2, -6.0, -15.3, -18.000000000000007, -17.400000000000002, -12.600000000000001, -17.699999999999985, -6.4, -16.799999999999997, -6.300000000000001, -9.3, -11.7, -6.300000000000001, -14.2, -6.4, -5.2, -6.300000000000001, -4.300000000000001, -50.2, -18.800000000000004, -5.300000000000001, -6.300000000000001, -6.2, -10.899999999999999, -5.300000000000001, -12.7, -47.3, -12.4, -3.3, -11.9, -7.5, -5.300000000000001, -18.6, -11.7, -6.4, -5.9, -4.2, -19.0, -4.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9298240523228576, "mean_inference_ms": 5.457363509179797, "mean_action_processing_ms": 0.0960474086315071, "mean_env_wait_ms": 13.729694776279175, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1272000, "timesteps_this_iter": 0, "agent_timesteps_total": 1272000, "timers": {"sample_time_ms": 20300.466, "sample_throughput": 197.04, "load_time_ms": 0.334, "load_throughput": 11978592.032, "learn_time_ms": 12012.448, "learn_throughput": 332.988, "update_time_ms": 2.364}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.13897932069075683, "policy_loss": -0.02164008408454397, "vf_loss": 15.979329850468584, "vf_explained_var": 0.3933726970226534, "kl": 0.013752943119295934, "entropy": 0.2042352578412461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1272000, "num_agent_steps_sampled": 1272000, "num_steps_trained": 1272000, "num_agent_steps_trained": 1272000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12848, "training_iteration": 318, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-12-21", "timestamp": 1643656341, "time_this_iter_s": 15.990229845046997, "time_total_s": 10996.06653046608, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10996.06653046608, "timesteps_since_restore": 0, "iterations_since_restore": 318, "perf": {"cpu_util_percent": 28.472727272727273, "ram_util_percent": 63.04545454545453}}
{"episode_reward_max": -3.0, "episode_reward_min": -91.89999999999988, "episode_reward_mean": -12.280999999999997, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.2, -14.3, -10.000000000000002, -17.09999999999999, -5.300000000000001, -5.2, -10.5, -30.9, -10.4, -19.3, -91.89999999999988, -12.899999999999997, -5.3, -23.799999999999997, -10.3, -17.3, -4.2, -4.300000000000001, -20.6, -3.4, -24.800000000000004, -5.2, -6.0, -15.3, -18.000000000000007, -17.400000000000002, -12.600000000000001, -17.699999999999985, -6.4, -16.799999999999997, -6.300000000000001, -9.3, -11.7, -6.300000000000001, -14.2, -6.4, -5.2, -6.300000000000001, -4.300000000000001, -50.2, -18.800000000000004, -5.300000000000001, -6.300000000000001, -6.2, -10.899999999999999, -5.300000000000001, -12.7, -47.3, -12.4, -3.3, -11.9, -7.5, -5.300000000000001, -18.6, -11.7, -6.4, -5.9, -4.2, -19.0, -4.2, -3.3, -8.299999999999999, -13.3, -8.4, -18.4, -4.300000000000001, -16.5, -5.2, -4.4, -12.5, -5.2, -7.199999999999999, -9.4, -12.499999999999998, -16.599999999999984, -7.199999999999999, -8.299999999999999, -47.2, -3.3, -3.6000000000000005, -8.4, -7.599999999999998, -21.400000000000002, -12.699999999999994, -17.2, -10.2, -6.499999999999999, -4.300000000000001, -5.300000000000001, -5.2, -8.6, -10.2, -21.4, -3.7, -3.0, -13.599999999999998, -21.000000000000004, -5.6000000000000005, -3.2, -16.099999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7991487025489104, "mean_inference_ms": 5.444702487764081, "mean_action_processing_ms": 0.09591357015446964, "mean_env_wait_ms": 13.827183243464802, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1276000, "timesteps_this_iter": 0, "agent_timesteps_total": 1276000, "timers": {"sample_time_ms": 20348.479, "sample_throughput": 196.575, "load_time_ms": 0.34, "load_throughput": 11776790.678, "learn_time_ms": 12043.144, "learn_throughput": 332.139, "update_time_ms": 2.35}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.10243826582527128, "policy_loss": -0.01702226412092005, "vf_loss": 11.884386965151757, "vf_explained_var": 0.21912358018659775, "kl": 0.010266160195266433, "entropy": 0.231117763402321, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1276000, "num_agent_steps_sampled": 1276000, "num_steps_trained": 1276000, "num_agent_steps_trained": 1276000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12888, "training_iteration": 319, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-12-37", "timestamp": 1643656357, "time_this_iter_s": 16.108871936798096, "time_total_s": 11012.175402402878, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11012.175402402878, "timesteps_since_restore": 0, "iterations_since_restore": 319, "perf": {"cpu_util_percent": 23.2304347826087, "ram_util_percent": 63.14347826086957}}
{"episode_reward_max": -3.0, "episode_reward_min": -47.3, "episode_reward_mean": -10.987, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.800000000000004, -5.300000000000001, -6.300000000000001, -6.2, -10.899999999999999, -5.300000000000001, -12.7, -47.3, -12.4, -3.3, -11.9, -7.5, -5.300000000000001, -18.6, -11.7, -6.4, -5.9, -4.2, -19.0, -4.2, -3.3, -8.299999999999999, -13.3, -8.4, -18.4, -4.300000000000001, -16.5, -5.2, -4.4, -12.5, -5.2, -7.199999999999999, -9.4, -12.499999999999998, -16.599999999999984, -7.199999999999999, -8.299999999999999, -47.2, -3.3, -3.6000000000000005, -8.4, -7.599999999999998, -21.400000000000002, -12.699999999999994, -17.2, -10.2, -6.499999999999999, -4.300000000000001, -5.300000000000001, -5.2, -8.6, -10.2, -21.4, -3.7, -3.0, -13.599999999999998, -21.000000000000004, -5.6000000000000005, -3.2, -16.099999999999998, -3.8000000000000003, -10.9, -8.5, -39.0, -18.8, -3.2, -11.499999999999998, -16.599999999999994, -6.199999999999999, -22.5, -7.2, -20.200000000000003, -10.5, -3.4, -7.300000000000001, -13.2, -9.899999999999997, -8.2, -6.4, -11.1, -12.799999999999995, -10.5, -9.1, -16.2, -10.2, -10.199999999999987, -5.2, -12.0, -15.499999999999993, -11.2, -13.599999999999998, -5.2, -14.6, -13.699999999999998, -4.2, -8.4, -12.4, -15.899999999999991, -11.599999999999998, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7888050712396377, "mean_inference_ms": 5.31136649146689, "mean_action_processing_ms": 0.09582419590434652, "mean_env_wait_ms": 13.922132425119877, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1280000, "timesteps_this_iter": 0, "agent_timesteps_total": 1280000, "timers": {"sample_time_ms": 20365.37, "sample_throughput": 196.412, "load_time_ms": 0.351, "load_throughput": 11389054.375, "learn_time_ms": 12067.196, "learn_throughput": 331.477, "update_time_ms": 2.347}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.09506864967625789, "policy_loss": -0.015046447472426519, "vf_loss": 10.947934905303422, "vf_explained_var": 0.269487626001399, "kl": 0.010583897881540714, "entropy": 0.2453915171565548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1280000, "num_agent_steps_sampled": 1280000, "num_steps_trained": 1280000, "num_agent_steps_trained": 1280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12928, "training_iteration": 320, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-12-52", "timestamp": 1643656372, "time_this_iter_s": 15.165561199188232, "time_total_s": 11027.340963602066, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11027.340963602066, "timesteps_since_restore": 0, "iterations_since_restore": 320, "perf": {"cpu_util_percent": 22.636363636363633, "ram_util_percent": 63.10909090909088}}
{"episode_reward_max": -3.0, "episode_reward_min": -39.0, "episode_reward_mean": -10.396, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.4, -7.599999999999998, -21.400000000000002, -12.699999999999994, -17.2, -10.2, -6.499999999999999, -4.300000000000001, -5.300000000000001, -5.2, -8.6, -10.2, -21.4, -3.7, -3.0, -13.599999999999998, -21.000000000000004, -5.6000000000000005, -3.2, -16.099999999999998, -3.8000000000000003, -10.9, -8.5, -39.0, -18.8, -3.2, -11.499999999999998, -16.599999999999994, -6.199999999999999, -22.5, -7.2, -20.200000000000003, -10.5, -3.4, -7.300000000000001, -13.2, -9.899999999999997, -8.2, -6.4, -11.1, -12.799999999999995, -10.5, -9.1, -16.2, -10.2, -10.199999999999987, -5.2, -12.0, -15.499999999999993, -11.2, -13.599999999999998, -5.2, -14.6, -13.699999999999998, -4.2, -8.4, -12.4, -15.899999999999991, -11.599999999999998, -4.300000000000001, -12.5, -22.900000000000016, -8.7, -3.5, -4.2, -6.2, -4.2, -4.2, -8.700000000000001, -4.2, -21.30000000000003, -13.7, -8.3, -5.300000000000001, -17.700000000000003, -6.2, -5.2, -7.4, -9.1, -5.300000000000001, -16.0, -4.3, -5.9, -5.2, -7.300000000000001, -17.3, -7.3, -13.499999999999998, -3.3, -8.3, -9.499999999999995, -3.3, -16.3, -10.2, -9.8, -12.2, -13.099999999999993, -13.599999999999998, -4.300000000000001, -19.7], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7799278112212833, "mean_inference_ms": 5.298568916050653, "mean_action_processing_ms": 0.09573628713615101, "mean_env_wait_ms": 13.89578473096172, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1284000, "timesteps_this_iter": 0, "agent_timesteps_total": 1284000, "timers": {"sample_time_ms": 20445.908, "sample_throughput": 195.638, "load_time_ms": 0.357, "load_throughput": 11198248.565, "learn_time_ms": 12041.271, "learn_throughput": 332.191, "update_time_ms": 2.357}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.031924672412275465, "policy_loss": -0.039230710292054764, "vf_loss": 7.059450871681654, "vf_explained_var": 0.35654483866947956, "kl": 0.009337387727823283, "entropy": 0.1932164754398087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1284000, "num_agent_steps_sampled": 1284000, "num_steps_trained": 1284000, "num_agent_steps_trained": 1284000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12968, "training_iteration": 321, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-13-08", "timestamp": 1643656388, "time_this_iter_s": 16.33895182609558, "time_total_s": 11043.679915428162, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11043.679915428162, "timesteps_since_restore": 0, "iterations_since_restore": 321, "perf": {"cpu_util_percent": 24.13478260869565, "ram_util_percent": 62.90434782608698}}
{"episode_reward_max": -3.3, "episode_reward_min": -57.70000000000001, "episode_reward_mean": -11.489, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.799999999999995, -10.5, -9.1, -16.2, -10.2, -10.199999999999987, -5.2, -12.0, -15.499999999999993, -11.2, -13.599999999999998, -5.2, -14.6, -13.699999999999998, -4.2, -8.4, -12.4, -15.899999999999991, -11.599999999999998, -4.300000000000001, -12.5, -22.900000000000016, -8.7, -3.5, -4.2, -6.2, -4.2, -4.2, -8.700000000000001, -4.2, -21.30000000000003, -13.7, -8.3, -5.300000000000001, -17.700000000000003, -6.2, -5.2, -7.4, -9.1, -5.300000000000001, -16.0, -4.3, -5.9, -5.2, -7.300000000000001, -17.3, -7.3, -13.499999999999998, -3.3, -8.3, -9.499999999999995, -3.3, -16.3, -10.2, -9.8, -12.2, -13.099999999999993, -13.599999999999998, -4.300000000000001, -19.7, -14.899999999999999, -25.1, -9.399999999999999, -17.2, -45.2, -7.3, -7.9, -4.800000000000001, -11.2, -6.3, -23.0, -7.299999999999999, -3.5000000000000004, -13.4, -11.0, -40.2, -3.3, -7.2, -22.3, -22.5, -10.7, -14.2, -5.300000000000001, -5.300000000000001, -21.699999999999996, -3.3, -27.3, -7.1, -9.8, -4.300000000000001, -57.70000000000001, -4.2, -10.100000000000001, -18.199999999999967, -11.799999999999999, -3.3, -4.2, -20.9, -3.4, -7.1], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.77107747304394, "mean_inference_ms": 5.285877005709629, "mean_action_processing_ms": 0.09565030377773187, "mean_env_wait_ms": 13.869804084683787, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1288000, "timesteps_this_iter": 0, "agent_timesteps_total": 1288000, "timers": {"sample_time_ms": 20500.313, "sample_throughput": 195.119, "load_time_ms": 0.367, "load_throughput": 10892881.444, "learn_time_ms": 12213.216, "learn_throughput": 327.514, "update_time_ms": 2.373}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.2252517876418067, "policy_loss": -0.016291031791197678, "vf_loss": 24.068679934547795, "vf_explained_var": 0.24847254394203103, "kl": 0.014250999936917518, "entropy": 0.20153175948928762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1288000, "num_agent_steps_sampled": 1288000, "num_steps_trained": 1288000, "num_agent_steps_trained": 1288000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13008, "training_iteration": 322, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-13-24", "timestamp": 1643656404, "time_this_iter_s": 15.874344110488892, "time_total_s": 11059.55425953865, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11059.55425953865, "timesteps_since_restore": 0, "iterations_since_restore": 322, "perf": {"cpu_util_percent": 19.669565217391302, "ram_util_percent": 62.947826086956546}}
{"episode_reward_max": -3.2, "episode_reward_min": -60.60000000000006, "episode_reward_mean": -14.186000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.0, -4.3, -5.9, -5.2, -7.300000000000001, -17.3, -7.3, -13.499999999999998, -3.3, -8.3, -9.499999999999995, -3.3, -16.3, -10.2, -9.8, -12.2, -13.099999999999993, -13.599999999999998, -4.300000000000001, -19.7, -14.899999999999999, -25.1, -9.399999999999999, -17.2, -45.2, -7.3, -7.9, -4.800000000000001, -11.2, -6.3, -23.0, -7.299999999999999, -3.5000000000000004, -13.4, -11.0, -40.2, -3.3, -7.2, -22.3, -22.5, -10.7, -14.2, -5.300000000000001, -5.300000000000001, -21.699999999999996, -3.3, -27.3, -7.1, -9.8, -4.300000000000001, -57.70000000000001, -4.2, -10.100000000000001, -18.199999999999967, -11.799999999999999, -3.3, -4.2, -20.9, -3.4, -7.1, -36.2, -10.799999999999986, -8.3, -3.2, -9.499999999999998, -11.2, -15.600000000000001, -13.2, -11.9, -11.9, -12.899999999999995, -25.2, -3.6, -26.599999999999998, -10.7, -20.900000000000006, -3.3, -44.3, -3.4, -11.3, -19.2, -34.2, -16.7, -5.300000000000001, -4.300000000000001, -9.9, -8.799999999999999, -24.3, -4.2, -12.599999999999998, -15.199999999999998, -10.999999999999996, -5.2, -18.2, -39.000000000000064, -37.60000000000001, -15.399999999999997, -60.60000000000006, -20.799999999999997, -8.799999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7622242880764407, "mean_inference_ms": 5.273263151243591, "mean_action_processing_ms": 0.09556533506551394, "mean_env_wait_ms": 13.844029342794597, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1292000, "timesteps_this_iter": 0, "agent_timesteps_total": 1292000, "timers": {"sample_time_ms": 20733.981, "sample_throughput": 192.92, "load_time_ms": 0.359, "load_throughput": 11133596.124, "learn_time_ms": 8293.106, "learn_throughput": 482.328, "update_time_ms": 1.708}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.31691996649994203, "policy_loss": -0.0258376961193418, "vf_loss": 34.203157239319175, "vf_explained_var": 0.1859902770288529, "kl": 0.012088026798779645, "entropy": 0.24090536937758486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1292000, "num_agent_steps_sampled": 1292000, "num_steps_trained": 1292000, "num_agent_steps_trained": 1292000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13048, "training_iteration": 323, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-13-40", "timestamp": 1643656420, "time_this_iter_s": 15.667139053344727, "time_total_s": 11075.221398591995, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11075.221398591995, "timesteps_since_restore": 0, "iterations_since_restore": 323, "perf": {"cpu_util_percent": 22.85454545454546, "ram_util_percent": 62.90000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -60.60000000000006, "episode_reward_mean": -13.659, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.7, -14.2, -5.300000000000001, -5.300000000000001, -21.699999999999996, -3.3, -27.3, -7.1, -9.8, -4.300000000000001, -57.70000000000001, -4.2, -10.100000000000001, -18.199999999999967, -11.799999999999999, -3.3, -4.2, -20.9, -3.4, -7.1, -36.2, -10.799999999999986, -8.3, -3.2, -9.499999999999998, -11.2, -15.600000000000001, -13.2, -11.9, -11.9, -12.899999999999995, -25.2, -3.6, -26.599999999999998, -10.7, -20.900000000000006, -3.3, -44.3, -3.4, -11.3, -19.2, -34.2, -16.7, -5.300000000000001, -4.300000000000001, -9.9, -8.799999999999999, -24.3, -4.2, -12.599999999999998, -15.199999999999998, -10.999999999999996, -5.2, -18.2, -39.000000000000064, -37.60000000000001, -15.399999999999997, -60.60000000000006, -20.799999999999997, -8.799999999999999, -7.2, -5.4, -17.9, -5.2, -10.7, -5.300000000000001, -11.5, -10.3, -14.999999999999998, -15.699999999999973, -3.2, -12.0, -4.3, -8.299999999999997, -23.0, -9.4, -22.199999999999996, -6.4, -3.4, -10.6, -9.0, -7.0, -11.3, -19.900000000000013, -8.0, -11.5, -19.999999999999996, -3.5000000000000004, -8.799999999999997, -16.2, -38.9, -3.3, -14.0, -19.5, -16.1, -4.3, -14.699999999999998, -5.300000000000001, -7.2, -5.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7534785175365677, "mean_inference_ms": 5.2606782648904105, "mean_action_processing_ms": 0.09547856159771335, "mean_env_wait_ms": 13.818064165540532, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1296000, "timesteps_this_iter": 0, "agent_timesteps_total": 1296000, "timers": {"sample_time_ms": 17432.924, "sample_throughput": 229.451, "load_time_ms": 0.359, "load_throughput": 11130641.544, "learn_time_ms": 7928.94, "learn_throughput": 504.481, "update_time_ms": 1.724}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.07012650930918553, "policy_loss": -0.022388914834347462, "vf_loss": 9.176155713296705, "vf_explained_var": 0.2705632799415178, "kl": 0.012550313937032698, "entropy": 0.25004571894163724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1296000, "num_agent_steps_sampled": 1296000, "num_steps_trained": 1296000, "num_agent_steps_trained": 1296000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13088, "training_iteration": 324, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-13-55", "timestamp": 1643656435, "time_this_iter_s": 15.60457706451416, "time_total_s": 11090.82597565651, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11090.82597565651, "timesteps_since_restore": 0, "iterations_since_restore": 324, "perf": {"cpu_util_percent": 35.9304347826087, "ram_util_percent": 62.91304347826089}}
{"episode_reward_max": -3.2, "episode_reward_min": -60.60000000000006, "episode_reward_mean": -12.635999999999997, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.2, -34.2, -16.7, -5.300000000000001, -4.300000000000001, -9.9, -8.799999999999999, -24.3, -4.2, -12.599999999999998, -15.199999999999998, -10.999999999999996, -5.2, -18.2, -39.000000000000064, -37.60000000000001, -15.399999999999997, -60.60000000000006, -20.799999999999997, -8.799999999999999, -7.2, -5.4, -17.9, -5.2, -10.7, -5.300000000000001, -11.5, -10.3, -14.999999999999998, -15.699999999999973, -3.2, -12.0, -4.3, -8.299999999999997, -23.0, -9.4, -22.199999999999996, -6.4, -3.4, -10.6, -9.0, -7.0, -11.3, -19.900000000000013, -8.0, -11.5, -19.999999999999996, -3.5000000000000004, -8.799999999999997, -16.2, -38.9, -3.3, -14.0, -19.5, -16.1, -4.3, -14.699999999999998, -5.300000000000001, -7.2, -5.2, -7.599999999999999, -22.6, -6.1, -3.3, -9.2, -6.300000000000001, -15.2, -19.2, -5.599999999999999, -9.3, -5.2, -6.300000000000001, -11.2, -6.3, -15.299999999999981, -17.2, -7.9, -6.300000000000001, -14.5, -11.299999999999997, -12.4, -6.2, -6.300000000000001, -16.4, -13.3, -38.8, -13.2, -5.2, -10.9, -5.1, -7.3999999999999995, -4.3, -5.300000000000001, -35.70000000000001, -13.899999999999999, -3.3, -9.600000000000001, -9.8, -12.3, -6.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7447681212263655, "mean_inference_ms": 5.248161663564378, "mean_action_processing_ms": 0.09539204861745952, "mean_env_wait_ms": 13.792240302618282, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1300000, "timesteps_this_iter": 0, "agent_timesteps_total": 1300000, "timers": {"sample_time_ms": 16231.771, "sample_throughput": 246.43, "load_time_ms": 0.357, "load_throughput": 11189286.381, "learn_time_ms": 7886.981, "learn_throughput": 507.165, "update_time_ms": 1.747}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.11917888975041288, "policy_loss": -0.008879765843151397, "vf_loss": 12.760980129882853, "vf_explained_var": 0.3130635572377072, "kl": 0.007472535816116774, "entropy": 0.22248683471673278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1300000, "num_agent_steps_sampled": 1300000, "num_steps_trained": 1300000, "num_agent_steps_trained": 1300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13128, "training_iteration": 325, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-14-12", "timestamp": 1643656452, "time_this_iter_s": 16.734111070632935, "time_total_s": 11107.560086727142, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11107.560086727142, "timesteps_since_restore": 0, "iterations_since_restore": 325, "perf": {"cpu_util_percent": 35.24347826086957, "ram_util_percent": 62.926086956521736}}
{"episode_reward_max": -3.2, "episode_reward_min": -38.9, "episode_reward_mean": -10.699000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, -7.0, -11.3, -19.900000000000013, -8.0, -11.5, -19.999999999999996, -3.5000000000000004, -8.799999999999997, -16.2, -38.9, -3.3, -14.0, -19.5, -16.1, -4.3, -14.699999999999998, -5.300000000000001, -7.2, -5.2, -7.599999999999999, -22.6, -6.1, -3.3, -9.2, -6.300000000000001, -15.2, -19.2, -5.599999999999999, -9.3, -5.2, -6.300000000000001, -11.2, -6.3, -15.299999999999981, -17.2, -7.9, -6.300000000000001, -14.5, -11.299999999999997, -12.4, -6.2, -6.300000000000001, -16.4, -13.3, -38.8, -13.2, -5.2, -10.9, -5.1, -7.3999999999999995, -4.3, -5.300000000000001, -35.70000000000001, -13.899999999999999, -3.3, -9.600000000000001, -9.8, -12.3, -6.300000000000001, -7.4, -3.2, -15.899999999999999, -3.3, -10.3, -20.6, -4.4, -21.900000000000006, -8.8, -10.5, -13.499999999999996, -6.2, -6.4, -5.300000000000001, -4.2, -5.300000000000001, -9.2, -7.6000000000000005, -3.4, -6.2, -12.7, -12.3, -13.5, -4.4, -16.800000000000004, -4.5, -23.500000000000036, -3.3, -6.2, -5.8999999999999995, -25.00000000000001, -6.0, -4.3, -17.8, -6.4, -10.299999999999997, -10.999999999999998, -13.399999999999999, -5.2, -8.499999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7362252304351227, "mean_inference_ms": 5.2359496876346645, "mean_action_processing_ms": 0.09531728417806111, "mean_env_wait_ms": 13.767632085346877, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1304000, "timesteps_this_iter": 0, "agent_timesteps_total": 1304000, "timers": {"sample_time_ms": 16276.509, "sample_throughput": 245.753, "load_time_ms": 0.358, "load_throughput": 11170661.163, "learn_time_ms": 7857.042, "learn_throughput": 509.097, "update_time_ms": 1.68}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.07923765350633892, "policy_loss": -0.014820011385706483, "vf_loss": 9.353043074537348, "vf_explained_var": 0.23669704846156542, "kl": 0.008777336116764112, "entropy": 0.18421484506338515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1304000, "num_agent_steps_sampled": 1304000, "num_steps_trained": 1304000, "num_agent_steps_trained": 1304000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13168, "training_iteration": 326, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-14-29", "timestamp": 1643656469, "time_this_iter_s": 16.902969121932983, "time_total_s": 11124.463055849075, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11124.463055849075, "timesteps_since_restore": 0, "iterations_since_restore": 326, "perf": {"cpu_util_percent": 37.645833333333336, "ram_util_percent": 63.05833333333334}}
{"episode_reward_max": -3.2, "episode_reward_min": -38.8, "episode_reward_mean": -10.402000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.3, -38.8, -13.2, -5.2, -10.9, -5.1, -7.3999999999999995, -4.3, -5.300000000000001, -35.70000000000001, -13.899999999999999, -3.3, -9.600000000000001, -9.8, -12.3, -6.300000000000001, -7.4, -3.2, -15.899999999999999, -3.3, -10.3, -20.6, -4.4, -21.900000000000006, -8.8, -10.5, -13.499999999999996, -6.2, -6.4, -5.300000000000001, -4.2, -5.300000000000001, -9.2, -7.6000000000000005, -3.4, -6.2, -12.7, -12.3, -13.5, -4.4, -16.800000000000004, -4.5, -23.500000000000036, -3.3, -6.2, -5.8999999999999995, -25.00000000000001, -6.0, -4.3, -17.8, -6.4, -10.299999999999997, -10.999999999999998, -13.399999999999999, -5.2, -8.499999999999998, -21.800000000000004, -11.4, -3.3, -19.3, -3.3, -6.8999999999999995, -13.2, -15.5, -8.2, -4.300000000000001, -9.299999999999999, -4.300000000000001, -4.3, -6.4, -12.6, -4.300000000000001, -16.099999999999973, -9.599999999999996, -18.400000000000002, -5.2, -14.2, -15.699999999999998, -4.4, -14.2, -17.100000000000012, -14.2, -7.799999999999999, -6.4, -5.2, -7.199999999999999, -12.2, -16.5, -20.400000000000002, -7.1, -9.199999999999998, -19.3, -13.899999999999999, -3.3, -6.699999999999999, -12.4, -5.999999999999999, -20.799999999999997, -5.1, -4.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8474520362697273, "mean_inference_ms": 5.340427277295075, "mean_action_processing_ms": 0.09530031214574748, "mean_env_wait_ms": 13.504253993370185, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1308000, "timesteps_this_iter": 0, "agent_timesteps_total": 1308000, "timers": {"sample_time_ms": 16030.932, "sample_throughput": 249.518, "load_time_ms": 0.358, "load_throughput": 11170661.163, "learn_time_ms": 7866.699, "learn_throughput": 508.472, "update_time_ms": 1.639}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.0715493552261583, "policy_loss": -0.010233178836924414, "vf_loss": 8.127203156021974, "vf_explained_var": 0.4100268594680294, "kl": 0.008498802364282064, "entropy": 0.18634615993547823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1308000, "num_agent_steps_sampled": 1308000, "num_steps_trained": 1308000, "num_agent_steps_trained": 1308000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13212, "training_iteration": 327, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-14-45", "timestamp": 1643656485, "time_this_iter_s": 15.676825046539307, "time_total_s": 11140.139880895615, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11140.139880895615, "timesteps_since_restore": 0, "iterations_since_restore": 327, "perf": {"cpu_util_percent": 32.986956521739124, "ram_util_percent": 63.01304347826087}}
{"episode_reward_max": -2.2, "episode_reward_min": -25.00000000000001, "episode_reward_mean": -10.218, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.800000000000004, -4.5, -23.500000000000036, -3.3, -6.2, -5.8999999999999995, -25.00000000000001, -6.0, -4.3, -17.8, -6.4, -10.299999999999997, -10.999999999999998, -13.399999999999999, -5.2, -8.499999999999998, -21.800000000000004, -11.4, -3.3, -19.3, -3.3, -6.8999999999999995, -13.2, -15.5, -8.2, -4.300000000000001, -9.299999999999999, -4.300000000000001, -4.3, -6.4, -12.6, -4.300000000000001, -16.099999999999973, -9.599999999999996, -18.400000000000002, -5.2, -14.2, -15.699999999999998, -4.4, -14.2, -17.100000000000012, -14.2, -7.799999999999999, -6.4, -5.2, -7.199999999999999, -12.2, -16.5, -20.400000000000002, -7.1, -9.199999999999998, -19.3, -13.899999999999999, -3.3, -6.699999999999999, -12.4, -5.999999999999999, -20.799999999999997, -5.1, -4.2, -4.300000000000001, -5.300000000000001, -4.300000000000001, -8.2, -13.299999999999999, -11.499999999999995, -8.9, -6.4, -11.3, -10.2, -11.799999999999999, -12.3, -17.999999999999996, -13.299999999999994, -13.2, -11.3, -3.3, -9.399999999999999, -3.4, -6.300000000000001, -9.2, -2.2, -4.4, -10.0, -13.299999999999999, -18.90000000000001, -14.7, -8.799999999999999, -14.100000000000001, -13.3, -22.8, -7.800000000000001, -4.300000000000001, -11.5, -3.3, -13.799999999999999, -3.3, -10.299999999999999, -3.3, -17.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8391070473854425, "mean_inference_ms": 5.328292759716261, "mean_action_processing_ms": 0.09522248424490506, "mean_env_wait_ms": 13.481109878858874, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1312000, "timesteps_this_iter": 0, "agent_timesteps_total": 1312000, "timers": {"sample_time_ms": 16030.501, "sample_throughput": 249.524, "load_time_ms": 0.359, "load_throughput": 11135813.089, "learn_time_ms": 7859.402, "learn_throughput": 508.945, "update_time_ms": 1.685}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.04961716023584207, "policy_loss": -0.013226448999898088, "vf_loss": 6.205444541269092, "vf_explained_var": 0.4473039943043904, "kl": 0.013137919212706555, "entropy": 0.18894288233451306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1312000, "num_agent_steps_sampled": 1312000, "num_steps_trained": 1312000, "num_agent_steps_trained": 1312000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13252, "training_iteration": 328, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-15-01", "timestamp": 1643656501, "time_this_iter_s": 15.824090003967285, "time_total_s": 11155.963970899582, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11155.963970899582, "timesteps_since_restore": 0, "iterations_since_restore": 328, "perf": {"cpu_util_percent": 36.27272727272727, "ram_util_percent": 62.936363636363645}}
{"episode_reward_max": -2.2, "episode_reward_min": -38.00000000000008, "episode_reward_mean": -10.378000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.100000000000012, -14.2, -7.799999999999999, -6.4, -5.2, -7.199999999999999, -12.2, -16.5, -20.400000000000002, -7.1, -9.199999999999998, -19.3, -13.899999999999999, -3.3, -6.699999999999999, -12.4, -5.999999999999999, -20.799999999999997, -5.1, -4.2, -4.300000000000001, -5.300000000000001, -4.300000000000001, -8.2, -13.299999999999999, -11.499999999999995, -8.9, -6.4, -11.3, -10.2, -11.799999999999999, -12.3, -17.999999999999996, -13.299999999999994, -13.2, -11.3, -3.3, -9.399999999999999, -3.4, -6.300000000000001, -9.2, -2.2, -4.4, -10.0, -13.299999999999999, -18.90000000000001, -14.7, -8.799999999999999, -14.100000000000001, -13.3, -22.8, -7.800000000000001, -4.300000000000001, -11.5, -3.3, -13.799999999999999, -3.3, -10.299999999999999, -3.3, -17.2, -9.799999999999999, -38.00000000000008, -4.3, -10.399999999999999, -25.000000000000043, -5.000000000000001, -4.3, -5.2, -12.5, -9.299999999999999, -16.099999999999998, -14.699999999999996, -7.5, -5.2, -8.3, -9.8, -14.3, -14.099999999999998, -3.2, -18.7, -8.2, -8.600000000000001, -13.499999999999996, -10.9, -7.700000000000001, -13.2, -9.899999999999999, -9.2, -4.2, -10.9, -3.3, -5.9, -4.2, -15.999999999999998, -10.5, -11.399999999999997, -20.3, -16.2, -5.2, -5.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7124462390860606, "mean_inference_ms": 5.316124053561338, "mean_action_processing_ms": 0.09507314196499156, "mean_env_wait_ms": 13.575094375570602, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1316000, "timesteps_this_iter": 0, "agent_timesteps_total": 1316000, "timers": {"sample_time_ms": 15961.964, "sample_throughput": 250.596, "load_time_ms": 0.361, "load_throughput": 11090174.511, "learn_time_ms": 7870.417, "learn_throughput": 508.232, "update_time_ms": 1.673}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.07092822441350549, "policy_loss": -0.017284404931049192, "vf_loss": 8.736983528861435, "vf_explained_var": 0.42444490950594665, "kl": 0.014030795377937668, "entropy": 0.2403405406462249, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1316000, "num_agent_steps_sampled": 1316000, "num_steps_trained": 1316000, "num_agent_steps_trained": 1316000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13292, "training_iteration": 329, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-15-16", "timestamp": 1643656516, "time_this_iter_s": 15.599019050598145, "time_total_s": 11171.56298995018, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11171.56298995018, "timesteps_since_restore": 0, "iterations_since_restore": 329, "perf": {"cpu_util_percent": 32.69565217391305, "ram_util_percent": 63.0}}
{"episode_reward_max": -2.2, "episode_reward_min": -44.900000000000034, "episode_reward_mean": -11.128999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.2, -2.2, -4.4, -10.0, -13.299999999999999, -18.90000000000001, -14.7, -8.799999999999999, -14.100000000000001, -13.3, -22.8, -7.800000000000001, -4.300000000000001, -11.5, -3.3, -13.799999999999999, -3.3, -10.299999999999999, -3.3, -17.2, -9.799999999999999, -38.00000000000008, -4.3, -10.399999999999999, -25.000000000000043, -5.000000000000001, -4.3, -5.2, -12.5, -9.299999999999999, -16.099999999999998, -14.699999999999996, -7.5, -5.2, -8.3, -9.8, -14.3, -14.099999999999998, -3.2, -18.7, -8.2, -8.600000000000001, -13.499999999999996, -10.9, -7.700000000000001, -13.2, -9.899999999999999, -9.2, -4.2, -10.9, -3.3, -5.9, -4.2, -15.999999999999998, -10.5, -11.399999999999997, -20.3, -16.2, -5.2, -5.300000000000001, -16.599999999999998, -3.3, -5.300000000000001, -13.9, -6.2, -15.3, -19.4, -17.099999999999998, -4.300000000000001, -44.900000000000034, -12.399999999999975, -9.3, -8.900000000000004, -15.899999999999995, -5.300000000000001, -7.199999999999999, -3.7, -4.2, -6.9, -9.2, -25.5, -13.6, -9.799999999999981, -11.099999999999998, -5.300000000000001, -9.2, -3.3, -24.4, -18.6, -24.3, -5.2, -16.199999999999996, -9.799999999999995, -10.8, -13.2, -9.2, -8.3, -9.2, -16.5, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.702704074149066, "mean_inference_ms": 5.187266070410685, "mean_action_processing_ms": 0.09499125493423001, "mean_env_wait_ms": 13.66808924830764, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1320000, "timesteps_this_iter": 0, "agent_timesteps_total": 1320000, "timers": {"sample_time_ms": 16061.126, "sample_throughput": 249.049, "load_time_ms": 0.356, "load_throughput": 11241768.963, "learn_time_ms": 7869.705, "learn_throughput": 508.278, "update_time_ms": 1.69}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.12130118411244645, "policy_loss": -0.016896817819665996, "vf_loss": 13.757963824336247, "vf_explained_var": 0.27893772907154535, "kl": 0.010294526382471553, "entropy": 0.20913865749714194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1320000, "num_agent_steps_sampled": 1320000, "num_steps_trained": 1320000, "num_agent_steps_trained": 1320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13332, "training_iteration": 330, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-15-32", "timestamp": 1643656532, "time_this_iter_s": 16.045547008514404, "time_total_s": 11187.608536958694, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11187.608536958694, "timesteps_since_restore": 0, "iterations_since_restore": 330, "perf": {"cpu_util_percent": 33.71363636363637, "ram_util_percent": 63.0}}
{"episode_reward_max": -3.2, "episode_reward_min": -44.900000000000034, "episode_reward_mean": -11.780999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.2, -8.600000000000001, -13.499999999999996, -10.9, -7.700000000000001, -13.2, -9.899999999999999, -9.2, -4.2, -10.9, -3.3, -5.9, -4.2, -15.999999999999998, -10.5, -11.399999999999997, -20.3, -16.2, -5.2, -5.300000000000001, -16.599999999999998, -3.3, -5.300000000000001, -13.9, -6.2, -15.3, -19.4, -17.099999999999998, -4.300000000000001, -44.900000000000034, -12.399999999999975, -9.3, -8.900000000000004, -15.899999999999995, -5.300000000000001, -7.199999999999999, -3.7, -4.2, -6.9, -9.2, -25.5, -13.6, -9.799999999999981, -11.099999999999998, -5.300000000000001, -9.2, -3.3, -24.4, -18.6, -24.3, -5.2, -16.199999999999996, -9.799999999999995, -10.8, -13.2, -9.2, -8.3, -9.2, -16.5, -3.3, -3.2, -14.899999999999993, -3.2, -14.899999999999997, -16.699999999999992, -9.999999999999996, -9.999999999999998, -13.099999999999996, -8.5, -19.299999999999997, -39.2, -14.2, -9.399999999999999, -16.2, -21.2, -10.499999999999991, -10.299999999999997, -9.2, -32.0, -11.79999999999998, -5.300000000000001, -16.5, -3.4000000000000004, -15.399999999999999, -5.2, -17.4, -3.4, -15.3, -8.7, -16.6, -20.9, -11.599999999999993, -11.999999999999998, -16.6, -5.2, -19.39999999999999, -13.099999999999994, -4.2, -4.2, -5.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6943213635596406, "mean_inference_ms": 5.175221373454376, "mean_action_processing_ms": 0.09490835314161677, "mean_env_wait_ms": 13.643319863161842, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1324000, "timesteps_this_iter": 0, "agent_timesteps_total": 1324000, "timers": {"sample_time_ms": 16005.063, "sample_throughput": 249.921, "load_time_ms": 0.353, "load_throughput": 11343621.366, "learn_time_ms": 7840.663, "learn_throughput": 510.161, "update_time_ms": 1.697}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.07042414972268206, "policy_loss": -0.02565234673600043, "vf_loss": 9.54092725284638, "vf_explained_var": 0.4101034811747971, "kl": 0.011107908859944905, "entropy": 0.22745706290807774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1324000, "num_agent_steps_sampled": 1324000, "num_steps_trained": 1324000, "num_agent_steps_trained": 1324000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13372, "training_iteration": 331, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-15-48", "timestamp": 1643656548, "time_this_iter_s": 15.486262083053589, "time_total_s": 11203.094799041748, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11203.094799041748, "timesteps_since_restore": 0, "iterations_since_restore": 331, "perf": {"cpu_util_percent": 31.665217391304346, "ram_util_percent": 63.0}}
{"episode_reward_max": -1.3, "episode_reward_min": -84.4, "episode_reward_mean": -13.515, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.5, -13.6, -9.799999999999981, -11.099999999999998, -5.300000000000001, -9.2, -3.3, -24.4, -18.6, -24.3, -5.2, -16.199999999999996, -9.799999999999995, -10.8, -13.2, -9.2, -8.3, -9.2, -16.5, -3.3, -3.2, -14.899999999999993, -3.2, -14.899999999999997, -16.699999999999992, -9.999999999999996, -9.999999999999998, -13.099999999999996, -8.5, -19.299999999999997, -39.2, -14.2, -9.399999999999999, -16.2, -21.2, -10.499999999999991, -10.299999999999997, -9.2, -32.0, -11.79999999999998, -5.300000000000001, -16.5, -3.4000000000000004, -15.399999999999999, -5.2, -17.4, -3.4, -15.3, -8.7, -16.6, -20.9, -11.599999999999993, -11.999999999999998, -16.6, -5.2, -19.39999999999999, -13.099999999999994, -4.2, -4.2, -5.2, -18.799999999999997, -5.699999999999999, -4.2, -11.5, -10.8, -4.300000000000001, -67.30000000000001, -29.1, -7.2, -6.300000000000001, -14.799999999999997, -3.2, -9.9, -11.4, -3.3, -17.6, -23.500000000000004, -12.3, -14.4, -4.300000000000001, -10.399999999999999, -19.8, -3.6000000000000005, -5.2, -14.099999999999993, -21.6, -9.2, -8.399999999999991, -1.3, -14.5, -13.599999999999998, -3.4, -4.800000000000001, -44.3, -18.5, -10.2, -15.599999999999996, -84.4, -9.3, -5.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.686083313013096, "mean_inference_ms": 5.1632843339513474, "mean_action_processing_ms": 0.0948279420584689, "mean_env_wait_ms": 13.618902041400593, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1328000, "timesteps_this_iter": 0, "agent_timesteps_total": 1328000, "timers": {"sample_time_ms": 15987.666, "sample_throughput": 250.193, "load_time_ms": 0.358, "load_throughput": 11175869.971, "learn_time_ms": 7842.615, "learn_throughput": 510.034, "update_time_ms": 1.758}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.4728157499822618, "policy_loss": -0.014439255383706861, "vf_loss": 48.67040930960768, "vf_explained_var": 0.22033659924742996, "kl": 0.009171763585397466, "entropy": 0.2004765251951833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1328000, "num_agent_steps_sampled": 1328000, "num_steps_trained": 1328000, "num_agent_steps_trained": 1328000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13412, "training_iteration": 332, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-16-04", "timestamp": 1643656564, "time_this_iter_s": 16.01176404953003, "time_total_s": 11219.106563091278, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11219.106563091278, "timesteps_since_restore": 0, "iterations_since_restore": 332, "perf": {"cpu_util_percent": 31.250000000000004, "ram_util_percent": 63.01818181818182}}
{"episode_reward_max": -1.3, "episode_reward_min": -84.4, "episode_reward_mean": -13.313999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -16.5, -3.4000000000000004, -15.399999999999999, -5.2, -17.4, -3.4, -15.3, -8.7, -16.6, -20.9, -11.599999999999993, -11.999999999999998, -16.6, -5.2, -19.39999999999999, -13.099999999999994, -4.2, -4.2, -5.2, -18.799999999999997, -5.699999999999999, -4.2, -11.5, -10.8, -4.300000000000001, -67.30000000000001, -29.1, -7.2, -6.300000000000001, -14.799999999999997, -3.2, -9.9, -11.4, -3.3, -17.6, -23.500000000000004, -12.3, -14.4, -4.300000000000001, -10.399999999999999, -19.8, -3.6000000000000005, -5.2, -14.099999999999993, -21.6, -9.2, -8.399999999999991, -1.3, -14.5, -13.599999999999998, -3.4, -4.800000000000001, -44.3, -18.5, -10.2, -15.599999999999996, -84.4, -9.3, -5.2, -4.2, -5.300000000000001, -11.7, -12.5, -8.299999999999999, -7.2, -4.2, -3.3, -7.6, -3.3, -4.2, -17.3, -18.6, -10.3, -18.5, -13.4, -13.399999999999999, -5.300000000000001, -7.499999999999996, -3.2, -6.1, -4.4, -11.3, -13.799999999999999, -9.999999999999998, -7.1, -24.3, -21.8, -13.599999999999996, -8.2, -14.600000000000001, -16.799999999999997, -6.2, -10.1, -10.5, -15.3, -5.2, -19.3, -76.3, -40.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6777959265420095, "mean_inference_ms": 5.1513906806195315, "mean_action_processing_ms": 0.09474656914534912, "mean_env_wait_ms": 13.594556482052862, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1332000, "timesteps_this_iter": 0, "agent_timesteps_total": 1332000, "timers": {"sample_time_ms": 16004.287, "sample_throughput": 249.933, "load_time_ms": 0.364, "load_throughput": 10991362.683, "learn_time_ms": 7847.088, "learn_throughput": 509.743, "update_time_ms": 1.756}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.16185785934969943, "policy_loss": -0.02055511443965858, "vf_loss": 18.170372001714604, "vf_explained_var": 0.1393479931739069, "kl": 0.011807659157408062, "entropy": 0.20672779432547989, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1332000, "num_agent_steps_sampled": 1332000, "num_steps_trained": 1332000, "num_agent_steps_trained": 1332000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13452, "training_iteration": 333, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-16-20", "timestamp": 1643656580, "time_this_iter_s": 15.854475021362305, "time_total_s": 11234.96103811264, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11234.96103811264, "timesteps_since_restore": 0, "iterations_since_restore": 333, "perf": {"cpu_util_percent": 23.891304347826086, "ram_util_percent": 63.0}}
{"episode_reward_max": -1.3, "episode_reward_min": -116.69999999999989, "episode_reward_mean": -14.251999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.399999999999999, -19.8, -3.6000000000000005, -5.2, -14.099999999999993, -21.6, -9.2, -8.399999999999991, -1.3, -14.5, -13.599999999999998, -3.4, -4.800000000000001, -44.3, -18.5, -10.2, -15.599999999999996, -84.4, -9.3, -5.2, -4.2, -5.300000000000001, -11.7, -12.5, -8.299999999999999, -7.2, -4.2, -3.3, -7.6, -3.3, -4.2, -17.3, -18.6, -10.3, -18.5, -13.4, -13.399999999999999, -5.300000000000001, -7.499999999999996, -3.2, -6.1, -4.4, -11.3, -13.799999999999999, -9.999999999999998, -7.1, -24.3, -21.8, -13.599999999999996, -8.2, -14.600000000000001, -16.799999999999997, -6.2, -10.1, -10.5, -15.3, -5.2, -19.3, -76.3, -40.3, -8.5, -3.3, -13.899999999999997, -3.7, -4.300000000000001, -10.2, -8.999999999999998, -6.8999999999999995, -3.4, -116.69999999999989, -18.400000000000002, -24.7, -11.599999999999998, -9.3, -14.099999999999996, -13.999999999999996, -14.3, -3.3, -20.5, -16.9, -24.900000000000016, -15.599999999999998, -10.3, -13.199999999999992, -12.7, -14.5, -6.999999999999999, -3.3000000000000003, -4.2, -4.4, -67.2, -15.799999999999999, -3.3, -4.2, -9.2, -14.6, -25.799999999999997, -5.4, -7.300000000000001, -3.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.669548308475378, "mean_inference_ms": 5.139587734236243, "mean_action_processing_ms": 0.09466637070138152, "mean_env_wait_ms": 13.570399755899548, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1336000, "timesteps_this_iter": 0, "agent_timesteps_total": 1336000, "timers": {"sample_time_ms": 16023.898, "sample_throughput": 249.627, "load_time_ms": 0.362, "load_throughput": 11034738.227, "learn_time_ms": 7866.164, "learn_throughput": 508.507, "update_time_ms": 1.761}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.7111369882709027, "policy_loss": -0.015705539126660156, "vf_loss": 72.60975537633384, "vf_explained_var": 0.011577561850188881, "kl": 0.012402547431015749, "entropy": 0.18768642609638553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1336000, "num_agent_steps_sampled": 1336000, "num_steps_trained": 1336000, "num_agent_steps_trained": 1336000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13492, "training_iteration": 334, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-16-36", "timestamp": 1643656596, "time_this_iter_s": 15.944275856018066, "time_total_s": 11250.905313968658, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11250.905313968658, "timesteps_since_restore": 0, "iterations_since_restore": 334, "perf": {"cpu_util_percent": 29.304347826086957, "ram_util_percent": 63.0}}
{"episode_reward_max": -1.4000000000000001, "episode_reward_min": -116.69999999999989, "episode_reward_mean": -14.945, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.1, -4.4, -11.3, -13.799999999999999, -9.999999999999998, -7.1, -24.3, -21.8, -13.599999999999996, -8.2, -14.600000000000001, -16.799999999999997, -6.2, -10.1, -10.5, -15.3, -5.2, -19.3, -76.3, -40.3, -8.5, -3.3, -13.899999999999997, -3.7, -4.300000000000001, -10.2, -8.999999999999998, -6.8999999999999995, -3.4, -116.69999999999989, -18.400000000000002, -24.7, -11.599999999999998, -9.3, -14.099999999999996, -13.999999999999996, -14.3, -3.3, -20.5, -16.9, -24.900000000000016, -15.599999999999998, -10.3, -13.199999999999992, -12.7, -14.5, -6.999999999999999, -3.3000000000000003, -4.2, -4.4, -67.2, -15.799999999999999, -3.3, -4.2, -9.2, -14.6, -25.799999999999997, -5.4, -7.300000000000001, -3.4, -8.8, -7.9, -12.799999999999988, -12.199999999999998, -5.4, -76.2, -18.6, -21.099999999999994, -1.4000000000000001, -12.7, -9.2, -18.9, -4.800000000000001, -6.2, -7.1, -4.9, -17.6, -4.4, -12.5, -24.20000000000001, -15.699999999999992, -5.9, -9.2, -4.2, -6.2, -25.799999999999997, -3.3, -8.2, -8.799999999999997, -14.599999999999998, -17.3, -16.700000000000003, -8.3, -13.9, -25.800000000000004, -20.699999999999996, -15.199999999999985, -13.3, -23.600000000000016, -22.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6613287035548536, "mean_inference_ms": 5.1277932065487, "mean_action_processing_ms": 0.09458316479696602, "mean_env_wait_ms": 13.54604229618225, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1340000, "timesteps_this_iter": 0, "agent_timesteps_total": 1340000, "timers": {"sample_time_ms": 16014.944, "sample_throughput": 249.767, "load_time_ms": 0.367, "load_throughput": 10890760.143, "learn_time_ms": 7790.0, "learn_throughput": 513.479, "update_time_ms": 1.724}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.2705808903791651, "policy_loss": -0.015670462349750183, "vf_loss": 28.55433283236719, "vf_explained_var": 0.032831688145155545, "kl": 0.011787179423269857, "entropy": 0.23272929108271034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1340000, "num_agent_steps_sampled": 1340000, "num_steps_trained": 1340000, "num_agent_steps_trained": 1340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13532, "training_iteration": 335, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-16-52", "timestamp": 1643656612, "time_this_iter_s": 15.689218044281006, "time_total_s": 11266.59453201294, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11266.59453201294, "timesteps_since_restore": 0, "iterations_since_restore": 335, "perf": {"cpu_util_percent": 33.3590909090909, "ram_util_percent": 63.0090909090909}}
{"episode_reward_max": -1.4000000000000001, "episode_reward_min": -84.40000000000008, "episode_reward_mean": -14.267999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.900000000000016, -15.599999999999998, -10.3, -13.199999999999992, -12.7, -14.5, -6.999999999999999, -3.3000000000000003, -4.2, -4.4, -67.2, -15.799999999999999, -3.3, -4.2, -9.2, -14.6, -25.799999999999997, -5.4, -7.300000000000001, -3.4, -8.8, -7.9, -12.799999999999988, -12.199999999999998, -5.4, -76.2, -18.6, -21.099999999999994, -1.4000000000000001, -12.7, -9.2, -18.9, -4.800000000000001, -6.2, -7.1, -4.9, -17.6, -4.4, -12.5, -24.20000000000001, -15.699999999999992, -5.9, -9.2, -4.2, -6.2, -25.799999999999997, -3.3, -8.2, -8.799999999999997, -14.599999999999998, -17.3, -16.700000000000003, -8.3, -13.9, -25.800000000000004, -20.699999999999996, -15.199999999999985, -13.3, -23.600000000000016, -22.4, -5.4, -39.2, -12.6, -25.00000000000001, -23.2, -84.40000000000008, -4.800000000000001, -17.999999999999996, -18.000000000000004, -15.699999999999998, -13.699999999999985, -5.300000000000001, -4.300000000000001, -40.3, -12.7, -3.2, -10.899999999999999, -12.7, -34.2, -13.6, -8.799999999999997, -16.599999999999994, -12.7, -5.2, -18.4, -10.799999999999999, -12.399999999999997, -10.9, -5.2, -7.199999999999999, -12.3, -4.2, -11.299999999999999, -18.6, -5.2, -4.300000000000001, -16.4, -4.300000000000001, -6.300000000000001, -6.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.653286606138119, "mean_inference_ms": 5.116195446517168, "mean_action_processing_ms": 0.09450624739464451, "mean_env_wait_ms": 13.522491376297271, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1344000, "timesteps_this_iter": 0, "agent_timesteps_total": 1344000, "timers": {"sample_time_ms": 15905.445, "sample_throughput": 251.486, "load_time_ms": 0.367, "load_throughput": 10887933.026, "learn_time_ms": 7800.119, "learn_throughput": 512.813, "update_time_ms": 1.698}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.3542025772634373, "policy_loss": -0.01711616068778019, "vf_loss": 37.085077652623575, "vf_explained_var": -0.053979273957590904, "kl": 0.007790672893550028, "entropy": 0.2182914757199826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1344000, "num_agent_steps_sampled": 1344000, "num_steps_trained": 1344000, "num_agent_steps_trained": 1344000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13572, "training_iteration": 336, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-17-08", "timestamp": 1643656628, "time_this_iter_s": 16.673070907592773, "time_total_s": 11283.267602920532, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11283.267602920532, "timesteps_since_restore": 0, "iterations_since_restore": 336, "perf": {"cpu_util_percent": 38.12916666666667, "ram_util_percent": 63.0875}}
{"episode_reward_max": -3.2, "episode_reward_min": -84.40000000000008, "episode_reward_mean": -12.923, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -25.799999999999997, -3.3, -8.2, -8.799999999999997, -14.599999999999998, -17.3, -16.700000000000003, -8.3, -13.9, -25.800000000000004, -20.699999999999996, -15.199999999999985, -13.3, -23.600000000000016, -22.4, -5.4, -39.2, -12.6, -25.00000000000001, -23.2, -84.40000000000008, -4.800000000000001, -17.999999999999996, -18.000000000000004, -15.699999999999998, -13.699999999999985, -5.300000000000001, -4.300000000000001, -40.3, -12.7, -3.2, -10.899999999999999, -12.7, -34.2, -13.6, -8.799999999999997, -16.599999999999994, -12.7, -5.2, -18.4, -10.799999999999999, -12.399999999999997, -10.9, -5.2, -7.199999999999999, -12.3, -4.2, -11.299999999999999, -18.6, -5.2, -4.300000000000001, -16.4, -4.300000000000001, -6.300000000000001, -6.2, -5.999999999999999, -10.199999999999998, -10.2, -11.399999999999999, -17.9, -6.2, -11.899999999999997, -10.3, -8.7, -4.4, -22.5, -12.5, -9.199999999999998, -4.2, -11.399999999999999, -4.2, -8.6, -8.3, -12.7, -4.2, -5.2, -7.099999999999999, -5.2, -18.300000000000004, -4.5, -4.3, -10.199999999999998, -15.899999999999999, -4.300000000000001, -18.5, -12.399999999999997, -17.400000000000002, -9.6, -19.7, -3.9000000000000004, -8.899999999999999, -3.4, -4.4, -43.3, -4.300000000000001, -5.300000000000001, -20.999999999999996, -5.3, -6.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.761575753776672, "mean_inference_ms": 5.217869864044826, "mean_action_processing_ms": 0.0944891360289376, "mean_env_wait_ms": 13.267449198316958, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1348000, "timesteps_this_iter": 0, "agent_timesteps_total": 1348000, "timers": {"sample_time_ms": 15953.877, "sample_throughput": 250.723, "load_time_ms": 0.372, "load_throughput": 10750490.837, "learn_time_ms": 7853.301, "learn_throughput": 509.34, "update_time_ms": 1.731}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.12705244031304153, "policy_loss": -0.02004516384018565, "vf_loss": 14.615165762555215, "vf_explained_var": 0.04375164585728799, "kl": 0.015748046396586095, "entropy": 0.22555520812510163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1348000, "num_agent_steps_sampled": 1348000, "num_steps_trained": 1348000, "num_agent_steps_trained": 1348000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13616, "training_iteration": 337, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-17-25", "timestamp": 1643656645, "time_this_iter_s": 16.60239005088806, "time_total_s": 11299.86999297142, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11299.86999297142, "timesteps_since_restore": 0, "iterations_since_restore": 337, "perf": {"cpu_util_percent": 35.29130434782609, "ram_util_percent": 63.00434782608695}}
{"episode_reward_max": -3.2, "episode_reward_min": -98.10000000000011, "episode_reward_mean": -12.116000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.4, -10.799999999999999, -12.399999999999997, -10.9, -5.2, -7.199999999999999, -12.3, -4.2, -11.299999999999999, -18.6, -5.2, -4.300000000000001, -16.4, -4.300000000000001, -6.300000000000001, -6.2, -5.999999999999999, -10.199999999999998, -10.2, -11.399999999999999, -17.9, -6.2, -11.899999999999997, -10.3, -8.7, -4.4, -22.5, -12.5, -9.199999999999998, -4.2, -11.399999999999999, -4.2, -8.6, -8.3, -12.7, -4.2, -5.2, -7.099999999999999, -5.2, -18.300000000000004, -4.5, -4.3, -10.199999999999998, -15.899999999999999, -4.300000000000001, -18.5, -12.399999999999997, -17.400000000000002, -9.6, -19.7, -3.9000000000000004, -8.899999999999999, -3.4, -4.4, -43.3, -4.300000000000001, -5.300000000000001, -20.999999999999996, -5.3, -6.300000000000001, -12.6, -3.3, -11.799999999999999, -4.300000000000001, -6.4, -6.300000000000001, -19.700000000000003, -14.3, -13.099999999999998, -7.300000000000001, -29.80000000000002, -19.8, -21.3, -11.600000000000001, -98.10000000000011, -5.300000000000001, -5.4, -5.2, -7.4, -7.299999999999999, -18.000000000000004, -10.4, -13.8, -13.399999999999999, -11.2, -18.2, -3.2, -13.099999999999998, -8.9, -3.3, -60.900000000000034, -11.199999999999998, -3.2, -27.90000000000001, -6.1, -15.8, -4.7, -29.49999999999997, -8.999999999999996, -11.8], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.754087528013374, "mean_inference_ms": 5.206999926182714, "mean_action_processing_ms": 0.09444894249403438, "mean_env_wait_ms": 13.248395362147765, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1352000, "timesteps_this_iter": 0, "agent_timesteps_total": 1352000, "timers": {"sample_time_ms": 16329.181, "sample_throughput": 244.96, "load_time_ms": 0.375, "load_throughput": 10661000.191, "learn_time_ms": 8071.677, "learn_throughput": 495.56, "update_time_ms": 1.761}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.46569737233697206, "policy_loss": -0.016452009527273076, "vf_loss": 48.12458348030685, "vf_explained_var": 0.09563419222831726, "kl": 0.015042359136448307, "entropy": 0.2122962237766353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1352000, "num_agent_steps_sampled": 1352000, "num_steps_trained": 1352000, "num_agent_steps_trained": 1352000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13656, "training_iteration": 338, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-17-47", "timestamp": 1643656667, "time_this_iter_s": 21.737383127212524, "time_total_s": 11321.607376098633, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11321.607376098633, "timesteps_since_restore": 0, "iterations_since_restore": 338, "perf": {"cpu_util_percent": 48.87096774193548, "ram_util_percent": 63.66451612903226}}
{"episode_reward_max": -3.2, "episode_reward_min": -98.10000000000011, "episode_reward_mean": -12.235, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.5, -4.3, -10.199999999999998, -15.899999999999999, -4.300000000000001, -18.5, -12.399999999999997, -17.400000000000002, -9.6, -19.7, -3.9000000000000004, -8.899999999999999, -3.4, -4.4, -43.3, -4.300000000000001, -5.300000000000001, -20.999999999999996, -5.3, -6.300000000000001, -12.6, -3.3, -11.799999999999999, -4.300000000000001, -6.4, -6.300000000000001, -19.700000000000003, -14.3, -13.099999999999998, -7.300000000000001, -29.80000000000002, -19.8, -21.3, -11.600000000000001, -98.10000000000011, -5.300000000000001, -5.4, -5.2, -7.4, -7.299999999999999, -18.000000000000004, -10.4, -13.8, -13.399999999999999, -11.2, -18.2, -3.2, -13.099999999999998, -8.9, -3.3, -60.900000000000034, -11.199999999999998, -3.2, -27.90000000000001, -6.1, -15.8, -4.7, -29.49999999999997, -8.999999999999996, -11.8, -12.799999999999995, -16.3, -5.2, -12.799999999999997, -21.1, -4.3, -17.7, -18.600000000000005, -3.2, -6.2, -10.3, -3.2, -10.2, -11.0, -3.3, -13.099999999999998, -18.2, -13.2, -5.2, -21.4, -11.199999999999989, -31.299999999999965, -14.100000000000001, -3.3, -10.999999999999998, -8.9, -9.2, -4.300000000000001, -4.700000000000001, -7.499999999999998, -4.4, -6.300000000000001, -5.2, -8.2, -3.2, -8.3, -8.399999999999999, -8.8, -7.800000000000001, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.631796734138544, "mean_inference_ms": 5.196262439624891, "mean_action_processing_ms": 0.09434856134128833, "mean_env_wait_ms": 13.343813254293941, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1356000, "timesteps_this_iter": 0, "agent_timesteps_total": 1356000, "timers": {"sample_time_ms": 16620.473, "sample_throughput": 240.667, "load_time_ms": 0.367, "load_throughput": 10884401.194, "learn_time_ms": 8150.45, "learn_throughput": 490.77, "update_time_ms": 1.732}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.08776854454747511, "policy_loss": -0.012361537379222692, "vf_loss": 9.97439944987656, "vf_explained_var": 0.27876868055712795, "kl": 0.006427539208763737, "entropy": 0.18690401085762567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1356000, "num_agent_steps_sampled": 1356000, "num_steps_trained": 1356000, "num_agent_steps_trained": 1356000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13696, "training_iteration": 339, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-18-04", "timestamp": 1643656684, "time_this_iter_s": 17.116829872131348, "time_total_s": 11338.724205970764, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11338.724205970764, "timesteps_since_restore": 0, "iterations_since_restore": 339, "perf": {"cpu_util_percent": 26.15416666666667, "ram_util_percent": 64.18333333333334}}
{"episode_reward_max": -3.2, "episode_reward_min": -60.900000000000034, "episode_reward_mean": -12.040000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.000000000000004, -10.4, -13.8, -13.399999999999999, -11.2, -18.2, -3.2, -13.099999999999998, -8.9, -3.3, -60.900000000000034, -11.199999999999998, -3.2, -27.90000000000001, -6.1, -15.8, -4.7, -29.49999999999997, -8.999999999999996, -11.8, -12.799999999999995, -16.3, -5.2, -12.799999999999997, -21.1, -4.3, -17.7, -18.600000000000005, -3.2, -6.2, -10.3, -3.2, -10.2, -11.0, -3.3, -13.099999999999998, -18.2, -13.2, -5.2, -21.4, -11.199999999999989, -31.299999999999965, -14.100000000000001, -3.3, -10.999999999999998, -8.9, -9.2, -4.300000000000001, -4.700000000000001, -7.499999999999998, -4.4, -6.300000000000001, -5.2, -8.2, -3.2, -8.3, -8.399999999999999, -8.8, -7.800000000000001, -3.3, -14.699999999999996, -20.700000000000006, -47.800000000000004, -3.6000000000000005, -12.599999999999998, -9.399999999999999, -9.999999999999998, -12.3, -9.2, -18.799999999999997, -5.4, -17.299999999999997, -10.799999999999999, -15.699999999999998, -28.599999999999998, -10.399999999999999, -14.899999999999999, -13.2, -12.8, -6.3999999999999995, -3.3, -15.099999999999978, -5.1, -5.3, -14.099999999999998, -11.299999999999997, -12.399999999999999, -4.300000000000001, -18.6, -25.5, -12.599999999999998, -11.899999999999999, -16.3, -13.999999999999998, -3.4, -9.299999999999999, -4.2, -9.2, -14.999999999999996, -8.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6228275414382223, "mean_inference_ms": 5.072206325991542, "mean_action_processing_ms": 0.09430646312944364, "mean_env_wait_ms": 13.437899516920801, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1360000, "timesteps_this_iter": 0, "agent_timesteps_total": 1360000, "timers": {"sample_time_ms": 16823.799, "sample_throughput": 237.758, "load_time_ms": 0.365, "load_throughput": 10946898.082, "learn_time_ms": 8255.614, "learn_throughput": 484.519, "update_time_ms": 1.756}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.14535013016072973, "policy_loss": -0.01087562136392119, "vf_loss": 15.590455534509433, "vf_explained_var": 0.33541114150836904, "kl": 0.005347293737560477, "entropy": 0.19417756706956893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1360000, "num_agent_steps_sampled": 1360000, "num_steps_trained": 1360000, "num_agent_steps_trained": 1360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13736, "training_iteration": 340, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-18-22", "timestamp": 1643656702, "time_this_iter_s": 18.340036153793335, "time_total_s": 11357.064242124557, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11357.064242124557, "timesteps_since_restore": 0, "iterations_since_restore": 340, "perf": {"cpu_util_percent": 32.957692307692305, "ram_util_percent": 64.23846153846154}}
{"episode_reward_max": -3.2, "episode_reward_min": -72.2, "episode_reward_mean": -12.344000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.199999999999989, -31.299999999999965, -14.100000000000001, -3.3, -10.999999999999998, -8.9, -9.2, -4.300000000000001, -4.700000000000001, -7.499999999999998, -4.4, -6.300000000000001, -5.2, -8.2, -3.2, -8.3, -8.399999999999999, -8.8, -7.800000000000001, -3.3, -14.699999999999996, -20.700000000000006, -47.800000000000004, -3.6000000000000005, -12.599999999999998, -9.399999999999999, -9.999999999999998, -12.3, -9.2, -18.799999999999997, -5.4, -17.299999999999997, -10.799999999999999, -15.699999999999998, -28.599999999999998, -10.399999999999999, -14.899999999999999, -13.2, -12.8, -6.3999999999999995, -3.3, -15.099999999999978, -5.1, -5.3, -14.099999999999998, -11.299999999999997, -12.399999999999999, -4.300000000000001, -18.6, -25.5, -12.599999999999998, -11.899999999999999, -16.3, -13.999999999999998, -3.4, -9.299999999999999, -4.2, -9.2, -14.999999999999996, -8.2, -3.3000000000000003, -72.2, -4.3, -9.100000000000001, -10.3, -5.4, -18.2, -8.7, -25.80000000000004, -3.4, -11.2, -5.2, -19.20000000000001, -10.600000000000001, -14.9, -4.2, -5.9, -14.799999999999999, -17.0, -15.799999999999997, -6.9, -10.9, -20.400000000000006, -8.7, -5.0, -6.300000000000001, -23.8, -15.9, -17.60000000000001, -3.3, -11.299999999999997, -5.4, -5.300000000000001, -5.300000000000001, -12.700000000000001, -12.8, -15.699999999999998, -6.2, -25.6, -52.69999999999994], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.615538646584893, "mean_inference_ms": 5.061576716904129, "mean_action_processing_ms": 0.09426940576930391, "mean_env_wait_ms": 13.418042814930141, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1364000, "timesteps_this_iter": 0, "agent_timesteps_total": 1364000, "timers": {"sample_time_ms": 17206.567, "sample_throughput": 232.469, "load_time_ms": 0.367, "load_throughput": 10904917.777, "learn_time_ms": 8436.622, "learn_throughput": 474.123, "update_time_ms": 1.741}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.3042353478230296, "policy_loss": -0.012395902146755528, "vf_loss": 31.614593081128213, "vf_explained_var": 0.24200618452923273, "kl": 0.008079674498322193, "entropy": 0.18217526702711018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1364000, "num_agent_steps_sampled": 1364000, "num_steps_trained": 1364000, "num_agent_steps_trained": 1364000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13776, "training_iteration": 341, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-18-42", "timestamp": 1643656722, "time_this_iter_s": 20.075767993927002, "time_total_s": 11377.140010118484, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11377.140010118484, "timesteps_since_restore": 0, "iterations_since_restore": 341, "perf": {"cpu_util_percent": 38.54827586206898, "ram_util_percent": 63.906896551724124}}
{"episode_reward_max": -3.1, "episode_reward_min": -137.29999999999998, "episode_reward_mean": -13.527999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -15.099999999999978, -5.1, -5.3, -14.099999999999998, -11.299999999999997, -12.399999999999999, -4.300000000000001, -18.6, -25.5, -12.599999999999998, -11.899999999999999, -16.3, -13.999999999999998, -3.4, -9.299999999999999, -4.2, -9.2, -14.999999999999996, -8.2, -3.3000000000000003, -72.2, -4.3, -9.100000000000001, -10.3, -5.4, -18.2, -8.7, -25.80000000000004, -3.4, -11.2, -5.2, -19.20000000000001, -10.600000000000001, -14.9, -4.2, -5.9, -14.799999999999999, -17.0, -15.799999999999997, -6.9, -10.9, -20.400000000000006, -8.7, -5.0, -6.300000000000001, -23.8, -15.9, -17.60000000000001, -3.3, -11.299999999999997, -5.4, -5.300000000000001, -5.300000000000001, -12.700000000000001, -12.8, -15.699999999999998, -6.2, -25.6, -52.69999999999994, -11.1, -137.29999999999998, -13.599999999999998, -5.1, -16.6, -4.300000000000001, -8.199999999999998, -9.1, -4.2, -19.099999999999998, -6.2, -8.4, -8.4, -12.5, -11.999999999999996, -18.599999999999998, -12.5, -4.4, -21.400000000000006, -7.1, -4.4, -45.000000000000014, -9.2, -22.2, -16.799999999999997, -12.600000000000001, -5.2, -4.2, -12.099999999999996, -3.1, -4.300000000000001, -8.799999999999997, -4.2, -30.700000000000003, -9.799999999999999, -3.2, -8.599999999999998, -4.4, -15.699999999999983, -17.8], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.608298789916928, "mean_inference_ms": 5.0508877647276496, "mean_action_processing_ms": 0.0942263710166966, "mean_env_wait_ms": 13.397761126686026, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1368000, "timesteps_this_iter": 0, "agent_timesteps_total": 1368000, "timers": {"sample_time_ms": 17399.382, "sample_throughput": 229.893, "load_time_ms": 0.36, "load_throughput": 11116628.677, "learn_time_ms": 8399.658, "learn_throughput": 476.21, "update_time_ms": 1.678}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.6492072742101886, "policy_loss": -0.013907138929171588, "vf_loss": 66.25894221644248, "vf_explained_var": 0.1453655097433316, "kl": 0.00874042355863779, "entropy": 0.16961494674605707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1368000, "num_agent_steps_sampled": 1368000, "num_steps_trained": 1368000, "num_agent_steps_trained": 1368000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13816, "training_iteration": 342, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-18-58", "timestamp": 1643656738, "time_this_iter_s": 15.756090879440308, "time_total_s": 11392.896100997925, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11392.896100997925, "timesteps_since_restore": 0, "iterations_since_restore": 342, "perf": {"cpu_util_percent": 31.763636363636365, "ram_util_percent": 63.59999999999998}}
{"episode_reward_max": -3.1, "episode_reward_min": -137.29999999999998, "episode_reward_mean": -12.671999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.9, -10.9, -20.400000000000006, -8.7, -5.0, -6.300000000000001, -23.8, -15.9, -17.60000000000001, -3.3, -11.299999999999997, -5.4, -5.300000000000001, -5.300000000000001, -12.700000000000001, -12.8, -15.699999999999998, -6.2, -25.6, -52.69999999999994, -11.1, -137.29999999999998, -13.599999999999998, -5.1, -16.6, -4.300000000000001, -8.199999999999998, -9.1, -4.2, -19.099999999999998, -6.2, -8.4, -8.4, -12.5, -11.999999999999996, -18.599999999999998, -12.5, -4.4, -21.400000000000006, -7.1, -4.4, -45.000000000000014, -9.2, -22.2, -16.799999999999997, -12.600000000000001, -5.2, -4.2, -12.099999999999996, -3.1, -4.300000000000001, -8.799999999999997, -4.2, -30.700000000000003, -9.799999999999999, -3.2, -8.599999999999998, -4.4, -15.699999999999983, -17.8, -16.7, -8.200000000000001, -4.8999999999999995, -8.5, -15.6, -9.899999999999999, -8.8, -21.700000000000003, -16.499999999999986, -3.2, -10.899999999999999, -7.399999999999999, -9.5, -9.2, -6.300000000000001, -39.80000000000002, -15.799999999999999, -12.999999999999998, -17.600000000000016, -9.3, -8.799999999999999, -6.499999999999998, -4.800000000000001, -4.700000000000001, -12.899999999999974, -8.1, -9.2, -4.300000000000001, -5.3, -19.0, -5.2, -8.5, -6.300000000000001, -5.300000000000001, -15.499999999999998, -3.3, -4.300000000000001, -5.2, -16.7, -6.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.600786682814461, "mean_inference_ms": 5.039862850087822, "mean_action_processing_ms": 0.09416049808287451, "mean_env_wait_ms": 13.375702167197783, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1372000, "timesteps_this_iter": 0, "agent_timesteps_total": 1372000, "timers": {"sample_time_ms": 17326.774, "sample_throughput": 230.857, "load_time_ms": 0.346, "load_throughput": 11552965.156, "learn_time_ms": 8400.297, "learn_throughput": 476.174, "update_time_ms": 1.698}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.1975791766798945, "policy_loss": -0.021829549099008243, "vf_loss": 21.885613608103927, "vf_explained_var": 0.06751707869191323, "kl": 0.00919949245656705, "entropy": 0.19236973939082955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1372000, "num_agent_steps_sampled": 1372000, "num_steps_trained": 1372000, "num_agent_steps_trained": 1372000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13856, "training_iteration": 343, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-19-14", "timestamp": 1643656754, "time_this_iter_s": 15.506898164749146, "time_total_s": 11408.402999162674, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11408.402999162674, "timesteps_since_restore": 0, "iterations_since_restore": 343, "perf": {"cpu_util_percent": 34.404347826086955, "ram_util_percent": 63.59130434782606}}
{"episode_reward_max": -3.1, "episode_reward_min": -58.400000000000034, "episode_reward_mean": -11.135, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -45.000000000000014, -9.2, -22.2, -16.799999999999997, -12.600000000000001, -5.2, -4.2, -12.099999999999996, -3.1, -4.300000000000001, -8.799999999999997, -4.2, -30.700000000000003, -9.799999999999999, -3.2, -8.599999999999998, -4.4, -15.699999999999983, -17.8, -16.7, -8.200000000000001, -4.8999999999999995, -8.5, -15.6, -9.899999999999999, -8.8, -21.700000000000003, -16.499999999999986, -3.2, -10.899999999999999, -7.399999999999999, -9.5, -9.2, -6.300000000000001, -39.80000000000002, -15.799999999999999, -12.999999999999998, -17.600000000000016, -9.3, -8.799999999999999, -6.499999999999998, -4.800000000000001, -4.700000000000001, -12.899999999999974, -8.1, -9.2, -4.300000000000001, -5.3, -19.0, -5.2, -8.5, -6.300000000000001, -5.300000000000001, -15.499999999999998, -3.3, -4.300000000000001, -5.2, -16.7, -6.300000000000001, -18.3, -7.300000000000001, -5.300000000000001, -10.3, -5.1, -9.9, -4.300000000000001, -5.2, -7.300000000000001, -11.799999999999997, -17.9, -15.199999999999998, -12.199999999999996, -4.3, -15.6, -12.799999999999999, -4.2, -8.4, -9.3, -16.5, -6.300000000000001, -7.099999999999999, -19.800000000000004, -12.2, -16.6, -12.2, -17.3, -14.899999999999997, -6.2, -8.2, -58.400000000000034, -4.800000000000001, -17.099999999999998, -5.300000000000001, -17.700000000000003, -7.7, -7.299999999999999, -5.300000000000001, -6.4, -6.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5931441203622865, "mean_inference_ms": 5.028744916356643, "mean_action_processing_ms": 0.09408609942982238, "mean_env_wait_ms": 13.352986567657835, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1376000, "timesteps_this_iter": 0, "agent_timesteps_total": 1376000, "timers": {"sample_time_ms": 17355.086, "sample_throughput": 230.48, "load_time_ms": 0.346, "load_throughput": 11575283.566, "learn_time_ms": 8391.729, "learn_throughput": 476.66, "update_time_ms": 1.688}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.05093474809821415, "policy_loss": -0.01563884493674562, "vf_loss": 6.604394515291337, "vf_explained_var": 0.3658302186637796, "kl": 0.008817527742580053, "entropy": 0.19205454103248093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1376000, "num_agent_steps_sampled": 1376000, "num_steps_trained": 1376000, "num_agent_steps_trained": 1376000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13896, "training_iteration": 344, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-19-30", "timestamp": 1643656770, "time_this_iter_s": 16.14295196533203, "time_total_s": 11424.545951128006, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11424.545951128006, "timesteps_since_restore": 0, "iterations_since_restore": 344, "perf": {"cpu_util_percent": 36.29130434782608, "ram_util_percent": 63.521739130434774}}
{"episode_reward_max": -3.2, "episode_reward_min": -58.400000000000034, "episode_reward_mean": -10.844000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.799999999999999, -6.499999999999998, -4.800000000000001, -4.700000000000001, -12.899999999999974, -8.1, -9.2, -4.300000000000001, -5.3, -19.0, -5.2, -8.5, -6.300000000000001, -5.300000000000001, -15.499999999999998, -3.3, -4.300000000000001, -5.2, -16.7, -6.300000000000001, -18.3, -7.300000000000001, -5.300000000000001, -10.3, -5.1, -9.9, -4.300000000000001, -5.2, -7.300000000000001, -11.799999999999997, -17.9, -15.199999999999998, -12.199999999999996, -4.3, -15.6, -12.799999999999999, -4.2, -8.4, -9.3, -16.5, -6.300000000000001, -7.099999999999999, -19.800000000000004, -12.2, -16.6, -12.2, -17.3, -14.899999999999997, -6.2, -8.2, -58.400000000000034, -4.800000000000001, -17.099999999999998, -5.300000000000001, -17.700000000000003, -7.7, -7.299999999999999, -5.300000000000001, -6.4, -6.2, -9.500000000000002, -10.6, -13.499999999999998, -7.300000000000001, -7.300000000000001, -4.2, -16.299999999999997, -8.299999999999999, -22.1, -4.300000000000001, -5.8999999999999995, -11.5, -17.9, -5.4, -4.2, -3.7, -8.099999999999998, -10.1, -8.4, -26.600000000000005, -24.600000000000005, -7.5, -10.699999999999996, -15.799999999999999, -19.7, -4.6, -6.4, -5.1, -11.199999999999998, -5.3, -5.300000000000001, -53.3, -19.3, -6.300000000000001, -17.3, -10.7, -8.600000000000001, -6.699999999999999, -19.2, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.58551839190651, "mean_inference_ms": 5.017628979512806, "mean_action_processing_ms": 0.09400764189219796, "mean_env_wait_ms": 13.330052961046265, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1380000, "timesteps_this_iter": 0, "agent_timesteps_total": 1380000, "timers": {"sample_time_ms": 17339.518, "sample_throughput": 230.687, "load_time_ms": 0.342, "load_throughput": 11684111.707, "learn_time_ms": 8340.135, "learn_throughput": 479.609, "update_time_ms": 1.69}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.12685788593865852, "policy_loss": -0.017401298167564534, "vf_loss": 14.357332477902853, "vf_explained_var": 0.1309050832384376, "kl": 0.011418150181993558, "entropy": 0.1926349532059444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1380000, "num_agent_steps_sampled": 1380000, "num_steps_trained": 1380000, "num_agent_steps_trained": 1380000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13936, "training_iteration": 345, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-19-45", "timestamp": 1643656785, "time_this_iter_s": 15.095902919769287, "time_total_s": 11439.641854047775, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11439.641854047775, "timesteps_since_restore": 0, "iterations_since_restore": 345, "perf": {"cpu_util_percent": 33.12857142857143, "ram_util_percent": 63.6142857142857}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -58.400000000000034, "episode_reward_mean": -11.965, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.300000000000001, -7.099999999999999, -19.800000000000004, -12.2, -16.6, -12.2, -17.3, -14.899999999999997, -6.2, -8.2, -58.400000000000034, -4.800000000000001, -17.099999999999998, -5.300000000000001, -17.700000000000003, -7.7, -7.299999999999999, -5.300000000000001, -6.4, -6.2, -9.500000000000002, -10.6, -13.499999999999998, -7.300000000000001, -7.300000000000001, -4.2, -16.299999999999997, -8.299999999999999, -22.1, -4.300000000000001, -5.8999999999999995, -11.5, -17.9, -5.4, -4.2, -3.7, -8.099999999999998, -10.1, -8.4, -26.600000000000005, -24.600000000000005, -7.5, -10.699999999999996, -15.799999999999999, -19.7, -4.6, -6.4, -5.1, -11.199999999999998, -5.3, -5.300000000000001, -53.3, -19.3, -6.300000000000001, -17.3, -10.7, -8.600000000000001, -6.699999999999999, -19.2, -3.2, -5.300000000000001, -2.3000000000000003, -22.900000000000002, -8.399999999999997, -11.499999999999998, -4.7, -3.4, -5.4, -9.500000000000002, -4.4, -8.8, -3.4, -34.599999999999994, -4.2, -11.799999999999999, -11.799999999999994, -20.300000000000008, -10.6, -19.900000000000002, -22.400000000000002, -8.3, -7.300000000000001, -10.2, -13.499999999999996, -9.799999999999999, -6.199999999999999, -23.4, -5.000000000000001, -8.5, -7.700000000000001, -16.5, -10.7, -14.899999999999997, -18.700000000000003, -9.2, -14.0, -13.999999999999998, -19.3, -8.499999999999988, -22.200000000000003], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5777891446842354, "mean_inference_ms": 5.006549049650681, "mean_action_processing_ms": 0.09392840962911418, "mean_env_wait_ms": 13.307155123803987, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1384000, "timesteps_this_iter": 0, "agent_timesteps_total": 1384000, "timers": {"sample_time_ms": 17197.55, "sample_throughput": 232.591, "load_time_ms": 0.34, "load_throughput": 11756160.045, "learn_time_ms": 8294.935, "learn_throughput": 482.222, "update_time_ms": 1.708}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.14374287507586903, "policy_loss": -0.013712829351425171, "vf_loss": 15.695521858687043, "vf_explained_var": 0.12000136426700059, "kl": 0.00833208254040116, "entropy": 0.18970403415701723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1384000, "num_agent_steps_sampled": 1384000, "num_steps_trained": 1384000, "num_agent_steps_trained": 1384000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13976, "training_iteration": 346, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-20-00", "timestamp": 1643656800, "time_this_iter_s": 15.32616114616394, "time_total_s": 11454.96801519394, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11454.96801519394, "timesteps_since_restore": 0, "iterations_since_restore": 346, "perf": {"cpu_util_percent": 33.47272727272727, "ram_util_percent": 63.59999999999998}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -72.9, "episode_reward_mean": -12.48, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.7, -4.6, -6.4, -5.1, -11.199999999999998, -5.3, -5.300000000000001, -53.3, -19.3, -6.300000000000001, -17.3, -10.7, -8.600000000000001, -6.699999999999999, -19.2, -3.2, -5.300000000000001, -2.3000000000000003, -22.900000000000002, -8.399999999999997, -11.499999999999998, -4.7, -3.4, -5.4, -9.500000000000002, -4.4, -8.8, -3.4, -34.599999999999994, -4.2, -11.799999999999999, -11.799999999999994, -20.300000000000008, -10.6, -19.900000000000002, -22.400000000000002, -8.3, -7.300000000000001, -10.2, -13.499999999999996, -9.799999999999999, -6.199999999999999, -23.4, -5.000000000000001, -8.5, -7.700000000000001, -16.5, -10.7, -14.899999999999997, -18.700000000000003, -9.2, -14.0, -13.999999999999998, -19.3, -8.499999999999988, -22.200000000000003, -5.800000000000001, -20.9, -16.6, -17.4, -4.4, -14.399999999999999, -13.3, -19.2, -6.3999999999999995, -6.1, -13.599999999999985, -28.900000000000002, -3.3, -12.3, -27.700000000000006, -25.3, -10.699999999999998, -7.9, -5.800000000000001, -4.3, -16.999999999999996, -4.300000000000001, -14.5, -16.999999999999996, -4.2, -5.2, -5.300000000000001, -16.4, -10.900000000000002, -6.699999999999999, -14.4, -18.10000000000001, -6.5, -6.0, -11.6, -6.4, -13.5, -10.0, -7.5, -9.999999999999998, -13.099999999999998, -5.300000000000001, -72.9, -11.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.682939292238525, "mean_inference_ms": 5.105354840385436, "mean_action_processing_ms": 0.09390245415769317, "mean_env_wait_ms": 13.058945067590157, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1388000, "timesteps_this_iter": 0, "agent_timesteps_total": 1388000, "timers": {"sample_time_ms": 17099.827, "sample_throughput": 233.92, "load_time_ms": 0.334, "load_throughput": 11981158.323, "learn_time_ms": 8233.191, "learn_throughput": 485.838, "update_time_ms": 1.741}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.2611862831373489, "policy_loss": -0.013454112891227969, "vf_loss": 27.41560444190938, "vf_explained_var": 0.23326168355121407, "kl": 0.008063523543323053, "entropy": 0.18431392616482192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1388000, "num_agent_steps_sampled": 1388000, "num_steps_trained": 1388000, "num_agent_steps_trained": 1388000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14020, "training_iteration": 347, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-20-16", "timestamp": 1643656816, "time_this_iter_s": 15.4529869556427, "time_total_s": 11470.421002149582, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11470.421002149582, "timesteps_since_restore": 0, "iterations_since_restore": 347, "perf": {"cpu_util_percent": 30.540909090909096, "ram_util_percent": 63.686363636363645}}
{"episode_reward_max": -3.2, "episode_reward_min": -72.9, "episode_reward_mean": -11.993000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.799999999999999, -6.199999999999999, -23.4, -5.000000000000001, -8.5, -7.700000000000001, -16.5, -10.7, -14.899999999999997, -18.700000000000003, -9.2, -14.0, -13.999999999999998, -19.3, -8.499999999999988, -22.200000000000003, -5.800000000000001, -20.9, -16.6, -17.4, -4.4, -14.399999999999999, -13.3, -19.2, -6.3999999999999995, -6.1, -13.599999999999985, -28.900000000000002, -3.3, -12.3, -27.700000000000006, -25.3, -10.699999999999998, -7.9, -5.800000000000001, -4.3, -16.999999999999996, -4.300000000000001, -14.5, -16.999999999999996, -4.2, -5.2, -5.300000000000001, -16.4, -10.900000000000002, -6.699999999999999, -14.4, -18.10000000000001, -6.5, -6.0, -11.6, -6.4, -13.5, -10.0, -7.5, -9.999999999999998, -13.099999999999998, -5.300000000000001, -72.9, -11.2, -9.3, -4.700000000000001, -4.800000000000001, -13.0, -14.2, -13.399999999999999, -8.5, -5.300000000000001, -4.300000000000001, -6.300000000000001, -8.799999999999999, -16.3, -3.7000000000000006, -5.300000000000001, -15.6, -9.299999999999999, -8.8, -9.5, -22.200000000000017, -17.4, -4.3, -7.399999999999999, -15.799999999999997, -19.4, -7.299999999999999, -5.2, -8.600000000000001, -11.3, -9.9, -3.2, -7.5, -9.3, -36.2, -4.7, -24.200000000000014, -8.8, -6.2, -7.2, -5.2, -15.999999999999996], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.675364085725754, "mean_inference_ms": 5.094385398302367, "mean_action_processing_ms": 0.09382313520458384, "mean_env_wait_ms": 13.037485468698101, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1392000, "timesteps_this_iter": 0, "agent_timesteps_total": 1392000, "timers": {"sample_time_ms": 16696.962, "sample_throughput": 239.565, "load_time_ms": 0.341, "load_throughput": 11735601.567, "learn_time_ms": 8039.079, "learn_throughput": 497.569, "update_time_ms": 1.676}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.09016326623017429, "policy_loss": -0.009395226395578795, "vf_loss": 9.89999475357353, "vf_explained_var": 0.3865568787820878, "kl": 0.009298656083102996, "entropy": 0.18908873716349242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1392000, "num_agent_steps_sampled": 1392000, "num_steps_trained": 1392000, "num_agent_steps_trained": 1392000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14060, "training_iteration": 348, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-20-32", "timestamp": 1643656832, "time_this_iter_s": 15.872414112091064, "time_total_s": 11486.293416261673, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11486.293416261673, "timesteps_since_restore": 0, "iterations_since_restore": 348, "perf": {"cpu_util_percent": 27.656521739130437, "ram_util_percent": 63.782608695652165}}
{"episode_reward_max": -1.3, "episode_reward_min": -72.9, "episode_reward_mean": -11.514000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -5.2, -5.300000000000001, -16.4, -10.900000000000002, -6.699999999999999, -14.4, -18.10000000000001, -6.5, -6.0, -11.6, -6.4, -13.5, -10.0, -7.5, -9.999999999999998, -13.099999999999998, -5.300000000000001, -72.9, -11.2, -9.3, -4.700000000000001, -4.800000000000001, -13.0, -14.2, -13.399999999999999, -8.5, -5.300000000000001, -4.300000000000001, -6.300000000000001, -8.799999999999999, -16.3, -3.7000000000000006, -5.300000000000001, -15.6, -9.299999999999999, -8.8, -9.5, -22.200000000000017, -17.4, -4.3, -7.399999999999999, -15.799999999999997, -19.4, -7.299999999999999, -5.2, -8.600000000000001, -11.3, -9.9, -3.2, -7.5, -9.3, -36.2, -4.7, -24.200000000000014, -8.8, -6.2, -7.2, -5.2, -15.999999999999996, -15.4, -2.7000000000000006, -22.500000000000007, -5.999999999999999, -13.099999999999998, -22.800000000000004, -15.799999999999976, -9.0, -4.2, -4.4, -6.300000000000001, -12.399999999999999, -6.300000000000001, -11.2, -5.4, -15.2, -5.300000000000001, -11.6, -5.300000000000001, -7.2, -6.300000000000001, -14.099999999999996, -7.799999999999998, -12.899999999999999, -14.599999999999998, -12.999999999999996, -12.7, -5.2, -6.2, -70.50000000000003, -16.099999999999998, -8.999999999999998, -1.3, -19.500000000000004, -22.700000000000006, -5.300000000000001, -13.7, -15.299999999999995, -4.2, -5.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.55634813564516, "mean_inference_ms": 5.083444899582002, "mean_action_processing_ms": 0.0936778088265185, "mean_env_wait_ms": 13.12673055659663, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1396000, "timesteps_this_iter": 0, "agent_timesteps_total": 1396000, "timers": {"sample_time_ms": 16396.42, "sample_throughput": 243.956, "load_time_ms": 0.338, "load_throughput": 11843298.038, "learn_time_ms": 7959.084, "learn_throughput": 502.57, "update_time_ms": 1.714}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.2454052172020398, "policy_loss": -0.013368688370551794, "vf_loss": 25.829482893405423, "vf_explained_var": 0.12706024858259385, "kl": 0.00797574606839089, "entropy": 0.1906354498158219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1396000, "num_agent_steps_sampled": 1396000, "num_steps_trained": 1396000, "num_agent_steps_trained": 1396000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14100, "training_iteration": 349, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-20-47", "timestamp": 1643656847, "time_this_iter_s": 15.257833242416382, "time_total_s": 11501.55124950409, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11501.55124950409, "timesteps_since_restore": 0, "iterations_since_restore": 349, "perf": {"cpu_util_percent": 25.12857142857143, "ram_util_percent": 63.79999999999999}}
{"episode_reward_max": -1.2, "episode_reward_min": -70.50000000000003, "episode_reward_mean": -11.341, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -7.399999999999999, -15.799999999999997, -19.4, -7.299999999999999, -5.2, -8.600000000000001, -11.3, -9.9, -3.2, -7.5, -9.3, -36.2, -4.7, -24.200000000000014, -8.8, -6.2, -7.2, -5.2, -15.999999999999996, -15.4, -2.7000000000000006, -22.500000000000007, -5.999999999999999, -13.099999999999998, -22.800000000000004, -15.799999999999976, -9.0, -4.2, -4.4, -6.300000000000001, -12.399999999999999, -6.300000000000001, -11.2, -5.4, -15.2, -5.300000000000001, -11.6, -5.300000000000001, -7.2, -6.300000000000001, -14.099999999999996, -7.799999999999998, -12.899999999999999, -14.599999999999998, -12.999999999999996, -12.7, -5.2, -6.2, -70.50000000000003, -16.099999999999998, -8.999999999999998, -1.3, -19.500000000000004, -22.700000000000006, -5.300000000000001, -13.7, -15.299999999999995, -4.2, -5.300000000000001, -9.8, -14.999999999999998, -6.300000000000001, -8.099999999999998, -18.2, -29.499999999999964, -44.69999999999994, -9.7, -8.2, -5.300000000000001, -9.79999999999999, -6.2, -1.2, -13.4, -12.999999999999996, -3.3, -4.300000000000001, -8.8, -10.8, -8.8, -9.700000000000001, -4.300000000000001, -14.5, -13.2, -11.7, -7.099999999999998, -8.3, -4.300000000000001, -8.999999999999996, -15.3, -7.300000000000001, -13.2, -6.300000000000001, -15.7, -15.199999999999987, -3.8000000000000003, -18.60000000000002, -13.9, -5.0, -7.799999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.547435130191823, "mean_inference_ms": 4.96266321960651, "mean_action_processing_ms": 0.09359684631187572, "mean_env_wait_ms": 13.21510069646087, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1400000, "timesteps_this_iter": 0, "agent_timesteps_total": 1400000, "timers": {"sample_time_ms": 16160.125, "sample_throughput": 247.523, "load_time_ms": 0.344, "load_throughput": 11633878.372, "learn_time_ms": 7851.715, "learn_throughput": 509.443, "update_time_ms": 1.713}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.11480715302500112, "policy_loss": -0.024526397862611838, "vf_loss": 13.876136755174207, "vf_explained_var": 0.20094436765998921, "kl": 0.009525683240905575, "entropy": 0.20434119275580812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1400000, "num_agent_steps_sampled": 1400000, "num_steps_trained": 1400000, "num_agent_steps_trained": 1400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14140, "training_iteration": 350, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-21-03", "timestamp": 1643656863, "time_this_iter_s": 15.702819108963013, "time_total_s": 11517.254068613052, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11517.254068613052, "timesteps_since_restore": 0, "iterations_since_restore": 350, "perf": {"cpu_util_percent": 27.621739130434786, "ram_util_percent": 63.8086956521739}}
{"episode_reward_max": -1.2, "episode_reward_min": -70.50000000000003, "episode_reward_mean": -13.018000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.300000000000001, -14.099999999999996, -7.799999999999998, -12.899999999999999, -14.599999999999998, -12.999999999999996, -12.7, -5.2, -6.2, -70.50000000000003, -16.099999999999998, -8.999999999999998, -1.3, -19.500000000000004, -22.700000000000006, -5.300000000000001, -13.7, -15.299999999999995, -4.2, -5.300000000000001, -9.8, -14.999999999999998, -6.300000000000001, -8.099999999999998, -18.2, -29.499999999999964, -44.69999999999994, -9.7, -8.2, -5.300000000000001, -9.79999999999999, -6.2, -1.2, -13.4, -12.999999999999996, -3.3, -4.300000000000001, -8.8, -10.8, -8.8, -9.700000000000001, -4.300000000000001, -14.5, -13.2, -11.7, -7.099999999999998, -8.3, -4.300000000000001, -8.999999999999996, -15.3, -7.300000000000001, -13.2, -6.300000000000001, -15.7, -15.199999999999987, -3.8000000000000003, -18.60000000000002, -13.9, -5.0, -7.799999999999999, -16.6, -18.700000000000003, -5.300000000000001, -9.4, -8.700000000000001, -11.3, -8.299999999999997, -14.099999999999998, -6.4, -15.3, -26.3, -14.499999999999998, -22.2, -26.000000000000046, -7.800000000000001, -19.999999999999996, -11.799999999999999, -9.600000000000001, -22.800000000000008, -8.8, -14.899999999999999, -4.300000000000001, -7.300000000000001, -5.300000000000001, -9.7, -5.1, -17.5, -60.5, -25.500000000000004, -4.300000000000001, -31.2, -9.2, -30.50000000000004, -6.2, -13.599999999999998, -9.000000000000002, -9.2, -5.4, -16.7, -18.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.539974913677272, "mean_inference_ms": 4.951942938103538, "mean_action_processing_ms": 0.0935142720655519, "mean_env_wait_ms": 13.192335099865627, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1404000, "timesteps_this_iter": 0, "agent_timesteps_total": 1404000, "timers": {"sample_time_ms": 15733.686, "sample_throughput": 254.232, "load_time_ms": 0.347, "load_throughput": 11536282.748, "learn_time_ms": 7647.932, "learn_throughput": 523.017, "update_time_ms": 1.706}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.21980768592166966, "policy_loss": -0.02202191872982889, "vf_loss": 24.13083583334441, "vf_explained_var": 0.2055835941145497, "kl": 0.00867770263678205, "entropy": 0.18165251634293986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1404000, "num_agent_steps_sampled": 1404000, "num_steps_trained": 1404000, "num_agent_steps_trained": 1404000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14180, "training_iteration": 351, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-21-18", "timestamp": 1643656878, "time_this_iter_s": 14.852681875228882, "time_total_s": 11532.106750488281, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11532.106750488281, "timesteps_since_restore": 0, "iterations_since_restore": 351, "perf": {"cpu_util_percent": 31.723809523809525, "ram_util_percent": 63.79999999999999}}
{"episode_reward_max": -3.8000000000000003, "episode_reward_min": -60.5, "episode_reward_mean": -13.024000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.700000000000001, -4.300000000000001, -14.5, -13.2, -11.7, -7.099999999999998, -8.3, -4.300000000000001, -8.999999999999996, -15.3, -7.300000000000001, -13.2, -6.300000000000001, -15.7, -15.199999999999987, -3.8000000000000003, -18.60000000000002, -13.9, -5.0, -7.799999999999999, -16.6, -18.700000000000003, -5.300000000000001, -9.4, -8.700000000000001, -11.3, -8.299999999999997, -14.099999999999998, -6.4, -15.3, -26.3, -14.499999999999998, -22.2, -26.000000000000046, -7.800000000000001, -19.999999999999996, -11.799999999999999, -9.600000000000001, -22.800000000000008, -8.8, -14.899999999999999, -4.300000000000001, -7.300000000000001, -5.300000000000001, -9.7, -5.1, -17.5, -60.5, -25.500000000000004, -4.300000000000001, -31.2, -9.2, -30.50000000000004, -6.2, -13.599999999999998, -9.000000000000002, -9.2, -5.4, -16.7, -18.2, -10.3, -15.199999999999998, -14.7, -6.300000000000001, -14.600000000000001, -12.5, -7.299999999999999, -13.899999999999999, -4.300000000000001, -17.099999999999998, -5.2, -5.2, -6.2, -16.1, -6.300000000000001, -17.2, -4.2, -9.999999999999986, -36.3, -14.799999999999999, -11.799999999999997, -12.09999999999999, -4.300000000000001, -6.300000000000001, -5.2, -11.2, -9.399999999999999, -8.599999999999998, -4.4, -14.600000000000001, -14.4, -27.2, -13.4, -10.1, -14.7, -31.3, -8.4, -52.10000000000007, -9.199999999999998, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.532516340461275, "mean_inference_ms": 4.941289076178132, "mean_action_processing_ms": 0.09343469426784246, "mean_env_wait_ms": 13.1699236781455, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1408000, "timesteps_this_iter": 0, "agent_timesteps_total": 1408000, "timers": {"sample_time_ms": 15483.575, "sample_throughput": 258.338, "load_time_ms": 0.347, "load_throughput": 11526771.556, "learn_time_ms": 7660.544, "learn_throughput": 522.156, "update_time_ms": 1.729}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.14472069636047366, "policy_loss": -0.01626489758942156, "vf_loss": 16.017536302856218, "vf_explained_var": 0.19533173089386313, "kl": 0.0134886388674343, "entropy": 0.180897477084911, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1408000, "num_agent_steps_sampled": 1408000, "num_steps_trained": 1408000, "num_agent_steps_trained": 1408000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14220, "training_iteration": 352, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-21-33", "timestamp": 1643656893, "time_this_iter_s": 15.422538995742798, "time_total_s": 11547.529289484024, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11547.529289484024, "timesteps_since_restore": 0, "iterations_since_restore": 352, "perf": {"cpu_util_percent": 30.39545454545454, "ram_util_percent": 63.76818181818182}}
{"episode_reward_max": -3.2, "episode_reward_min": -216.4, "episode_reward_mean": -14.508000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.899999999999999, -4.300000000000001, -7.300000000000001, -5.300000000000001, -9.7, -5.1, -17.5, -60.5, -25.500000000000004, -4.300000000000001, -31.2, -9.2, -30.50000000000004, -6.2, -13.599999999999998, -9.000000000000002, -9.2, -5.4, -16.7, -18.2, -10.3, -15.199999999999998, -14.7, -6.300000000000001, -14.600000000000001, -12.5, -7.299999999999999, -13.899999999999999, -4.300000000000001, -17.099999999999998, -5.2, -5.2, -6.2, -16.1, -6.300000000000001, -17.2, -4.2, -9.999999999999986, -36.3, -14.799999999999999, -11.799999999999997, -12.09999999999999, -4.300000000000001, -6.300000000000001, -5.2, -11.2, -9.399999999999999, -8.599999999999998, -4.4, -14.600000000000001, -14.4, -27.2, -13.4, -10.1, -14.7, -31.3, -8.4, -52.10000000000007, -9.199999999999998, -4.300000000000001, -5.300000000000001, -11.600000000000001, -8.5, -3.2, -6.300000000000001, -7.300000000000001, -216.4, -21.6, -7.9, -10.3, -5.2, -24.800000000000036, -3.4, -7.2, -16.5, -5.6000000000000005, -7.300000000000001, -17.799999999999997, -13.899999999999997, -7.699999999999999, -12.799999999999999, -4.4, -9.4, -6.4, -17.2, -23.5, -6.499999999999999, -13.799999999999999, -6.2, -8.4, -10.099999999999994, -20.200000000000003, -4.4, -19.000000000000007, -12.1, -14.6, -4.300000000000001, -8.099999999999998, -23.600000000000097, -3.7], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5250964873284065, "mean_inference_ms": 4.930586251078787, "mean_action_processing_ms": 0.09335528605237828, "mean_env_wait_ms": 13.147609567425402, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1412000, "timesteps_this_iter": 0, "agent_timesteps_total": 1412000, "timers": {"sample_time_ms": 15501.01, "sample_throughput": 258.048, "load_time_ms": 0.368, "load_throughput": 10878049.666, "learn_time_ms": 7647.314, "learn_throughput": 523.059, "update_time_ms": 1.692}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.7628355490704698, "policy_loss": -0.014601407203102304, "vf_loss": 77.69275618855671, "vf_explained_var": 0.12074498502157067, "kl": 0.008480309844215375, "entropy": 0.19123305985203354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1412000, "num_agent_steps_sampled": 1412000, "num_steps_trained": 1412000, "num_agent_steps_trained": 1412000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14260, "training_iteration": 353, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-21-49", "timestamp": 1643656909, "time_this_iter_s": 15.425097942352295, "time_total_s": 11562.954387426376, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11562.954387426376, "timesteps_since_restore": 0, "iterations_since_restore": 353, "perf": {"cpu_util_percent": 29.222727272727273, "ram_util_percent": 63.781818181818174}}
{"episode_reward_max": -3.2, "episode_reward_min": -216.4, "episode_reward_mean": -14.755999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.799999999999997, -12.09999999999999, -4.300000000000001, -6.300000000000001, -5.2, -11.2, -9.399999999999999, -8.599999999999998, -4.4, -14.600000000000001, -14.4, -27.2, -13.4, -10.1, -14.7, -31.3, -8.4, -52.10000000000007, -9.199999999999998, -4.300000000000001, -5.300000000000001, -11.600000000000001, -8.5, -3.2, -6.300000000000001, -7.300000000000001, -216.4, -21.6, -7.9, -10.3, -5.2, -24.800000000000036, -3.4, -7.2, -16.5, -5.6000000000000005, -7.300000000000001, -17.799999999999997, -13.899999999999997, -7.699999999999999, -12.799999999999999, -4.4, -9.4, -6.4, -17.2, -23.5, -6.499999999999999, -13.799999999999999, -6.2, -8.4, -10.099999999999994, -20.200000000000003, -4.4, -19.000000000000007, -12.1, -14.6, -4.300000000000001, -8.099999999999998, -23.600000000000097, -3.7, -86.19999999999989, -6.0, -14.299999999999997, -11.5, -6.2, -8.7, -8.8, -13.1, -8.299999999999997, -14.099999999999996, -5.2, -13.2, -3.2, -9.3, -25.3, -22.1, -18.2, -4.300000000000001, -4.300000000000001, -10.399999999999999, -5.300000000000001, -10.2, -7.300000000000001, -7.2, -7.4, -5.300000000000001, -45.3, -4.5, -8.5, -10.5, -6.2, -59.2, -22.7, -12.7, -9.2, -16.9, -11.799999999999997, -7.2, -6.4, -9.600000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5177326321728675, "mean_inference_ms": 4.920021825721216, "mean_action_processing_ms": 0.09328036433987413, "mean_env_wait_ms": 13.125733750958762, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1416000, "timesteps_this_iter": 0, "agent_timesteps_total": 1416000, "timers": {"sample_time_ms": 15454.896, "sample_throughput": 258.818, "load_time_ms": 0.367, "load_throughput": 10893588.728, "learn_time_ms": 7645.585, "learn_throughput": 523.178, "update_time_ms": 1.693}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.21462355985942105, "policy_loss": -0.01681849364121194, "vf_loss": 23.084142012493583, "vf_explained_var": 0.17603821337863962, "kl": 0.009999342990881847, "entropy": 0.1769117926477745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1416000, "num_agent_steps_sampled": 1416000, "num_steps_trained": 1416000, "num_agent_steps_trained": 1416000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14300, "training_iteration": 354, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-22-04", "timestamp": 1643656924, "time_this_iter_s": 15.792552947998047, "time_total_s": 11578.746940374374, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11578.746940374374, "timesteps_since_restore": 0, "iterations_since_restore": 354, "perf": {"cpu_util_percent": 37.34782608695652, "ram_util_percent": 63.79999999999998}}
{"episode_reward_max": -2.8000000000000007, "episode_reward_min": -86.19999999999989, "episode_reward_mean": -11.975999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.799999999999999, -4.4, -9.4, -6.4, -17.2, -23.5, -6.499999999999999, -13.799999999999999, -6.2, -8.4, -10.099999999999994, -20.200000000000003, -4.4, -19.000000000000007, -12.1, -14.6, -4.300000000000001, -8.099999999999998, -23.600000000000097, -3.7, -86.19999999999989, -6.0, -14.299999999999997, -11.5, -6.2, -8.7, -8.8, -13.1, -8.299999999999997, -14.099999999999996, -5.2, -13.2, -3.2, -9.3, -25.3, -22.1, -18.2, -4.300000000000001, -4.300000000000001, -10.399999999999999, -5.300000000000001, -10.2, -7.300000000000001, -7.2, -7.4, -5.300000000000001, -45.3, -4.5, -8.5, -10.5, -6.2, -59.2, -22.7, -12.7, -9.2, -16.9, -11.799999999999997, -7.2, -6.4, -9.600000000000001, -5.4, -5.300000000000001, -15.1, -4.300000000000001, -4.300000000000001, -7.1, -10.2, -5.300000000000001, -11.600000000000001, -18.600000000000005, -3.3, -5.300000000000001, -20.700000000000003, -10.399999999999999, -12.600000000000001, -3.7, -4.300000000000001, -14.9, -5.300000000000001, -18.2, -12.3, -13.099999999999998, -6.0, -15.899999999999999, -3.4, -3.6000000000000005, -12.2, -10.2, -19.90000000000001, -2.8000000000000007, -4.2, -11.9, -16.5, -8.2, -10.5, -4.700000000000001, -15.5, -26.3, -10.4, -9.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5104937154190354, "mean_inference_ms": 4.909458128044312, "mean_action_processing_ms": 0.09320279605995228, "mean_env_wait_ms": 13.103716661465564, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1420000, "timesteps_this_iter": 0, "agent_timesteps_total": 1420000, "timers": {"sample_time_ms": 15432.271, "sample_throughput": 259.197, "load_time_ms": 0.367, "load_throughput": 10911300.728, "learn_time_ms": 7674.394, "learn_throughput": 521.214, "update_time_ms": 1.663}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.08346257069278308, "policy_loss": -0.01126565799237259, "vf_loss": 9.416663943567583, "vf_explained_var": 0.09779479163949208, "kl": 0.00934933713043906, "entropy": 0.15650766608856057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1420000, "num_agent_steps_sampled": 1420000, "num_steps_trained": 1420000, "num_agent_steps_trained": 1420000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14340, "training_iteration": 355, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-22-20", "timestamp": 1643656940, "time_this_iter_s": 15.17749285697937, "time_total_s": 11593.924433231354, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11593.924433231354, "timesteps_since_restore": 0, "iterations_since_restore": 355, "perf": {"cpu_util_percent": 32.7, "ram_util_percent": 63.79999999999999}}
{"episode_reward_max": -2.5000000000000004, "episode_reward_min": -59.2, "episode_reward_mean": -11.245, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -10.2, -7.300000000000001, -7.2, -7.4, -5.300000000000001, -45.3, -4.5, -8.5, -10.5, -6.2, -59.2, -22.7, -12.7, -9.2, -16.9, -11.799999999999997, -7.2, -6.4, -9.600000000000001, -5.4, -5.300000000000001, -15.1, -4.300000000000001, -4.300000000000001, -7.1, -10.2, -5.300000000000001, -11.600000000000001, -18.600000000000005, -3.3, -5.300000000000001, -20.700000000000003, -10.399999999999999, -12.600000000000001, -3.7, -4.300000000000001, -14.9, -5.300000000000001, -18.2, -12.3, -13.099999999999998, -6.0, -15.899999999999999, -3.4, -3.6000000000000005, -12.2, -10.2, -19.90000000000001, -2.8000000000000007, -4.2, -11.9, -16.5, -8.2, -10.5, -4.700000000000001, -15.5, -26.3, -10.4, -9.3, -3.3, -5.300000000000001, -7.2, -16.5, -8.2, -5.300000000000001, -16.7, -22.0, -4.800000000000001, -6.300000000000001, -9.2, -7.1999999999999975, -52.199999999999996, -19.39999999999999, -8.999999999999996, -13.399999999999999, -8.3, -13.099999999999998, -11.399999999999999, -7.699999999999998, -12.799999999999999, -10.799999999999997, -8.3, -5.300000000000001, -15.9, -7.3999999999999995, -39.2, -2.5000000000000004, -7.7, -5.0, -15.599999999999998, -9.0, -6.300000000000001, -8.700000000000001, -10.8, -12.499999999999996, -4.2, -5.8999999999999995, -9.6, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.503245835735352, "mean_inference_ms": 4.8989808595799555, "mean_action_processing_ms": 0.09312764537010593, "mean_env_wait_ms": 13.081987932656498, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1424000, "timesteps_this_iter": 0, "agent_timesteps_total": 1424000, "timers": {"sample_time_ms": 15481.754, "sample_throughput": 258.369, "load_time_ms": 0.364, "load_throughput": 10992803.04, "learn_time_ms": 7673.163, "learn_throughput": 521.297, "update_time_ms": 1.705}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.16451963817059834, "policy_loss": -0.019551612801289045, "vf_loss": 18.345036754172334, "vf_explained_var": 0.1474818725739756, "kl": 0.010336434715899743, "entropy": 0.17666193745149078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1424000, "num_agent_steps_sampled": 1424000, "num_steps_trained": 1424000, "num_agent_steps_trained": 1424000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14380, "training_iteration": 356, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-22-35", "timestamp": 1643656955, "time_this_iter_s": 15.520816802978516, "time_total_s": 11609.445250034332, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11609.445250034332, "timesteps_since_restore": 0, "iterations_since_restore": 356, "perf": {"cpu_util_percent": 34.404545454545456, "ram_util_percent": 63.79999999999998}}
{"episode_reward_max": -2.5000000000000004, "episode_reward_min": -52.199999999999996, "episode_reward_mean": -11.346000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -3.6000000000000005, -12.2, -10.2, -19.90000000000001, -2.8000000000000007, -4.2, -11.9, -16.5, -8.2, -10.5, -4.700000000000001, -15.5, -26.3, -10.4, -9.3, -3.3, -5.300000000000001, -7.2, -16.5, -8.2, -5.300000000000001, -16.7, -22.0, -4.800000000000001, -6.300000000000001, -9.2, -7.1999999999999975, -52.199999999999996, -19.39999999999999, -8.999999999999996, -13.399999999999999, -8.3, -13.099999999999998, -11.399999999999999, -7.699999999999998, -12.799999999999999, -10.799999999999997, -8.3, -5.300000000000001, -15.9, -7.3999999999999995, -39.2, -2.5000000000000004, -7.7, -5.0, -15.599999999999998, -9.0, -6.300000000000001, -8.700000000000001, -10.8, -12.499999999999996, -4.2, -5.8999999999999995, -9.6, -4.300000000000001, -5.4, -17.299999999999994, -10.600000000000001, -17.400000000000002, -4.7, -20.000000000000007, -3.900000000000001, -26.900000000000006, -4.4, -10.3, -13.099999999999971, -5.300000000000001, -6.4, -25.0, -17.1, -20.800000000000004, -12.999999999999996, -4.300000000000001, -3.5000000000000004, -21.5, -13.999999999999998, -10.299999999999999, -9.6, -14.099999999999998, -9.2, -16.6, -4.300000000000001, -36.3, -3.2, -15.5, -17.200000000000003, -4.2, -6.799999999999999, -11.299999999999999, -7.300000000000001, -3.6000000000000005, -3.4, -5.300000000000001, -4.300000000000001, -9.2, -23.3, -3.900000000000001, -25.2, -7.700000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6058267646340156, "mean_inference_ms": 4.99536071169789, "mean_action_processing_ms": 0.09310898484659474, "mean_env_wait_ms": 12.841641570659073, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1428000, "timesteps_this_iter": 0, "agent_timesteps_total": 1428000, "timers": {"sample_time_ms": 15499.607, "sample_throughput": 258.071, "load_time_ms": 0.366, "load_throughput": 10917691.156, "learn_time_ms": 7668.509, "learn_throughput": 521.614, "update_time_ms": 1.631}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.1533942954955242, "policy_loss": -0.007035928136438772, "vf_loss": 15.995394988213816, "vf_explained_var": 0.17621035165684198, "kl": 0.007929028464015308, "entropy": 0.15755664713840972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1428000, "num_agent_steps_sampled": 1428000, "num_steps_trained": 1428000, "num_agent_steps_trained": 1428000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14424, "training_iteration": 357, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-22-51", "timestamp": 1643656971, "time_this_iter_s": 15.593589067459106, "time_total_s": 11625.038839101791, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11625.038839101791, "timesteps_since_restore": 0, "iterations_since_restore": 357, "perf": {"cpu_util_percent": 33.84347826086957, "ram_util_percent": 63.84347826086957}}
{"episode_reward_max": -2.5000000000000004, "episode_reward_min": -57.10000000000006, "episode_reward_mean": -11.373999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.9, -7.3999999999999995, -39.2, -2.5000000000000004, -7.7, -5.0, -15.599999999999998, -9.0, -6.300000000000001, -8.700000000000001, -10.8, -12.499999999999996, -4.2, -5.8999999999999995, -9.6, -4.300000000000001, -5.4, -17.299999999999994, -10.600000000000001, -17.400000000000002, -4.7, -20.000000000000007, -3.900000000000001, -26.900000000000006, -4.4, -10.3, -13.099999999999971, -5.300000000000001, -6.4, -25.0, -17.1, -20.800000000000004, -12.999999999999996, -4.300000000000001, -3.5000000000000004, -21.5, -13.999999999999998, -10.299999999999999, -9.6, -14.099999999999998, -9.2, -16.6, -4.300000000000001, -36.3, -3.2, -15.5, -17.200000000000003, -4.2, -6.799999999999999, -11.299999999999999, -7.300000000000001, -3.6000000000000005, -3.4, -5.300000000000001, -4.300000000000001, -9.2, -23.3, -3.900000000000001, -25.2, -7.700000000000001, -6.300000000000001, -11.9, -18.0, -12.9, -3.3, -4.300000000000001, -4.300000000000001, -8.7, -4.300000000000001, -7.999999999999987, -8.8, -5.800000000000001, -4.300000000000001, -57.10000000000006, -16.2, -3.2, -9.599999999999998, -40.4, -3.3, -13.399999999999999, -7.599999999999999, -5.2, -7.199999999999999, -15.5, -3.3, -5.2, -6.399999999999999, -3.3, -17.3, -28.0, -9.399999999999988, -12.899999999999999, -13.399999999999999, -13.599999999999994, -20.5, -10.899999999999999, -4.2, -14.699999999999998, -5.6000000000000005, -7.800000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.598814457521357, "mean_inference_ms": 4.985048413276071, "mean_action_processing_ms": 0.09303675552776643, "mean_env_wait_ms": 12.821561300450869, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1432000, "timesteps_this_iter": 0, "agent_timesteps_total": 1432000, "timers": {"sample_time_ms": 15488.002, "sample_throughput": 258.264, "load_time_ms": 0.356, "load_throughput": 11228226.476, "learn_time_ms": 7620.897, "learn_throughput": 524.873, "update_time_ms": 1.738}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.16822902481897825, "policy_loss": -0.014404345419438136, "vf_loss": 18.209529637521314, "vf_explained_var": 0.18124501371896395, "kl": 0.008957836035172825, "entropy": 0.1749030500610349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1432000, "num_agent_steps_sampled": 1432000, "num_steps_trained": 1432000, "num_agent_steps_trained": 1432000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14464, "training_iteration": 358, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-23-06", "timestamp": 1643656986, "time_this_iter_s": 15.33111310005188, "time_total_s": 11640.369952201843, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11640.369952201843, "timesteps_since_restore": 0, "iterations_since_restore": 358, "perf": {"cpu_util_percent": 35.32380952380953, "ram_util_percent": 63.8809523809524}}
{"episode_reward_max": -2.3, "episode_reward_min": -57.10000000000006, "episode_reward_mean": -10.634, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.2, -16.6, -4.300000000000001, -36.3, -3.2, -15.5, -17.200000000000003, -4.2, -6.799999999999999, -11.299999999999999, -7.300000000000001, -3.6000000000000005, -3.4, -5.300000000000001, -4.300000000000001, -9.2, -23.3, -3.900000000000001, -25.2, -7.700000000000001, -6.300000000000001, -11.9, -18.0, -12.9, -3.3, -4.300000000000001, -4.300000000000001, -8.7, -4.300000000000001, -7.999999999999987, -8.8, -5.800000000000001, -4.300000000000001, -57.10000000000006, -16.2, -3.2, -9.599999999999998, -40.4, -3.3, -13.399999999999999, -7.599999999999999, -5.2, -7.199999999999999, -15.5, -3.3, -5.2, -6.399999999999999, -3.3, -17.3, -28.0, -9.399999999999988, -12.899999999999999, -13.399999999999999, -13.599999999999994, -20.5, -10.899999999999999, -4.2, -14.699999999999998, -5.6000000000000005, -7.800000000000001, -3.4, -20.8, -7.8999999999999995, -17.0, -11.199999999999998, -7.199999999999999, -4.300000000000001, -6.4, -5.300000000000001, -18.299999999999997, -7.4, -2.3, -4.300000000000001, -4.300000000000001, -9.299999999999992, -3.3, -12.3, -11.0, -20.699999999999957, -11.4, -5.0, -13.099999999999996, -4.2, -6.4, -5.5, -18.6, -8.2, -12.599999999999975, -5.300000000000001, -6.4, -19.599999999999998, -3.2, -15.2, -4.2, -11.600000000000001, -6.300000000000001, -14.499999999999996, -10.6, -18.499999999999993, -12.399999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.48334906129867, "mean_inference_ms": 4.97475488063801, "mean_action_processing_ms": 0.09289915314285369, "mean_env_wait_ms": 12.909069776344175, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1436000, "timesteps_this_iter": 0, "agent_timesteps_total": 1436000, "timers": {"sample_time_ms": 15436.923, "sample_throughput": 259.119, "load_time_ms": 0.358, "load_throughput": 11174381.244, "learn_time_ms": 7613.432, "learn_throughput": 525.387, "update_time_ms": 1.693}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.05348205015423798, "policy_loss": -0.013960713842102597, "vf_loss": 6.687541618590714, "vf_explained_var": 0.3025269171243073, "kl": 0.00944515868755184, "entropy": 0.14893871160043823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1436000, "num_agent_steps_sampled": 1436000, "num_steps_trained": 1436000, "num_agent_steps_trained": 1436000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14504, "training_iteration": 359, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-23-21", "timestamp": 1643657001, "time_this_iter_s": 15.14618992805481, "time_total_s": 11655.516142129898, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11655.516142129898, "timesteps_since_restore": 0, "iterations_since_restore": 359, "perf": {"cpu_util_percent": 33.92272727272727, "ram_util_percent": 63.886363636363654}}
{"episode_reward_max": -2.3, "episode_reward_min": -28.0, "episode_reward_mean": -10.071999999999997, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.599999999999999, -5.2, -7.199999999999999, -15.5, -3.3, -5.2, -6.399999999999999, -3.3, -17.3, -28.0, -9.399999999999988, -12.899999999999999, -13.399999999999999, -13.599999999999994, -20.5, -10.899999999999999, -4.2, -14.699999999999998, -5.6000000000000005, -7.800000000000001, -3.4, -20.8, -7.8999999999999995, -17.0, -11.199999999999998, -7.199999999999999, -4.300000000000001, -6.4, -5.300000000000001, -18.299999999999997, -7.4, -2.3, -4.300000000000001, -4.300000000000001, -9.299999999999992, -3.3, -12.3, -11.0, -20.699999999999957, -11.4, -5.0, -13.099999999999996, -4.2, -6.4, -5.5, -18.6, -8.2, -12.599999999999975, -5.300000000000001, -6.4, -19.599999999999998, -3.2, -15.2, -4.2, -11.600000000000001, -6.300000000000001, -14.499999999999996, -10.6, -18.499999999999993, -12.399999999999999, -4.2, -5.300000000000001, -4.300000000000001, -17.400000000000002, -4.9, -5.0, -7.800000000000001, -11.799999999999997, -3.3, -17.0, -5.999999999999999, -3.2, -4.2, -18.2, -12.2, -8.799999999999999, -3.4, -13.7, -4.2, -12.2, -7.499999999999999, -25.300000000000004, -3.6000000000000005, -8.4, -16.0, -4.9, -24.6, -16.3, -12.8, -12.700000000000001, -16.4, -3.3, -11.699999999999996, -18.4, -8.599999999999998, -15.799999999999997, -12.499999999999996, -4.9, -9.599999999999998, -5.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.474955321097783, "mean_inference_ms": 4.8575445253595015, "mean_action_processing_ms": 0.09282438512596393, "mean_env_wait_ms": 12.99566675096216, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1440000, "timesteps_this_iter": 0, "agent_timesteps_total": 1440000, "timers": {"sample_time_ms": 15433.549, "sample_throughput": 259.176, "load_time_ms": 0.354, "load_throughput": 11313787.848, "learn_time_ms": 7623.303, "learn_throughput": 524.707, "update_time_ms": 1.679}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.06603671696878248, "policy_loss": -0.007371709812232243, "vf_loss": 7.2874341698743965, "vf_explained_var": 0.22738882271192407, "kl": 0.008891381733803546, "entropy": 0.15458759368467395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1440000, "num_agent_steps_sampled": 1440000, "num_steps_trained": 1440000, "num_agent_steps_trained": 1440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14544, "training_iteration": 360, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-23-37", "timestamp": 1643657017, "time_this_iter_s": 15.844810009002686, "time_total_s": 11671.3609521389, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11671.3609521389, "timesteps_since_restore": 0, "iterations_since_restore": 360, "perf": {"cpu_util_percent": 28.639130434782604, "ram_util_percent": 63.90000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -25.300000000000004, "episode_reward_mean": -9.789, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, -13.099999999999996, -4.2, -6.4, -5.5, -18.6, -8.2, -12.599999999999975, -5.300000000000001, -6.4, -19.599999999999998, -3.2, -15.2, -4.2, -11.600000000000001, -6.300000000000001, -14.499999999999996, -10.6, -18.499999999999993, -12.399999999999999, -4.2, -5.300000000000001, -4.300000000000001, -17.400000000000002, -4.9, -5.0, -7.800000000000001, -11.799999999999997, -3.3, -17.0, -5.999999999999999, -3.2, -4.2, -18.2, -12.2, -8.799999999999999, -3.4, -13.7, -4.2, -12.2, -7.499999999999999, -25.300000000000004, -3.6000000000000005, -8.4, -16.0, -4.9, -24.6, -16.3, -12.8, -12.700000000000001, -16.4, -3.3, -11.699999999999996, -18.4, -8.599999999999998, -15.799999999999997, -12.499999999999996, -4.9, -9.599999999999998, -5.300000000000001, -12.600000000000001, -11.699999999999998, -18.3, -6.9, -4.300000000000001, -10.0, -8.3, -3.3, -4.300000000000001, -4.2, -12.099999999999987, -13.099999999999998, -4.3, -4.2, -18.500000000000004, -3.3, -10.199999999999998, -3.2, -10.3, -3.2, -3.3, -13.7, -19.2, -14.3, -11.2, -16.19999999999999, -9.2, -7.399999999999999, -19.799999999999997, -14.3, -4.300000000000001, -11.7, -11.3, -11.299999999999995, -7.299999999999999, -13.399999999999999, -3.9000000000000004, -5.300000000000001, -5.2, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.467832018730497, "mean_inference_ms": 4.847320103224735, "mean_action_processing_ms": 0.09274843786100635, "mean_env_wait_ms": 12.974467755052046, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1444000, "timesteps_this_iter": 0, "agent_timesteps_total": 1444000, "timers": {"sample_time_ms": 15478.608, "sample_throughput": 258.421, "load_time_ms": 0.349, "load_throughput": 11445774.321, "learn_time_ms": 7684.554, "learn_throughput": 520.525, "update_time_ms": 1.684}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.03195556954991433, "policy_loss": -0.012284546705984301, "vf_loss": 4.361731823157239, "vf_explained_var": 0.3936804745146023, "kl": 0.010368233155315282, "entropy": 0.14935818447140597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1444000, "num_agent_steps_sampled": 1444000, "num_steps_trained": 1444000, "num_agent_steps_trained": 1444000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14584, "training_iteration": 361, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-23-53", "timestamp": 1643657033, "time_this_iter_s": 15.813507080078125, "time_total_s": 11687.174459218979, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11687.174459218979, "timesteps_since_restore": 0, "iterations_since_restore": 361, "perf": {"cpu_util_percent": 30.718181818181822, "ram_util_percent": 63.90000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -25.300000000000004, "episode_reward_mean": -9.986999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.499999999999999, -25.300000000000004, -3.6000000000000005, -8.4, -16.0, -4.9, -24.6, -16.3, -12.8, -12.700000000000001, -16.4, -3.3, -11.699999999999996, -18.4, -8.599999999999998, -15.799999999999997, -12.499999999999996, -4.9, -9.599999999999998, -5.300000000000001, -12.600000000000001, -11.699999999999998, -18.3, -6.9, -4.300000000000001, -10.0, -8.3, -3.3, -4.300000000000001, -4.2, -12.099999999999987, -13.099999999999998, -4.3, -4.2, -18.500000000000004, -3.3, -10.199999999999998, -3.2, -10.3, -3.2, -3.3, -13.7, -19.2, -14.3, -11.2, -16.19999999999999, -9.2, -7.399999999999999, -19.799999999999997, -14.3, -4.300000000000001, -11.7, -11.3, -11.299999999999995, -7.299999999999999, -13.399999999999999, -3.9000000000000004, -5.300000000000001, -5.2, -3.2, -3.3, -10.2, -4.300000000000001, -18.4, -7.700000000000001, -15.3, -13.099999999999996, -3.2, -11.399999999999999, -11.2, -4.2, -9.4, -3.2, -4.2, -4.3, -9.799999999999999, -15.3, -7.7, -7.499999999999999, -10.2, -12.3, -5.300000000000001, -18.7, -6.599999999999999, -5.000000000000001, -13.5, -8.2, -14.599999999999971, -7.2, -5.2, -7.299999999999999, -3.3, -4.300000000000001, -16.699999999999992, -22.900000000000006, -6.3, -18.099999999999998, -12.299999999999999, -8.3, -18.299999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4607747059662506, "mean_inference_ms": 4.837193432968, "mean_action_processing_ms": 0.09267463516950089, "mean_env_wait_ms": 12.953478562894427, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1448000, "timesteps_this_iter": 0, "agent_timesteps_total": 1448000, "timers": {"sample_time_ms": 15551.627, "sample_throughput": 257.208, "load_time_ms": 0.357, "load_throughput": 11192272.181, "learn_time_ms": 7713.446, "learn_throughput": 518.575, "update_time_ms": 1.684}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.0491918519487284, "policy_loss": -0.030241350448059458, "vf_loss": 7.864589495940875, "vf_explained_var": 0.34831593889062124, "kl": 0.01310702339719815, "entropy": 0.16077908114880643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1448000, "num_agent_steps_sampled": 1448000, "num_steps_trained": 1448000, "num_agent_steps_trained": 1448000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14624, "training_iteration": 362, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-24-09", "timestamp": 1643657049, "time_this_iter_s": 15.82958698272705, "time_total_s": 11703.004046201706, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11703.004046201706, "timesteps_since_restore": 0, "iterations_since_restore": 362, "perf": {"cpu_util_percent": 33.7304347826087, "ram_util_percent": 63.90000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -67.90000000000008, "episode_reward_mean": -10.502000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -13.7, -19.2, -14.3, -11.2, -16.19999999999999, -9.2, -7.399999999999999, -19.799999999999997, -14.3, -4.300000000000001, -11.7, -11.3, -11.299999999999995, -7.299999999999999, -13.399999999999999, -3.9000000000000004, -5.300000000000001, -5.2, -3.2, -3.3, -10.2, -4.300000000000001, -18.4, -7.700000000000001, -15.3, -13.099999999999996, -3.2, -11.399999999999999, -11.2, -4.2, -9.4, -3.2, -4.2, -4.3, -9.799999999999999, -15.3, -7.7, -7.499999999999999, -10.2, -12.3, -5.300000000000001, -18.7, -6.599999999999999, -5.000000000000001, -13.5, -8.2, -14.599999999999971, -7.2, -5.2, -7.299999999999999, -3.3, -4.300000000000001, -16.699999999999992, -22.900000000000006, -6.3, -18.099999999999998, -12.299999999999999, -8.3, -18.299999999999997, -4.5, -10.2, -16.299999999999997, -4.4, -67.90000000000008, -7.699999999999998, -3.2, -22.800000000000004, -20.0, -3.3, -15.8, -8.7, -19.5, -13.1, -13.7, -4.2, -15.5, -3.4, -6.0, -9.5, -5.2, -9.3, -15.699999999999978, -7.800000000000001, -10.899999999999999, -8.9, -4.6000000000000005, -17.7, -4.3, -3.3, -9.3, -9.4, -4.9, -7.4, -4.300000000000001, -15.8, -7.2, -12.9, -10.4, -17.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4537362764094497, "mean_inference_ms": 4.827087289850337, "mean_action_processing_ms": 0.09260031972607738, "mean_env_wait_ms": 12.932394565552986, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1452000, "timesteps_this_iter": 0, "agent_timesteps_total": 1452000, "timers": {"sample_time_ms": 15572.468, "sample_throughput": 256.864, "load_time_ms": 0.345, "load_throughput": 11601698.361, "learn_time_ms": 7728.419, "learn_throughput": 517.57, "update_time_ms": 1.695}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.08254524013027549, "policy_loss": -0.021499552052988802, "vf_loss": 10.340839005413876, "vf_explained_var": 0.1696475822438476, "kl": 0.010594772904192817, "entropy": 0.16851329090854814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1452000, "num_agent_steps_sampled": 1452000, "num_steps_trained": 1452000, "num_agent_steps_trained": 1452000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14664, "training_iteration": 363, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-24-24", "timestamp": 1643657064, "time_this_iter_s": 15.492871046066284, "time_total_s": 11718.496917247772, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11718.496917247772, "timesteps_since_restore": 0, "iterations_since_restore": 363, "perf": {"cpu_util_percent": 33.027272727272724, "ram_util_percent": 63.95454545454545}}
{"episode_reward_max": -3.2, "episode_reward_min": -67.90000000000008, "episode_reward_mean": -10.990000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.3, -5.300000000000001, -18.7, -6.599999999999999, -5.000000000000001, -13.5, -8.2, -14.599999999999971, -7.2, -5.2, -7.299999999999999, -3.3, -4.300000000000001, -16.699999999999992, -22.900000000000006, -6.3, -18.099999999999998, -12.299999999999999, -8.3, -18.299999999999997, -4.5, -10.2, -16.299999999999997, -4.4, -67.90000000000008, -7.699999999999998, -3.2, -22.800000000000004, -20.0, -3.3, -15.8, -8.7, -19.5, -13.1, -13.7, -4.2, -15.5, -3.4, -6.0, -9.5, -5.2, -9.3, -15.699999999999978, -7.800000000000001, -10.899999999999999, -8.9, -4.6000000000000005, -17.7, -4.3, -3.3, -9.3, -9.4, -4.9, -7.4, -4.300000000000001, -15.8, -7.2, -12.9, -10.4, -17.4, -8.7, -14.1, -6.999999999999998, -8.3, -10.199999999999998, -4.300000000000001, -7.3, -5.5, -8.3, -16.2, -11.099999999999977, -16.599999999999998, -9.3, -23.899999999999984, -11.4, -21.299999999999997, -22.2, -3.3, -16.2, -22.399999999999984, -8.899999999999999, -5.2, -3.3, -25.800000000000054, -3.3, -7.899999999999999, -10.399999999999997, -3.2, -3.3, -5.2, -4.300000000000001, -19.4, -3.3, -19.599999999999998, -17.2, -8.799999999999992, -9.5, -3.4, -3.2, -15.399999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4468089671296087, "mean_inference_ms": 4.817076664080398, "mean_action_processing_ms": 0.09252887774076318, "mean_env_wait_ms": 12.91155923161452, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1456000, "timesteps_this_iter": 0, "agent_timesteps_total": 1456000, "timers": {"sample_time_ms": 15585.95, "sample_throughput": 256.641, "load_time_ms": 0.345, "load_throughput": 11601698.361, "learn_time_ms": 7713.373, "learn_throughput": 518.58, "update_time_ms": 1.684}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.0821329180411594, "policy_loss": -0.016885097939220647, "vf_loss": 9.78611585177401, "vf_explained_var": 0.2527611121695529, "kl": 0.01925924260498905, "entropy": 0.16985525245307595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1456000, "num_agent_steps_sampled": 1456000, "num_steps_trained": 1456000, "num_agent_steps_trained": 1456000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14704, "training_iteration": 364, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-24-40", "timestamp": 1643657080, "time_this_iter_s": 15.625188112258911, "time_total_s": 11734.122105360031, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11734.122105360031, "timesteps_since_restore": 0, "iterations_since_restore": 364, "perf": {"cpu_util_percent": 23.19090909090909, "ram_util_percent": 63.950000000000024}}
{"episode_reward_max": -3.2, "episode_reward_min": -97.3, "episode_reward_mean": -11.368, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -9.3, -15.699999999999978, -7.800000000000001, -10.899999999999999, -8.9, -4.6000000000000005, -17.7, -4.3, -3.3, -9.3, -9.4, -4.9, -7.4, -4.300000000000001, -15.8, -7.2, -12.9, -10.4, -17.4, -8.7, -14.1, -6.999999999999998, -8.3, -10.199999999999998, -4.300000000000001, -7.3, -5.5, -8.3, -16.2, -11.099999999999977, -16.599999999999998, -9.3, -23.899999999999984, -11.4, -21.299999999999997, -22.2, -3.3, -16.2, -22.399999999999984, -8.899999999999999, -5.2, -3.3, -25.800000000000054, -3.3, -7.899999999999999, -10.399999999999997, -3.2, -3.3, -5.2, -4.300000000000001, -19.4, -3.3, -19.599999999999998, -17.2, -8.799999999999992, -9.5, -3.4, -3.2, -15.399999999999999, -3.3, -22.000000000000057, -3.6000000000000005, -14.2, -3.2, -3.3, -7.999999999999999, -19.9, -4.300000000000001, -4.800000000000001, -23.1, -13.399999999999999, -4.700000000000001, -3.2, -31.300000000000004, -14.9, -4.2, -8.999999999999996, -14.299999999999997, -11.999999999999998, -15.100000000000001, -3.3, -6.300000000000001, -3.3, -4.4, -25.6, -4.300000000000001, -8.5, -11.2, -7.2, -7.1, -11.1, -10.3, -15.199999999999978, -9.5, -25.5, -8.899999999999999, -16.199999999999996, -14.899999999999997, -97.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4399100669415934, "mean_inference_ms": 4.807057889781047, "mean_action_processing_ms": 0.09245466559342691, "mean_env_wait_ms": 12.890627143992543, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1460000, "timesteps_this_iter": 0, "agent_timesteps_total": 1460000, "timers": {"sample_time_ms": 15587.341, "sample_throughput": 256.618, "load_time_ms": 0.342, "load_throughput": 11712661.268, "learn_time_ms": 7736.233, "learn_throughput": 517.048, "update_time_ms": 1.687}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.5091846437884434, "policy_loss": -0.012776519283051452, "vf_loss": 52.15309318098971, "vf_explained_var": 0.05557087659835815, "kl": 0.007162741515117713, "entropy": 0.17283634415236854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1460000, "num_agent_steps_sampled": 1460000, "num_steps_trained": 1460000, "num_agent_steps_trained": 1460000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14744, "training_iteration": 365, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-24-56", "timestamp": 1643657096, "time_this_iter_s": 15.569923877716064, "time_total_s": 11749.692029237747, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11749.692029237747, "timesteps_since_restore": 0, "iterations_since_restore": 365, "perf": {"cpu_util_percent": 19.800000000000004, "ram_util_percent": 63.90000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -97.3, "episode_reward_mean": -12.445, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.899999999999999, -5.2, -3.3, -25.800000000000054, -3.3, -7.899999999999999, -10.399999999999997, -3.2, -3.3, -5.2, -4.300000000000001, -19.4, -3.3, -19.599999999999998, -17.2, -8.799999999999992, -9.5, -3.4, -3.2, -15.399999999999999, -3.3, -22.000000000000057, -3.6000000000000005, -14.2, -3.2, -3.3, -7.999999999999999, -19.9, -4.300000000000001, -4.800000000000001, -23.1, -13.399999999999999, -4.700000000000001, -3.2, -31.300000000000004, -14.9, -4.2, -8.999999999999996, -14.299999999999997, -11.999999999999998, -15.100000000000001, -3.3, -6.300000000000001, -3.3, -4.4, -25.6, -4.300000000000001, -8.5, -11.2, -7.2, -7.1, -11.1, -10.3, -15.199999999999978, -9.5, -25.5, -8.899999999999999, -16.199999999999996, -14.899999999999997, -97.3, -11.8, -37.4, -13.1, -11.799999999999999, -18.200000000000003, -3.3, -5.300000000000001, -10.599999999999998, -4.300000000000001, -4.300000000000001, -4.2, -20.1, -3.3, -20.6, -4.3, -9.899999999999999, -4.2, -3.2, -4.2, -4.2, -16.9, -7.3, -13.299999999999997, -11.2, -3.4, -12.899999999999999, -29.5, -3.3, -9.2, -17.5, -22.4, -11.799999999999999, -14.799999999999997, -18.900000000000002, -24.700000000000003, -4.6000000000000005, -82.50000000000011, -9.2, -27.10000000000001, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.433021394129261, "mean_inference_ms": 4.7971231214747965, "mean_action_processing_ms": 0.09238157035575217, "mean_env_wait_ms": 12.870056713330687, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1464000, "timesteps_this_iter": 0, "agent_timesteps_total": 1464000, "timers": {"sample_time_ms": 15614.566, "sample_throughput": 256.171, "load_time_ms": 0.352, "load_throughput": 11356675.015, "learn_time_ms": 7750.829, "learn_throughput": 516.074, "update_time_ms": 1.667}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.4069781797387267, "policy_loss": -0.012071642944569229, "vf_loss": 41.85129259779889, "vf_explained_var": -0.1347615957901042, "kl": 0.008938339309718133, "entropy": 0.15519231594698404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1464000, "num_agent_steps_sampled": 1464000, "num_steps_trained": 1464000, "num_agent_steps_trained": 1464000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14784, "training_iteration": 366, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-25-12", "timestamp": 1643657112, "time_this_iter_s": 15.710036993026733, "time_total_s": 11765.402066230774, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11765.402066230774, "timesteps_since_restore": 0, "iterations_since_restore": 366, "perf": {"cpu_util_percent": 21.518181818181816, "ram_util_percent": 63.90000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -97.3, "episode_reward_mean": -13.319, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -25.6, -4.300000000000001, -8.5, -11.2, -7.2, -7.1, -11.1, -10.3, -15.199999999999978, -9.5, -25.5, -8.899999999999999, -16.199999999999996, -14.899999999999997, -97.3, -11.8, -37.4, -13.1, -11.799999999999999, -18.200000000000003, -3.3, -5.300000000000001, -10.599999999999998, -4.300000000000001, -4.300000000000001, -4.2, -20.1, -3.3, -20.6, -4.3, -9.899999999999999, -4.2, -3.2, -4.2, -4.2, -16.9, -7.3, -13.299999999999997, -11.2, -3.4, -12.899999999999999, -29.5, -3.3, -9.2, -17.5, -22.4, -11.799999999999999, -14.799999999999997, -18.900000000000002, -24.700000000000003, -4.6000000000000005, -82.50000000000011, -9.2, -27.10000000000001, -3.2, -6.399999999999999, -21.300000000000075, -4.9, -7.499999999999999, -10.599999999999996, -5.8, -4.3, -19.700000000000003, -16.299999999999997, -4.300000000000001, -4.3, -3.2, -7.199999999999998, -3.2, -4.300000000000001, -32.60000000000001, -16.999999999999996, -3.3, -3.3, -17.6, -9.0, -5.4, -3.3, -4.300000000000001, -7.300000000000001, -14.0, -3.3, -20.400000000000006, -13.899999999999999, -32.3, -5.8, -19.1, -3.2, -10.600000000000001, -10.2, -23.000000000000053, -16.299999999999997, -24.10000000000001, -3.3, -16.299999999999997, -31.5, -28.7, -7.099999999999998, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.532943388071692, "mean_inference_ms": 4.891143824681021, "mean_action_processing_ms": 0.09236593931973765, "mean_env_wait_ms": 12.63697278669792, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1468000, "timesteps_this_iter": 0, "agent_timesteps_total": 1468000, "timers": {"sample_time_ms": 15627.878, "sample_throughput": 255.953, "load_time_ms": 0.351, "load_throughput": 11389827.563, "learn_time_ms": 7749.513, "learn_throughput": 516.161, "update_time_ms": 1.665}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.19496061943686738, "policy_loss": -0.012094217568876282, "vf_loss": 20.655211373106127, "vf_explained_var": -0.04764087732120227, "kl": 0.008369358951666078, "entropy": 0.17125884904576244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1468000, "num_agent_steps_sampled": 1468000, "num_steps_trained": 1468000, "num_agent_steps_trained": 1468000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14828, "training_iteration": 367, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-25-27", "timestamp": 1643657127, "time_this_iter_s": 15.566919088363647, "time_total_s": 11780.968985319138, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11780.968985319138, "timesteps_since_restore": 0, "iterations_since_restore": 367, "perf": {"cpu_util_percent": 29.413636363636364, "ram_util_percent": 63.85454545454545}}
{"episode_reward_max": -3.2, "episode_reward_min": -82.50000000000011, "episode_reward_mean": -12.963000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -12.899999999999999, -29.5, -3.3, -9.2, -17.5, -22.4, -11.799999999999999, -14.799999999999997, -18.900000000000002, -24.700000000000003, -4.6000000000000005, -82.50000000000011, -9.2, -27.10000000000001, -3.2, -6.399999999999999, -21.300000000000075, -4.9, -7.499999999999999, -10.599999999999996, -5.8, -4.3, -19.700000000000003, -16.299999999999997, -4.300000000000001, -4.3, -3.2, -7.199999999999998, -3.2, -4.300000000000001, -32.60000000000001, -16.999999999999996, -3.3, -3.3, -17.6, -9.0, -5.4, -3.3, -4.300000000000001, -7.300000000000001, -14.0, -3.3, -20.400000000000006, -13.899999999999999, -32.3, -5.8, -19.1, -3.2, -10.600000000000001, -10.2, -23.000000000000053, -16.299999999999997, -24.10000000000001, -3.3, -16.299999999999997, -31.5, -28.7, -7.099999999999998, -3.2, -6.899999999999999, -3.3, -3.3, -17.3, -7.2, -15.7, -14.499999999999998, -28.00000000000001, -5.300000000000001, -17.099999999999998, -27.700000000000028, -13.099999999999998, -16.5, -3.5, -24.900000000000002, -27.700000000000003, -10.6, -3.2, -13.399999999999999, -3.4, -9.2, -4.6000000000000005, -35.7, -7.2, -9.299999999999999, -12.799999999999999, -12.099999999999998, -3.9000000000000004, -10.699999999999998, -3.2, -15.799999999999997, -15.7, -17.799999999999997, -5.2, -11.29999999999999, -8.799999999999999, -17.0, -13.799999999999999, -3.3, -8.599999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5263039042255198, "mean_inference_ms": 4.881393185550154, "mean_action_processing_ms": 0.09229935105479119, "mean_env_wait_ms": 12.618168076547175, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1472000, "timesteps_this_iter": 0, "agent_timesteps_total": 1472000, "timers": {"sample_time_ms": 15644.866, "sample_throughput": 255.675, "load_time_ms": 0.353, "load_throughput": 11342854.439, "learn_time_ms": 7781.831, "learn_throughput": 514.018, "update_time_ms": 1.568}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.12642244065570976, "policy_loss": -0.010522604871901774, "vf_loss": 13.61024747125564, "vf_explained_var": 0.22751583681311657, "kl": 0.014027049201408601, "entropy": 0.18767026934412218, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1472000, "num_agent_steps_sampled": 1472000, "num_steps_trained": 1472000, "num_agent_steps_trained": 1472000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14868, "training_iteration": 368, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-25-43", "timestamp": 1643657143, "time_this_iter_s": 15.837524175643921, "time_total_s": 11796.806509494781, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11796.806509494781, "timesteps_since_restore": 0, "iterations_since_restore": 368, "perf": {"cpu_util_percent": 30.44347826086957, "ram_util_percent": 63.79999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -41.90000000000005, "episode_reward_mean": -12.590000000000005, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.300000000000001, -14.0, -3.3, -20.400000000000006, -13.899999999999999, -32.3, -5.8, -19.1, -3.2, -10.600000000000001, -10.2, -23.000000000000053, -16.299999999999997, -24.10000000000001, -3.3, -16.299999999999997, -31.5, -28.7, -7.099999999999998, -3.2, -6.899999999999999, -3.3, -3.3, -17.3, -7.2, -15.7, -14.499999999999998, -28.00000000000001, -5.300000000000001, -17.099999999999998, -27.700000000000028, -13.099999999999998, -16.5, -3.5, -24.900000000000002, -27.700000000000003, -10.6, -3.2, -13.399999999999999, -3.4, -9.2, -4.6000000000000005, -35.7, -7.2, -9.299999999999999, -12.799999999999999, -12.099999999999998, -3.9000000000000004, -10.699999999999998, -3.2, -15.799999999999997, -15.7, -17.799999999999997, -5.2, -11.29999999999999, -8.799999999999999, -17.0, -13.799999999999999, -3.3, -8.599999999999998, -24.700000000000003, -5.2, -15.299999999999999, -16.099999999999998, -11.3, -17.0, -11.3, -6.0, -5.300000000000001, -18.700000000000003, -19.700000000000003, -3.6000000000000005, -23.900000000000002, -10.3, -12.999999999999998, -3.3, -12.499999999999995, -4.300000000000001, -3.3, -9.2, -16.2, -3.3, -11.799999999999999, -5.300000000000001, -7.1, -17.6, -6.2, -3.8000000000000007, -13.1, -18.099999999999994, -41.90000000000005, -15.199999999999987, -10.2, -10.599999999999993, -18.00000000000002, -11.6, -3.2, -9.899999999999999, -7.2, -12.5], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4142172119256253, "mean_inference_ms": 4.871661910738334, "mean_action_processing_ms": 0.09216740860483984, "mean_env_wait_ms": 12.704015923021297, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1476000, "timesteps_this_iter": 0, "agent_timesteps_total": 1476000, "timers": {"sample_time_ms": 15685.223, "sample_throughput": 255.017, "load_time_ms": 0.351, "load_throughput": 11397565.217, "learn_time_ms": 7827.87, "learn_throughput": 510.995, "update_time_ms": 1.689}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.10632211847571275, "policy_loss": -0.01090129568211494, "vf_loss": 11.658607297558937, "vf_explained_var": 0.15761732651341345, "kl": 0.010610428428778546, "entropy": 0.18500931395958828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1476000, "num_agent_steps_sampled": 1476000, "num_steps_trained": 1476000, "num_agent_steps_trained": 1476000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14908, "training_iteration": 369, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-25-59", "timestamp": 1643657159, "time_this_iter_s": 15.694254159927368, "time_total_s": 11812.500763654709, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11812.500763654709, "timesteps_since_restore": 0, "iterations_since_restore": 369, "perf": {"cpu_util_percent": 35.42727272727273, "ram_util_percent": 63.895454545454555}}
{"episode_reward_max": -3.2, "episode_reward_min": -41.90000000000005, "episode_reward_mean": -12.869999999999997, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.2, -4.6000000000000005, -35.7, -7.2, -9.299999999999999, -12.799999999999999, -12.099999999999998, -3.9000000000000004, -10.699999999999998, -3.2, -15.799999999999997, -15.7, -17.799999999999997, -5.2, -11.29999999999999, -8.799999999999999, -17.0, -13.799999999999999, -3.3, -8.599999999999998, -24.700000000000003, -5.2, -15.299999999999999, -16.099999999999998, -11.3, -17.0, -11.3, -6.0, -5.300000000000001, -18.700000000000003, -19.700000000000003, -3.6000000000000005, -23.900000000000002, -10.3, -12.999999999999998, -3.3, -12.499999999999995, -4.300000000000001, -3.3, -9.2, -16.2, -3.3, -11.799999999999999, -5.300000000000001, -7.1, -17.6, -6.2, -3.8000000000000007, -13.1, -18.099999999999994, -41.90000000000005, -15.199999999999987, -10.2, -10.599999999999993, -18.00000000000002, -11.6, -3.2, -9.899999999999999, -7.2, -12.5, -11.999999999999998, -15.1, -12.3, -9.3, -35.300000000000004, -11.899999999999999, -38.20000000000001, -16.499999999999986, -7.699999999999998, -3.3, -19.299999999999997, -8.2, -4.2, -19.1, -15.3, -5.2, -16.099999999999987, -3.3, -11.099999999999998, -13.49999999999998, -24.700000000000003, -4.2, -28.1, -24.1, -5.799999999999999, -15.60000000000001, -21.400000000000002, -11.399999999999999, -12.0, -37.100000000000016, -4.300000000000001, -20.0, -9.6, -4.300000000000001, -3.2, -14.199999999999996, -18.0, -6.3, -3.3, -39.699999999999996], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4063617092565948, "mean_inference_ms": 4.757992562964738, "mean_action_processing_ms": 0.09210205063517812, "mean_env_wait_ms": 12.789281748630216, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1480000, "timesteps_this_iter": 0, "agent_timesteps_total": 1480000, "timers": {"sample_time_ms": 15781.226, "sample_throughput": 253.466, "load_time_ms": 0.349, "load_throughput": 11473169.664, "learn_time_ms": 7848.115, "learn_throughput": 509.677, "update_time_ms": 1.654}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.18300416057939412, "policy_loss": -0.010295173697053425, "vf_loss": 19.264293710006182, "vf_explained_var": 0.19774184066762207, "kl": 0.010927723432288643, "entropy": 0.19181793433844402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1480000, "num_agent_steps_sampled": 1480000, "num_steps_trained": 1480000, "num_agent_steps_trained": 1480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14948, "training_iteration": 370, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-26-15", "timestamp": 1643657175, "time_this_iter_s": 16.372793912887573, "time_total_s": 11828.873557567596, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11828.873557567596, "timesteps_since_restore": 0, "iterations_since_restore": 370, "perf": {"cpu_util_percent": 38.32916666666667, "ram_util_percent": 64.05833333333332}}
{"episode_reward_max": -3.2, "episode_reward_min": -41.90000000000005, "episode_reward_mean": -13.058, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.2, -3.3, -11.799999999999999, -5.300000000000001, -7.1, -17.6, -6.2, -3.8000000000000007, -13.1, -18.099999999999994, -41.90000000000005, -15.199999999999987, -10.2, -10.599999999999993, -18.00000000000002, -11.6, -3.2, -9.899999999999999, -7.2, -12.5, -11.999999999999998, -15.1, -12.3, -9.3, -35.300000000000004, -11.899999999999999, -38.20000000000001, -16.499999999999986, -7.699999999999998, -3.3, -19.299999999999997, -8.2, -4.2, -19.1, -15.3, -5.2, -16.099999999999987, -3.3, -11.099999999999998, -13.49999999999998, -24.700000000000003, -4.2, -28.1, -24.1, -5.799999999999999, -15.60000000000001, -21.400000000000002, -11.399999999999999, -12.0, -37.100000000000016, -4.300000000000001, -20.0, -9.6, -4.300000000000001, -3.2, -14.199999999999996, -18.0, -6.3, -3.3, -39.699999999999996, -8.2, -5.4, -3.4, -13.899999999999999, -19.000000000000004, -4.9, -22.6, -11.899999999999997, -24.500000000000004, -31.4, -4.300000000000001, -4.300000000000001, -14.899999999999991, -13.1, -14.3, -3.4, -16.299999999999997, -10.2, -12.7, -4.3, -11.8, -3.2, -14.099999999999998, -26.600000000000005, -13.599999999999998, -15.499999999999993, -3.3, -4.300000000000001, -16.999999999999996, -3.3, -3.3, -5.799999999999999, -5.4, -19.10000000000001, -20.900000000000002, -13.3, -3.2, -9.599999999999996, -38.2, -4.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3997958269252866, "mean_inference_ms": 4.748348315398124, "mean_action_processing_ms": 0.09203360683896503, "mean_env_wait_ms": 12.769322535881747, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1484000, "timesteps_this_iter": 0, "agent_timesteps_total": 1484000, "timers": {"sample_time_ms": 15770.034, "sample_throughput": 253.646, "load_time_ms": 0.347, "load_throughput": 11543426.448, "learn_time_ms": 7839.86, "learn_throughput": 510.213, "update_time_ms": 1.743}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.1095117905087048, "policy_loss": -0.015237737324849893, "vf_loss": 12.418106179468094, "vf_explained_var": 0.3342703756465707, "kl": 0.009463770001145977, "entropy": 0.17111736046530868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1484000, "num_agent_steps_sampled": 1484000, "num_steps_trained": 1484000, "num_agent_steps_trained": 1484000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14988, "training_iteration": 371, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-26-31", "timestamp": 1643657191, "time_this_iter_s": 15.421795129776001, "time_total_s": 11844.295352697372, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11844.295352697372, "timesteps_since_restore": 0, "iterations_since_restore": 371, "perf": {"cpu_util_percent": 31.03636363636364, "ram_util_percent": 64.0}}
{"episode_reward_max": -3.2, "episode_reward_min": -44.2, "episode_reward_mean": -12.742999999999997, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.700000000000003, -4.2, -28.1, -24.1, -5.799999999999999, -15.60000000000001, -21.400000000000002, -11.399999999999999, -12.0, -37.100000000000016, -4.300000000000001, -20.0, -9.6, -4.300000000000001, -3.2, -14.199999999999996, -18.0, -6.3, -3.3, -39.699999999999996, -8.2, -5.4, -3.4, -13.899999999999999, -19.000000000000004, -4.9, -22.6, -11.899999999999997, -24.500000000000004, -31.4, -4.300000000000001, -4.300000000000001, -14.899999999999991, -13.1, -14.3, -3.4, -16.299999999999997, -10.2, -12.7, -4.3, -11.8, -3.2, -14.099999999999998, -26.600000000000005, -13.599999999999998, -15.499999999999993, -3.3, -4.300000000000001, -16.999999999999996, -3.3, -3.3, -5.799999999999999, -5.4, -19.10000000000001, -20.900000000000002, -13.3, -3.2, -9.599999999999996, -38.2, -4.300000000000001, -17.8, -9.3, -5.3, -22.5, -14.999999999999996, -9.3, -16.799999999999997, -8.699999999999996, -13.7, -12.099999999999998, -3.2, -12.899999999999999, -3.4, -6.300000000000001, -3.3, -4.300000000000001, -10.999999999999998, -7.3, -4.300000000000001, -3.2, -17.1, -9.2, -5.300000000000001, -4.300000000000001, -42.499999999999964, -6.2, -9.5, -5.2, -8.0, -24.000000000000025, -17.49999999999999, -44.2, -5.2, -27.90000000000005, -8.2, -25.5, -14.3, -16.799999999999997, -4.3, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.393127807509833, "mean_inference_ms": 4.7387302604841155, "mean_action_processing_ms": 0.09196351654242836, "mean_env_wait_ms": 12.749375647136217, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1488000, "timesteps_this_iter": 0, "agent_timesteps_total": 1488000, "timers": {"sample_time_ms": 15744.564, "sample_throughput": 254.056, "load_time_ms": 0.337, "load_throughput": 11883564.244, "learn_time_ms": 7817.815, "learn_throughput": 511.652, "update_time_ms": 1.692}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.18382202304338896, "policy_loss": -0.015089566397771079, "vf_loss": 19.826471192221486, "vf_explained_var": 0.2661196571524425, "kl": 0.010769280607706403, "entropy": 0.1736442231282752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1488000, "num_agent_steps_sampled": 1488000, "num_steps_trained": 1488000, "num_agent_steps_trained": 1488000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15028, "training_iteration": 372, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-26-46", "timestamp": 1643657206, "time_this_iter_s": 15.431948900222778, "time_total_s": 11859.727301597595, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11859.727301597595, "timesteps_since_restore": 0, "iterations_since_restore": 372, "perf": {"cpu_util_percent": 32.9090909090909, "ram_util_percent": 64.02727272727272}}
{"episode_reward_max": -3.2, "episode_reward_min": -53.1, "episode_reward_mean": -11.693, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.8, -3.2, -14.099999999999998, -26.600000000000005, -13.599999999999998, -15.499999999999993, -3.3, -4.300000000000001, -16.999999999999996, -3.3, -3.3, -5.799999999999999, -5.4, -19.10000000000001, -20.900000000000002, -13.3, -3.2, -9.599999999999996, -38.2, -4.300000000000001, -17.8, -9.3, -5.3, -22.5, -14.999999999999996, -9.3, -16.799999999999997, -8.699999999999996, -13.7, -12.099999999999998, -3.2, -12.899999999999999, -3.4, -6.300000000000001, -3.3, -4.300000000000001, -10.999999999999998, -7.3, -4.300000000000001, -3.2, -17.1, -9.2, -5.300000000000001, -4.300000000000001, -42.499999999999964, -6.2, -9.5, -5.2, -8.0, -24.000000000000025, -17.49999999999999, -44.2, -5.2, -27.90000000000005, -8.2, -25.5, -14.3, -16.799999999999997, -4.3, -3.3, -16.299999999999997, -3.3, -14.199999999999998, -13.099999999999996, -4.2, -19.700000000000006, -6.699999999999999, -10.5, -4.300000000000001, -21.800000000000008, -5.300000000000001, -7.399999999999999, -8.3, -4.2, -4.2, -4.2, -6.300000000000001, -5.300000000000001, -23.200000000000003, -9.2, -53.1, -3.3, -4.300000000000001, -5.300000000000001, -31.500000000000025, -17.6, -4.1, -4.300000000000001, -3.3, -8.3, -20.1, -10.5, -12.9, -14.499999999999998, -10.600000000000001, -4.800000000000001, -11.599999999999996, -10.799999999999999, -11.899999999999999, -10.79999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.386395800057372, "mean_inference_ms": 4.7290829848987155, "mean_action_processing_ms": 0.09188887226375803, "mean_env_wait_ms": 12.72917721053263, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1492000, "timesteps_this_iter": 0, "agent_timesteps_total": 1492000, "timers": {"sample_time_ms": 15700.853, "sample_throughput": 254.763, "load_time_ms": 0.338, "load_throughput": 11837448.67, "learn_time_ms": 7816.996, "learn_throughput": 511.706, "update_time_ms": 1.689}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.1246575594068535, "policy_loss": -0.014862363663331796, "vf_loss": 13.889437174156148, "vf_explained_var": 0.34289668311354937, "kl": 0.010414131251366464, "entropy": 0.17856062387907376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1492000, "num_agent_steps_sampled": 1492000, "num_steps_trained": 1492000, "num_agent_steps_trained": 1492000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15068, "training_iteration": 373, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-27-01", "timestamp": 1643657221, "time_this_iter_s": 15.27667784690857, "time_total_s": 11875.003979444504, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11875.003979444504, "timesteps_since_restore": 0, "iterations_since_restore": 373, "perf": {"cpu_util_percent": 32.44761904761905, "ram_util_percent": 64.0}}
{"episode_reward_max": -3.2, "episode_reward_min": -53.1, "episode_reward_mean": -11.407, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.1, -9.2, -5.300000000000001, -4.300000000000001, -42.499999999999964, -6.2, -9.5, -5.2, -8.0, -24.000000000000025, -17.49999999999999, -44.2, -5.2, -27.90000000000005, -8.2, -25.5, -14.3, -16.799999999999997, -4.3, -3.3, -16.299999999999997, -3.3, -14.199999999999998, -13.099999999999996, -4.2, -19.700000000000006, -6.699999999999999, -10.5, -4.300000000000001, -21.800000000000008, -5.300000000000001, -7.399999999999999, -8.3, -4.2, -4.2, -4.2, -6.300000000000001, -5.300000000000001, -23.200000000000003, -9.2, -53.1, -3.3, -4.300000000000001, -5.300000000000001, -31.500000000000025, -17.6, -4.1, -4.300000000000001, -3.3, -8.3, -20.1, -10.5, -12.9, -14.499999999999998, -10.600000000000001, -4.800000000000001, -11.599999999999996, -10.799999999999999, -11.899999999999999, -10.79999999999999, -4.100000000000001, -3.3, -25.60000000000001, -10.899999999999999, -13.5, -3.2, -20.9, -16.3, -11.399999999999999, -7.3, -8.5, -3.3, -5.300000000000001, -3.3, -4.2, -6.4, -22.299999999999997, -5.799999999999999, -6.1, -24.9, -11.5, -26.599999999999998, -8.8, -6.299999999999999, -4.300000000000001, -4.4, -8.9, -16.5, -19.2, -19.9, -3.3, -4.300000000000001, -15.599999999999998, -3.4, -8.3, -3.3, -13.199999999999996, -5.000000000000001, -4.2, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3798409749608163, "mean_inference_ms": 4.719537636278368, "mean_action_processing_ms": 0.09181791470417064, "mean_env_wait_ms": 12.709299530649378, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1496000, "timesteps_this_iter": 0, "agent_timesteps_total": 1496000, "timers": {"sample_time_ms": 15702.465, "sample_throughput": 254.737, "load_time_ms": 0.338, "load_throughput": 11833274.087, "learn_time_ms": 7837.69, "learn_throughput": 510.354, "update_time_ms": 1.739}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.09074112076953214, "policy_loss": -0.0180199343631024, "vf_loss": 10.798112882625672, "vf_explained_var": 0.25106435777038655, "kl": 0.012984125013814293, "entropy": 0.17082543980770853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1496000, "num_agent_steps_sampled": 1496000, "num_steps_trained": 1496000, "num_agent_steps_trained": 1496000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15108, "training_iteration": 374, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-27-17", "timestamp": 1643657237, "time_this_iter_s": 15.858466863632202, "time_total_s": 11890.862446308136, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11890.862446308136, "timesteps_since_restore": 0, "iterations_since_restore": 374, "perf": {"cpu_util_percent": 34.85652173913044, "ram_util_percent": 64.0}}
{"episode_reward_max": -3.2, "episode_reward_min": -53.1, "episode_reward_mean": -10.617, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-53.1, -3.3, -4.300000000000001, -5.300000000000001, -31.500000000000025, -17.6, -4.1, -4.300000000000001, -3.3, -8.3, -20.1, -10.5, -12.9, -14.499999999999998, -10.600000000000001, -4.800000000000001, -11.599999999999996, -10.799999999999999, -11.899999999999999, -10.79999999999999, -4.100000000000001, -3.3, -25.60000000000001, -10.899999999999999, -13.5, -3.2, -20.9, -16.3, -11.399999999999999, -7.3, -8.5, -3.3, -5.300000000000001, -3.3, -4.2, -6.4, -22.299999999999997, -5.799999999999999, -6.1, -24.9, -11.5, -26.599999999999998, -8.8, -6.299999999999999, -4.300000000000001, -4.4, -8.9, -16.5, -19.2, -19.9, -3.3, -4.300000000000001, -15.599999999999998, -3.4, -8.3, -3.3, -13.199999999999996, -5.000000000000001, -4.2, -3.3, -3.3, -6.4, -24.3, -7.999999999999998, -3.2, -9.099999999999998, -7.299999999999999, -4.2, -6.0, -8.0, -7.099999999999999, -3.2, -4.300000000000001, -13.199999999999998, -6.6000000000000005, -7.499999999999999, -12.399999999999999, -14.2, -3.4, -10.999999999999996, -20.7, -22.700000000000003, -3.3, -23.4, -18.9, -11.899999999999995, -3.2, -17.800000000000004, -21.799999999999997, -11.3, -8.5, -18.9, -4.9, -8.799999999999999, -3.2, -7.4, -10.299999999999997, -6.300000000000001, -20.8, -4.4], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.373338098268499, "mean_inference_ms": 4.710049896167832, "mean_action_processing_ms": 0.091747959650247, "mean_env_wait_ms": 12.689659970508954, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1500000, "timesteps_this_iter": 0, "agent_timesteps_total": 1500000, "timers": {"sample_time_ms": 15740.313, "sample_throughput": 254.125, "load_time_ms": 0.353, "load_throughput": 11341320.895, "learn_time_ms": 7802.198, "learn_throughput": 512.676, "update_time_ms": 1.809}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.11227437203239289, "policy_loss": -0.016168489431341488, "vf_loss": 12.766665506875643, "vf_explained_var": 0.22172448667146827, "kl": 0.012922248806244905, "entropy": 0.18971440135951964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1500000, "num_agent_steps_sampled": 1500000, "num_steps_trained": 1500000, "num_agent_steps_trained": 1500000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15148, "training_iteration": 375, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-27-33", "timestamp": 1643657253, "time_this_iter_s": 15.390900135040283, "time_total_s": 11906.253346443176, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11906.253346443176, "timesteps_since_restore": 0, "iterations_since_restore": 375, "perf": {"cpu_util_percent": 35.01363636363636, "ram_util_percent": 64.04999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.2, "episode_reward_mean": -10.54, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.5, -26.599999999999998, -8.8, -6.299999999999999, -4.300000000000001, -4.4, -8.9, -16.5, -19.2, -19.9, -3.3, -4.300000000000001, -15.599999999999998, -3.4, -8.3, -3.3, -13.199999999999996, -5.000000000000001, -4.2, -3.3, -3.3, -6.4, -24.3, -7.999999999999998, -3.2, -9.099999999999998, -7.299999999999999, -4.2, -6.0, -8.0, -7.099999999999999, -3.2, -4.300000000000001, -13.199999999999998, -6.6000000000000005, -7.499999999999999, -12.399999999999999, -14.2, -3.4, -10.999999999999996, -20.7, -22.700000000000003, -3.3, -23.4, -18.9, -11.899999999999995, -3.2, -17.800000000000004, -21.799999999999997, -11.3, -8.5, -18.9, -4.9, -8.799999999999999, -3.2, -7.4, -10.299999999999997, -6.300000000000001, -20.8, -4.4, -12.4, -13.399999999999999, -12.399999999999997, -5.300000000000001, -8.1, -33.2, -8.799999999999997, -17.600000000000005, -6.4, -17.400000000000006, -4.300000000000001, -16.699999999999996, -17.0, -18.900000000000006, -5.1, -7.699999999999999, -10.999999999999996, -15.799999999999999, -3.2, -5.300000000000001, -19.2, -4.3, -3.5000000000000004, -21.3, -9.700000000000001, -3.2, -3.3, -17.900000000000016, -4.4, -3.3, -3.3, -4.300000000000001, -20.400000000000006, -14.999999999999996, -19.2, -3.3, -13.099999999999971, -16.39999999999998, -12.299999999999997, -15.09999999999998], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.366882540099256, "mean_inference_ms": 4.700661764291213, "mean_action_processing_ms": 0.09168017938477607, "mean_env_wait_ms": 12.67032801690013, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1504000, "timesteps_this_iter": 0, "agent_timesteps_total": 1504000, "timers": {"sample_time_ms": 15714.287, "sample_throughput": 254.545, "load_time_ms": 0.346, "load_throughput": 11573686.534, "learn_time_ms": 7798.943, "learn_throughput": 512.89, "update_time_ms": 1.775}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 0.10077307186495033, "policy_loss": -0.014956766177189126, "vf_loss": 11.506653057375262, "vf_explained_var": 0.2422573443382017, "kl": 0.011042698279991317, "entropy": 0.21171893932486094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1504000, "num_agent_steps_sampled": 1504000, "num_steps_trained": 1504000, "num_agent_steps_trained": 1504000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15188, "training_iteration": 376, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-27-48", "timestamp": 1643657268, "time_this_iter_s": 15.770945072174072, "time_total_s": 11922.02429151535, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11922.02429151535, "timesteps_since_restore": 0, "iterations_since_restore": 376, "perf": {"cpu_util_percent": 35.63181818181818, "ram_util_percent": 64.13636363636365}}
{"episode_reward_max": -3.2, "episode_reward_min": -174.2, "episode_reward_mean": -12.605, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.9, -11.899999999999995, -3.2, -17.800000000000004, -21.799999999999997, -11.3, -8.5, -18.9, -4.9, -8.799999999999999, -3.2, -7.4, -10.299999999999997, -6.300000000000001, -20.8, -4.4, -12.4, -13.399999999999999, -12.399999999999997, -5.300000000000001, -8.1, -33.2, -8.799999999999997, -17.600000000000005, -6.4, -17.400000000000006, -4.300000000000001, -16.699999999999996, -17.0, -18.900000000000006, -5.1, -7.699999999999999, -10.999999999999996, -15.799999999999999, -3.2, -5.300000000000001, -19.2, -4.3, -3.5000000000000004, -21.3, -9.700000000000001, -3.2, -3.3, -17.900000000000016, -4.4, -3.3, -3.3, -4.300000000000001, -20.400000000000006, -14.999999999999996, -19.2, -3.3, -13.099999999999971, -16.39999999999998, -12.299999999999997, -15.09999999999998, -10.899999999999999, -21.5, -10.3, -4.9, -3.4, -19.799999999999997, -174.2, -14.3, -27.3, -3.3, -8.3, -13.999999999999998, -8.3, -4.300000000000001, -13.099999999999989, -11.4, -12.099999999999998, -12.3, -29.30000000000005, -3.4, -13.1, -4.4, -10.799999999999997, -9.6, -8.2, -13.3, -24.3, -3.3, -8.399999999999999, -4.4, -4.2, -10.899999999999997, -18.900000000000006, -3.3, -10.3, -4.2, -7.299999999999999, -3.4, -21.700000000000003, -15.599999999999985, -4.3, -11.799999999999999, -3.3, -4.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4643648673965037, "mean_inference_ms": 4.7924519393159555, "mean_action_processing_ms": 0.09166766048579834, "mean_env_wait_ms": 12.443986952579477, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1508000, "timesteps_this_iter": 0, "agent_timesteps_total": 1508000, "timers": {"sample_time_ms": 15699.271, "sample_throughput": 254.789, "load_time_ms": 0.36, "load_throughput": 11097510.253, "learn_time_ms": 7770.806, "learn_throughput": 514.747, "update_time_ms": 1.764}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 1.1482655115633382, "policy_loss": -0.03206964263752583, "vf_loss": 117.9075438568028, "vf_explained_var": 0.13768838656845914, "kl": 0.020972101509923118, "entropy": 0.1985967273793874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1508000, "num_agent_steps_sampled": 1508000, "num_steps_trained": 1508000, "num_agent_steps_trained": 1508000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15232, "training_iteration": 377, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-28-04", "timestamp": 1643657284, "time_this_iter_s": 15.17245101928711, "time_total_s": 11937.196742534637, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11937.196742534637, "timesteps_since_restore": 0, "iterations_since_restore": 377, "perf": {"cpu_util_percent": 31.87272727272727, "ram_util_percent": 63.98181818181818}}
{"episode_reward_max": -3.2, "episode_reward_min": -174.2, "episode_reward_mean": -12.522, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.700000000000001, -3.2, -3.3, -17.900000000000016, -4.4, -3.3, -3.3, -4.300000000000001, -20.400000000000006, -14.999999999999996, -19.2, -3.3, -13.099999999999971, -16.39999999999998, -12.299999999999997, -15.09999999999998, -10.899999999999999, -21.5, -10.3, -4.9, -3.4, -19.799999999999997, -174.2, -14.3, -27.3, -3.3, -8.3, -13.999999999999998, -8.3, -4.300000000000001, -13.099999999999989, -11.4, -12.099999999999998, -12.3, -29.30000000000005, -3.4, -13.1, -4.4, -10.799999999999997, -9.6, -8.2, -13.3, -24.3, -3.3, -8.399999999999999, -4.4, -4.2, -10.899999999999997, -18.900000000000006, -3.3, -10.3, -4.2, -7.299999999999999, -3.4, -21.700000000000003, -15.599999999999985, -4.3, -11.799999999999999, -3.3, -4.2, -3.3, -4.4, -24.100000000000097, -9.2, -8.799999999999999, -6.8999999999999995, -11.7, -3.4, -5.3, -5.800000000000001, -9.5, -15.8, -10.1, -9.2, -43.4, -20.799999999999997, -5.2, -24.40000000000001, -16.799999999999997, -6.299999999999999, -13.199999999999998, -4.300000000000001, -18.1, -13.4, -3.3, -19.800000000000004, -10.6, -8.3, -4.4, -4.300000000000001, -3.4, -40.4, -4.300000000000001, -4.2, -3.2, -17.099999999999994, -3.3, -16.5, -4.2, -17.700000000000003], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.458045913663324, "mean_inference_ms": 4.783156811464803, "mean_action_processing_ms": 0.09160094772937559, "mean_env_wait_ms": 12.42583567566441, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1512000, "timesteps_this_iter": 0, "agent_timesteps_total": 1512000, "timers": {"sample_time_ms": 15648.602, "sample_throughput": 255.614, "load_time_ms": 0.351, "load_throughput": 11408415.613, "learn_time_ms": 7766.162, "learn_throughput": 515.055, "update_time_ms": 1.749}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.12417728072733328, "policy_loss": -0.015082489787751148, "vf_loss": 13.822147912492035, "vf_explained_var": 0.23165635633212264, "kl": 0.011523570584618096, "entropy": 0.20535458968051018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1512000, "num_agent_steps_sampled": 1512000, "num_steps_trained": 1512000, "num_agent_steps_trained": 1512000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15272, "training_iteration": 378, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-28-19", "timestamp": 1643657299, "time_this_iter_s": 15.562092065811157, "time_total_s": 11952.758834600449, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11952.758834600449, "timesteps_since_restore": 0, "iterations_since_restore": 378, "perf": {"cpu_util_percent": 27.19090909090909, "ram_util_percent": 63.940909090909095}}
{"episode_reward_max": -3.2, "episode_reward_min": -83.10000000000005, "episode_reward_mean": -11.737000000000005, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.2, -13.3, -24.3, -3.3, -8.399999999999999, -4.4, -4.2, -10.899999999999997, -18.900000000000006, -3.3, -10.3, -4.2, -7.299999999999999, -3.4, -21.700000000000003, -15.599999999999985, -4.3, -11.799999999999999, -3.3, -4.2, -3.3, -4.4, -24.100000000000097, -9.2, -8.799999999999999, -6.8999999999999995, -11.7, -3.4, -5.3, -5.800000000000001, -9.5, -15.8, -10.1, -9.2, -43.4, -20.799999999999997, -5.2, -24.40000000000001, -16.799999999999997, -6.299999999999999, -13.199999999999998, -4.300000000000001, -18.1, -13.4, -3.3, -19.800000000000004, -10.6, -8.3, -4.4, -4.300000000000001, -3.4, -40.4, -4.300000000000001, -4.2, -3.2, -17.099999999999994, -3.3, -16.5, -4.2, -17.700000000000003, -21.700000000000074, -12.2, -4.2, -6.300000000000001, -10.2, -17.2, -9.299999999999995, -20.8, -5.300000000000001, -68.5, -8.3, -13.6, -3.5000000000000004, -3.2, -4.4, -10.899999999999997, -9.3, -3.3, -8.2, -3.4, -4.300000000000001, -5.4, -3.3, -14.999999999999996, -3.3, -18.099999999999998, -4.4, -45.30000000000006, -16.2, -17.799999999999997, -3.2, -3.4, -13.1, -14.7, -3.4, -3.3, -3.4, -5.300000000000001, -83.10000000000005, -20.200000000000003], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.34905303765614, "mean_inference_ms": 4.773879784267465, "mean_action_processing_ms": 0.09147001339100734, "mean_env_wait_ms": 12.509626974190665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1516000, "timesteps_this_iter": 0, "agent_timesteps_total": 1516000, "timers": {"sample_time_ms": 15646.834, "sample_throughput": 255.643, "load_time_ms": 0.351, "load_throughput": 11393695.076, "learn_time_ms": 7741.804, "learn_throughput": 516.675, "update_time_ms": 1.652}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.3576375388965932, "policy_loss": -0.009790228114974113, "vf_loss": 36.662703319967434, "vf_explained_var": 0.12382549098742905, "kl": 0.00888708386634343, "entropy": 0.17157950871573982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1516000, "num_agent_steps_sampled": 1516000, "num_steps_trained": 1516000, "num_agent_steps_trained": 1516000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15312, "training_iteration": 379, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-28-35", "timestamp": 1643657315, "time_this_iter_s": 15.472559213638306, "time_total_s": 11968.231393814087, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11968.231393814087, "timesteps_since_restore": 0, "iterations_since_restore": 379, "perf": {"cpu_util_percent": 20.71818181818182, "ram_util_percent": 63.818181818181806}}
{"episode_reward_max": -3.2, "episode_reward_min": -83.10000000000005, "episode_reward_mean": -12.282000000000004, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.199999999999998, -4.300000000000001, -18.1, -13.4, -3.3, -19.800000000000004, -10.6, -8.3, -4.4, -4.300000000000001, -3.4, -40.4, -4.300000000000001, -4.2, -3.2, -17.099999999999994, -3.3, -16.5, -4.2, -17.700000000000003, -21.700000000000074, -12.2, -4.2, -6.300000000000001, -10.2, -17.2, -9.299999999999995, -20.8, -5.300000000000001, -68.5, -8.3, -13.6, -3.5000000000000004, -3.2, -4.4, -10.899999999999997, -9.3, -3.3, -8.2, -3.4, -4.300000000000001, -5.4, -3.3, -14.999999999999996, -3.3, -18.099999999999998, -4.4, -45.30000000000006, -16.2, -17.799999999999997, -3.2, -3.4, -13.1, -14.7, -3.4, -3.3, -3.4, -5.300000000000001, -83.10000000000005, -20.200000000000003, -25.499999999999993, -6.1, -15.100000000000001, -6.0, -9.2, -12.299999999999999, -3.4, -15.099999999999998, -13.099999999999998, -23.700000000000003, -6.2, -20.400000000000002, -14.0, -5.300000000000001, -10.7, -7.899999999999999, -16.299999999999997, -15.399999999999999, -9.499999999999998, -4.2, -11.199999999999998, -13.099999999999998, -37.30000000000007, -3.2, -4.2, -7.399999999999998, -5.300000000000001, -39.899999999999956, -4.6000000000000005, -6.2, -3.6, -17.3, -17.499999999999993, -11.399999999999997, -3.3, -8.700000000000001, -3.2, -22.4, -16.2, -8.799999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.341389442654398, "mean_inference_ms": 4.663337021261283, "mean_action_processing_ms": 0.09140007541481786, "mean_env_wait_ms": 12.592525307564607, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1520000, "timesteps_this_iter": 0, "agent_timesteps_total": 1520000, "timers": {"sample_time_ms": 15545.749, "sample_throughput": 257.305, "load_time_ms": 0.349, "load_throughput": 11460629.824, "learn_time_ms": 7721.077, "learn_throughput": 518.062, "update_time_ms": 1.71}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.11005625649886105, "policy_loss": -0.015939854732364096, "vf_loss": 12.507485704909088, "vf_explained_var": 0.19483877215334164, "kl": 0.010224643265718904, "entropy": 0.18777912683704848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1520000, "num_agent_steps_sampled": 1520000, "num_steps_trained": 1520000, "num_agent_steps_trained": 1520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15352, "training_iteration": 380, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-28-50", "timestamp": 1643657330, "time_this_iter_s": 15.569183111190796, "time_total_s": 11983.800576925278, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11983.800576925278, "timesteps_since_restore": 0, "iterations_since_restore": 380, "perf": {"cpu_util_percent": 32.127272727272725, "ram_util_percent": 63.81363636363637}}
{"episode_reward_max": -3.2, "episode_reward_min": -85.29999999999998, "episode_reward_mean": -12.808, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -5.4, -3.3, -14.999999999999996, -3.3, -18.099999999999998, -4.4, -45.30000000000006, -16.2, -17.799999999999997, -3.2, -3.4, -13.1, -14.7, -3.4, -3.3, -3.4, -5.300000000000001, -83.10000000000005, -20.200000000000003, -25.499999999999993, -6.1, -15.100000000000001, -6.0, -9.2, -12.299999999999999, -3.4, -15.099999999999998, -13.099999999999998, -23.700000000000003, -6.2, -20.400000000000002, -14.0, -5.300000000000001, -10.7, -7.899999999999999, -16.299999999999997, -15.399999999999999, -9.499999999999998, -4.2, -11.199999999999998, -13.099999999999998, -37.30000000000007, -3.2, -4.2, -7.399999999999998, -5.300000000000001, -39.899999999999956, -4.6000000000000005, -6.2, -3.6, -17.3, -17.499999999999993, -11.399999999999997, -3.3, -8.700000000000001, -3.2, -22.4, -16.2, -8.799999999999999, -3.3, -3.4, -6.2, -14.899999999999999, -9.399999999999999, -16.599999999999998, -28.3, -3.4, -23.2, -4.300000000000001, -12.099999999999998, -19.6, -6.499999999999999, -15.4, -3.3, -20.000000000000007, -8.899999999999999, -13.2, -3.3, -8.9, -13.499999999999998, -3.3, -4.300000000000001, -17.3, -16.4, -7.099999999999999, -12.899999999999999, -4.4, -4.300000000000001, -85.29999999999998, -3.3, -20.900000000000045, -4.300000000000001, -23.1, -13.5, -16.5, -3.4, -4.300000000000001, -11.3, -16.799999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3349049536781257, "mean_inference_ms": 4.654090448298891, "mean_action_processing_ms": 0.09132865906746175, "mean_env_wait_ms": 12.573217170719252, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1524000, "timesteps_this_iter": 0, "agent_timesteps_total": 1524000, "timers": {"sample_time_ms": 15530.836, "sample_throughput": 257.552, "load_time_ms": 0.35, "load_throughput": 11437971.094, "learn_time_ms": 7693.933, "learn_throughput": 519.89, "update_time_ms": 1.611}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.3115947499689746, "policy_loss": -0.01505736224153029, "vf_loss": 32.60474182623689, "vf_explained_var": 0.18495216850311524, "kl": 0.006711293868411694, "entropy": 0.15069827614852818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1524000, "num_agent_steps_sampled": 1524000, "num_steps_trained": 1524000, "num_agent_steps_trained": 1524000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15392, "training_iteration": 381, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-29-06", "timestamp": 1643657346, "time_this_iter_s": 15.20443868637085, "time_total_s": 11999.005015611649, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11999.005015611649, "timesteps_since_restore": 0, "iterations_since_restore": 381, "perf": {"cpu_util_percent": 21.752380952380946, "ram_util_percent": 63.90000000000001}}
{"episode_reward_max": -3.2, "episode_reward_min": -85.29999999999998, "episode_reward_mean": -12.963000000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.199999999999998, -13.099999999999998, -37.30000000000007, -3.2, -4.2, -7.399999999999998, -5.300000000000001, -39.899999999999956, -4.6000000000000005, -6.2, -3.6, -17.3, -17.499999999999993, -11.399999999999997, -3.3, -8.700000000000001, -3.2, -22.4, -16.2, -8.799999999999999, -3.3, -3.4, -6.2, -14.899999999999999, -9.399999999999999, -16.599999999999998, -28.3, -3.4, -23.2, -4.300000000000001, -12.099999999999998, -19.6, -6.499999999999999, -15.4, -3.3, -20.000000000000007, -8.899999999999999, -13.2, -3.3, -8.9, -13.499999999999998, -3.3, -4.300000000000001, -17.3, -16.4, -7.099999999999999, -12.899999999999999, -4.4, -4.300000000000001, -85.29999999999998, -3.3, -20.900000000000045, -4.300000000000001, -23.1, -13.5, -16.5, -3.4, -4.300000000000001, -11.3, -16.799999999999997, -8.299999999999997, -3.3, -5.699999999999999, -68.30000000000008, -6.5, -9.499999999999996, -15.600000000000001, -5.700000000000001, -8.3, -20.3, -13.799999999999994, -10.9, -4.300000000000001, -12.700000000000003, -13.3, -21.40000000000007, -23.700000000000003, -10.2, -20.80000000000006, -36.900000000000034, -3.3, -14.3, -4.700000000000001, -15.7, -23.699999999999996, -3.2, -14.899999999999999, -4.4, -4.300000000000001, -5.300000000000001, -13.1, -11.2, -4.300000000000001, -7.299999999999999, -6.899999999999999, -17.4, -10.3, -21.3, -30.70000000000007, -5.300000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.32855422598219, "mean_inference_ms": 4.644983143859774, "mean_action_processing_ms": 0.0912626321049986, "mean_env_wait_ms": 12.554403841021935, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1528000, "timesteps_this_iter": 0, "agent_timesteps_total": 1528000, "timers": {"sample_time_ms": 15540.78, "sample_throughput": 257.387, "load_time_ms": 0.353, "load_throughput": 11330597.69, "learn_time_ms": 7808.098, "learn_throughput": 512.289, "update_time_ms": 1.707}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.17567827551155002, "policy_loss": -0.02346557537644541, "vf_loss": 19.760577088241938, "vf_explained_var": 0.25324035581722054, "kl": 0.017070555471985965, "entropy": 0.19255579865827996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1528000, "num_agent_steps_sampled": 1528000, "num_steps_trained": 1528000, "num_agent_steps_trained": 1528000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15432, "training_iteration": 382, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-29-23", "timestamp": 1643657363, "time_this_iter_s": 16.95184087753296, "time_total_s": 12015.956856489182, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12015.956856489182, "timesteps_since_restore": 0, "iterations_since_restore": 382, "perf": {"cpu_util_percent": 29.676, "ram_util_percent": 63.964}}
{"episode_reward_max": -3.2, "episode_reward_min": -85.29999999999998, "episode_reward_mean": -13.260000000000005, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.499999999999998, -3.3, -4.300000000000001, -17.3, -16.4, -7.099999999999999, -12.899999999999999, -4.4, -4.300000000000001, -85.29999999999998, -3.3, -20.900000000000045, -4.300000000000001, -23.1, -13.5, -16.5, -3.4, -4.300000000000001, -11.3, -16.799999999999997, -8.299999999999997, -3.3, -5.699999999999999, -68.30000000000008, -6.5, -9.499999999999996, -15.600000000000001, -5.700000000000001, -8.3, -20.3, -13.799999999999994, -10.9, -4.300000000000001, -12.700000000000003, -13.3, -21.40000000000007, -23.700000000000003, -10.2, -20.80000000000006, -36.900000000000034, -3.3, -14.3, -4.700000000000001, -15.7, -23.699999999999996, -3.2, -14.899999999999999, -4.4, -4.300000000000001, -5.300000000000001, -13.1, -11.2, -4.300000000000001, -7.299999999999999, -6.899999999999999, -17.4, -10.3, -21.3, -30.70000000000007, -5.300000000000001, -12.3, -13.499999999999998, -11.399999999999999, -16.7, -15.5, -12.999999999999996, -6.399999999999999, -4.2, -9.4, -18.00000000000001, -21.400000000000027, -14.79999999999999, -13.8, -5.2, -18.50000000000002, -8.4, -12.499999999999998, -5.8999999999999995, -18.1, -21.3, -5.2, -12.39999999999999, -12.2, -13.499999999999998, -4.4, -5.2, -17.4, -6.3, -24.2, -16.3, -10.5, -8.1, -16.9, -20.1, -3.8000000000000003, -15.600000000000001, -9.699999999999998, -17.3, -5.0, -14.299999999999994], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3224291498550698, "mean_inference_ms": 4.636128232116796, "mean_action_processing_ms": 0.0912084179241926, "mean_env_wait_ms": 12.536703478873415, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1532000, "timesteps_this_iter": 0, "agent_timesteps_total": 1532000, "timers": {"sample_time_ms": 15823.31, "sample_throughput": 252.792, "load_time_ms": 0.354, "load_throughput": 11313787.848, "learn_time_ms": 7840.145, "learn_throughput": 510.195, "update_time_ms": 1.733}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.10404657485484275, "policy_loss": -0.022262969720728134, "vf_loss": 12.564342277088473, "vf_explained_var": 0.1635484408306819, "kl": 0.007393042405141403, "entropy": 0.18091396088561704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1532000, "num_agent_steps_sampled": 1532000, "num_steps_trained": 1532000, "num_agent_steps_trained": 1532000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15472, "training_iteration": 383, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-29-40", "timestamp": 1643657380, "time_this_iter_s": 17.27368426322937, "time_total_s": 12033.23054075241, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12033.23054075241, "timesteps_since_restore": 0, "iterations_since_restore": 383, "perf": {"cpu_util_percent": 38.30416666666667, "ram_util_percent": 64.0625}}
{"episode_reward_max": -1.3, "episode_reward_min": -30.70000000000007, "episode_reward_mean": -11.488, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -14.3, -4.700000000000001, -15.7, -23.699999999999996, -3.2, -14.899999999999999, -4.4, -4.300000000000001, -5.300000000000001, -13.1, -11.2, -4.300000000000001, -7.299999999999999, -6.899999999999999, -17.4, -10.3, -21.3, -30.70000000000007, -5.300000000000001, -12.3, -13.499999999999998, -11.399999999999999, -16.7, -15.5, -12.999999999999996, -6.399999999999999, -4.2, -9.4, -18.00000000000001, -21.400000000000027, -14.79999999999999, -13.8, -5.2, -18.50000000000002, -8.4, -12.499999999999998, -5.8999999999999995, -18.1, -21.3, -5.2, -12.39999999999999, -12.2, -13.499999999999998, -4.4, -5.2, -17.4, -6.3, -24.2, -16.3, -10.5, -8.1, -16.9, -20.1, -3.8000000000000003, -15.600000000000001, -9.699999999999998, -17.3, -5.0, -14.299999999999994, -1.3, -21.799999999999965, -3.3, -9.399999999999997, -3.5, -23.3, -11.3, -6.4, -18.0, -8.2, -10.4, -5.4, -7.099999999999999, -16.599999999999984, -4.300000000000001, -8.0, -8.700000000000001, -7.300000000000001, -15.999999999999998, -3.2, -22.3, -14.299999999999981, -5.1000000000000005, -14.8, -16.099999999999998, -17.7, -10.799999999999999, -5.2, -22.9, -6.299999999999999, -16.2, -4.3, -5.300000000000001, -13.49999999999998, -3.4, -8.7, -4.6000000000000005, -12.699999999999998, -4.300000000000001, -26.500000000000014], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3163423380427925, "mean_inference_ms": 4.627307701208736, "mean_action_processing_ms": 0.0911537859970233, "mean_env_wait_ms": 12.51903843639398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1536000, "timesteps_this_iter": 0, "agent_timesteps_total": 1536000, "timers": {"sample_time_ms": 15828.546, "sample_throughput": 252.708, "load_time_ms": 0.352, "load_throughput": 11355906.322, "learn_time_ms": 7818.184, "learn_throughput": 511.628, "update_time_ms": 1.678}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.0876165239440818, "policy_loss": -0.02147305207226866, "vf_loss": 10.808791538528217, "vf_explained_var": 0.3126522022549824, "kl": 0.011117033858892482, "entropy": 0.20203453475429164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1536000, "num_agent_steps_sampled": 1536000, "num_steps_trained": 1536000, "num_agent_steps_trained": 1536000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15512, "training_iteration": 384, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-29-55", "timestamp": 1643657395, "time_this_iter_s": 15.360850095748901, "time_total_s": 12048.59139084816, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12048.59139084816, "timesteps_since_restore": 0, "iterations_since_restore": 384, "perf": {"cpu_util_percent": 33.64545454545455, "ram_util_percent": 64.1181818181818}}
{"episode_reward_max": -1.3, "episode_reward_min": -27.2, "episode_reward_mean": -10.895, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -12.39999999999999, -12.2, -13.499999999999998, -4.4, -5.2, -17.4, -6.3, -24.2, -16.3, -10.5, -8.1, -16.9, -20.1, -3.8000000000000003, -15.600000000000001, -9.699999999999998, -17.3, -5.0, -14.299999999999994, -1.3, -21.799999999999965, -3.3, -9.399999999999997, -3.5, -23.3, -11.3, -6.4, -18.0, -8.2, -10.4, -5.4, -7.099999999999999, -16.599999999999984, -4.300000000000001, -8.0, -8.700000000000001, -7.300000000000001, -15.999999999999998, -3.2, -22.3, -14.299999999999981, -5.1000000000000005, -14.8, -16.099999999999998, -17.7, -10.799999999999999, -5.2, -22.9, -6.299999999999999, -16.2, -4.3, -5.300000000000001, -13.49999999999998, -3.4, -8.7, -4.6000000000000005, -12.699999999999998, -4.300000000000001, -26.500000000000014, -14.999999999999993, -16.2, -11.099999999999998, -15.899999999999999, -15.599999999999998, -4.3, -6.300000000000001, -5.300000000000001, -15.599999999999975, -7.199999999999998, -13.799999999999999, -13.299999999999986, -3.4, -5.300000000000001, -24.4, -12.7, -11.2, -9.099999999999998, -13.400000000000011, -4.300000000000001, -13.799999999999999, -4.2, -16.5, -4.300000000000001, -5.4, -4.300000000000001, -7.499999999999999, -7.300000000000001, -6.5, -10.399999999999999, -10.5, -9.2, -4.4, -27.2, -8.7, -15.5, -12.799999999999988, -15.899999999999997, -3.4000000000000004, -11.399999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3102285714957667, "mean_inference_ms": 4.618444221928464, "mean_action_processing_ms": 0.091094006128498, "mean_env_wait_ms": 12.500940464009739, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1540000, "timesteps_this_iter": 0, "agent_timesteps_total": 1540000, "timers": {"sample_time_ms": 15825.75, "sample_throughput": 252.753, "load_time_ms": 0.341, "load_throughput": 11728218.106, "learn_time_ms": 7790.255, "learn_throughput": 513.462, "update_time_ms": 1.615}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.04745263732388936, "policy_loss": -0.017054943346308284, "vf_loss": 6.360899109385347, "vf_explained_var": 0.4894528822873228, "kl": 0.00997307984794465, "entropy": 0.19321445713360463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1540000, "num_agent_steps_sampled": 1540000, "num_steps_trained": 1540000, "num_agent_steps_trained": 1540000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15552, "training_iteration": 385, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-30-11", "timestamp": 1643657411, "time_this_iter_s": 15.29966425895691, "time_total_s": 12063.891055107117, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12063.891055107117, "timesteps_since_restore": 0, "iterations_since_restore": 385, "perf": {"cpu_util_percent": 30.55, "ram_util_percent": 64.09999999999997}}
{"episode_reward_max": -3.2, "episode_reward_min": -30.2, "episode_reward_mean": -10.908, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.3, -14.299999999999981, -5.1000000000000005, -14.8, -16.099999999999998, -17.7, -10.799999999999999, -5.2, -22.9, -6.299999999999999, -16.2, -4.3, -5.300000000000001, -13.49999999999998, -3.4, -8.7, -4.6000000000000005, -12.699999999999998, -4.300000000000001, -26.500000000000014, -14.999999999999993, -16.2, -11.099999999999998, -15.899999999999999, -15.599999999999998, -4.3, -6.300000000000001, -5.300000000000001, -15.599999999999975, -7.199999999999998, -13.799999999999999, -13.299999999999986, -3.4, -5.300000000000001, -24.4, -12.7, -11.2, -9.099999999999998, -13.400000000000011, -4.300000000000001, -13.799999999999999, -4.2, -16.5, -4.300000000000001, -5.4, -4.300000000000001, -7.499999999999999, -7.300000000000001, -6.5, -10.399999999999999, -10.5, -9.2, -4.4, -27.2, -8.7, -15.5, -12.799999999999988, -15.899999999999997, -3.4000000000000004, -11.399999999999999, -11.399999999999999, -11.299999999999995, -10.3, -20.6, -4.300000000000001, -18.5, -11.999999999999998, -3.7, -30.2, -4.300000000000001, -6.8, -13.5, -13.9, -8.5, -15.69999999999999, -6.1, -8.2, -3.3, -11.9, -7.2, -7.199999999999998, -15.3, -13.399999999999997, -7.199999999999999, -23.500000000000014, -13.3, -5.3, -18.700000000000003, -5.799999999999999, -8.499999999999998, -8.3, -15.600000000000001, -3.3, -22.099999999999998, -20.80000000000001, -5.000000000000001, -4.4, -3.3, -7.300000000000001, -3.2], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3040521919741064, "mean_inference_ms": 4.609498638956174, "mean_action_processing_ms": 0.09102727550779154, "mean_env_wait_ms": 12.48226042384551, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1544000, "timesteps_this_iter": 0, "agent_timesteps_total": 1544000, "timers": {"sample_time_ms": 15734.524, "sample_throughput": 254.218, "load_time_ms": 0.341, "load_throughput": 11746282.994, "learn_time_ms": 7782.544, "learn_throughput": 513.971, "update_time_ms": 1.616}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.09031155327665469, "policy_loss": -0.01498866317072703, "vf_loss": 10.458368256656073, "vf_explained_var": 0.3393005201893468, "kl": 0.007952546037013586, "entropy": 0.18296905438746175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1544000, "num_agent_steps_sampled": 1544000, "num_steps_trained": 1544000, "num_agent_steps_trained": 1544000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15592, "training_iteration": 386, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-30-26", "timestamp": 1643657426, "time_this_iter_s": 15.06032395362854, "time_total_s": 12078.951379060745, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12078.951379060745, "timesteps_since_restore": 0, "iterations_since_restore": 386, "perf": {"cpu_util_percent": 30.938095238095237, "ram_util_percent": 64.09999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -30.2, "episode_reward_mean": -10.321, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -4.300000000000001, -7.499999999999999, -7.300000000000001, -6.5, -10.399999999999999, -10.5, -9.2, -4.4, -27.2, -8.7, -15.5, -12.799999999999988, -15.899999999999997, -3.4000000000000004, -11.399999999999999, -11.399999999999999, -11.299999999999995, -10.3, -20.6, -4.300000000000001, -18.5, -11.999999999999998, -3.7, -30.2, -4.300000000000001, -6.8, -13.5, -13.9, -8.5, -15.69999999999999, -6.1, -8.2, -3.3, -11.9, -7.2, -7.199999999999998, -15.3, -13.399999999999997, -7.199999999999999, -23.500000000000014, -13.3, -5.3, -18.700000000000003, -5.799999999999999, -8.499999999999998, -8.3, -15.600000000000001, -3.3, -22.099999999999998, -20.80000000000001, -5.000000000000001, -4.4, -3.3, -7.300000000000001, -3.2, -17.3, -3.4, -8.3, -6.2, -11.899999999999999, -3.3, -26.500000000000004, -4.300000000000001, -18.4, -15.999999999999998, -4.300000000000001, -8.3, -9.5, -3.3, -3.3, -9.700000000000001, -4.2, -8.899999999999999, -3.3, -19.3, -15.2, -22.3, -9.100000000000001, -3.3, -15.999999999999998, -6.1, -4.2, -4.300000000000001, -22.500000000000004, -14.399999999999997, -5.5, -10.2, -5.300000000000001, -4.4, -13.2, -3.3, -7.299999999999999, -8.5, -14.5, -19.90000000000001, -3.3, -5.1, -18.59999999999998, -12.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.399195210437571, "mean_inference_ms": 4.6991880636398795, "mean_action_processing_ms": 0.09101914550914493, "mean_env_wait_ms": 12.262421246645628, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1548000, "timesteps_this_iter": 0, "agent_timesteps_total": 1548000, "timers": {"sample_time_ms": 15792.342, "sample_throughput": 253.287, "load_time_ms": 0.318, "load_throughput": 12570027.722, "learn_time_ms": 7859.139, "learn_throughput": 508.962, "update_time_ms": 1.67}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.0643324425714391, "policy_loss": -0.015301012490144981, "vf_loss": 7.884341373558967, "vf_explained_var": 0.32828391418662123, "kl": 0.0087683621684021, "entropy": 0.15575414233470475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1548000, "num_agent_steps_sampled": 1548000, "num_steps_trained": 1548000, "num_agent_steps_trained": 1548000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15636, "training_iteration": 387, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-30-42", "timestamp": 1643657442, "time_this_iter_s": 16.60233998298645, "time_total_s": 12095.553719043732, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12095.553719043732, "timesteps_since_restore": 0, "iterations_since_restore": 387, "perf": {"cpu_util_percent": 31.737499999999997, "ram_util_percent": 64.12916666666666}}
{"episode_reward_max": -3.2, "episode_reward_min": -27.20000000000001, "episode_reward_mean": -10.030999999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.500000000000014, -13.3, -5.3, -18.700000000000003, -5.799999999999999, -8.499999999999998, -8.3, -15.600000000000001, -3.3, -22.099999999999998, -20.80000000000001, -5.000000000000001, -4.4, -3.3, -7.300000000000001, -3.2, -17.3, -3.4, -8.3, -6.2, -11.899999999999999, -3.3, -26.500000000000004, -4.300000000000001, -18.4, -15.999999999999998, -4.300000000000001, -8.3, -9.5, -3.3, -3.3, -9.700000000000001, -4.2, -8.899999999999999, -3.3, -19.3, -15.2, -22.3, -9.100000000000001, -3.3, -15.999999999999998, -6.1, -4.2, -4.300000000000001, -22.500000000000004, -14.399999999999997, -5.5, -10.2, -5.300000000000001, -4.4, -13.2, -3.3, -7.299999999999999, -8.5, -14.5, -19.90000000000001, -3.3, -5.1, -18.59999999999998, -12.3, -11.8, -15.699999999999998, -16.799999999999997, -6.2, -9.7, -11.899999999999988, -3.3, -5.2, -6.4, -7.499999999999998, -11.2, -9.2, -4.300000000000001, -20.199999999999996, -13.4, -15.999999999999998, -10.2, -4.2, -4.300000000000001, -5.300000000000001, -12.799999999999997, -9.2, -9.899999999999999, -13.2, -8.799999999999997, -3.2, -4.6000000000000005, -9.0, -27.20000000000001, -10.9, -8.2, -10.5, -14.5, -11.2, -8.2, -4.2, -3.4, -5.4, -12.5, -16.499999999999996], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3933608368890393, "mean_inference_ms": 4.690668363021859, "mean_action_processing_ms": 0.09096551305640041, "mean_env_wait_ms": 12.246195899523489, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1552000, "timesteps_this_iter": 0, "agent_timesteps_total": 1552000, "timers": {"sample_time_ms": 15975.64, "sample_throughput": 250.381, "load_time_ms": 0.333, "load_throughput": 12018063.037, "learn_time_ms": 8121.671, "learn_throughput": 492.51, "update_time_ms": 1.78}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.04626363359431746, "policy_loss": -0.008576060269748973, "vf_loss": 5.411309237762164, "vf_explained_var": 0.45592273230193764, "kl": 0.008064271232972417, "entropy": 0.18543961282859567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1552000, "num_agent_steps_sampled": 1552000, "num_steps_trained": 1552000, "num_agent_steps_trained": 1552000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15676, "training_iteration": 388, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-31-02", "timestamp": 1643657462, "time_this_iter_s": 19.241808891296387, "time_total_s": 12114.795527935028, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12114.795527935028, "timesteps_since_restore": 0, "iterations_since_restore": 388, "perf": {"cpu_util_percent": 36.337037037037035, "ram_util_percent": 64.1888888888889}}
{"episode_reward_max": -3.2, "episode_reward_min": -108.69999999999983, "episode_reward_mean": -11.342999999999996, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.999999999999998, -6.1, -4.2, -4.300000000000001, -22.500000000000004, -14.399999999999997, -5.5, -10.2, -5.300000000000001, -4.4, -13.2, -3.3, -7.299999999999999, -8.5, -14.5, -19.90000000000001, -3.3, -5.1, -18.59999999999998, -12.3, -11.8, -15.699999999999998, -16.799999999999997, -6.2, -9.7, -11.899999999999988, -3.3, -5.2, -6.4, -7.499999999999998, -11.2, -9.2, -4.300000000000001, -20.199999999999996, -13.4, -15.999999999999998, -10.2, -4.2, -4.300000000000001, -5.300000000000001, -12.799999999999997, -9.2, -9.899999999999999, -13.2, -8.799999999999997, -3.2, -4.6000000000000005, -9.0, -27.20000000000001, -10.9, -8.2, -10.5, -14.5, -11.2, -8.2, -4.2, -3.4, -5.4, -12.5, -16.499999999999996, -9.799999999999999, -4.2, -6.300000000000001, -5.8999999999999995, -7.3, -5.2, -4.4, -7.2, -24.900000000000023, -22.900000000000002, -13.799999999999997, -10.9, -3.2, -21.700000000000063, -9.4, -5.1000000000000005, -4.300000000000001, -108.69999999999983, -4.2, -8.3, -88.4, -4.2, -5.2, -7.499999999999999, -8.999999999999998, -15.5, -7.399999999999999, -9.200000000000003, -4.300000000000001, -8.700000000000001, -8.2, -9.2, -5.000000000000001, -16.999999999999993, -10.099999999999998, -3.3, -12.599999999999996, -8.2, -12.099999999999998, -6.399999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.287557929811104, "mean_inference_ms": 4.682325151810801, "mean_action_processing_ms": 0.09085715954621813, "mean_env_wait_ms": 12.329940507513692, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1556000, "timesteps_this_iter": 0, "agent_timesteps_total": 1556000, "timers": {"sample_time_ms": 16335.084, "sample_throughput": 244.872, "load_time_ms": 0.336, "load_throughput": 11909715.34, "learn_time_ms": 8187.773, "learn_throughput": 488.533, "update_time_ms": 1.768}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.6733692340595367, "policy_loss": -0.008653492164067043, "vf_loss": 68.13103311856588, "vf_explained_var": 0.19501460175360402, "kl": 0.007906764844826044, "entropy": 0.19020559819795751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1556000, "num_agent_steps_sampled": 1556000, "num_steps_trained": 1556000, "num_agent_steps_trained": 1556000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15716, "training_iteration": 389, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-31-19", "timestamp": 1643657479, "time_this_iter_s": 17.07024312019348, "time_total_s": 12131.865771055222, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12131.865771055222, "timesteps_since_restore": 0, "iterations_since_restore": 389, "perf": {"cpu_util_percent": 33.928, "ram_util_percent": 64.208}}
{"episode_reward_max": -1.2, "episode_reward_min": -108.69999999999983, "episode_reward_mean": -12.601, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.799999999999997, -9.2, -9.899999999999999, -13.2, -8.799999999999997, -3.2, -4.6000000000000005, -9.0, -27.20000000000001, -10.9, -8.2, -10.5, -14.5, -11.2, -8.2, -4.2, -3.4, -5.4, -12.5, -16.499999999999996, -9.799999999999999, -4.2, -6.300000000000001, -5.8999999999999995, -7.3, -5.2, -4.4, -7.2, -24.900000000000023, -22.900000000000002, -13.799999999999997, -10.9, -3.2, -21.700000000000063, -9.4, -5.1000000000000005, -4.300000000000001, -108.69999999999983, -4.2, -8.3, -88.4, -4.2, -5.2, -7.499999999999999, -8.999999999999998, -15.5, -7.399999999999999, -9.200000000000003, -4.300000000000001, -8.700000000000001, -8.2, -9.2, -5.000000000000001, -16.999999999999993, -10.099999999999998, -3.3, -12.599999999999996, -8.2, -12.099999999999998, -6.399999999999999, -10.799999999999997, -20.0, -3.7, -3.2, -13.2, -22.50000000000002, -10.999999999999996, -9.4, -18.200000000000003, -3.3, -26.400000000000002, -19.7, -22.6, -24.099999999999998, -21.799999999999958, -98.70000000000014, -7.3, -5.300000000000001, -6.4, -8.099999999999998, -15.3, -4.300000000000001, -17.5, -8.399999999999999, -4.4, -5.800000000000001, -24.6, -5.000000000000001, -3.2, -4.4, -11.9, -1.2, -4.300000000000001, -5.1000000000000005, -4.300000000000001, -13.5, -3.2, -4.2, -4.300000000000001, -16.9], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2804498947526475, "mean_inference_ms": 4.575201937906706, "mean_action_processing_ms": 0.09080542373347504, "mean_env_wait_ms": 12.412445198511703, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1560000, "timesteps_this_iter": 0, "agent_timesteps_total": 1560000, "timers": {"sample_time_ms": 16419.195, "sample_throughput": 243.617, "load_time_ms": 0.34, "load_throughput": 11749573.5, "learn_time_ms": 8357.445, "learn_throughput": 478.615, "update_time_ms": 1.741}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.4006203064244361, "policy_loss": -0.022217952665842828, "vf_loss": 42.16788647008199, "vf_explained_var": 0.14480932726654955, "kl": 0.01286780451105944, "entropy": 0.1601082846562388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1560000, "num_agent_steps_sampled": 1560000, "num_steps_trained": 1560000, "num_agent_steps_trained": 1560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15756, "training_iteration": 390, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-31-36", "timestamp": 1643657496, "time_this_iter_s": 17.442616939544678, "time_total_s": 12149.308387994766, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12149.308387994766, "timesteps_since_restore": 0, "iterations_since_restore": 390, "perf": {"cpu_util_percent": 27.566666666666663, "ram_util_percent": 64.25}}
{"episode_reward_max": -1.2, "episode_reward_min": -98.70000000000014, "episode_reward_mean": -12.489, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88.4, -4.2, -5.2, -7.499999999999999, -8.999999999999998, -15.5, -7.399999999999999, -9.200000000000003, -4.300000000000001, -8.700000000000001, -8.2, -9.2, -5.000000000000001, -16.999999999999993, -10.099999999999998, -3.3, -12.599999999999996, -8.2, -12.099999999999998, -6.399999999999999, -10.799999999999997, -20.0, -3.7, -3.2, -13.2, -22.50000000000002, -10.999999999999996, -9.4, -18.200000000000003, -3.3, -26.400000000000002, -19.7, -22.6, -24.099999999999998, -21.799999999999958, -98.70000000000014, -7.3, -5.300000000000001, -6.4, -8.099999999999998, -15.3, -4.300000000000001, -17.5, -8.399999999999999, -4.4, -5.800000000000001, -24.6, -5.000000000000001, -3.2, -4.4, -11.9, -1.2, -4.300000000000001, -5.1000000000000005, -4.300000000000001, -13.5, -3.2, -4.2, -4.300000000000001, -16.9, -7.2, -19.900000000000006, -10.099999999999998, -6.2, -23.200000000000003, -18.799999999999997, -5.2, -4.300000000000001, -9.3, -4.2, -4.300000000000001, -5.300000000000001, -12.3, -10.299999999999999, -14.799999999999999, -9.2, -4.300000000000001, -5.300000000000001, -17.099999999999994, -8.399999999999997, -24.799999999999997, -3.2, -17.499999999999996, -20.1, -4.300000000000001, -4.300000000000001, -8.2, -6.300000000000001, -4.4, -12.7, -7.899999999999999, -3.2, -12.799999999999999, -9.09999999999999, -3.2, -8.2, -33.8, -16.699999999999996, -3.2, -76.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2747479012665406, "mean_inference_ms": 4.56678190867699, "mean_action_processing_ms": 0.09075749721561582, "mean_env_wait_ms": 12.395668823946266, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1564000, "timesteps_this_iter": 0, "agent_timesteps_total": 1564000, "timers": {"sample_time_ms": 16745.376, "sample_throughput": 238.872, "load_time_ms": 0.34, "load_throughput": 11749573.5, "learn_time_ms": 8459.55, "learn_throughput": 472.838, "update_time_ms": 1.832}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.3150995208591383, "policy_loss": -0.01925818220241576, "vf_loss": 33.329221014181776, "vf_explained_var": 0.171061312255039, "kl": 0.01182546159834073, "entropy": 0.18373630760658172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1564000, "num_agent_steps_sampled": 1564000, "num_steps_trained": 1564000, "num_agent_steps_trained": 1564000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15796, "training_iteration": 391, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-31-54", "timestamp": 1643657514, "time_this_iter_s": 17.797078132629395, "time_total_s": 12167.105466127396, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12167.105466127396, "timesteps_since_restore": 0, "iterations_since_restore": 391, "perf": {"cpu_util_percent": 35.2, "ram_util_percent": 64.21923076923078}}
{"episode_reward_max": -1.2, "episode_reward_min": -76.3, "episode_reward_mean": -11.527000000000003, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.3, -4.300000000000001, -17.5, -8.399999999999999, -4.4, -5.800000000000001, -24.6, -5.000000000000001, -3.2, -4.4, -11.9, -1.2, -4.300000000000001, -5.1000000000000005, -4.300000000000001, -13.5, -3.2, -4.2, -4.300000000000001, -16.9, -7.2, -19.900000000000006, -10.099999999999998, -6.2, -23.200000000000003, -18.799999999999997, -5.2, -4.300000000000001, -9.3, -4.2, -4.300000000000001, -5.300000000000001, -12.3, -10.299999999999999, -14.799999999999999, -9.2, -4.300000000000001, -5.300000000000001, -17.099999999999994, -8.399999999999997, -24.799999999999997, -3.2, -17.499999999999996, -20.1, -4.300000000000001, -4.300000000000001, -8.2, -6.300000000000001, -4.4, -12.7, -7.899999999999999, -3.2, -12.799999999999999, -9.09999999999999, -3.2, -8.2, -33.8, -16.699999999999996, -3.2, -76.3, -7.199999999999999, -3.2, -13.0, -10.0, -10.499999999999998, -9.8, -11.799999999999997, -9.3, -5.2, -21.599999999999998, -19.7, -15.600000000000001, -19.6, -27.2, -18.500000000000004, -17.800000000000004, -19.099999999999998, -18.50000000000002, -11.500000000000002, -3.6000000000000005, -20.3, -4.300000000000001, -5.2, -5.300000000000001, -23.600000000000005, -10.699999999999998, -21.70000000000002, -3.3, -4.300000000000001, -10.799999999999997, -12.799999999999999, -12.999999999999998, -4.2, -17.2, -5.3999999999999995, -21.4, -11.7, -9.899999999999999, -19.4, -13.799999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.269099259831839, "mean_inference_ms": 4.558467172876304, "mean_action_processing_ms": 0.09071459034586433, "mean_env_wait_ms": 12.37935921117043, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1568000, "timesteps_this_iter": 0, "agent_timesteps_total": 1568000, "timers": {"sample_time_ms": 16907.692, "sample_throughput": 236.579, "load_time_ms": 0.35, "load_throughput": 11444212.824, "learn_time_ms": 8383.93, "learn_throughput": 477.103, "update_time_ms": 1.744}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.11908825988410622, "policy_loss": -0.018523831534830313, "vf_loss": 13.650325460780051, "vf_explained_var": 0.1449909004472917, "kl": 0.01230654510244501, "entropy": 0.18745754565042194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1568000, "num_agent_steps_sampled": 1568000, "num_steps_trained": 1568000, "num_agent_steps_trained": 1568000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15836, "training_iteration": 392, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-32-11", "timestamp": 1643657531, "time_this_iter_s": 16.78095293045044, "time_total_s": 12183.886419057846, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12183.886419057846, "timesteps_since_restore": 0, "iterations_since_restore": 392, "perf": {"cpu_util_percent": 38.50833333333333, "ram_util_percent": 64.14999999999999}}
{"episode_reward_max": -3.2, "episode_reward_min": -76.3, "episode_reward_mean": -12.108000000000002, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.799999999999997, -3.2, -17.499999999999996, -20.1, -4.300000000000001, -4.300000000000001, -8.2, -6.300000000000001, -4.4, -12.7, -7.899999999999999, -3.2, -12.799999999999999, -9.09999999999999, -3.2, -8.2, -33.8, -16.699999999999996, -3.2, -76.3, -7.199999999999999, -3.2, -13.0, -10.0, -10.499999999999998, -9.8, -11.799999999999997, -9.3, -5.2, -21.599999999999998, -19.7, -15.600000000000001, -19.6, -27.2, -18.500000000000004, -17.800000000000004, -19.099999999999998, -18.50000000000002, -11.500000000000002, -3.6000000000000005, -20.3, -4.300000000000001, -5.2, -5.300000000000001, -23.600000000000005, -10.699999999999998, -21.70000000000002, -3.3, -4.300000000000001, -10.799999999999997, -12.799999999999999, -12.999999999999998, -4.2, -17.2, -5.3999999999999995, -21.4, -11.7, -9.899999999999999, -19.4, -13.799999999999997, -34.7, -3.2, -11.4, -6.4, -5.4, -12.599999999999973, -12.899999999999999, -12.199999999999998, -4.4, -21.9, -3.4, -16.6, -4.700000000000001, -7.2, -12.9, -17.299999999999997, -17.799999999999997, -9.600000000000001, -7.0, -3.3, -11.1, -12.7, -7.6, -5.9, -12.099999999999996, -3.7000000000000006, -20.1, -3.3, -8.999999999999998, -3.3, -11.899999999999997, -4.4, -5.300000000000001, -4.2, -25.3, -7.3, -16.9, -5.300000000000001, -3.3, -22.000000000000004], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.263470012501133, "mean_inference_ms": 4.550329403841459, "mean_action_processing_ms": 0.09067962667232171, "mean_env_wait_ms": 12.363868657224094, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1572000, "timesteps_this_iter": 0, "agent_timesteps_total": 1572000, "timers": {"sample_time_ms": 16863.401, "sample_throughput": 237.2, "load_time_ms": 0.349, "load_throughput": 11448117.366, "learn_time_ms": 8490.385, "learn_throughput": 471.121, "update_time_ms": 1.722}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.09414091686898422, "policy_loss": -0.018473414226525254, "vf_loss": 11.173488956625743, "vf_explained_var": 0.22378974230058732, "kl": 0.009760574162308612, "entropy": 0.18114132109268377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1572000, "num_agent_steps_sampled": 1572000, "num_steps_trained": 1572000, "num_agent_steps_trained": 1572000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15876, "training_iteration": 393, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-32-30", "timestamp": 1643657550, "time_this_iter_s": 18.658158779144287, "time_total_s": 12202.54457783699, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12202.54457783699, "timesteps_since_restore": 0, "iterations_since_restore": 393, "perf": {"cpu_util_percent": 43.869230769230775, "ram_util_percent": 64.20000000000002}}
{"episode_reward_max": -3.0, "episode_reward_min": -34.7, "episode_reward_mean": -11.199999999999998, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.3, -4.300000000000001, -5.2, -5.300000000000001, -23.600000000000005, -10.699999999999998, -21.70000000000002, -3.3, -4.300000000000001, -10.799999999999997, -12.799999999999999, -12.999999999999998, -4.2, -17.2, -5.3999999999999995, -21.4, -11.7, -9.899999999999999, -19.4, -13.799999999999997, -34.7, -3.2, -11.4, -6.4, -5.4, -12.599999999999973, -12.899999999999999, -12.199999999999998, -4.4, -21.9, -3.4, -16.6, -4.700000000000001, -7.2, -12.9, -17.299999999999997, -17.799999999999997, -9.600000000000001, -7.0, -3.3, -11.1, -12.7, -7.6, -5.9, -12.099999999999996, -3.7000000000000006, -20.1, -3.3, -8.999999999999998, -3.3, -11.899999999999997, -4.4, -5.300000000000001, -4.2, -25.3, -7.3, -16.9, -5.300000000000001, -3.3, -22.000000000000004, -9.3, -4.300000000000001, -8.2, -32.4, -7.300000000000001, -10.799999999999999, -3.3, -4.2, -13.3, -3.0, -20.4, -5.300000000000001, -10.399999999999997, -14.199999999999978, -4.300000000000001, -9.599999999999998, -11.599999999999982, -4.9, -7.4, -10.0, -27.400000000000002, -8.3, -22.599999999999948, -3.3, -17.5, -6.799999999999999, -5.1000000000000005, -16.599999999999998, -9.3, -8.8, -14.399999999999999, -13.700000000000001, -8.499999999999998, -22.9, -11.299999999999997, -9.999999999999996, -6.1, -11.5, -29.5, -14.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.258101379568203, "mean_inference_ms": 4.542660104413638, "mean_action_processing_ms": 0.09066706332316833, "mean_env_wait_ms": 12.350463514229908, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1576000, "timesteps_this_iter": 0, "agent_timesteps_total": 1576000, "timers": {"sample_time_ms": 17359.839, "sample_throughput": 230.417, "load_time_ms": 0.353, "load_throughput": 11328302.498, "learn_time_ms": 8637.178, "learn_throughput": 463.114, "update_time_ms": 1.792}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.1091183992768688, "policy_loss": -0.01769630985474715, "vf_loss": 12.561504621915919, "vf_explained_var": 0.2607744625178717, "kl": 0.013314591989959728, "entropy": 0.20960368516464387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1576000, "num_agent_steps_sampled": 1576000, "num_steps_trained": 1576000, "num_agent_steps_trained": 1576000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15916, "training_iteration": 394, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-32-50", "timestamp": 1643657570, "time_this_iter_s": 20.73088002204895, "time_total_s": 12223.27545785904, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12223.27545785904, "timesteps_since_restore": 0, "iterations_since_restore": 394, "perf": {"cpu_util_percent": 48.67333333333333, "ram_util_percent": 64.22000000000001}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -32.4, "episode_reward_mean": -10.211, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.1, -12.7, -7.6, -5.9, -12.099999999999996, -3.7000000000000006, -20.1, -3.3, -8.999999999999998, -3.3, -11.899999999999997, -4.4, -5.300000000000001, -4.2, -25.3, -7.3, -16.9, -5.300000000000001, -3.3, -22.000000000000004, -9.3, -4.300000000000001, -8.2, -32.4, -7.300000000000001, -10.799999999999999, -3.3, -4.2, -13.3, -3.0, -20.4, -5.300000000000001, -10.399999999999997, -14.199999999999978, -4.300000000000001, -9.599999999999998, -11.599999999999982, -4.9, -7.4, -10.0, -27.400000000000002, -8.3, -22.599999999999948, -3.3, -17.5, -6.799999999999999, -5.1000000000000005, -16.599999999999998, -9.3, -8.8, -14.399999999999999, -13.700000000000001, -8.499999999999998, -22.9, -11.299999999999997, -9.999999999999996, -6.1, -11.5, -29.5, -14.3, -10.3, -11.600000000000001, -7.499999999999998, -10.599999999999998, -3.3, -4.4, -12.199999999999989, -10.299999999999999, -2.4000000000000004, -4.4, -12.9, -5.4, -5.300000000000001, -5.3, -6.8999999999999995, -5.9, -10.599999999999996, -26.400000000000027, -3.8000000000000003, -6.2, -5.799999999999999, -4.3, -5.699999999999999, -8.9, -5.6, -7.3, -5.9, -4.9, -7.199999999999999, -10.8, -9.7, -12.1, -10.7, -13.499999999999998, -20.400000000000016, -4.1, -4.2, -5.6, -21.5, -30.400000000000045], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2528711015567584, "mean_inference_ms": 4.5352500362322905, "mean_action_processing_ms": 0.0906649466142095, "mean_env_wait_ms": 12.338025441841678, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1580000, "timesteps_this_iter": 0, "agent_timesteps_total": 1580000, "timers": {"sample_time_ms": 17755.16, "sample_throughput": 225.287, "load_time_ms": 0.351, "load_throughput": 11382872.651, "learn_time_ms": 8736.337, "learn_throughput": 457.858, "update_time_ms": 1.784}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.09698114590569129, "policy_loss": -0.01631005628094558, "vf_loss": 11.254045291805781, "vf_explained_var": 0.29055107017999054, "kl": 0.008332319302528148, "entropy": 0.19791747052823344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1580000, "num_agent_steps_sampled": 1580000, "num_steps_trained": 1580000, "num_agent_steps_trained": 1580000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15956, "training_iteration": 395, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-33-09", "timestamp": 1643657589, "time_this_iter_s": 18.77164602279663, "time_total_s": 12242.047103881836, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12242.047103881836, "timesteps_since_restore": 0, "iterations_since_restore": 395, "perf": {"cpu_util_percent": 44.24444444444444, "ram_util_percent": 64.23703703703703}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -66.3, "episode_reward_mean": -11.486, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.5, -6.799999999999999, -5.1000000000000005, -16.599999999999998, -9.3, -8.8, -14.399999999999999, -13.700000000000001, -8.499999999999998, -22.9, -11.299999999999997, -9.999999999999996, -6.1, -11.5, -29.5, -14.3, -10.3, -11.600000000000001, -7.499999999999998, -10.599999999999998, -3.3, -4.4, -12.199999999999989, -10.299999999999999, -2.4000000000000004, -4.4, -12.9, -5.4, -5.300000000000001, -5.3, -6.8999999999999995, -5.9, -10.599999999999996, -26.400000000000027, -3.8000000000000003, -6.2, -5.799999999999999, -4.3, -5.699999999999999, -8.9, -5.6, -7.3, -5.9, -4.9, -7.199999999999999, -10.8, -9.7, -12.1, -10.7, -13.499999999999998, -20.400000000000016, -4.1, -4.2, -5.6, -21.5, -30.400000000000045, -21.1, -6.300000000000001, -20.400000000000006, -14.199999999999998, -8.5, -9.3, -4.300000000000001, -25.3, -18.89999999999999, -15.799999999999999, -3.3, -8.399999999999999, -10.499999999999984, -14.299999999999997, -4.2, -20.599999999999998, -8.399999999999999, -15.999999999999993, -15.5, -10.999999999999998, -3.2, -10.4, -10.4, -3.3, -24.90000000000002, -66.3, -11.599999999999998, -3.3, -5.300000000000001, -15.499999999999993, -4.5, -9.2, -26.400000000000002, -16.2, -8.299999999999999, -12.2, -17.6, -5.699999999999999, -22.7, -6.300000000000001, -22.900000000000006, -3.3, -8.9, -3.3], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3464579626548607, "mean_inference_ms": 4.6239267586109944, "mean_action_processing_ms": 0.0907044309980575, "mean_env_wait_ms": 12.127610848624695, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1584000, "timesteps_this_iter": 0, "agent_timesteps_total": 1584000, "timers": {"sample_time_ms": 17956.018, "sample_throughput": 222.767, "load_time_ms": 0.353, "load_throughput": 11320658.57, "learn_time_ms": 8875.166, "learn_throughput": 450.696, "update_time_ms": 1.783}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515623, "cur_lr": 0.00010000000000000003, "total_loss": 0.2621934157267954, "policy_loss": -0.012529594671501908, "vf_loss": 27.390026535910945, "vf_explained_var": 0.05787790129261632, "kl": 0.009131386797508802, "entropy": 0.16591965353456878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1584000, "num_agent_steps_sampled": 1584000, "num_steps_trained": 1584000, "num_agent_steps_trained": 1584000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16000, "training_iteration": 396, "trial_id": "ff1e1_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-01-31_19-33-27", "timestamp": 1643657607, "time_this_iter_s": 17.46177315711975, "time_total_s": 12259.508877038956, "pid": 29697, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12259.508877038956, "timesteps_since_restore": 0, "iterations_since_restore": 396, "perf": {"cpu_util_percent": 39.5, "ram_util_percent": 64.308}}
